"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9947],{56087:function(e,t,a){a.d(t,{y:function(){return r}});var n=a(15969),i=a(96187);let l=async(e,t)=>{let{eventSlug:a,source:n,medium:l,campaign:r,term:o,content:s,utmId:c,referralId:d,...u}=e||{},m=Object.fromEntries(Object.entries({utm_source:n,utm_medium:l,utm_campaign:r,utm_term:o,utm_content:s,utm_id:c,referralId:d}).filter(e=>{let[,t]=e;return t}));return await (0,i._)("/public/event/".concat(a,"/register"),{method:"POST",body:JSON.stringify({...u,...m}),...t})},r=e=>(0,n.useMutation)({mutationKey:["RegisterOnEvent"],mutationFn:e=>l(e),...e});r.fetcher=(e,t)=>l(e,t)},9947:function(e,t,a){a.d(t,{I:function(){return L}});var n=a(27573),i=a(7653);a(39068);var l=a(83980),r=a(5512),o=a(31813),s=a(74242),c=a(84969),d=a(59908),u=a(25665),m=a(50294),h=a(81695),g=a(93351),v=a(36176),x=a(41946),p=a(56087),f=a(5068),j=a(96187);let y="GetEventBySlug";async function b(e,t){let{eventSlug:a}=e;return await (0,j._)("/v2/events/".concat(a),{...t,isPublic:!0})}let w=(e,t)=>(0,f.useQuery)({queryKey:[y],queryFn:()=>b(e),...t});w.queryKey=y,w.getKey=e=>[y,e],w.fetcher=(e,t)=>b(e,t);var _=a(73131),N=a(1370),C=a(49288),k=a(23131),M=a(61213),E=a(52114),S=a(86565);let T=(e,t)=>{let a=Array.from({length:(0,E.Z)((0,c.Z)(t),(0,c.Z)(e))+1}).map((t,a)=>(0,S.Z)((0,c.Z)(e),{days:a})),i=1===a.length;return a.map((e,t)=>i?(0,n.jsx)("span",{children:(0,n.jsx)("strong",{children:(0,d.Z)(e,"dd")})},String(e)):t===a.length-1?(0,n.jsxs)("span",{children:["e ",(0,n.jsx)("strong",{children:(0,d.Z)(e,"dd")})]},String(e)):t===a.length?(0,n.jsx)("span",{children:(0,n.jsx)("strong",{children:(0,d.Z)(e,"dd")})},String(e)):(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{children:(0,d.Z)(e,"dd")}),","," "]},String(e)))};var Z=a(25602),A=a(44810);let F=A.Ry({name:A.Z_().when("$hasName",{is:!1,then:A.Z_().min(5,"Preencha seu nome completo").required("Nome \xe9 obrigat\xf3rio")}),email:A.Z_().when("$hasEmail",{is:!1,then:A.Z_().email("Email inv\xe1lido").required("Email \xe9 obrigat\xf3rio")}),phone:A.Z_().when("$hasPhone",{is:!1,then:A.Z_().test("phone","Telefone inv\xe1lido",e=>{var t;let a=e?null===(t=(0,v.SR)(e))||void 0===t?void 0:t.number:null;return!a||(0,v.tm)(a)}).required("Telefone \xe9 obrigat\xf3rio")}),trail:A.Ry().when("$hasTrails",{is:!0,then:A.Ry({value:A.Z_().required("Trilha \xe9 obrigat\xf3ria"),label:A.Z_()}).required()}),terms:A.O7().oneOf([!0],"Voc\xea deve aceitar os termos e condi\xe7\xf5es para continuar").required()}).required(),P="Garantir ingresso gratuito",I=e=>{var t,a,f,j,y,b,w;let{event:_,onOpenChange:E,referralUtmContent:S}=e,{user:A,isAuthenticated:I}=(0,k.a)(),{showTriggerModalFromStorage:L}=(0,M.l)(),O=(0,h.useSearchParams)(),D=null==A?void 0:A.name,q=null==A?void 0:A.email,B=null==A?void 0:A.phone,z="https://app.rocketseat.com.br/events",H=S||"eventos_plataforma-lp_inscricao",R="utm_source=site&utm_medium=organic&utm_campaign=lead&utm_term=".concat(_.slug,"&utm_content=").concat(H),U=(0,i.useMemo)(()=>(null==_?void 0:_.eventTrails)||[],[null==_?void 0:_.eventTrails]),K=(null==U?void 0:U.length)>1,G=null==_?void 0:_.start_date,V=null==_?void 0:_.end_date,J=null==U?void 0:U.map(e=>({value:e.slug,label:e.title,icon:(0,n.jsx)(m.default,{src:e.icon_url,width:32,height:32,alt:"Icone da trilha ".concat(null==e?void 0:e.title)})})),X=T(G,V),$=(0,s.Z)((0,c.Z)(G),(0,c.Z)(V)),Q=(0,d.Z)((0,c.Z)(G),"MMMM",{locale:u.Z}),W=(0,d.Z)((0,c.Z)(G),"HH"),{mutateAsync:Y}=(0,p.y)(),{mutateAsync:ee}=(0,x.G)(),{control:et,register:ea,setValue:en,handleSubmit:ei,formState:{errors:el,isSubmitting:er}}=(0,g.cI)({resolver:(0,o.X)(F),context:{hasName:!!D,hasEmail:!!q,hasPhone:!!B,hasTrails:K}}),eo=null==O?void 0:O.get("utm_source"),es=null==O?void 0:O.get("utm_medium"),ec=null==O?void 0:O.get("utm_campaign"),ed=null==O?void 0:O.get("utm_id"),eu=null==O?void 0:O.get("utm_term"),em=null==O?void 0:O.get("utm_content"),eh=null==O?void 0:O.get("referral_id"),eg=(0,i.useMemo)(()=>({source:eo||"platform",medium:es||"organic",campaign:ec||"lead",term:eu||_.slug,content:em||H,utmId:ed||void 0,referralId:eh||void 0}),[H,_.slug,eh,ec,em,ed,es,eo,eu]),ev=(0,i.useCallback)(async e=>{try{var t,a,n,i;let{name:l,email:r,phone:o,trail:s}=e,c=D||l||"",d=q||r||"",u=B||o,m=K?null==s?void 0:s.value:U[0].slug||"",h=u||"",g=null===(t=(0,v.SR)(String(u)))||void 0===t?void 0:t.number;g&&(h=String(g));let x=await Y({name:c,email:d,phone:h,eventSlug:_.slug,trail:m,pageUri:window.location.href,...eg});I&&await ee({tags:[N.c.ACCOUNT,N.c.ACCOUNT_EVENT]}),C.H.track("[Event subscription] Modal Clicked",{ButtonLabel:P,ContentName:null==_?void 0:_.title,ContentType:"Evento",Page:window.location.pathname});let p=(null==_?void 0:null===(n=_.metadata)||void 0===n?void 0:null===(a=n.lp_cta_url)||void 0===a?void 0:a.includes(z))?"".concat(z,"/").concat(_.slug):"".concat(null==_?void 0:null===(i=_.metadata)||void 0===i?void 0:i.lp_cta_url,"/obrigado/").concat(x.referralId,"?").concat(R);L("Inscrito em um evento"),window.open(p,"_blank"),window.location.pathname="/events/".concat(null==_?void 0:_.slug,"/overview")}catch(e){r.toast.danger({title:"Ingresso",description:"Erro ao registrar o ingresso, por favor tente novamente"})}},[null==_?void 0:null===(t=_.metadata)||void 0===t?void 0:t.lp_cta_url,_.slug,null==_?void 0:_.title,K,I,R,Y,ee,L,U,q,D,B,eg]);return(0,i.useEffect)(()=>{en("terms",!1)},[]),(0,n.jsxs)(r.Modal.Content,{className:"flex flex-col justify-between h-full max-h-full bg-gray-800 w-full max-w-[29.75rem] md:h-fit md:max-h-[90vh]",children:[(0,n.jsx)(r.Modal.Header,{title:"Participe gratuitamente",onClose:()=>E&&E(!1)}),(0,n.jsxs)("form",{onSubmit:ei(ev),className:"flex flex-col gap-6 px-6 py-7 h-full overflow-y-auto md:px-8",children:[(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-6 h-full",children:[(0,n.jsxs)("p",{className:"text-gray-200",children:["O evento acontecer\xe1 ",$?"no dia":"nos dias"," ",X," de ",(0,n.jsx)("strong",{children:Q}),", \xe0s"," ",(0,n.jsx)("strong",{children:"".concat(W,"h")}),", na ",(0,n.jsx)("strong",{children:"plataforma"})," ","da ",(0,n.jsx)("strong",{children:"Rocketseat"}),"!"]}),!D&&(0,n.jsx)(Z.g,{label:"Nome",errorMessage:null==el?void 0:null===(a=el.name)||void 0===a?void 0:a.message,children:(0,n.jsx)(r.TextField,{...ea("name"),placeholder:"Digite seu nome completo",className:"border-gray-900",disabled:er})}),!q&&(0,n.jsx)(Z.g,{label:"Email",errorMessage:null==el?void 0:null===(f=el.email)||void 0===f?void 0:f.message,children:(0,n.jsx)(r.TextField,{...ea("email"),placeholder:"Digite seu email",className:"border-gray-900",disabled:er})}),!B&&(0,n.jsx)(Z.g,{label:"Telefone",errorMessage:null==el?void 0:null===(j=el.phone)||void 0===j?void 0:j.message,children:(0,n.jsx)(g.Qr,{name:"phone",control:et,render:e=>{let{field:{onChange:t,value:a}}=e;return(0,n.jsx)(v.ZP,{international:!0,value:a,defaultCountry:"BR",limitMaxLength:!0,disabled:er,placeholder:"Digite seu n\xfamero de Whatsapp",onChange:t,className:"h-12 rounded-sm bg-gray-900 w-full border border-gray-900 px-4 [&_*]:placeholder-gray-400 [&_*]:bg-transparent focus:[&_*]:outline-none [&_option]:bg-gray-900 [&_option]:text-gray-100 outline-none transition-colors focus:border-purpleseat-light hover:border-purpleseat-light placeholder:text-gray-400 text-gray-100"})}})}),K&&(0,n.jsx)(Z.g,{label:"Trilha",errorMessage:null==el?void 0:null===(b=el.trail)||void 0===b?void 0:null===(y=b.value)||void 0===y?void 0:y.message,children:(0,n.jsx)(g.Qr,{name:"trail",control:et,render:e=>{let{field:{name:t,onChange:a,value:i}}=e;return(0,n.jsx)(r.Autocomplete,{name:t,value:i,onChange:a,options:J,placeholder:"Escolha sua trilha",leftIcon:(0,n.jsx)(l.SourceCodeIcon,{size:24}),className:"rounded-sm text-gray-100"})}})}),(0,n.jsx)(Z.g,{errorMessage:null==el?void 0:null===(w=el.terms)||void 0===w?void 0:w.message,children:(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(r.Checkbox,{...ea("terms"),onCheckedChange:e=>en("terms",!!e),disabled:er}),(0,n.jsxs)("p",{className:"text-gray-300 text-xs",children:["Autorizo o envio de comunica\xe7\xf5es por e-mail ou qualquer outro meio e concordo com os"," ",(0,n.jsx)("a",{className:"underline",href:"https://www.rocketseat.com.br/terms",rel:"noopener noreferrer",target:"_blank",children:"Termos"})," e ",(0,n.jsx)("a",{className:"underline",href:"https://www.rocketseat.com.br/privacy?",rel:"noopener noreferrer",target:"_blank",children:"Pol\xedticas de privacidade."})]})]})}),(0,n.jsx)(r.Button,{type:"submit",loading:er,disabled:er,className:"mt-6",children:P})]}),(0,n.jsx)(r.Divider,{orientation:"horizontal",className:"w-full"}),(0,n.jsxs)("div",{className:"flex gap-2 w-full items-center justify-center",children:[(0,n.jsx)(m.default,{src:"/assets/icons/journey/color-shield-check.svg",width:24,height:24,alt:""}),(0,n.jsxs)("p",{className:"text-gray-100",children:["Seus dados est\xe3o"," ",(0,n.jsx)("span",{className:"text-success-light",children:"100% seguros"})]})]})]})]})},L=e=>{let{open:t,eventSlug:a,onOpenChange:l,referralUtmContent:o}=e,[s,c]=(0,i.useState)(null);return(0,i.useEffect)(()=>{(async function(){c(await w.fetcher({eventSlug:a},{next:{revalidate:1*_.Xk.Day,tags:[N.c.GET_EVENT_BY_SLUG,"".concat(N.c.GET_EVENT_BY_SLUG,":").concat(a)]}}))})()},[a]),(0,n.jsx)(r.Modal,{open:t,onOpenChange:l,children:(0,n.jsxs)(r.Modal.Portal,{children:[(0,n.jsx)(r.Modal.Overlay,{}),s?(0,n.jsx)(I,{event:s,onOpenChange:l,referralUtmContent:o}):(0,n.jsx)("div",{})]})})}},25602:function(e,t,a){a.d(t,{g:function(){return l}});var n=a(27573),i=a(64933);let l=e=>{let{label:t,errorMessage:a,isMandatory:l,className:r,children:o,...s}=e;return(0,n.jsxs)("div",{className:(0,i.cn)("flex flex-col gap-2 self-stretch",r),...s,children:[!!t&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-gray-200 text-sm",children:t})," ",l&&(0,n.jsx)("span",{className:"text-[#F75A68]",children:"*"})]}),o,!!a&&(0,n.jsx)("span",{className:"text-sm text-danger-light",children:a})]})}},51710:function(e,t,a){a.d(t,{EventAuthProvider:function(){return s},e:function(){return c}});var n=a(27573),i=a(7653),l=a(49370),r=a(23131);let o=(0,i.createContext)({}),s=e=>{let{children:t,initialUser:a,jwtToken:s}=e,[c,d]=(0,i.useState)(a||null),u=(0,i.useRef)(!1),m=!!c,h=(0,i.useCallback)(function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if((0,r.e)(),l.I.reset(),e){let e=window.location.pathname,t=new URLSearchParams(window.location.search);t.set("logout","true"),t.set("to",e);let a=t.toString();window.location.href="/?".concat(a)}},[]);(0,i.useEffect)(()=>{c&&m&&!u.current&&((0,l.R)({userId:c.id,name:c.name,email:c.email}),u.current=!0)},[m,c]);let g=(0,i.useMemo)(()=>({isAuthenticated:m,user:c,setUser:d,jwtToken:s,signOut:h}),[m,s,h,c]);return(0,n.jsx)(o.Provider,{value:g,children:t})};function c(){return(0,i.useContext)(o)}},61213:function(e,t,a){a.d(t,{NotificationProvider:function(){return F},l:function(){return P}});var n=a(27573),i=a(7653),l=a(5512),r=a(54077),o=a(91204),s=a(69174),c=a(50294),d=a(81695),u=a(64825),m=a(15969),h=a(96187);let g=async(e,t)=>{let{hash:a}=e;await (0,h._)("/users/device",{method:"DELETE",body:JSON.stringify({hash:a}),...t})},v=e=>(0,m.useMutation)({mutationKey:["DeleteNotificationDevice"],mutationFn:g,...e});v.fetcher=(e,t)=>g(e,t);let x=async(e,t)=>{let{hash:a}=e;await (0,h._)("/users/device",{method:"POST",body:JSON.stringify({hash:a}),...t})},p=e=>(0,m.useMutation)({mutationKey:["SendNotificationDevice"],mutationFn:x,...e});p.fetcher=(e,t)=>x(e,t);let f=async(e,t)=>{let{notificationId:a,action:n,deviceToken:i,from:l}=e;await (0,h._)("/v2/notifications/metrics",{method:"PUT",body:JSON.stringify({notification_id:a,action:n,device_token:i,from:l}),...t})},j=e=>(0,m.useMutation)({mutationKey:["SendNotificationMetrics"],mutationFn:f,...e});j.fetcher=(e,t)=>f(e,t);var y=a(73131),b=a(98531);let w=0===(0,b.C6)().length?(0,b.ZF)({apiKey:"AIzaSyA4KL0w5LHX7wj1-e3BoIsKq7wpbhmfiNA",authDomain:"rocketseat-42.firebaseapp.com",projectId:"rocketseat-42",storageBucket:"rocketseat-42.appspot.com",messagingSenderId:"668279521235",appId:"1:668279521235:web:42bb5f768bc059c5d0b926",measurementId:"G-S77CKG4C8H"}):(0,b.Mq)(),_=async()=>await (0,s.Gb)()?(0,s.KL)(w):null,N=async()=>{try{let e=await _();if(e)return await (0,s.LP)(e,{vapidKey:"BD1ad_jbgOlXti9nZVLGrzrbi_inEheSTU-IDVx_TBm1FhD1XlUwz4ki4UNmWU4k54xucC5hzDC7zsZxFvxGeog"});return null}catch(e){return console.error("FirebaseFetchTokenError:",e),null}};var C=a(49288),k=a(83980),M=a(88146);let E=()=>{let{permissionStatus:e,activatePushNotifications:t,triggerModalVisible:a}=P(),[i,r]=(0,u._)(y.Fe.DismissedTriggerModal,!1);return i||"granted"===e?null:(0,n.jsx)(l.Modal,{open:a,onOpenChange:e=>!e&&r(!0),children:(0,n.jsxs)(l.Modal.Portal,{children:[(0,n.jsx)(l.Modal.Overlay,{className:"z-[101]"}),(0,n.jsxs)(l.Modal.Content,{className:"max-w-[520px] bg-gray-800 z-[111]",children:[(0,n.jsx)(l.Modal.Header,{image:S,title:"N\xe3o perca as \xfaltimas novidades e atualiza\xe7\xf5es da plataforma!",className:"bg-none [&_.AuiModalHeader-title]:line-clamp-none",onClose:()=>{r(!0),C.H.track("[Notification] Push modal click",{Action:"Fechar"})}}),(0,n.jsxs)("div",{className:"flex flex-col gap-6 overflow-auto px-6 md:px-12",children:[(0,n.jsx)("p",{className:"text-sm text-gray-200 text-center",children:"Ative agora mesmo as notifica\xe7\xf5es em seu dispositivo para se manter sempre por dentro de tudo:"}),(0,n.jsxs)("div",{className:"grid md:grid-cols-[repeat(2,minmax(0,max-content))] justify-center pb-6 border-b border-b-gray-700 gap-x-4 gap-y-2 text-sm text-gray-200",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(k.BookIcon,{className:"size-5 text-purpleseat-light"}),(0,n.jsx)(n.Fragment,{children:"Novas aulas e conte\xfados"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(k.TicketIcon,{className:"size-5 text-purpleseat-light"}),(0,n.jsx)(n.Fragment,{children:"Eventos exclusivos"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(k.MyJourneyIcon,{className:"size-5 text-purpleseat-light"}),(0,n.jsx)(n.Fragment,{children:"Lembretes de tarefas"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(k.AddIcon,{className:"size-5 text-purpleseat-light"}),(0,n.jsx)(n.Fragment,{children:"E muito mais!"})]})]}),(0,n.jsx)("p",{className:"text-xs text-gray-400 text-center md:px-4",children:"* Voc\xea pode ajustar suas prefer\xeancias de notifica\xe7\xf5es a qualquer momento nas configura\xe7\xf5es de conta."})]}),(0,n.jsxs)(l.Modal.Actions,{className:"bg-transparent [&_.AuiModalActions-buttons]:justify-center max-md:[&_.AuiModalActions-buttons]:flex-col-reverse max-md:[&_.AuiModalActions-buttons>*]:w-full",children:[(0,n.jsx)(M.default,{href:"/account/notification-preferences",onClick:()=>r(!0),children:(0,n.jsx)(l.Button,{variant:"secondary",className:"max-md:w-full",onClick:()=>C.H.track("[Notification] Push modal click",{Action:"Prefer\xeancias"}),children:"Prefer\xeancias"})}),(0,n.jsx)(l.Button,{onClick:()=>{t(),C.H.track("[Notification] Push modal click",{Action:"denied"===e?"Central de ajuda":"Habilitar no navegador"})},rightIcon:"denied"===e&&(0,n.jsx)(k.ArrowUpRightIcon,{}),children:"prompt"===e?"Ativar agora":"Ver como habilitar"})]})]})]})})},S=(0,n.jsxs)("svg",{width:"64",height:"60",viewBox:"0 0 64 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M4.48636 48.5969C9.22712 55.5506 18.4971 59.0769 32.0345 59.0769L32.0572 59.0769C45.5744 59.073 54.8217 55.5455 59.5419 48.5927C63.4933 42.772 64 35.3523 64 29.5384C64 23.7248 63.4933 16.3054 59.5419 10.4849C54.8217 3.53223 45.5744 0.00463933 32.0568 2.804e-06L32.0303 2.80632e-06C18.4932 -0.000227896 9.22712 3.52536 4.48666 10.4791C0.509923 16.3123 5.88914e-06 23.7288 6.39703e-06 29.5384C6.9049e-06 35.3479 0.509918 42.7641 4.48636 48.5969Z",fill:"#323238"}),(0,n.jsx)("path",{d:"M42.8249 40.8295H48.0001L39.9047 32.736C44.1671 27.5144 45.9134 22.2271 43.8053 20.1191C41.5175 17.8294 37.0482 18.2104 30.7552 23.5867L31.9136 24.7451C36.1199 21.2099 40.0226 19.45 41.2894 20.7187C42.8172 22.2464 39.8584 27.6846 34.7836 32.7883L42.8249 40.8295Z",fill:"#B585FB"}),(0,n.jsx)("path",{d:"M20.1947 39.8801C22.4826 42.1699 26.95 41.791 33.2409 36.4166L32.0825 35.2581C27.8763 38.7934 23.9775 40.5512 22.7108 39.2826C21.181 37.7529 24.1399 32.3166 29.2146 27.2111L21.1733 19.1699H16.0001L24.0955 27.2633C19.835 32.485 18.0868 37.7724 20.1947 39.8801Z",fill:"#B585FB"})]});var T=a(23131),Z=a(51710);let A=(0,i.createContext)({permissionStatus:"prompt",activatePushNotifications:()=>{},showTriggerModal:()=>{},showTriggerModalFromStorage:()=>{},triggerModalVisible:!1}),F=e=>{let{children:t}=e,a=(0,d.useRouter)(),{isAuthenticated:m}=(0,T.a)(),{isAuthenticated:h}=(0,Z.e)(),{mutateAsync:g}=p(),{mutateAsync:x}=v(),{mutateAsync:f}=j(),[b,w]=(0,i.useState)(null),[k,M]=(0,i.useState)(!1),[S,F]=(0,u._)(y.Fe.FCMToken,null),[P,I]=(0,u._)(y.Fe.FCMTokenExpirationDate,null),[L,O]=(0,u._)(y.Fe.OpenTriggerModalAction,null),D=(0,i.useRef)(0),q=(0,i.useRef)(!1),B=(0,i.useCallback)(async()=>{try{let e=await N(),t=(0,r.Z)(new Date,7);return e&&(await g({hash:e}),F(e),I(t)),e}catch(e){return console.error("Failed to fetch new FCM token:",e),null}},[g,F,I]),z=(0,i.useCallback)(async()=>{S&&await x({hash:S}),F(null),I(null)},[x,F,I,S]),H=(0,i.useCallback)(async()=>S&&P&&(0,o.Z)(new Date(P),new Date)?S:(z(),B()),[B,z,S,P]),R=(0,i.useCallback)(async()=>{if((m||h)&&!q.current){if(q.current=!0,!await H()){D.current<3?(D.current+=1,q.current=!1,await R()):console.error("Unable to load FCM token after multiple attempts");return}q.current=!1}},[m,h,H]),U=(0,i.useCallback)(()=>{"denied"===b?window.open(y.er,"_blank"):"prompt"===b&&Notification.requestPermission()},[b]),K=(0,i.useCallback)(e=>{M(!0),C.H.track("[Notification] Push modal view",{Trigger:e})},[]),G=(0,i.useCallback)(e=>{O(e)},[O]);(0,i.useEffect)(()=>{let e;return navigator.permissions&&navigator.permissions.query({name:"notifications"}).then(t=>{w(t.state),e=e=>{w(e.target.state)},t.addEventListener("change",e)}),()=>{e&&navigator.permissions.query({name:"notifications"}).then(t=>{e&&t.removeEventListener("change",e)})}},[]),(0,i.useEffect)(()=>{"denied"===b?z():"granted"===b&&R()},[R,b,z]),(0,i.useEffect)(()=>{let e;return(async()=>{if(!S)return;let e=await _();if(e)return(0,s.ps)(e,e=>{var t,a,i,r,o,s,d,u;let m=(null==e?void 0:null===(t=e.fcmOptions)||void 0===t?void 0:t.link)||(null===(a=e.data)||void 0===a?void 0:a.links_to),h=null===(i=e.data)||void 0===i?void 0:i.device_token,g=null===(r=e.data)||void 0===r?void 0:r.notification_id,v=null===(o=e.data)||void 0===o?void 0:o.context_icon_url,x=null===(s=e.data)||void 0===s?void 0:s.context_title;l.toast.default({title:(0,n.jsx)("span",{className:"uppercase text-[10px] text-purpleseat-light",children:null===(d=e.data)||void 0===d?void 0:d.title}),description:null===(u=e.data)||void 0===u?void 0:u.body,duration:1e4,...v&&{icon:e=>{let{className:t,...a}=e;return(0,n.jsxs)("div",{className:(0,l.cn)("relative",t),...a,children:[(0,n.jsx)(c.default,{src:v,width:24,height:24,alt:x||"Notifica\xe7\xe3o"}),(0,n.jsx)("div",{className:"w-2 h-2 bg-greenseat-light rounded outline outline-4 outline-gray-700 absolute top-0 left-0"})]})}},className:"[&_.AuiToastDescription]:line-clamp-2",onClick:()=>{window.open(m,"_blank"),h&&g&&f({action:"click",deviceToken:h,notificationId:g,from:"toast"})}}),h&&g&&f({action:"receive",deviceToken:h,notificationId:g,from:"toast"})})})().then(t=>{t&&(e=t)}),()=>null==e?void 0:e()},[S,a,f]),(0,i.useEffect)(()=>{L&&(K(L),O(null))},[]);let V=(0,i.useMemo)(()=>({permissionStatus:b||"prompt",activatePushNotifications:U,showTriggerModal:K,showTriggerModalFromStorage:G,triggerModalVisible:k}),[b,U,K,G,k]);return(0,n.jsxs)(A.Provider,{value:V,children:[t,(0,n.jsx)(E,{})]})},P=()=>{let e=(0,i.useContext)(A);if(!e)throw Error("useNotification must be used within a NotificationProvider");return e}}}]);