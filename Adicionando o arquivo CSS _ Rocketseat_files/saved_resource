<!doctype html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:100,300,400,500,700,900"/><script src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script><meta name="robots" content="noindex"/><title>Panda Video - Hospedagem de video</title></head><body id="body"><script>/*! For license information please see main.315.bundle.js.LICENSE.txt */
(()=>{var e={518:(e,t,n)=>{"use strict";function i(){return"undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}function r(){return"npm"}n.d(t,{S:()=>r,n:()=>i})},422:(e,t,n)=>{"use strict";n.d(t,{KV:()=>r,l$:()=>s});var i=n(518);function r(){return!(0,i.n)()&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function s(e,t){return e.require(t)}e=n.hmd(e)},170:(e,t,n)=>{"use strict";n.d(t,{Z1:()=>h,ph:()=>d,yW:()=>c});var i=n(422),r=n(235);e=n.hmd(e);const s=(0,r.Rf)(),a={nowSeconds:()=>Date.now()/1e3},o=(0,i.KV)()?function(){try{return(0,i.l$)(e,"perf_hooks").performance}catch(e){return}}():function(){const{performance:e}=s;if(e&&e.now)return{now:()=>e.now(),timeOrigin:Date.now()-e.now()}}(),l=void 0===o?a:{nowSeconds:()=>(o.timeOrigin+o.now())/1e3},c=a.nowSeconds.bind(a),d=l.nowSeconds.bind(l);let u;const h=(()=>{const{performance:e}=s;if(!e||!e.now)return void(u="none");const t=36e5,n=e.now(),i=Date.now(),r=e.timeOrigin?Math.abs(e.timeOrigin+n-i):t,a=r<t,o=e.timing&&e.timing.navigationStart,l="number"==typeof o?Math.abs(o+n-i):t;return a||l<t?r<=l?(u="timeOrigin",e.timeOrigin):(u="navigationStart",o):(u="dateNow",i)})()},235:(e,t,n)=>{"use strict";function i(e){return e&&e.Math==Math?e:void 0}n.d(t,{Rf:()=>s,YO:()=>a,n2:()=>r});const r="object"==typeof globalThis&&i(globalThis)||"object"==typeof window&&i(window)||"object"==typeof self&&i(self)||"object"==typeof n.g&&i(n.g)||function(){return this}()||{};function s(){return r}function a(e,t,n){const i=n||r,s=i.__SENTRY__=i.__SENTRY__||{};return s[e]||(s[e]=t())}},568:e=>{var t=null;function n(e,t){e.addEventListener("click",(function(){t.remove(),window.pandaLoad.initPlayerLoading()}))}e.exports={createUnloadedPlayerContainer:function(e){var t=document.createElement("div");t.id="video-container",t.classList.add("container"),t.classList.add("in-page-container");var i=document.createElement("img");i.style.cssText="\n      object-position: center;\n      object-fit: contain;\n    ",i.src=e,i.classList.add("plyr__poster"),i.classList.add("thumbnail-blur");var r=window.player_configs.controls.includes("play-large");if(r){var s=(new DOMParser).parseFromString('<button type="button" class="plyr__control plyr__control--overlaid" data-plyr="play" aria-pressed="false" aria-label="Reproduzir" style="z-index: 10; display: flex;">\n    <svg id="plyr-play" viewBox="0 0 18 18">\n        <path d="M15.562 8.1L3.87.225c-.818-.562-1.87 0-1.87.9v15.75c0 .9 1.052 1.462 1.87.9L15.563 9.9c.584-.45.584-1.35 0-1.8z" />\n    </svg>\n    <span class="plyr__sr-only">Reproduzir</span>\n  </button>',"text/html").body.firstChild;t.appendChild(s),n(s,t)}r||(i.style.cursor="pointer"),t.appendChild(i),n(i,t),document.body.appendChild(t),window.pandaLoad.applySettingsUnloadedPlayer()},setThumbnailUrl:function(e){var t=e.REFRESH_CONFIG,n=e.EMBED_DOMAIN,i=e.THUMBS_URL,r=e.LIBRARY_ID,s=e.VIDEO_ID;return e.thumb&&""!==e.thumb?t?e.thumb.includes("".concat(n,"/"))?e.thumb+"?date="+(new Date).getTime():i+"/"+r+"/"+e.thumb+"?date="+(new Date).getTime():e.thumb.includes("".concat(n,"/"))?e.thumb:i+"/"+r+"/"+e.thumb:"https://b-"+r+n+"/"+s+"/thumbnail.jpg"},wireUpEvents:function(){window.onmessage=function(e){var n=e.data,i=n.type,r=n.parameter;"play"!==i&&"play_toggle"!==i||(document.getElementById("video-container").remove(),window.pandaLoad.initPlayerLoading()),"volume"===i&&(t=r)},function(){var e=new URL(location.href).searchParams.get("v"),t=null;try{t=localStorage.getItem("panda_video:"+e)}catch(e){}var n=t?Number(t):0;(function(e,t){window.parent.postMessage({message:"panda_ready",video:e,currentTime:t,isMutedIndicator:!!player_configs.mutedIndicatorIcon,isPreviousProgressLoaded:!1},"*")})(e,n),function(e,t){var n=null;try{var i=localStorage.getItem("plyr");i&&(n=JSON.parse(i))}catch(e){}var r=n&&n.muted?n.muted:player_configs.muted,s=n&&n.volume?n.volume:1,a=n&&n.speed?n.speed:player_configs.defaultSpeed,o=player_configs,l=o.primaryColor,c=o.captionsColor,d=o.captionsBackgroundColor,u=o.controlsColor,h=o.menuColor,p={paused:!0,hasAudio:!0,muted:r,pip:player_configs.controls.includes("pip"),volume:s,speed:{selected:a,options:player_configs.availableSpeeds,turbo:player_configs.defaultSpeed},captions:{active:!1,currentTrack:-1,meta:{},toggled:!1,language:"pt",languages:["pt","es","en"]},currentTime:t,duration:0,fullscreen:!1,colors:{primaryColor:l,captionsColor:c,captionsBackgroundColor:d,controlsColor:u,menuColor:h}};window.parent.postMessage({message:"panda_allData",video:e,playerData:JSON.parse(JSON.stringify(p))},"*")}(e,n)}()},checkPlayerVolume:function(){null!==t&&(player.volume=t)}}},251:()=>{function e(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,t(r.key),r)}}function t(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:String(t)}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}!function(t){function i(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"!=(t=n(e=r))&&"string"!==t||isNaN(e-parseFloat(e)))return i(null,s,a);var o,l=function(e){return"0".concat(e).slice(-2)},c=(o=r,Math.trunc(o/60/60%60,10)),d=function(e){return Math.trunc(e/60%60,10)}(r),u=function(e){return Math.trunc(e%60,10)}(r);return c=s||c>0?"".concat(c,":"):"","".concat(a&&r>0?"-":"").concat(c).concat(l(d),":").concat(l(u))}var r=function(){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.player=e,this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}var r,s;return r=n,s=[{key:"enabled",get:function(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.thumbnail.enabled}},{key:"config",get:function(){return this.player.config.thumbnail}},{key:"load",value:function(){this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.loaded=!0,this.listeners())}},{key:"startMove",value:function(e){if(this.loaded&&!(!e instanceof Event)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t=this.player.elements.progress.getBoundingClientRect(),n=100/t.width*(e.pageX-t.left);this.seekTime=this.player.media.duration*(n/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=i(this.seekTime)}this.showImageAtCurrentTime()}}},{key:"endMove",value:function(){this.toggleThumbContainer(!1,!0)}},{key:"startScrubbing",value:function(e){!1!==e.button&&0!==e.button||(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))}},{key:"endScrubbing",value:function(){var e=this;this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):this.player.media.addEventListener("timeupdate",(function(){e.mouseDown||e.toggleScrubbingContainer(!1)}),{once:!0})}},{key:"listeners",value:function(){var e=this,t=this.player;t.on("play",(function(){e.toggleThumbContainer(!1,!0)})),t.on("seeked",(function(){e.toggleThumbContainer(!1)})),t.on("timeupdate",(function(){e.lastTime=e.player.media.currentTime}));var n=this.player.elements;["mousemove","touchmove","mouseleave","click","mousedown","touchstart","mouseup","touchend"].forEach((function(e){null!=n.progress.addEventListener&&n.progress.addEventListener(e,(function(n){var i=t.thumbnails;if(i&&i.loaded)switch(e){case"mousemove":case"touchmove":case"mousedown":case"touchstart":i.startMove(n);break;case"mouseleave":case"click":i.endMove(!1,!0);break;case"mouseup":case"touchend":i.endScrubbing(n)}}))}))}},{key:"render",value:function(){this.elements.thumb.container=t.createElement("div"),this.elements.thumb.container.classList.add(this.player.config.classNames.previewThumbnails.thumbContainer),this.elements.thumb.imageContainer=t.createElement("div"),this.elements.thumb.imageContainer.className=this.player.config.classNames.previewThumbnails.imageContainer,this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);var e=t.createElement("div");e.className=this.player.config.classNames.previewThumbnails.timeContainer,this.elements.thumb.time=t.createElement("span"),this.elements.thumb.time.textContent="00:00",e.appendChild(this.elements.thumb.time),this.elements.thumb.container.appendChild(e),this.player.elements.progress instanceof Element&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=t.createElement("div"),this.elements.scrubbing.container.className=this.player.config.classNames.previewThumbnails.scrubbingContainer,this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)}},{key:"showImageAtCurrentTime",value:function(){this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();var e=this.config,t=this.player.duration/e.pic_num,n=Math.floor(this.seekTime/t),i=Math.ceil((n+1)/(e.col*e.row))-1,r=n>=0;this.mouseDown||this.toggleThumbContainer(r),r&&n!==this.showingThumb&&(this.showingThumb=n,this.loadImage(i))}},{key:"loadImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.showingThumb,i=this.config.urls[t];if(this.currentImageElement&&this.currentImageElement.src===i)this.showImage(this.currentImageElement,t,n,i,!1),this.currentImageElement.dataset.index=n,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&(this.loadingImage.onload=null);var r=new Image;r.src=i,r.dataset.index=n,this.player.debug.log("Loading image: ".concat(i)),r.onload=function(){return e.showImage(r,t,n,i,!0)},this.loadingImage=r,this.removeOldImages(r)}}},{key:"showImage",value:function(e,t,n,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.player.debug.log("Showing thumb: ".concat(i,". num: ").concat(n,". qual: ").concat(t,". newimg: ").concat(r)),this.setImageSizeAndOffset(e,n),r&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(i)||this.loadedImages.push(i))}},{key:"removeOldImages",value:function(e){var t=this;Array.from(this.currentImageContainer.children).forEach((function(n){if("img"===n.tagName.toLowerCase()&&n.dataset.index!==e.dataset.index&&!n.dataset.deleting){n.dataset.deleting=!0;var i=t.currentImageContainer;setTimeout((function(){i.removeChild(n),t.player.debug.log("Removing thumb: ".concat(n.dataset.filename))}),500)}}))}},{key:"currentImageContainer",get:function(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}},{key:"thumbAspectRatio",get:function(){return this.config.width/this.config.height}},{key:"thumbContainerHeight",get:function(){return this.mouseDown?Math.floor(this.player.media.clientWidth/this.thumbAspectRatio):Math.min(135,Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4))}},{key:"currentImageElement",get:function(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement},set:function(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}},{key:"toggleThumbContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(n,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)}},{key:"toggleScrubbingContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)}},{key:"determineContainerAutoSizing",value:function(){this.elements.thumb.imageContainer.clientHeight>20&&(this.sizeSpecifiedInCSS=!0)}},{key:"setThumbContainerSizeAndPos",value:function(){if(!this.sizeSpecifiedInCSS){var e=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);this.elements.thumb.imageContainer.style.height="".concat(this.thumbContainerHeight,"px"),this.elements.thumb.imageContainer.style.width="".concat(e,"px")}this.setThumbContainerPos()}},{key:"setThumbContainerPos",value:function(){var e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),n=this.elements.thumb.container,i=t.left-e.left+10,r=t.right-e.left-n.clientWidth-10,s=this.mousePosX-e.left-n.clientWidth/2;s<i&&(s=i),s>r&&(s=r),n.style.left="".concat(s,"px")}},{key:"setScrubbingContainerSize",value:function(){this.elements.scrubbing.container.style.width="".concat(this.player.media.clientWidth,"px"),this.elements.scrubbing.container.style.height=this.player.media.clientWidth/this.thumbAspectRatio+"px"}},{key:"setImageSizeAndOffset",value:function(e,t){var n=this.config,i=t+1-n.col*n.row*(Math.ceil((t+1)/(n.col*n.row))-1),r=Math.ceil(i/n.row)-1,s=i-r*n.row-1,a=this.thumbContainerHeight/n.height;e.style.height="".concat(Math.floor(e.naturalHeight*a),"px"),e.style.width="".concat(Math.floor(e.naturalWidth*a),"px"),e.style.left="-".concat(s*n.width*a,"px"),e.style.top="-".concat(r*n.height*a,"px")}}],s&&e(r.prototype,s),Object.defineProperty(r,"prototype",{writable:!1}),n}();t.addEventListener("ready",(function(e){var t=e.detail.plyr;t.thumbnails=new r(t)}))}(document)},615:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(81),r=n.n(i),s=n(645),a=n.n(s)()(r());a.push([e.id,'.plyr__progress input {\n  border-radius: 0px !important;\n  -webkit-appearance: none;\n  background: transparent;\n}\n.plyr__progress input[value]::-webkit-progress-bar {\n  border-radius: 0px !important;\n}\n.plyr__progress input[value]::-webkit-progress-value {\n  border-radius: 0px !important;\n}\n.plyr__progress__container {\n  position: absolute;\n  top: 14px;\n  left: 10px;\n  width: calc(100% - 24px);\n}\n@media (max-width: 480px) {\n  .plyr__progress__container {\n    top: -5px;\n  }\n}\n.plyr__pb {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  z-index: 3;\n  margin-left: calc(var(--plyr-range-thumb-height, 13px) * -0.5);\n  margin-right: -6.5px;\n  margin-right: calc(var(--plyr-range-thumb-height, 13px) * -0.5);\n  width: calc(100% + 13px);\n  width: calc(100% + var(--plyr-range-thumb-height, 13px));\n}\n.plyr__preview-thumb {\n  bottom: 22px;\n  transition: bottom ease 0.1s;\n}\n.plyr__controls {\n  padding-top: 70px;\n}\n\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-webkit-slider-runnable-track {\n  background-color: transparent !important;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-moz-range-track {\n  background-color: transparent !important;\n}\n.plyr--full-ui.plyr--video .plyr__progress input[type="range"]::-ms-track {\n  background-color: transparent !important;\n}\n\n.plyr__progress input {\n  background-color: transparent !important;\n  color: transparent !important;\n  top: -6px !important;\n  z-index: 7 !important;\n  cursor: pointer;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-webkit-slider-thumb {\n  opacity: 0;\n  transition: opacity ease 0.1s;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-moz-range-thumb {\n  opacity: 0;\n  transition: opacity ease 0.1s;\n}\n.plyr--full-ui.plyr--video .plyr__progress input[type="range"]::-ms-thumb {\n  opacity: 0;\n  transition: opacity ease 0.1s;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]:active::-webkit-slider-thumb {\n  opacity: 1;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]:active::-moz-range-thumb {\n  opacity: 1;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]:active::-ms-thumb {\n  opacity: 1;\n}\n\n.sp__base {\n  width: 100%;\n  padding: 0;\n  margin: 0;\n  font-size: 0;\n  text-align: left;\n  box-sizing: border-box;\n  position: relative;\n  user-select: none; /* supported by Chrome and Opera */\n  -webkit-user-select: none; /* Safari */\n  -khtml-user-select: none; /* Konqueror HTML */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* Internet Explorer/Edge */\n}\n\n.pb__shadow {\n  width: 100%;\n  height: 50px;\n  position: absolute;\n  top: -44px;\n  left: 0px;\n  background: linear-gradient(transparent, rgba(0, 0, 0, 0.4));\n  background: var(\n    --plyr-video-controls-background,\n    linear-gradient(transparent, rgba(0, 0, 0, 0.4))\n  );\n}\n\n.sp__progressbar {\n  width: 100%;\n  height: 9px;\n  box-sizing: border-box;\n  font-size: 0;\n  margin: 0;\n  padding: 0;\n  position: relative;\n  transition: all ease 0.12s;\n  text-align: left;\n  overflow-x: hidden;\n  white-space: nowrap;\n}\n.sp__progressbar li {\n  display: inline-block;\n  list-style: none;\n  height: 9px;\n  margin: 0;\n  padding: 3px 0;\n  position: relative;\n  top: 0;\n  transition: all ease 0.12s;\n  box-sizing: border-box;\n  position: relative;\n  background-color: transparent;\n  cursor: pointer;\n  overflow-x: hidden;\n}\n\n.sp__progressbar.hover {\n  transform: scaleY(1.8);\n  margin-top: 0px;\n}\n.sp__progressbar li.active {\n  padding: 2px 0;\n}\n\n.sp__progressbar li .sp__container {\n  width: calc(100% - 2px);\n  left: 1px;\n  height: 100%;\n  position: relative;\n  box-shadow: #00000050 0 0 1px;\n  overflow-x: hidden;\n}\n\n.sp__progressbar li .sp__bg {\n  background-color: rgba(255, 255, 255, 0.2);\n  height: 100%;\n  width: 100%;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  z-index: 0;\n}\n\n.sp__progressbar li .sp__section {\n  height: 100%;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  z-index: 1;\n}\n\n.sp__progressbar:hover li {\n  opacity: 0.75;\n}\n.sp__progressbar:hover li:hover {\n  opacity: 1;\n}\n\n.sp__title {\n  position: absolute;\n  bottom: 18px;\n  left: 0px;\n  color: white;\n  font-size: 14px !important;\n  font-weight: 700;\n  text-align: center;\n  text-shadow: 0 0 4px black;\n  opacity: 0;\n  transition: opacity ease 0.12s;\n  line-height: 17px;\n}\n.sp__title.animated {\n  transition: left ease 0.08s;\n}\n.sp__title.active {\n  opacity: 1;\n}\n\n.sp__moment {\n  border: 2px solid #ffffff77;\n  border-radius: 50%;\n  width: 12px;\n  height: 12px;\n  z-index: 5;\n  display: block;\n  position: absolute;\n  top: -1.5px;\n  left: 0px;\n  box-sizing: border-box;\n  background-color: #ffffff77;\n  box-shadow: 0 0 3px #00000055;\n  pointer-events: all;\n}\n.sp__moment.hover {\n  cursor: pointer;\n  border: 2px solid #fff;\n  background-color: #ffffff99;\n}\n',""]);const o=a},376:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(81),r=n.n(i),s=n(645),a=n.n(s)()(r());a.push([e.id,"@keyframes plyr-progress{to{background-position:25px 0;background-position:var(--plyr-progress-loading-size,25px) 0}}@keyframes plyr-popup{0%{opacity:.5;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes plyr-fade-in{from{opacity:0}to{opacity:1}}.plyr{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;align-items:center;direction:ltr;display:flex;flex-direction:column;font-family:inherit;font-family:var(--plyr-font-family,inherit);font-variant-numeric:tabular-nums;font-weight:400;font-weight:var(--plyr-font-weight-regular,400);line-height:1.7;line-height:var(--plyr-line-height,1.7);max-width:100%;min-width:200px;position:relative;text-shadow:none;transition:box-shadow .3s ease;z-index:0}.plyr audio,.plyr iframe,.plyr video{display:block;height:100%;width:100%}.plyr button{font:inherit;line-height:inherit;width:auto}.plyr:focus{outline:0}.plyr--full-ui{box-sizing:border-box}.plyr--full-ui *,.plyr--full-ui ::after,.plyr--full-ui ::before{box-sizing:inherit}.plyr--full-ui a,.plyr--full-ui button,.plyr--full-ui input,.plyr--full-ui label{touch-action:manipulation}.plyr__badge{background:#4a5464;background:var(--plyr-badge-background,#4a5464);border-radius:2px;border-radius:var(--plyr-badge-border-radius,2px);color:#fff;color:var(--plyr-badge-text-color,#fff);font-size:9px;font-size:var(--plyr-font-size-badge,9px);line-height:1;padding:3px 4px}.plyr--full-ui ::-webkit-media-text-track-container{display:none}.plyr__captions{animation:plyr-fade-in .3s ease;bottom:0;display:none;font-size:13px;font-size:var(--plyr-font-size-small,13px);left:0;padding:10px;padding:var(--plyr-control-spacing,10px);position:absolute;text-align:center;transition:transform .4s ease-in-out;width:100%}.plyr__captions span:empty{display:none}@media (min-width:480px){.plyr__captions{font-size:15px;font-size:var(--plyr-font-size-base,15px);padding:calc(10px * 2);padding:calc(var(--plyr-control-spacing,10px) * 2)}}@media (min-width:768px){.plyr__captions{font-size:18px;font-size:var(--plyr-font-size-large,18px)}}.plyr--captions-active .plyr__captions{display:block}.plyr:not(.plyr--hide-controls) .plyr__controls:not(:empty)~.plyr__captions{transform:translateY(calc(10px * -4));transform:translateY(calc(var(--plyr-control-spacing,10px) * -4))}.plyr__caption{background:rgba(0,0,0,.8);background:var(--plyr-captions-background,rgba(0,0,0,.8));border-radius:2px;-webkit-box-decoration-break:clone;box-decoration-break:clone;color:#fff;color:var(--plyr-captions-text-color,#fff);line-height:185%;padding:.2em .5em;white-space:pre-wrap}.plyr__caption div{display:inline}.plyr__control{background:0 0;border:0;border-radius:3px;border-radius:var(--plyr-control-radius,3px);color:inherit;cursor:pointer;flex-shrink:0;overflow:visible;padding:calc(10px * .7);padding:calc(var(--plyr-control-spacing,10px) * .7);position:relative;transition:all .3s ease}.plyr__control svg{display:block;fill:currentColor;height:18px;height:var(--plyr-control-icon-size,18px);pointer-events:none;width:18px;width:var(--plyr-control-icon-size,18px)}.plyr__control:focus{outline:0}.plyr__control.plyr__tab-focus{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}a.plyr__control{text-decoration:none}a.plyr__control::after,a.plyr__control::before{display:none}.plyr__control.plyr__control--pressed .icon--not-pressed,.plyr__control.plyr__control--pressed .label--not-pressed,.plyr__control:not(.plyr__control--pressed) .icon--pressed,.plyr__control:not(.plyr__control--pressed) .label--pressed{display:none}.plyr--full-ui ::-webkit-media-controls{display:none}.plyr__controls{align-items:center;display:flex;justify-content:flex-end;text-align:center}.plyr__controls .plyr__progress__container{flex:1;min-width:0}.plyr__controls .plyr__controls__item{margin-left:calc(10px / 4);margin-left:calc(var(--plyr-control-spacing,10px)/ 4)}.plyr__controls .plyr__controls__item:first-child{margin-left:0;margin-right:auto}.plyr__controls .plyr__controls__item.plyr__progress__container{padding-left:calc(10px / 4);padding-left:calc(var(--plyr-control-spacing,10px)/ 4)}.plyr__controls .plyr__controls__item.plyr__time{padding:0 calc(10px / 2);padding:0 calc(var(--plyr-control-spacing,10px)/ 2)}.plyr__controls .plyr__controls__item.plyr__progress__container:first-child,.plyr__controls .plyr__controls__item.plyr__time+.plyr__time,.plyr__controls .plyr__controls__item.plyr__time:first-child{padding-left:0}.plyr__controls:empty{display:none}.plyr [data-plyr=airplay],.plyr [data-plyr=captions],.plyr [data-plyr=fullscreen],.plyr [data-plyr=pip]{display:none}.plyr--airplay-supported [data-plyr=airplay],.plyr--captions-enabled [data-plyr=captions],.plyr--fullscreen-enabled [data-plyr=fullscreen],.plyr--pip-supported [data-plyr=pip]{display:inline-block}.plyr__menu{display:flex;position:relative}.plyr__menu .plyr__control svg{transition:transform .3s ease}.plyr__menu .plyr__control[aria-expanded=true] svg{transform:rotate(90deg)}.plyr__menu .plyr__control[aria-expanded=true] .plyr__tooltip{display:none}.plyr__menu__container{animation:plyr-popup .2s ease;background:rgba(255,255,255,.9);background:var(--plyr-menu-background,rgba(255,255,255,.9));border-radius:4px;bottom:100%;box-shadow:0 1px 2px rgba(0,0,0,.15);box-shadow:var(--plyr-menu-shadow,0 1px 2px rgba(0,0,0,.15));color:#4a5464;color:var(--plyr-menu-color,#4a5464);font-size:15px;font-size:var(--plyr-font-size-base,15px);margin-bottom:10px;position:absolute;right:-3px;text-align:left;white-space:nowrap;z-index:3}.plyr__menu__container>div{overflow:hidden;transition:height .35s cubic-bezier(.4,0,.2,1),width .35s cubic-bezier(.4,0,.2,1)}.plyr__menu__container::after{border:4px solid transparent;border:var(--plyr-menu-arrow-size,4px) solid transparent;border-top-color:rgba(255,255,255,.9);border-top-color:var(--plyr-menu-background,rgba(255,255,255,.9));content:'';height:0;position:absolute;right:calc(((18px / 2) + calc(10px * .7)) - (4px / 2));right:calc(((var(--plyr-control-icon-size,18px)/ 2) + calc(var(--plyr-control-spacing,10px) * .7)) - (var(--plyr-menu-arrow-size,4px)/ 2));top:100%;width:0}.plyr__menu__container [role=menu]{padding:calc(10px * .7);padding:calc(var(--plyr-control-spacing,10px) * .7)}.plyr__menu__container [role=menuitem],.plyr__menu__container [role=menuitemradio]{margin-top:2px}.plyr__menu__container [role=menuitem]:first-child,.plyr__menu__container [role=menuitemradio]:first-child{margin-top:0}.plyr__menu__container .plyr__control{align-items:center;color:#4a5464;color:var(--plyr-menu-color,#4a5464);display:flex;font-size:13px;font-size:var(--plyr-font-size-menu,var(--plyr-font-size-small,13px));padding-bottom:calc(calc(10px * .7)/ 1.5);padding-bottom:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 1.5);padding-left:calc(calc(10px * .7) * 1.5);padding-left:calc(calc(var(--plyr-control-spacing,10px) * .7) * 1.5);padding-right:calc(calc(10px * .7) * 1.5);padding-right:calc(calc(var(--plyr-control-spacing,10px) * .7) * 1.5);padding-top:calc(calc(10px * .7)/ 1.5);padding-top:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 1.5);-webkit-user-select:none;-ms-user-select:none;user-select:none;width:100%}.plyr__menu__container .plyr__control>span{align-items:inherit;display:flex;width:100%}.plyr__menu__container .plyr__control::after{border:4px solid transparent;border:var(--plyr-menu-item-arrow-size,4px) solid transparent;content:'';position:absolute;top:50%;transform:translateY(-50%)}.plyr__menu__container .plyr__control--forward{padding-right:calc(calc(10px * .7) * 4);padding-right:calc(calc(var(--plyr-control-spacing,10px) * .7) * 4)}.plyr__menu__container .plyr__control--forward::after{border-left-color:#728197;border-left-color:var(--plyr-menu-arrow-color,#728197);right:calc((calc(10px * .7) * 1.5) - 4px);right:calc((calc(var(--plyr-control-spacing,10px) * .7) * 1.5) - var(--plyr-menu-item-arrow-size,4px))}.plyr__menu__container .plyr__control--forward.plyr__tab-focus::after,.plyr__menu__container .plyr__control--forward:hover::after{border-left-color:currentColor}.plyr__menu__container .plyr__control--back{font-weight:400;font-weight:var(--plyr-font-weight-regular,400);margin:calc(10px * .7);margin:calc(var(--plyr-control-spacing,10px) * .7);margin-bottom:calc(calc(10px * .7)/ 2);margin-bottom:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 2);padding-left:calc(calc(10px * .7) * 4);padding-left:calc(calc(var(--plyr-control-spacing,10px) * .7) * 4);position:relative;width:calc(100% - (calc(10px * .7) * 2));width:calc(100% - (calc(var(--plyr-control-spacing,10px) * .7) * 2))}.plyr__menu__container .plyr__control--back::after{border-right-color:#728197;border-right-color:var(--plyr-menu-arrow-color,#728197);left:calc((calc(10px * .7) * 1.5) - 4px);left:calc((calc(var(--plyr-control-spacing,10px) * .7) * 1.5) - var(--plyr-menu-item-arrow-size,4px))}.plyr__menu__container .plyr__control--back::before{background:#dcdfe5;background:var(--plyr-menu-back-border-color,#dcdfe5);box-shadow:0 1px 0 #fff;box-shadow:0 1px 0 var(--plyr-menu-back-border-shadow-color,#fff);content:'';height:1px;left:0;margin-top:calc(calc(10px * .7)/ 2);margin-top:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 2);overflow:hidden;position:absolute;right:0;top:100%}.plyr__menu__container .plyr__control--back.plyr__tab-focus::after,.plyr__menu__container .plyr__control--back:hover::after{border-right-color:currentColor}.plyr__menu__container .plyr__control[role=menuitemradio]{padding-left:calc(10px * .7);padding-left:calc(var(--plyr-control-spacing,10px) * .7)}.plyr__menu__container .plyr__control[role=menuitemradio]::after,.plyr__menu__container .plyr__control[role=menuitemradio]::before{border-radius:100%}.plyr__menu__container .plyr__control[role=menuitemradio]::before{background:rgba(0,0,0,.1);content:'';display:block;flex-shrink:0;height:16px;margin-right:10px;margin-right:var(--plyr-control-spacing,10px);transition:all .3s ease;width:16px}.plyr__menu__container .plyr__control[role=menuitemradio]::after{background:#fff;border:0;height:6px;left:12px;opacity:0;top:50%;transform:translateY(-50%) scale(0);transition:transform .3s ease,opacity .3s ease;width:6px}.plyr__menu__container .plyr__control[role=menuitemradio][aria-checked=true]::before{background:#00b3ff;background:var(--plyr-control-toggle-checked-background,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)))}.plyr__menu__container .plyr__control[role=menuitemradio][aria-checked=true]::after{opacity:1;transform:translateY(-50%) scale(1)}.plyr__menu__container .plyr__control[role=menuitemradio].plyr__tab-focus::before,.plyr__menu__container .plyr__control[role=menuitemradio]:hover::before{background:rgba(35,40,47,.1)}.plyr__menu__container .plyr__menu__value{align-items:center;display:flex;margin-left:auto;margin-right:calc((calc(10px * .7) - 2) * -1);margin-right:calc((calc(var(--plyr-control-spacing,10px) * .7) - 2) * -1);overflow:hidden;padding-left:calc(calc(10px * .7) * 3.5);padding-left:calc(calc(var(--plyr-control-spacing,10px) * .7) * 3.5);pointer-events:none}.plyr--full-ui input[type=range]{-webkit-appearance:none;background:0 0;border:0;border-radius:calc(13px * 2);border-radius:calc(var(--plyr-range-thumb-height,13px) * 2);color:#00b3ff;color:var(--plyr-range-fill-background,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));display:block;height:calc((3px * 2) + 13px);height:calc((var(--plyr-range-thumb-active-shadow-width,3px) * 2) + var(--plyr-range-thumb-height,13px));margin:0;min-width:0;padding:0;transition:box-shadow .3s ease;width:100%}.plyr--full-ui input[type=range]::-webkit-slider-runnable-track{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-webkit-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-webkit-user-select:none;user-select:none;background-image:linear-gradient(to right,currentColor 0,transparent 0);background-image:linear-gradient(to right,currentColor var(--value,0),transparent var(--value,0))}.plyr--full-ui input[type=range]::-webkit-slider-thumb{background:#fff;background:var(--plyr-range-thumb-background,#fff);border:0;border-radius:100%;box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2));height:13px;height:var(--plyr-range-thumb-height,13px);position:relative;-webkit-transition:all .2s ease;transition:all .2s ease;width:13px;width:var(--plyr-range-thumb-height,13px);-webkit-appearance:none;margin-top:calc(((13px - 5px)/ 2) * -1);margin-top:calc(((var(--plyr-range-thumb-height,13px) - var(--plyr-range-track-height,5px))/ 2) * -1)}.plyr--full-ui input[type=range]::-moz-range-track{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-moz-transition:box-shadow .3s ease;transition:box-shadow .3s ease;user-select:none}.plyr--full-ui input[type=range]::-moz-range-thumb{background:#fff;background:var(--plyr-range-thumb-background,#fff);border:0;border-radius:100%;box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2));height:13px;height:var(--plyr-range-thumb-height,13px);position:relative;-moz-transition:all .2s ease;transition:all .2s ease;width:13px;width:var(--plyr-range-thumb-height,13px)}.plyr--full-ui input[type=range]::-moz-range-progress{background:currentColor;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px)}.plyr--full-ui input[type=range]::-ms-track{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-ms-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-ms-user-select:none;user-select:none;color:transparent}.plyr--full-ui input[type=range]::-ms-fill-upper{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-ms-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-ms-user-select:none;user-select:none}.plyr--full-ui input[type=range]::-ms-fill-lower{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-ms-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-ms-user-select:none;user-select:none;background:currentColor}.plyr--full-ui input[type=range]::-ms-thumb{background:#fff;background:var(--plyr-range-thumb-background,#fff);border:0;border-radius:100%;box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2));height:13px;height:var(--plyr-range-thumb-height,13px);position:relative;-ms-transition:all .2s ease;transition:all .2s ease;width:13px;width:var(--plyr-range-thumb-height,13px);margin-top:0}.plyr--full-ui input[type=range]::-ms-tooltip{display:none}.plyr--full-ui input[type=range]:focus{outline:0}.plyr--full-ui input[type=range]::-moz-focus-outer{border:0}.plyr--full-ui input[type=range].plyr__tab-focus::-webkit-slider-runnable-track{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}.plyr--full-ui input[type=range].plyr__tab-focus::-moz-range-track{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}.plyr--full-ui input[type=range].plyr__tab-focus::-ms-track{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}.plyr__poster{background-color:#000;background-position:50% 50%;background-repeat:no-repeat;background-size:contain;height:100%;left:0;opacity:0;position:absolute;top:0;transition:opacity .2s ease;width:100%;z-index:1}.plyr--stopped.plyr__poster-enabled .plyr__poster{opacity:1}.plyr__time{font-size:13px;font-size:var(--plyr-font-size-time,var(--plyr-font-size-small,13px))}.plyr__time+.plyr__time::before{content:'\\2044';margin-right:10px;margin-right:var(--plyr-control-spacing,10px)}@media (max-width:calc(768px - 1px)){.plyr__time+.plyr__time{display:none}}.plyr__tooltip{background:rgba(255,255,255,.9);background:var(--plyr-tooltip-background,rgba(255,255,255,.9));border-radius:3px;border-radius:var(--plyr-tooltip-radius,3px);bottom:100%;box-shadow:0 1px 2px rgba(0,0,0,.15);box-shadow:var(--plyr-tooltip-shadow,0 1px 2px rgba(0,0,0,.15));color:#4a5464;color:var(--plyr-tooltip-color,#4a5464);font-size:13px;font-size:var(--plyr-font-size-small,13px);font-weight:400;font-weight:var(--plyr-font-weight-regular,400);left:50%;line-height:1.3;margin-bottom:calc(calc(10px / 2) * 2);margin-bottom:calc(calc(var(--plyr-control-spacing,10px)/ 2) * 2);opacity:0;padding:calc(10px / 2) calc(calc(10px / 2) * 1.5);padding:calc(var(--plyr-control-spacing,10px)/ 2) calc(calc(var(--plyr-control-spacing,10px)/ 2) * 1.5);pointer-events:none;position:absolute;transform:translate(-50%,10px) scale(.8);transform-origin:50% 100%;transition:transform .2s .1s ease,opacity .2s .1s ease;white-space:nowrap;z-index:2}.plyr__tooltip::before{border-left:4px solid transparent;border-left:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-right:4px solid transparent;border-right:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-top:4px solid rgba(255,255,255,.9);border-top:var(--plyr-tooltip-arrow-size,4px) solid var(--plyr-tooltip-background,rgba(255,255,255,.9));bottom:calc(4px * -1);bottom:calc(var(--plyr-tooltip-arrow-size,4px) * -1);content:'';height:0;left:50%;position:absolute;transform:translateX(-50%);width:0;z-index:2}.plyr .plyr__control.plyr__tab-focus .plyr__tooltip,.plyr .plyr__control:hover .plyr__tooltip,.plyr__tooltip--visible{opacity:1;transform:translate(-50%,0) scale(1)}.plyr .plyr__control:hover .plyr__tooltip{z-index:3}.plyr__controls>.plyr__control:first-child .plyr__tooltip,.plyr__controls>.plyr__control:first-child+.plyr__control .plyr__tooltip{left:0;transform:translate(0,10px) scale(.8);transform-origin:0 100%}.plyr__controls>.plyr__control:first-child .plyr__tooltip::before,.plyr__controls>.plyr__control:first-child+.plyr__control .plyr__tooltip::before{left:calc((18px / 2) + calc(10px * .7));left:calc((var(--plyr-control-icon-size,18px)/ 2) + calc(var(--plyr-control-spacing,10px) * .7))}.plyr__controls>.plyr__control:last-child .plyr__tooltip{left:auto;right:0;transform:translate(0,10px) scale(.8);transform-origin:100% 100%}.plyr__controls>.plyr__control:last-child .plyr__tooltip::before{left:auto;right:calc((18px / 2) + calc(10px * .7));right:calc((var(--plyr-control-icon-size,18px)/ 2) + calc(var(--plyr-control-spacing,10px) * .7));transform:translateX(50%)}.plyr__controls>.plyr__control:first-child .plyr__tooltip--visible,.plyr__controls>.plyr__control:first-child+.plyr__control .plyr__tooltip--visible,.plyr__controls>.plyr__control:first-child+.plyr__control.plyr__tab-focus .plyr__tooltip,.plyr__controls>.plyr__control:first-child+.plyr__control:hover .plyr__tooltip,.plyr__controls>.plyr__control:first-child.plyr__tab-focus .plyr__tooltip,.plyr__controls>.plyr__control:first-child:hover .plyr__tooltip,.plyr__controls>.plyr__control:last-child .plyr__tooltip--visible,.plyr__controls>.plyr__control:last-child.plyr__tab-focus .plyr__tooltip,.plyr__controls>.plyr__control:last-child:hover .plyr__tooltip{transform:translate(0,0) scale(1)}.plyr__progress{left:calc(13px * .5);left:calc(var(--plyr-range-thumb-height,13px) * .5);margin-right:13px;margin-right:var(--plyr-range-thumb-height,13px);position:relative}.plyr__progress input[type=range],.plyr__progress__buffer{margin-left:calc(13px * -.5);margin-left:calc(var(--plyr-range-thumb-height,13px) * -.5);margin-right:calc(13px * -.5);margin-right:calc(var(--plyr-range-thumb-height,13px) * -.5);width:calc(100% + 13px);width:calc(100% + var(--plyr-range-thumb-height,13px))}.plyr__progress input[type=range]{position:relative;z-index:2}.plyr__progress .plyr__tooltip{font-size:13px;font-size:var(--plyr-font-size-time,var(--plyr-font-size-small,13px));left:0}.plyr__progress__buffer{-webkit-appearance:none;background:0 0;border:0;border-radius:100px;height:5px;height:var(--plyr-range-track-height,5px);left:0;margin-top:calc((5px / 2) * -1);margin-top:calc((var(--plyr-range-track-height,5px)/ 2) * -1);padding:0;position:absolute;top:50%}.plyr__progress__buffer::-webkit-progress-bar{background:0 0}.plyr__progress__buffer::-webkit-progress-value{background:currentColor;border-radius:100px;min-width:5px;min-width:var(--plyr-range-track-height,5px);-webkit-transition:width .2s ease;transition:width .2s ease}.plyr__progress__buffer::-moz-progress-bar{background:currentColor;border-radius:100px;min-width:5px;min-width:var(--plyr-range-track-height,5px);-moz-transition:width .2s ease;transition:width .2s ease}.plyr__progress__buffer::-ms-fill{border-radius:100px;-ms-transition:width .2s ease;transition:width .2s ease}.plyr--loading .plyr__progress__buffer{animation:plyr-progress 1s linear infinite;background-image:linear-gradient(-45deg,rgba(35,40,47,.6) 25%,transparent 25%,transparent 50%,rgba(35,40,47,.6) 50%,rgba(35,40,47,.6) 75%,transparent 75%,transparent);background-image:linear-gradient(-45deg,var(--plyr-progress-loading-background,rgba(35,40,47,.6)) 25%,transparent 25%,transparent 50%,var(--plyr-progress-loading-background,rgba(35,40,47,.6)) 50%,var(--plyr-progress-loading-background,rgba(35,40,47,.6)) 75%,transparent 75%,transparent);background-repeat:repeat-x;background-size:25px 25px;background-size:var(--plyr-progress-loading-size,25px) var(--plyr-progress-loading-size,25px);color:transparent}.plyr--video.plyr--loading .plyr__progress__buffer{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25))}.plyr--audio.plyr--loading .plyr__progress__buffer{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6))}.plyr__volume{align-items:center;display:flex;max-width:110px;min-width:80px;position:relative;width:20%}.plyr__volume input[type=range]{margin-left:calc(10px / 2);margin-left:calc(var(--plyr-control-spacing,10px)/ 2);margin-right:calc(10px / 2);margin-right:calc(var(--plyr-control-spacing,10px)/ 2);position:relative;z-index:2}.plyr--is-ios .plyr__volume{min-width:0;width:auto}.plyr--audio{display:block}.plyr--audio .plyr__controls{background:#fff;background:var(--plyr-audio-controls-background,#fff);border-radius:inherit;color:#4a5464;color:var(--plyr-audio-control-color,#4a5464);padding:10px;padding:var(--plyr-control-spacing,10px)}.plyr--audio .plyr__control.plyr__tab-focus,.plyr--audio .plyr__control:hover,.plyr--audio .plyr__control[aria-expanded=true]{background:#00b3ff;background:var(--plyr-audio-control-background-hover,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));color:#fff;color:var(--plyr-audio-control-color-hover,#fff)}.plyr--full-ui.plyr--audio input[type=range]::-webkit-slider-runnable-track{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-range-track-background,var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6)))}.plyr--full-ui.plyr--audio input[type=range]::-moz-range-track{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-range-track-background,var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6)))}.plyr--full-ui.plyr--audio input[type=range]::-ms-track{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-range-track-background,var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6)))}.plyr--full-ui.plyr--audio input[type=range]:active::-webkit-slider-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(35,40,47,.1);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(35,40,47,.1))}.plyr--full-ui.plyr--audio input[type=range]:active::-moz-range-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(35,40,47,.1);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(35,40,47,.1))}.plyr--full-ui.plyr--audio input[type=range]:active::-ms-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(35,40,47,.1);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(35,40,47,.1))}.plyr--audio .plyr__progress__buffer{color:rgba(193,200,209,.6);color:var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6))}.plyr--video{background:#000;overflow:hidden}.plyr--video.plyr--menu-open{overflow:visible}.plyr__video-wrapper{background:#000;height:100%;margin:auto;overflow:hidden;position:relative;width:100%}.plyr__video-embed,.plyr__video-wrapper--fixed-ratio{height:0;padding-bottom:56.25%}.plyr__video-embed iframe,.plyr__video-wrapper--fixed-ratio video{border:0;left:0;position:absolute;top:0}.plyr--full-ui .plyr__video-embed>.plyr__video-embed__container{padding-bottom:240%;position:relative;transform:translateY(-38.28125%)}.plyr--video .plyr__controls{background:linear-gradient(rgba(0,0,0,0),rgba(0,0,0,.75));background:var(--plyr-video-controls-background,linear-gradient(rgba(0,0,0,0),rgba(0,0,0,.75)));border-bottom-left-radius:inherit;border-bottom-right-radius:inherit;bottom:0;color:#fff;color:var(--plyr-video-control-color,#fff);left:0;padding:calc(10px / 2);padding:calc(var(--plyr-control-spacing,10px)/ 2);padding-top:calc(10px * 2);padding-top:calc(var(--plyr-control-spacing,10px) * 2);position:absolute;right:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out;z-index:3}@media (min-width:480px){.plyr--video .plyr__controls{padding:10px;padding:var(--plyr-control-spacing,10px);padding-top:calc(10px * 3.5);padding-top:calc(var(--plyr-control-spacing,10px) * 3.5)}}.plyr--video.plyr--hide-controls .plyr__controls{opacity:0;pointer-events:none;transform:translateY(100%)}.plyr--video .plyr__control.plyr__tab-focus,.plyr--video .plyr__control:hover,.plyr--video .plyr__control[aria-expanded=true]{background:#00b3ff;background:var(--plyr-video-control-background-hover,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));color:#fff;color:var(--plyr-video-control-color-hover,#fff)}.plyr__control--overlaid{background:#00b3ff;background:var(--plyr-video-control-background-hover,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));border:0;border-radius:100%;color:#fff;color:var(--plyr-video-control-color,#fff);display:none;left:50%;opacity:.9;padding:calc(10px * 1.5);padding:calc(var(--plyr-control-spacing,10px) * 1.5);position:absolute;top:50%;transform:translate(-50%,-50%);transition:.3s;z-index:2}.plyr__control--overlaid svg{left:2px;position:relative}.plyr__control--overlaid:focus,.plyr__control--overlaid:hover{opacity:1}.plyr--playing .plyr__control--overlaid{opacity:0;visibility:hidden}.plyr--full-ui.plyr--video .plyr__control--overlaid{display:block}.plyr--full-ui.plyr--video input[type=range]::-webkit-slider-runnable-track{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-range-track-background,var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25)))}.plyr--full-ui.plyr--video input[type=range]::-moz-range-track{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-range-track-background,var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25)))}.plyr--full-ui.plyr--video input[type=range]::-ms-track{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-range-track-background,var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25)))}.plyr--full-ui.plyr--video input[type=range]:active::-webkit-slider-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(255,255,255,.5);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(255,255,255,.5))}.plyr--full-ui.plyr--video input[type=range]:active::-moz-range-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(255,255,255,.5);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(255,255,255,.5))}.plyr--full-ui.plyr--video input[type=range]:active::-ms-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(255,255,255,.5);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(255,255,255,.5))}.plyr--video .plyr__progress__buffer{color:rgba(255,255,255,.25);color:var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25))}.plyr:-webkit-full-screen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-ms-fullscreen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:fullscreen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-webkit-full-screen video{height:100%}.plyr:-ms-fullscreen video{height:100%}.plyr:fullscreen video{height:100%}.plyr:-webkit-full-screen .plyr__video-wrapper{height:100%;position:static}.plyr:-ms-fullscreen .plyr__video-wrapper{height:100%;position:static}.plyr:fullscreen .plyr__video-wrapper{height:100%;position:static}.plyr:-webkit-full-screen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-ms-fullscreen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:fullscreen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen{display:block}.plyr:fullscreen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:fullscreen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-webkit-full-screen.plyr--hide-controls{cursor:none}.plyr:-ms-fullscreen.plyr--hide-controls{cursor:none}.plyr:fullscreen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-webkit-full-screen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}.plyr:-ms-fullscreen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}.plyr:fullscreen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr:-webkit-full-screen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-webkit-full-screen video{height:100%}.plyr:-webkit-full-screen .plyr__video-wrapper{height:100%;position:static}.plyr:-webkit-full-screen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-webkit-full-screen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-webkit-full-screen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr:-moz-full-screen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-moz-full-screen video{height:100%}.plyr:-moz-full-screen .plyr__video-wrapper{height:100%;position:static}.plyr:-moz-full-screen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-moz-full-screen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-moz-full-screen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-moz-full-screen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-moz-full-screen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr:-ms-fullscreen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-ms-fullscreen video{height:100%}.plyr:-ms-fullscreen .plyr__video-wrapper{height:100%;position:static}.plyr:-ms-fullscreen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-ms-fullscreen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-ms-fullscreen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr--fullscreen-fallback{background:#000;border-radius:0!important;height:100%;margin:0;width:100%;bottom:0;display:block;left:0;position:fixed;right:0;top:0;z-index:10000000}.plyr--fullscreen-fallback video{height:100%}.plyr--fullscreen-fallback .plyr__video-wrapper{height:100%;position:static}.plyr--fullscreen-fallback.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr--fullscreen-fallback .plyr__control .icon--exit-fullscreen{display:block}.plyr--fullscreen-fallback .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr--fullscreen-fallback.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr--fullscreen-fallback .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr__ads{border-radius:inherit;bottom:0;cursor:pointer;left:0;overflow:hidden;position:absolute;right:0;top:0;z-index:-1}.plyr__ads>div,.plyr__ads>div iframe{height:100%;position:absolute;width:100%}.plyr__ads::after{background:#23282f;border-radius:2px;bottom:10px;bottom:var(--plyr-control-spacing,10px);color:#fff;content:attr(data-badge-text);font-size:11px;padding:2px 6px;pointer-events:none;position:absolute;right:10px;right:var(--plyr-control-spacing,10px);z-index:3}.plyr__ads::after:empty{display:none}.plyr__cues{background:currentColor;display:block;height:5px;height:var(--plyr-range-track-height,5px);left:0;margin:-var(--plyr-range-track-height,5px)/2 0 0;opacity:.8;position:absolute;top:50%;width:3px;z-index:3}.plyr__preview-thumb{background-color:rgba(255,255,255,.9);background-color:var(--plyr-tooltip-background,rgba(255,255,255,.9));border-radius:3px;bottom:100%;box-shadow:0 1px 2px rgba(0,0,0,.15);box-shadow:var(--plyr-tooltip-shadow,0 1px 2px rgba(0,0,0,.15));margin-bottom:calc(calc(10px / 2) * 2);margin-bottom:calc(calc(var(--plyr-control-spacing,10px)/ 2) * 2);opacity:0;padding:3px;padding:var(--plyr-tooltip-radius,3px);pointer-events:none;position:absolute;transform:translate(0,10px) scale(.8);transform-origin:50% 100%;transition:transform .2s .1s ease,opacity .2s .1s ease;z-index:2}.plyr__preview-thumb--is-shown{opacity:1;transform:translate(0,0) scale(1)}.plyr__preview-thumb::before{border-left:4px solid transparent;border-left:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-right:4px solid transparent;border-right:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-top:4px solid rgba(255,255,255,.9);border-top:var(--plyr-tooltip-arrow-size,4px) solid var(--plyr-tooltip-background,rgba(255,255,255,.9));bottom:calc(4px * -1);bottom:calc(var(--plyr-tooltip-arrow-size,4px) * -1);content:'';height:0;left:50%;position:absolute;transform:translateX(-50%);width:0;z-index:2}.plyr__preview-thumb__image-container{background:#c1c8d1;border-radius:calc(3px - 1px);border-radius:calc(var(--plyr-tooltip-radius,3px) - 1px);overflow:hidden;position:relative;z-index:0}.plyr__preview-thumb__image-container img{height:100%;left:0;max-height:none;max-width:none;position:absolute;top:0;width:100%}.plyr__preview-thumb__time-container{bottom:6px;left:0;position:absolute;right:0;white-space:nowrap;z-index:3}.plyr__preview-thumb__time-container span{background-color:rgba(0,0,0,.55);border-radius:calc(3px - 1px);border-radius:calc(var(--plyr-tooltip-radius,3px) - 1px);color:#fff;font-size:13px;font-size:var(--plyr-font-size-time,var(--plyr-font-size-small,13px));padding:3px 6px}.plyr__preview-scrubbing{bottom:0;filter:blur(1px);height:100%;left:0;margin:auto;opacity:0;overflow:hidden;pointer-events:none;position:absolute;right:0;top:0;transition:opacity .3s ease;width:100%;z-index:1}.plyr__preview-scrubbing--is-shown{opacity:1}.plyr__preview-scrubbing img{height:100%;left:0;max-height:none;max-width:none;object-fit:contain;position:absolute;top:0;width:100%}.plyr--no-transition{transition:none!important}.plyr__sr-only{clip:rect(1px,1px,1px,1px);overflow:hidden;border:0!important;height:1px!important;padding:0!important;position:absolute!important;width:1px!important}.plyr [hidden]{display:none!important}",""]);const o=a},485:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(81),r=n.n(i),s=n(645),a=n.n(s)()(r());a.push([e.id,"html,\nbody {\n    margin: 0;\n    padding: 0;\n    overflow: hidden;\n    width: 100%;\n    display: flex;\n    background: transparent;\n    align-items: center;\n    justify-content: center;\n    font-family: 'Rubik', sans-serif;\n\n}\nhtml {\n    scrollbar-width: thin;\n    scrollbar-color: #888 #f1f1f1;\n}\n::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n}\n\n::-webkit-scrollbar-track {\n    background: #f1f1f1;\n}\n\n::-webkit-scrollbar-thumb {\n    background: #888;\n}\n\n::-webkit-scrollbar-thumb:hover {\n    background: #555;\n}\n\n.in-page-container{\n    height: auto !important;\n    margin: 0 !important;\n}\n:root{\n    --max-height: 100vh;\n    --muted-indicator-border-size: 2px;\n}\n\n.container {\n    width: 100%;\n    height: 100%;\n    display: table;\n}\n\nvideo {\n    width: 100%;\n    height: 100%;\n    visibility: hidden;\n}\n.plyr__poster {\n    background-size: var(--background-size, 'contain');\n    opacity: 1;\n}\n.panda-forward-wrapper{\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: space-between;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.panda-forward-wrapper div{\n    width: 50%;\n    height: 100%;\n}\n\n.plyr__captions {\n    font-size: 20px;\n    z-index: 4;\n}\n\n.plyr--video .plyr__controls {\n    z-index: 5;\n}\n\n.plyr--video.plyr--force-hide-controls .plyr__controls {\n    opacity: 0 !important;\n    pointer-events: none !important;\n    transform: translateY(100%) !important;\n}\n.plyr--video.plyr--force-hide-controls:hover .plyr__controls {\n    opacity: 0 !important;\n    pointer-events: none !important;\n    transform: translateY(100%) !important;\n}\n\n@media (min-width: 480px) {\n    .plyr__captions {\n        font-size: 18px;\n    }\n}\n.play-cta{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n}\n\n@media (max-width: 350px) {\n    .plyr__volume>input[type=range] {\n        display: none;\n    }\n\n    .plyr__volume {\n        min-width: 30px;\n        width: 30px;\n    }\n}\n@media (max-width: 480px) {\n    .plyr__captions {\n        font-size: 14px;\n    }\n}\n\n@media (min-width: 768px) {\n    .plyr__captions {\n        font-size: 23px;\n    }\n\n    .live-chat-container:not(.disabled), .assist-chat-container:not(.disabled) {\n        width: 50% !important\n    }\n}\n\n@media (min-width: 1024px) {\n    .plyr__captions {\n        font-size: 26px;\n    }\n}\n\n#live-time-indicator{\n    background: none;\n    outline: 0;\n    border: 0;\n    color: var(--live-indicator-color);\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n}\n#live-time-indicator div{\n    width: 8px;\n    height: 8px;\n    border-radius: 5px;\n    background: var(--live-indicator-color);\n    margin-right: 4px;\n}\n.not-realtime{\n    opacity: 0.5;\n}\n.hide-slyder-badge::-webkit-slider-thumb {\n    opacity: 0;\n}\n\n.plyr audio,\n.plyr iframe,\n.plyr video {\n    max-height: 100vh;\n}\n.end-cta{\n    width: 100%;\n    height: 100%;\n}\n.panda-branding-link {\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0 4px;\n    padding-bottom: 2px;\n    border-radius: 3px;\n    transition: background .3s;\n}\n\n.panda-branding-link:hover {\n    background: var(--plyr-color-main)\n}\n\n.plyr--video {\n    height: 100%\n}\n\n.container-drm {\n    width: 100%;\n    display: table-cell;\n    text-align: center;\n    vertical-align: middle;\n    position: absolute;\n    top: 45vh;\n}\n\n#drm-question {\n    color: white;\n    font-size: 1.8rem;\n    margin: 0;\n    margin-bottom: 20px;\n    text-shadow: 0px 0 1px black;\n}\n\n#drm-answer {\n    height: 33px;\n    font-size: 1rem;\n    margin-bottom: 15px;\n    width: 50%;\n    padding: 10px 15px;\n    display: inline-block;\n    border: .5px solid #ccc !important;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\n#drm-answer:focus {\n    outline: none;\n}\n\n#drm-button {\n    position: absolute;\n    height: 33px;\n    width: 33px;\n    border: none;\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 4px;\n    margin-left: -32px;\n}\n\n.drm-search-icon svg {\n    width: 30px;\n    height: 30px;\n    margin-left: -3px;\n}\n\n.drm-loading-icon svg {\n    height: 40px;\n    width: 40px;\n    position: absolute;\n    left: -2px;\n    top: -3px;\n}\n\n.disabled {\n    display: none  !important;\n}\n\n.panda-live-indicator {\n    position: absolute;\n    right: 20px;\n    top: 5px;\n    padding: 2px 16px;\n    border-radius: 4px;\n    font-weight: bold;\n    background-color: var(--live-indicator-color);\n    color: #fff;\n    opacity: 0.85;\n}\n\n#error-indicator{\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1000;\n    padding: 30px;\n    line-height: 2em;\n    background: rgba(0,0,0,0.6);\n}\n\n.panda-title-wrapper {\n    position: absolute;\n    top: calc(-100vh + 75px);\n    left: 0;\n    width: 100%;\n    transition: transform .01s;\n    height: 80px;\n    background: var(--plyr-video-controls-background, linear-gradient(rgba(0, 0, 0, .85), rgba(0, 0, 0, 0)));\n}\n\n.plyr-controls-fix-index {\n    z-index: 12 !important;\n}\n\n.redirect-loading {\n    background-color: #000;\n}\n@media (max-width: 550px) {\n    .panda-title-wrapper {\n        position: absolute;\n        top: calc(-100vh + 55px);\n        left: 0;\n        width: 100%;\n        transition: transform .01s;\n        height: 80px;\n        background: var(--plyr-video-controls-background, linear-gradient(rgba(0, 0, 0, .85), rgba(0, 0, 0, 0)));\n    }\n}\n\n.plyr--video.plyr--hide-controls .plyr__controls {\n    transform: translateY(0) !important;\n}\n\n.panda-title-wrapper p {\n    color: var(--plyr-video-control-color);\n    padding: 10px 20px;\n    margin: 0;\n    font-size: 18px;\n    font-weight: bold;\n    text-align: start;\n}\n\n.loading-icon svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translateX(-50%) translateY(-50%);\n    -webkit-transform: translateX(-50%) translateY(-50%);\n    -o-transform: translateX(-50%) translateY(-50%);\n    width: 30%;\n    height: 30%;\n}\n.live-offline-badge{\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background: #040814;\n    color: #fff;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n}\n@keyframes pulsateLogo {\n    0% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.1);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n.live-offline-badge img{\n    width: 40%;\n    max-width: 500px;\n    animation: pulsateLogo 3s ease-in-out infinite;\n}\n\n.live-offline-badge p{\n    font-size: 1rem;\n    margin-top: 10px;\n    font-weight: bold;\n}\n\n.live-thumb{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n}\n.live-thumb img{\n    width: 100%;\n    height: 100%;\n}\n.alternative-progress-wrapper{\n    width: 100%;\n    height: 20px;\n    position: absolute;\n    display: flex;\n    align-items: flex-end;\n    bottom: 0;\n    left: 0;\n    transition: width .1s;\n}\n.alternative-progress{\n    --value-progress: 0%;\n    background: var(--plyr-color-main);\n    height: 100%;\n    width: var(--value-progress);\n    transition: width 0.7s;\n    z-index: 100000;\n}\n@media (max-width: 550px) {\n    .alternative-progress-wrapper{\n        height: 20px;\n    }\n}\nbutton[data-plyr=\"play\"].plyr__control--overlaid{\n    z-index: 5;\n}\n@media (max-width: 450px) {\n    .alternative-progress-wrapper{\n        height: 14px;\n    }\n}\n@media (max-width: 380px) {\n    .alternative-progress-wrapper{\n        height: 10px;\n    }\n}\n@media (max-width: 490px){\n    button[data-plyr=\"rewind\"]{\n        display: none;\n    }\n    button[data-plyr=\"fast-forward\"]{\n        display: none;\n    }\n    button[data-plyr=\"play\"]{\n        margin-right: auto;\n    }\n    .no-progress button[data-plyr=\"play\"].plyr__controls__item, .no-progress div.plyr__time--current,.no-progress  div.plyr__time{\n        position: static !important;\n    }\n    .panda-bookmarks-div{\n        position: relative;\n    }\n}\n.panda-bookmarks-list-title{\n    width: calc(100% - 20px);\n    text-align: start;\n    padding: 5px 10px;\n    border-bottom: 1px solid #ccc;\n    margin: 3px 10px;\n    font-size: 13px;\n}\n.panda-bookmarks-list-wrapper{\n    animation: plyr-popup .2s ease;\n    position: absolute;\n    bottom: 50px;\n    right: 0px;\n    color: var(--plyr-menu-color,#4a5464);\n    background: var(--plyr-menu-background,rgba(255,255,255,.9));\n    border-radius: 4px;\n    opacity: 0.9;\n}\n\n.panda-bookmarks-list{ \n    list-style-type: none;\n    padding: 5px 10px;\n    padding-top: 0;\n    max-height: calc(var(--max-height) - 110px);\n    overflow-y: auto;\n    margin-top: 0;\n}\n.panda-bookmarks-list::-webkit-scrollbar {\n    width: 5px;\n}\n.panda-bookmarks-list::-webkit-scrollbar-track {\n    background: var(--plyr-menu-background,rgba(255,255,255,.9));\n    border-radius: 5px;\n}\n.panda-bookmarks-list::-webkit-scrollbar-thumb {\n    background: #ccc; \n    border-radius: 5px;\n}\n.panda-bookmarks-list li {\n    display: flex;\n    padding: 3px 10px;\n    min-width: 130px;\n    max-width: 220px;\n    text-align: start;\n    cursor: pointer;\n    border-radius: 2px;\n}\n.panda-bookmarks-list li:hover{\n    background: var(--plyr-color-main);\n    color: var(--plyr-video-control-color);\n}\n.panda-bookmarks-list  li span{\n    font-size: 13px;\n    font-weight: normal;\n    line-height: 18px;\n}\n.panda-bookmarks-button{\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 3px;\n    margin-left: 2px;\n    transition: background .3s;\n    border: 0;\n    background: none;\n}\n.active-bookmark {\n    background: var(--plyr-color-main);\n}\n.panda-bookmarks-button:hover {\n    background: var(--plyr-color-main)\n}\n.panda-bookmark-progress-dot{\n    width: 5px;\n    height: 5px;\n    border-radius: 50%;\n    background: var(--plyr-video-control-color);\n    position: absolute;\n    top: 7px;\n    left: calc(var(--dot-percent) - 6px);\n    z-index: 20;\n}\n\n.plyr__menu__container {\n    z-index: 9999;\n}\n\n.plyr__menu__container > div > div{\n    max-height: calc(var(--max-height) - 50px);\n}\n\n.plyr__menu__container > div > div::-webkit-scrollbar {\n    width: 5px;\n}\n.plyr__menu__container > div > div::-webkit-scrollbar-track {\n    background: var(--plyr-menu-background,rgba(255,255,255,.9));\n    border-radius: 5px;\n}\n.plyr__menu__container > div > div::-webkit-scrollbar-thumb {\n    background: #ccc; \n    border-radius: 5px;\n}\n\n.cta-overlay{\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 1;\n    width: 100%;\n    height: 100%;\n    outline: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.cta-overlay iframe{\n    outline: 0;\n    border: 0;\n} \n.cta-skip-button{\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    padding: 10px;\n    cursor: pointer;\n    background: rgba(255,255,255,0.4);\n    border: 0;\n    outline: 0;\n}\n.cta-container{\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    z-index: 1000;\n}\n.panda-resume-screen-wrapper{\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    background: var(--plyr-color-main);\n    z-index: 15;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    font-size: 1rem;\n}\n.panda-resume-screen-wrapper p{\n    color: var(--plyr-video-control-color);\n    font-size: 1.4em;\n    font-weight: bold;\n}\n.panda-resume-screen-buttons{\n    display: flex;\n    flex-direction: row;\n}\n.panda-resume-screen-buttons button{\n    background: none;\n    border: 0;\n    outline: 0;\n    display: flex;\n    align-items: center;\n    padding: 10px 20px;\n    cursor: pointer;\n    color: var(--plyr-video-control-color);\n    font-size: 1.1em;\n}\n.panda-resume-screen-buttons button svg{\n    width: 1.9em;\n    height: 1.9em;\n}\n.panda-resume-screen-buttons button span{\n    padding-left: 4px;\n}\n@media (max-width: 450px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.8rem;\n    }\n}\n@media (max-width: 350px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.7rem;\n    }\n}\n@media (max-width: 275px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.6rem;\n    }\n}\n@media (max-width: 230px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.5rem;\n    }\n}\n.plyr--full-ui.fullscreen ::-webkit-media-text-track-container {\n    display:block !important;\n}\n@keyframes plyr-popup{\n    0%{\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    100%{\n        opacity: 1;\n        transform: translateY(0px);\n    }\n}\n#context-menu-ai {\n    position: absolute;\n    min-height: 45px;\n    min-width: 170px;\n    display: none;\n    background: rgba(255,255,255,0.8);\n    bottom: 32px;\n    right: 0;\n}\n#context-menu-ai.active {\n    display: block;\n}\n#context-menu{\n    position: absolute;\n    display: flex;\n    width: 170px;\n    background: rgba(255,255,255,0.8);\n    border-radius: 3px;\n    z-index: 100;\n}\n#context-menu ul{\n    display: flex;\n    flex-direction: column;\n    align-items: start;\n    justify-content: space-around;\n    padding: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n}\n#context-menu ul li{\n    list-style: none;\n    display: flex;\n    width: 100%;\n}\n#context-menu ul li:hover{\n    opacity: 0.8;\n    background: var(--plyr-color-main);\n}\n#context-menu ul li *:hover{\n    color: var(--plyr-video-control-color);\n}\n#context-menu ul li a{\n    text-decoration: none;\n    color: #333;\n    font-size: 0.8rem;\n    padding: 10px;\n    cursor: pointer;\n    width: 100%;\n}\n#context-menu ul li button{\n    color: #333;\n    background: 0;\n    outline: 0;\n    border: 0;\n    font-size: 0.8rem;\n    cursor: pointer;\n    width: 100%;\n    text-align: start;\n    padding: 10px;\n}\n#content-ai {\n    height: 83%;\n    position: relative;\n    overflow: auto;\n}\n#content-ai-dialog,\n#report-problem-dialog {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n#modal-ai,\n#copy-paste{\n    display: flex;\n    flex-direction: column;\n    width: 520px;\n    height: 300px;\n    z-index: 100;\n    background-color: #1b1b4b;\n    border-radius: 5px;\n}\n#modal-ai {\n    position: relative;\n}\n\n#modal-ai .close-ai-button {\n    cursor: pointer;\n    top: 2px;\n    position: absolute;\n    right: 10px;\n    border: none;\n    background: none;\n    color: white;\n    font-size: 18px;\n    padding: 10px;\n}\n\n#modal-ai.smart-search  .close-ai-button {\n    top: 8px;\n}\n\n#search-content ul {\n    padding: 0 15px 0 15px;\n}\n\n#search-content ul li {\n    list-style: none;\n    color: white;\n    padding: 0 0 0 10px;\n    border: 1px solid #ccc;\n    font-size: 13px;\n    height: auto;\n    border-radius: 2px;\n    display: flex;\n    justify-content: space-between;\n    margin: 10px 0 0 0;\n    cursor: pointer;\n}\n\n#search-content ul li:hover {\n    background-color: #eee3;\n}\n\n#search-content ul li span {\n    margin: auto 10px;\n    background-color: #444;\n    padding: 8px 5px 8px 5px;\n    border-radius: 5px;\n}\n\n#modal-ai #input-smart-search {\n    margin: 15px 0 0px 15px;\n    padding: 0 0 0 10px;\n    width: 260px;\n    height: 30px;\n    border: none;\n    border-radius: 5px;\n}\n\n#modal-ai #input-smart-search:focus {\n    outline: none;\n}\n\n#mindmap-zoom-controls {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    display: flex;\n    padding: 15px;\n    flex-direction: column;\n    align-items: center;\n}\n#mindmap-zoom-controls button {\n    margin: 2px;\n    height: 20px;\n    font-size: 13px;\n    border: none;\n    padding: 3px;\n    cursor: pointer;\n}\n#mindmap-container {\n    transition: transform 0.3s ease;\n    transform-origin: top left;\n    height: 98%;\n    position: relative;\n    margin: 0px;\n    padding: 0px;\n}\n#mindmap-container svg{ \n    height: 100%;\n}\n#mindmap-container svg .mindmap-node {\n    cursor: pointer;\n}\n#question-enunciate {\n    color: #fff;\n    font-size: 14px;\n    margin: 2px 0 0 15px;\n}\n#answer-options {\n    margin: 15px 0 0 15px;\n    padding: 0;\n}\n#answer-options li {\n    display: block;\n    color: white;\n    padding: 10px;\n    margin-bottom: 10px;\n    width: 93%;\n    border: 1px solid #ccc;\n    font-size: 13px;\n    cursor: pointer;\n}\n#answer-options li:not(.answered):hover {\n    background-color: #eee3;\n}\n#abstract-footer,\n#questions-footer {\n    display: flex;\n    justify-content: space-between;\n    height: 60px;\n}\n#questions-footer button {\n    height: 30px;\n    margin: 10px 17px 0 14px;\n    cursor: pointer;\n}\n#questions-indicator,\n.title-ai-text,\n.report-problem-text{\n    display: flex;\n    color: #fff;\n    justify-content: center;\n    align-items: center;\n    font-weight: 600;\n    font-size: 15px;\n}\n#copy-paste #report-first-step section {\n    display: flex;\n    flex-direction: column; \n    align-items: flex-start;\n    margin: 10px 30px 0px 30px;\n    color: #ccc;\n    font-size: 16px;\n}\n#modal-ai #content-ai footer,\n#copy-paste #report-first-step footer {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-top: 12px;\n}\n#abstract-content {\n    color: white;\n    padding: 0 15px 0 15px;\n    font-size: 14px;\n}\n#abstract-content a {\n    color: white;\n}\n#abstract-content h1 {\n    font-size: 20px;\n}\n#abstract-content h2 {\n    font-size: 18px;\n}\n#abstract-content h3 {\n    font-size: 15px;\n}\n#abstract-copy-button,\n#abstract-download-button,\n#mindmap-download-button,\n.content-ai-dialog-button,\n.report-problem-dialog-button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: #a6a2ec;\n    border-radius: 6px;\n    border-style: none;\n    box-sizing: border-box;\n    color: #FFFFFF;\n    cursor: pointer;\n    height: 35px;\n    line-height: 20px;\n    margin: 0;\n    outline: none;\n    padding: 10px 0px;\n    position: relative;\n    text-align: center;\n    text-decoration: none;\n    transition: color 100ms;\n    vertical-align: baseline;\n    user-select: none;\n    -webkit-user-select: none;\n    touch-action: manipulation;\n    width: 140px;\n    font-size: 0.8rem;\n}\n\n#abstract-copy-button,\n#abstract-download-button,\n#mindmap-download-button {\n    height: 30px;\n    width: 90px;\n    margin: 10px 15px 0 15px;\n}\n\n#modal-ai #content-ai footer button:hover,\n#modal-ai #content-ai footer button:focus,\n#copy-paste #report-first-step footer button:hover,\n#copy-paste #report-first-step footer button:focus {\n    background-color: #bab7eb;\n}\n#modal-ai #content-ai footer > :first-child,\n#copy-paste #report-first-step footer > :first-child {\n    margin-right: 20px;\n}\n.other-input {\n    width: 100%;\n    padding: 10px 20px;\n    margin: 0px 0px 8px 0px;\n    display: inline-block;\n    border: .5px solid #ccc !important;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n#copy-paste #report-second-step {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    color: #fff;\n    font-size: 16px;\n    font-weight: 600;\n    text-align: center;\n    line-height: 1.3rem;\n}\n#copy-paste #report-second-step header {\n    margin-top: 10px;\n}\n#copy-paste #report-second-step #second-step-text {\n    margin-top: -10px;\n}\n#copy-paste #report-second-step #loading-div {\n    width: 120px;\n}\n#copy-paste #report-third-step {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    color: #fff;\n    font-size: 16px;\n    font-weight: 600;\n    text-align: center;\n    line-height: 1.3rem;\n}\n#copy-paste #report-third-step.alone {\n    margin-top: 40px;\n}\n#copy-paste #report-third-step header {\n    margin-top: 15px;\n    margin-bottom: 5px;\n}\n#copy-paste #report-third-step footer {\n    margin-top: 15px;\n}\n.report-textfield-card {\n    height: 40px;\n    width: 100%;\n    margin-top: 12px;\n}\n\n@media (min-width: 1024px) {\n    #modal-ai {\n        width: 60%;\n        height: 60%;\n    }\n}\n@media (max-width: 450px) {\n    #modal-ai,\n    #copy-paste {\n        width: 300px;\n        height: 180px;\n    }\n    #modal-ai .close-ai-button {\n        top: -6px;\n        right: 5px;\n        font-size: 15px;\n        padding: 10px;\n    }\n    #modal-ai header p,\n    #copy-paste header p {\n        margin: 10px 0px 0px 0px;\n    }\n    #answer-options li {\n        font-size: 7px;\n        padding: 5px;\n        width: 90%;\n    }\n    #questions-footer button {\n        height: 20px;\n        margin: 7px 12px 0 12px;\n    }\n    #abstract-footer,\n    #questions-footer {\n        height: 40px;\n    }\n    #abstract-content,\n    #questions-indicator,\n    #question-enunciate,\n    .title-ai-text,\n    .report-problem-text {\n        font-size: 9px;\n    }\n    #question-enunciate {\n        margin: 6px 0 0 15px;\n    }\n    #abstract-content h1 {\n        font-size: 14px;\n    }\n    #abstract-content h2 {\n        font-size: 12px;\n    }\n    #abstract-content h3 {\n        font-size: 10px;\n    }\n    .report-textfield-card {\n        height: 32px;\n        width: 94%;\n        padding-left: 2px;\n    }\n    #abstract-copy-button,\n    #abstract-download-button,\n    #mindmap-download-button,\n    .report-problem-dialog-button {\n        height: 20px;\n        line-height: 14px;\n        padding: 2px 0px;\n        width: 80px;\n        font-size: .5rem;\n    }\n    #copy-paste #report-first-step section div {\n        margin: 0 0 2.4px 4px;\n    }\n    #copy-paste #report-first-step section {\n        margin: 2px 4px 0px 2px;\n        font-size: 10px;\n    }\n    #copy-paste #report-second-step #second-step-text {\n        font-size: 12px;\n    }\n    #copy-paste #report-third-step footer {\n        margin-top: 5px;\n    }\n    #panda-last-step-img {\n        width: 50%;\n    }\n    .other-input {\n        width: 100%;\n        padding: 4px 8px;\n        margin: 5px 0px;\n        display: inline-block;\n        border: .25px solid #ccc;\n        border-radius: 4px;\n        box-sizing: border-box;\n        font-size: 10px;\n    }\n}\n.customSettingsBtn {\n    --max-height: 100vh;\n    --plyr-captions-text-color: #FFF;\n    --plyr-captions-background: #000;\n    --plyr-video-control-color: #FFFFFFFF;\n    --plyr-video-control-color-hover: #FFFFFFFF;\n    --plyr-menu-color: #4a5464;\n    --live-indicator-color: #fc2d2d;\n    -webkit-font-smoothing: antialiased;\n    direction: ltr;\n    white-space: nowrap;\n    box-sizing: inherit;\n    background: 0 0;\n    border: 0;\n    border-radius: 3px;\n    cursor: pointer;\n    flex-shrink: 0;\n    overflow: visible;\n    position: relative;\n    transition: all .3s ease;\n    font: inherit;\n    line-height: inherit;\n    touch-action: manipulation;\n    margin-top: 2px;\n    align-items: center;\n    color: var(--plyr-menu-color, #4a5464);\n    display: flex;\n    font-size: 13px !important;\n    padding-bottom: calc(calc(10px * .7)/ 1.5);\n    padding-left: calc(calc(10px * .7) * 1.5);\n    padding-top: calc(calc(10px * .7)/ 1.5);\n    user-select: none;\n    width: 100% !important;\n    padding-right: calc(calc(10px * .7) * 4);\n}\n\n.customSettingsBtn:hover {\ncolor: #fff;\n}\n.small-muted-icon {\n    width: 200px;\n    position: absolute;\n    top: 0;\n    left: 0;\n    margin-left: 10px;\n    margin-top: 10px;\n    background-color: var(--plyr-color-main);\n    opacity: 0.8;\n    display: flex;\n    color: var(--plyr-video-control-color);\n    align-items: center;\n    border: 1px solid var(--plyr-video-control-color);\n    border-radius: 3px;\n}\nbutton.small-muted-icon:after {\n    display: block;\n    width: 99999px;\n    top: 0;\n    left: 0;\n    z-index: 999999;\n    height: 99999px;\n    position: absolute;\n    content: '';\n    transform: translate(-50%, -50%);\n    cursor: pointer;\n}\n.small-muted-icon svg {\n    width: 50px;\n    height: 50px;\n}\n.small-muted-icon span{\n    padding: 0 10px;\n    font-weight: bold;\n}\n\n.blur {\n    visibility: visible;\n    position: absolute;\n    top: 0;\n    z-index: -1;\n    filter: blur(4px);\n    -webkit-filter: blur(4px);\n}\n\nbutton.panda-muted-indicator {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 80%;\n    max-width: 400px;\n    height: auto;\n    border-radius: 10px;\n    background-color: var(--muted-indicator-background);\n    border: var(--muted-indicator-border-size) solid var(--muted-indicator-text);\n    padding: 0.5em;\n    text-align: center;\n    transform: translate(-50%, -50%);\n    z-index: 9999999;\n    outline: none;\n    cursor: pointer;\n}\nbutton.panda-muted-indicator:after {\n    content: '';\n    position: absolute;\n    display: block;\n    width: 99999px;\n    height: 99999px;\n    transform: translate(-50%, -50%);\n    cursor: pointer;\n}\nbutton.panda-muted-indicator span {\n    display: block;\n    width: 100%;\n    padding: 0.5em 0;\n    box-sizing: border-box;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 24px;\n    font-weight: 700;\n    text-align: center;\n    color: var(--muted-indicator-text);\n    white-space: normal;\n    line-height: 1.1em;\n}\nbutton.panda-muted-indicator-big-text span {\n    font-size: 22px;\n}\nbutton.panda-muted-indicator svg {\n    width: 36%;\n    height: auto;\n}\nbutton.panda-muted-indicator svg,\nbutton.panda-muted-indicator svg path,\nbutton.panda-muted-indicator svg polygon {\n    fill: var(--muted-indicator-text);\n}\nbutton.panda-muted-indicator.medium {\n    transform: translate(-50%, -50%) scale(1.35);\n    transform-origin: center;\n}\nbutton.panda-muted-indicator.large {\n    width: 100%;\n    max-width: 100%;\n    height: 100%;\n    border-radius: 0;\n}\nbutton.panda-muted-indicator.large svg {\n    width: 24%;\n}\nbutton.panda-muted-indicator.large span {\n    font-size: 250%;\n}\n@media(max-width: 680px) {\n    button.panda-muted-indicator svg {\n        width: 30%;\n    }\n    button.panda-muted-indicator span,\n    button.panda-muted-indicator.large span {\n        font-size: 20px;\n    }\n    button.panda-muted-indicator-big-text span,\n    button.panda-muted-indicator-big-text.large span {\n        font-size: 16px;\n        line-height: 1em;\n    }\n}\n@media(max-width: 380px) {\n    button.panda-muted-indicator svg {\n        width: 25%;\n    }\n    button.panda-muted-indicator span,\n    button.panda-muted-indicator.large span {\n        font-size: 16px;\n        line-height: 1em;\n    }\n    button.panda-muted-indicator-big-text span,\n    button.panda-muted-indicator-big-text.large span {\n        font-size: 12px;\n        line-height: 1em;\n    }\n}\n\nbutton.panda-muted-indicator-impact-wrapper {\n    --size-width: 80%;\n    --size-height: 218px;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    z-index: 9999999;\n    display: flex;\n    width: 100%;\n    height: 100%;\n    padding: 0;\n    border: none;\n    background: rgba(0, 0, 0, 0);\t\t\t\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    outline: none;\n    cursor: pointer;\n    overflow: hidden;\n}\nbutton.panda-muted-indicator-impact-wrapper:after {\n    content: '';\n    position: absolute;\n    display: block;\n    width: 100%;\n    height: 100%;\n}\nbutton.panda-muted-indicator-impact-wrapper .text {\n    position: absolute;\n    display: block;\n    width: calc(80% - 0.5em);\n    max-width: calc(400px - 0.5em);\n    padding: 0.5em 0;\n    box-sizing: border-box;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 24px;\n    font-weight: 700;\n    text-align: center;\n    color: var(--muted-indicator-text);\n    white-space: normal;\n    line-height: 1.1em;\n}\nbutton.panda-muted-indicator-impact-wrapper-big-text .text {\n    font-size: 22px;\n}\nbutton.panda-muted-indicator-item .text.small-text {\n    padding: 0.7em 0;\n}\nbutton.panda-muted-indicator-item .text.large-text {\n    padding: 0;\n}\nbutton.panda-muted-indicator-item span.small-text {\n    padding: 10px 0;\n}\nbutton.panda-muted-indicator-item span.large-text {\n    padding: 8px 0;\n}\nbutton.panda-muted-indicator-impact-wrapper .text.top,\nbutton.panda-muted-indicator-impact-wrapper-big-text .text.top {\n    top: calc((50% - var(--size-height) / 2) + 0.5em - var(--muted-indicator-border-size));\n}\nbutton.panda-muted-indicator-impact-wrapper .text.bottom,\nbutton.panda-muted-indicator-impact-wrapper-big-text .text.bottom {\n    bottom: calc((50% - var(--size-height) / 2) + 0.5em - var(--muted-indicator-border-size));\n}\nbutton.panda-muted-indicator-impact-wrapper .panda-muted-indicator-impact-wrapper-canvas {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    z-index: -1;\n    width: 80%;\n    max-width: 400px;\n    height: var(--size-height);\n    background-color: var(--muted-indicator-background);\n    border-radius: 10px;\n    box-sizing: border-box;\n    border: var(--muted-indicator-border-size) solid var(--muted-indicator-text);\n    transform: translate(-50%, -50%);\n    transform-origin: center;\n}\nbutton.panda-muted-indicator-impact-wrapper svg {\n    position: absolute;\n    width:var(--size-width);\n    max-width: 400px;\n}\nbutton.panda-muted-indicator-impact-wrapper.medium {\n    transform: scale(1.35);\n}\nbutton.panda-muted-indicator-impact-wrapper.large .panda-muted-indicator-impact-wrapper-canvas {\n    --size-width: 100%;\n    --size-height: 100%;\n    width: 100%;\n    max-width: 100%;\n    border-radius: 0;\n}\nbutton.panda-muted-indicator-impact-wrapper.large {\n    --size-width: 65%;\n}\nbutton.panda-muted-indicator-impact-wrapper.large svg {\n    max-width: 500px;\n}\nbutton.panda-muted-indicator-impact-wrapper.large .text {\n    font-size: 225%;\n    width: 90%;\n}\nbutton.panda-muted-indicator-impact-wrapper.large .text.top {\n    top: calc((var(--size-width) / 3) - 0.5em);\n}\nbutton.panda-muted-indicator-impact-wrapper.large .text.bottom {\n    bottom: calc((var(--size-width) / 3) - 0.5em);\n}\n@media(max-width: 680px) {\n    button.panda-muted-indicator-impact-wrapper {\n        --size-height: 185px;\n    }\n    button.panda-muted-indicator-impact-wrapper svg {\n        --size-width: 65%;\n    }\n    button.panda-muted-indicator-impact-wrapper.medium {\n        transform: scale(1.15);\n    }\n    button.panda-muted-indicator-impact-wrapper .text,\n    button.panda-muted-indicator-impact-wrapper.large .text {\n        font-size: 20px;\n    }\n    button.panda-muted-indicator-impact-wrapper-big-text .text,\n    button.panda-muted-indicator-impact-wrapper-big-text.large .text {\n        font-size: 16px;\n        line-height: 1em;\n    }\n}\n@media(max-width: 380px) {\n    button.panda-muted-indicator-impact-wrapper {\n        --size-height: 140px;\n    }\n    button.panda-muted-indicator-impact-wrapper svg {\n        --size-width: 52.5%;\n    }\n    button.panda-muted-indicator-impact-wrapper.medium {\n        transform: initial;\n    }\n    button.panda-muted-indicator-impact-wrapper .text,\n    button.panda-muted-indicator-impact-wrapper.large .text {\n        font-size: 16px;\n        line-height: 1em;\n    }\n    button.panda-muted-indicator-impact-wrapper-big-text .text,\n    button.panda-muted-indicator-impact-wrapper-big-text.large .text {\n        font-size: 12px;\n        line-height: 1em;\n    }\n}\n.panda-muted-indicator-custom{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n    z-index: 999;\n    outline: 0;\n}\n#trial-warning{\n    position: absolute;\n    bottom: 50px;\n    right: 30px;\n    color: white;\n    text-align: center;\n    background: rgba(0,0,0,0.5);\n    opacity: 0.7;\n    font-size: 0.8rem;\n    padding: 5px 10px;\n}\n@media(max-width: 680px) {\n    #trial-warning{\n        font-size: 0.7rem;\n    }\n}\n@media(max-width: 380px) {\n    #trial-warning{\n        font-size: 0.5rem;\n    }\n}\n\n.plyr__controls .plyr__controls__item:first-child {\n    margin-right: 0;\n}\n\n\n.thumbnail-blur {\n    position: absolute;\n    top: -5px;\n    left: -5px;\n    width: 100%;\n    height: 100%;\n    filter: blur(10px);\n    transform: scale(1.1);\n    -webkit-filter: blur(5px);\n    -webkit-backdrop-filter:blur(5px);\n    backdrop-filter:blur(5px);\n    transition: filter .1s;\n    z-index: 1;\n}\n\n.panda-live-chat {\n    position: relative;\n}\n\n.panda-live-chat.new-message-badge::before{\n    position: absolute;\n    content: '';\n    width: 8px;\n    height: 8px;\n    top: 5px;\n    right: 6px;\n    border-radius: 100%;\n    background-color: red;\n}\n\n.live-chat-container:not(.disabled) {\n    width: 100%;\n    height: 100%; \n    position: fixed;\n    top: 0;\n    right: 0; \n    background-color: rgba(0, 0, 0, 0.9); \n    z-index: 1000; \n}\n\n.assist-chat-container:not(.disabled) {\n    width: 100%;\n    height: 100%; \n    position: fixed;\n    top: 0;\n    right: 0; \n    background-color: rgba(0, 0, 0, 0.9); \n    z-index: 1000; \n}\n\n#hot-keys-dialog {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n\n#hot-keys-dialog-content {\n    display: flex;\n    flex-direction: column;\n    width: 520px;\n    max-height: 50vh;\n    z-index: 100;\n    background-color: #1B1B20;\n    border-radius: 5px;\n    color: #fff;\n    padding: 16px;\n    overflow: auto;\n}\n#hot-keys-dialog-content header {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n}\n@media (max-width: 450px) {\n    #hot-keys-dialog-content {\n        width: 300px;\n        height: 200px;\n        padding: 8px;\n    } \n}\n#hot-keys-dialog-content header button {\n    color: #fff;\n    background: none;\n    border: none;\n    outline: none;\n    cursor: pointer;\n    font-size: 20px;\n    padding: 5px;\n}\n\n#hot-keys-dialog-content ul {\n    padding: 0;\n    margin: 0;\n}\n\n#hot-keys-dialog-content ul li {\n    list-style: none;\n    color: #D0D1D9;\n    padding: 0;\n    border-bottom: 1px solid #282931;\n    font-size: 0.9rem;\n    height: auto;\n    display: flex;\n    justify-content: space-between;\n    margin: 0;\n}\n#hot-keys-dialog-content ul li p {\n    padding:  8px 0;\n    margin: 0;\n}",""]);const o=a},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&a[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},443:function(e,t,n){"object"==typeof navigator&&(e.exports=function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a={addCSS:!0,thumbWidth:15,watch:!0};var o=function(e){return null!=e?e.constructor:null},l=function(e,t){return!!(e&&t&&e instanceof t)},c=function(e){return o(e)===String},d=function(e){return Array.isArray(e)},u=function(e){return l(e,NodeList)},h=c,p=d,f=u,m=function(e){return l(e,Element)},g=function(e){return l(e,Event)},y=function(e){return function(e){return null==e}(e)||(c(e)||d(e)||u(e))&&!e.length||function(e){return o(e)===Object}(e)&&!Object.keys(e).length};var v=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),m(t)?this.element=t:h(t)&&(this.element=document.querySelector(t)),m(this.element)&&y(this.element.rangeTouch)&&(this.config=s({},a,{},n),this.init())}return function(e,n,i){n&&t(e.prototype,n),i&&t(e,i)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,n=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[n](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!g(t))return null;var n,i=t.target,r=t.changedTouches[0],s=parseFloat(i.getAttribute("min"))||0,a=parseFloat(i.getAttribute("max"))||100,o=parseFloat(i.getAttribute("step"))||1,l=i.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(n=100/l.width*(r.clientX-l.left))?n=0:100<n&&(n=100),50>n?n-=(100-2*n)*c:50<n&&(n+=2*(n-50)*c),s+function(e,t){if(1>t){var n=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(n))}return Math.round(e/t)*t}(n/100*(a-s),o)}},{key:"set",value:function(t){e.enabled&&g(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var n=new Event(t,{bubbles:!0});e.dispatchEvent(n)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=null;if(y(t)||h(t)?i=Array.from(document.querySelectorAll(h(t)?t:'input[type="range"]')):m(t)?i=[t]:f(t)?i=Array.from(t):p(t)&&(i=t.filter(m)),y(i))return null;var r=s({},a,{},n);if(h(t)&&r.watch){var o=new MutationObserver((function(n){Array.from(n).forEach((function(n){Array.from(n.addedNodes).forEach((function(n){m(n)&&function(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}(n,t)&&new e(n,r)}))}))}));o.observe(document.body,{childList:!0,subtree:!0})}return i.map((function(t){return new e(t,n)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();const b=e=>null!=e?e.constructor:null,_=(e,t)=>Boolean(e&&t&&e instanceof t),w=e=>null==e,E=e=>b(e)===Object,T=e=>b(e)===String,S=e=>"function"==typeof e,x=e=>Array.isArray(e),k=e=>_(e,NodeList),C=e=>w(e)||(T(e)||x(e)||k(e))&&!e.length||E(e)&&!Object.keys(e).length;var L=w,A=E,R=e=>b(e)===Number&&!Number.isNaN(e),I=T,D=e=>b(e)===Boolean,P=S,M=x,O=k,N=e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,F=e=>_(e,Event),B=e=>_(e,KeyboardEvent),U=e=>_(e,TextTrack)||!w(e)&&T(e.kind),$=e=>{if(_(e,window.URL))return!0;if(!T(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!C(new URL(t).hostname)}catch(e){return!1}},G=C;const H=(()=>{const e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n=Object.keys(t).find((t=>void 0!==e.style[t]));return!!I(n)&&t[n]})();function q(e,t){setTimeout((()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}const z={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebkit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function j(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function V(e={},...t){if(!t.length)return e;const n=t.shift();return A(n)?(Object.keys(n).forEach((t=>{A(n[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),V(e[t],n[t])):Object.assign(e,{[t]:n[t]})})),V(e,...t)):e}function Y(e,t){const n=e.length?e:[e];Array.from(n).reverse().forEach(((e,n)=>{const i=n>0?t.cloneNode(!0):t,r=e.parentNode,s=e.nextSibling;i.appendChild(e),s?r.insertBefore(i,s):r.appendChild(i)}))}function K(e,t){N(e)&&!G(t)&&Object.entries(t).filter((([,e])=>!L(e))).forEach((([t,n])=>e.setAttribute(t,n)))}function W(e,t,n){const i=document.createElement(e);return A(t)&&K(i,t),I(n)&&(i.innerText=n),i}function X(e,t,n,i){N(t)&&t.appendChild(W(e,n,i))}function Z(e){O(e)||M(e)?Array.from(e).forEach(Z):N(e)&&N(e.parentNode)&&e.parentNode.removeChild(e)}function J(e){if(!N(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function Q(e,t){return N(t)&&N(t.parentNode)&&N(e)?(t.parentNode.replaceChild(e,t),e):null}function ee(e,t){if(!I(e)||G(e))return{};const n={},i=V({},t);return e.split(",").forEach((e=>{const t=e.trim(),r=t.replace(".",""),s=t.replace(/[[\]]/g,"").split("="),[a]=s,o=s.length>1?s[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":I(i.class)?n.class=`${i.class} ${r}`:n.class=r;break;case"#":n.id=t.replace("#","");break;case"[":n[a]=o}})),V(i,n)}function te(e,t){if(!N(e))return;let n=t;D(n)||(n=!e.hidden),e.hidden=n}function ne(e,t,n){if(O(e))return Array.from(e).map((e=>ne(e,t,n)));if(N(e)){let i="toggle";return void 0!==n&&(i=n?"add":"remove"),e.classList[i](t),e.classList.contains(t)}return!1}function ie(e,t){return N(e)&&e.classList.contains(t)}function re(e,t){const{prototype:n}=Element;return(n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function se(e){return this.elements.container.querySelectorAll(e)}function ae(e){return this.elements.container.querySelector(e)}function oe(e=null,t=!1){N(e)&&(e.focus({preventScroll:!0}),t&&ne(e,this.config.classNames.tabFocus))}const le={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},ce={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t,n){const i=z.isIPhone&&n&&ce.playsinline,r=ce[e]||"html5"!==t;return{api:r,ui:r&&ce.rangeInput&&("video"!==e||!z.isIPhone||i)}},pip:!(z.isIPhone||!P(W("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||W("video").disablePictureInPicture)),airplay:P(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(G(e))return!1;const[t]=e.split("/");let n=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(le).includes(n)&&(n+=`; codecs="${le[e]}"`);try{return Boolean(n&&this.media.canPlayType(n).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==H,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},de=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e})();function ue(e,t,n,i=!1,r=!0,s=!1){if(!e||!("addEventListener"in e)||G(t)||!P(n))return;const a=t.split(" ");let o=s;de&&(o={passive:r,capture:s}),a.forEach((t=>{this&&this.eventListeners&&i&&this.eventListeners.push({element:e,type:t,callback:n,options:o}),e[i?"addEventListener":"removeEventListener"](t,n,o)}))}function he(e,t="",n,i=!0,r=!1){ue.call(this,e,t,n,!0,i,r)}function pe(e,t="",n,i=!0,r=!1){ue.call(this,e,t,n,!1,i,r)}function fe(e,t="",n,i=!0,r=!1){const s=(...a)=>{pe(e,t,s,i,r),n.apply(this,a)};ue.call(this,e,t,s,!0,i,r)}function me(e,t="",n=!1,i={}){if(!N(e)||G(t))return;const r=new CustomEvent(t,{bubbles:n,detail:{...i,plyr:this}});e.dispatchEvent(r)}function ge(){this&&this.eventListeners&&(this.eventListeners.forEach((e=>{const{element:t,type:n,callback:i,options:r}=e;t.removeEventListener(n,i,r)})),this.eventListeners=[])}function ye(){return new Promise((e=>this.ready?setTimeout(e,0):he.call(this,this.elements.container,"ready",e))).then((()=>{}))}function ve(e){(e=>_(e,Promise)&&S(e.then))(e)&&e.then(null,(()=>{}))}function be(e){return M(e)?e.filter(((t,n)=>e.indexOf(t)===n)):e}function _e(e,t){return M(e)&&e.length?e.reduce(((e,n)=>Math.abs(n-t)<Math.abs(e-t)?n:e)):null}function we(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}const Ee=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((e,[t,n])=>({...e,[t/n]:[t,n]})),{});function Te(e){return!!(M(e)||I(e)&&e.includes(":"))&&(M(e)?e:e.split(":")).map(Number).every(R)}function Se(e){if(!M(e)||!e.every(R))return null;const[t,n]=e,i=(e,t)=>0===t?e:i(t,e%t),r=i(t,n);return[t/r,n/r]}function xe(e){const t=e=>Te(e)?e.split(":").map(Number):null;let n=t(e);if(null===n&&(n=t(this.config.ratio)),null===n&&!G(this.embed)&&M(this.embed.ratio)&&({ratio:n}=this.embed),null===n&&this.isHTML5){const{videoWidth:e,videoHeight:t}=this.media;n=[e,t]}return Se(n)}function ke(e){if(!this.isVideo)return{};const{wrapper:t}=this.elements,n=xe.call(this,e);if(!M(n))return{};const[i,r]=Se(n),s=100/i*r;if(we(`aspect-ratio: ${i}/${r}`)?t.style.aspectRatio=`${i}/${r}`:t.style.paddingBottom=`${s}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const e=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),n=(e-s)/(e/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${n}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:s,ratio:n}}function Ce(e,t,n=.05){const i=e/t,r=_e(Object.keys(Ee),i);return Math.abs(r-i)<=n?Ee[r]:[e,t]}const Le={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((e=>{const t=e.getAttribute("type");return!!G(t)||ce.mime.call(this,t)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:Le.getSources.call(this).map((e=>Number(e.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,G(this.config.ratio)||ke.call(e),Object.defineProperty(e.media,"quality",{get(){const t=Le.getSources.call(e).find((t=>t.getAttribute("src")===e.source));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&P(e.config.quality.onChange))e.config.quality.onChange(t);else{const n=Le.getSources.call(e).find((e=>Number(e.getAttribute("size"))===t));if(!n)return;const{currentTime:i,paused:r,preload:s,readyState:a,playbackRate:o}=e.media;e.media.src=n.getAttribute("src"),("none"!==s||a)&&(e.once("loadedmetadata",(()=>{e.speed=o,e.currentTime=i,r||ve(e.play())})),e.media.load())}me.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(Z(Le.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function Ae(e,...t){return G(e)?e:e.toString().replace(/{(\d+)}/g,((e,n)=>t[n].toString()))}const Re=(e="",t="",n="")=>e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),n.toString()),Ie=(e="")=>e.toString().replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()));function De(e){const t=document.createElement("div");return t.appendChild(e),t.innerHTML}const Pe={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},Me={get(e="",t={}){if(G(e)||G(t))return"";let n=j(t.i18n,e);if(G(n))return Object.keys(Pe).includes(e)?Pe[e]:"";const i={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(i).forEach((([e,t])=>{n=Re(n,e,t)})),n}};class Oe{constructor(t){e(this,"get",(e=>{if(!Oe.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(G(t))return null;const n=JSON.parse(t);return I(e)&&e.length?n[e]:n})),e(this,"set",(e=>{if(!Oe.supported||!this.enabled)return;if(!A(e))return;let t=this.get();G(t)&&(t={}),V(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch(e){}})),this.enabled=t.config.storage.enabled,this.key=t.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}function Ne(e,t="text"){return new Promise(((n,i)=>{try{const i=new XMLHttpRequest;if(!("withCredentials"in i))return;i.addEventListener("load",(()=>{if("text"===t)try{n(JSON.parse(i.responseText))}catch(e){n(i.responseText)}else n(i.response)})),i.addEventListener("error",(()=>{throw new Error(i.status)})),i.open("GET",e,!0),i.responseType=t,i.send()}catch(e){i(e)}}))}function Fe(e,t){if(!I(e))return;const n=I(t);let i=!1;const r=()=>null!==document.getElementById(t),s=(e,t)=>{e.innerHTML=t,n&&r()||document.body.insertAdjacentElement("afterbegin",e)};if(!n||!r()){const r=Oe.supported,a=document.createElement("div");if(a.setAttribute("hidden",""),n&&a.setAttribute("id",t),r){const e=window.localStorage.getItem(`cache-${t}`);if(i=null!==e,i){const t=JSON.parse(e);s(a,t.content)}}Ne(e).then((e=>{if(!G(e)){if(r)try{window.localStorage.setItem(`cache-${t}`,JSON.stringify({content:e}))}catch(e){}s(a,e)}})).catch((()=>{}))}}const Be=e=>Math.trunc(e/60/60%60,10);function Ue(e=0,t=!1,n=!1){if(!R(e))return Ue(void 0,t,n);const i=e=>`0${e}`.slice(-2);let r=Be(e);const s=(a=e,Math.trunc(a/60%60,10));var a;const o=(e=>Math.trunc(e%60,10))(e);return r=t||r>0?`${r}:`:"",`${n&&e>0?"-":""}${r}${i(s)}:${i(o)}`}const $e={getIconUrl(){const e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,n=e.host!==t||z.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:n}},findElements(){try{return this.elements.controls=ae.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:se.call(this,this.config.selectors.buttons.play),pause:ae.call(this,this.config.selectors.buttons.pause),restart:ae.call(this,this.config.selectors.buttons.restart),rewind:ae.call(this,this.config.selectors.buttons.rewind),fastForward:ae.call(this,this.config.selectors.buttons.fastForward),mute:ae.call(this,this.config.selectors.buttons.mute),pip:ae.call(this,this.config.selectors.buttons.pip),airplay:ae.call(this,this.config.selectors.buttons.airplay),settings:ae.call(this,this.config.selectors.buttons.settings),captions:ae.call(this,this.config.selectors.buttons.captions),fullscreen:ae.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=ae.call(this,this.config.selectors.progress),this.elements.inputs={seek:ae.call(this,this.config.selectors.inputs.seek),volume:ae.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:ae.call(this,this.config.selectors.display.buffer),currentTime:ae.call(this,this.config.selectors.display.currentTime),duration:ae.call(this,this.config.selectors.display.duration)},N(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){const n="http://www.w3.org/2000/svg",i=$e.getIconUrl.call(this),r=`${i.cors?"":i.url}#${this.config.iconPrefix}`,s=document.createElementNS(n,"svg");K(s,V(t,{"aria-hidden":"true",focusable:"false"}));const a=document.createElementNS(n,"use"),o=`${r}-${e}`;return"href"in a&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",o),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),s.appendChild(a),s},createLabel(e,t={}){const n=Me.get(e,this.config);return W("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},n)},createBadge(e){if(G(e))return null;const t=W("span",{class:this.config.classNames.menu.value});return t.appendChild(W("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){const n=V({},t);let i=function(e=""){let t=e.toString();return t=function(e=""){let t=e.toString();return t=Re(t,"-"," "),t=Re(t,"_"," "),t=Ie(t),Re(t," ","")}(t),t.charAt(0).toLowerCase()+t.slice(1)}(e);const r={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((e=>{Object.keys(n).includes(e)&&(r[e]=n[e],delete n[e])})),"button"!==r.element||Object.keys(n).includes("type")||(n.type="button"),Object.keys(n).includes("class")?n.class.split(" ").some((e=>e===this.config.classNames.control))||V(n,{class:`${n.class} ${this.config.classNames.control}`}):n.class=this.config.classNames.control,e){case"play":r.toggle=!0,r.label="play",r.labelPressed="pause",r.icon="play",r.iconPressed="pause";break;case"mute":r.toggle=!0,r.label="mute",r.labelPressed="unmute",r.icon="volume",r.iconPressed="muted";break;case"captions":r.toggle=!0,r.label="enableCaptions",r.labelPressed="disableCaptions",r.icon="captions-off",r.iconPressed="captions-on";break;case"fullscreen":r.toggle=!0,r.label="enterFullscreen",r.labelPressed="exitFullscreen",r.icon="enter-fullscreen",r.iconPressed="exit-fullscreen";break;case"play-large":n.class+=` ${this.config.classNames.control}--overlaid`,i="play",r.label="play",r.icon="play";break;default:G(r.label)&&(r.label=i),G(r.icon)&&(r.icon=e)}const s=W(r.element);return r.toggle?(s.appendChild($e.createIcon.call(this,r.iconPressed,{class:"icon--pressed"})),s.appendChild($e.createIcon.call(this,r.icon,{class:"icon--not-pressed"})),s.appendChild($e.createLabel.call(this,r.labelPressed,{class:"label--pressed"})),s.appendChild($e.createLabel.call(this,r.label,{class:"label--not-pressed"}))):(s.appendChild($e.createIcon.call(this,r.icon)),s.appendChild($e.createLabel.call(this,r.label))),V(n,ee(this.config.selectors.buttons[i],n)),K(s,n),"play"===i?(M(this.elements.buttons[i])||(this.elements.buttons[i]=[]),this.elements.buttons[i].push(s)):this.elements.buttons[i]=s,s},createRange(e,t){const n=W("input",V(ee(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":Me.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=n,$e.updateRangeFill.call(this,n),v.setup(n),n},createProgress(e,t){const n=W("progress",V(ee(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){n.appendChild(W("span",null,"0"));const t={played:"played",buffer:"buffered"}[e],i=t?Me.get(t,this.config):"";n.innerText=`% ${i.toLowerCase()}`}return this.elements.display[e]=n,n},createTime(e,t){const n=ee(this.config.selectors.display[e],t),i=W("div",V(n,{class:`${n.class?n.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":Me.get(e,this.config)}),"00:00");return this.elements.display[e]=i,i},bindMenuItemShortcuts(e,t){he.call(this,e,"keydown keyup",(n=>{if(!["Space","ArrowUp","ArrowDown","ArrowRight"].includes(n.key))return;if(n.preventDefault(),n.stopPropagation(),"keydown"===n.type)return;const i=re(e,'[role="menuitemradio"]');if(!i&&["Space","ArrowRight"].includes(n.key))$e.showMenuPanel.call(this,t,!0);else{let t;"Space"!==n.key&&("ArrowDown"===n.key||i&&"ArrowRight"===n.key?(t=e.nextElementSibling,N(t)||(t=e.parentNode.firstElementChild)):(t=e.previousElementSibling,N(t)||(t=e.parentNode.lastElementChild)),oe.call(this,t,!0))}}),!1),he.call(this,e,"keyup",(e=>{"Return"===e.key&&$e.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:e,list:t,type:n,title:i,badge:r=null,checked:s=!1}){const a=ee(this.config.selectors.inputs[n]),o=W("button",V(a,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${a.class?a.class:""}`.trim(),"aria-checked":s,value:e})),l=W("span");l.innerHTML=i,N(r)&&l.appendChild(r),o.appendChild(l),Object.defineProperty(o,"checked",{enumerable:!0,get:()=>"true"===o.getAttribute("aria-checked"),set(e){e&&Array.from(o.parentNode.children).filter((e=>re(e,'[role="menuitemradio"]'))).forEach((e=>e.setAttribute("aria-checked","false"))),o.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(o,"click keyup",(t=>{if(!B(t)||"Space"===t.key){switch(t.preventDefault(),t.stopPropagation(),o.checked=!0,n){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}$e.showMenuPanel.call(this,"home",B(t))}}),n,!1),$e.bindMenuItemShortcuts.call(this,o,n),t.appendChild(o)},formatTime(e=0,t=!1){return R(e)?Ue(e,Be(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,n=!1){N(e)&&R(t)&&(e.innerText=$e.formatTime(t,n))},updateVolume(){this.supported.ui&&(N(this.elements.inputs.volume)&&$e.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),N(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){N(e)&&(e.value=t,$e.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!F(e))return;let t=0;const n=(e,t)=>{const n=R(t)?t:0,i=N(e)?e:this.elements.display.buffer;if(N(i)){i.value=n;const e=i.getElementsByTagName("span")[0];N(e)&&(e.childNodes[0].nodeValue=n)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":i=this.currentTime,r=this.duration,t=0===i||0===r||Number.isNaN(i)||Number.isNaN(r)?0:(i/r*100).toFixed(2),"timeupdate"===e.type&&$e.setRange.call(this,this.elements.inputs.seek,t);break;case"playing":case"progress":n(this.elements.display.buffer,100*this.buffered)}var i,r},updateRangeFill(e){const t=F(e)?e.target:e;if(N(t)&&"range"===t.getAttribute("type")){if(re(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);const e=$e.formatTime(this.currentTime),n=$e.formatTime(this.duration),i=Me.get("seekLabel",this.config);t.setAttribute("aria-valuetext",i.replace("{currentTime}",e).replace("{duration}",n))}else if(re(t,this.config.selectors.inputs.volume)){const e=100*t.value;t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",`${e.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);z.isWebkit&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,n;if(!this.config.tooltips.seek||!N(this.elements.inputs.seek)||!N(this.elements.display.seekTooltip)||0===this.duration)return;const i=this.elements.display.seekTooltip,r=`${this.config.classNames.tooltip}--visible`,s=e=>ne(i,r,e);if(this.touch)return void s(!1);let a=0;const o=this.elements.progress.getBoundingClientRect();if(F(e))a=100/o.width*(e.pageX-o.left);else{if(!ie(i,r))return;a=parseFloat(i.style.left,10)}a<0?a=0:a>100&&(a=100);const l=this.duration/100*a;i.innerText=$e.formatTime(l);const c=null===(t=this.config.markers)||void 0===t||null===(n=t.points)||void 0===n?void 0:n.find((({time:e})=>e===Math.round(l)));c&&i.insertAdjacentHTML("afterbegin",`${c.label}<br>`),i.style.left=`${a}%`,F(e)&&["mouseenter","mouseleave"].includes(e.type)&&s("mouseenter"===e.type)},timeUpdate(e){const t=!N(this.elements.display.duration)&&this.config.invertTime;$e.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||$e.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return te(this.elements.display.currentTime,!0),void te(this.elements.progress,!0);N(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=N(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&$e.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&$e.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&$e.setMarkers.call(this),$e.updateSeekTooltip.call(this)},toggleMenuButton(e,t){te(this.elements.settings.buttons[e],!t)},updateSetting(e,t,n){const i=this.elements.settings.panels[e];let r=null,s=t;if("captions"===e)r=this.currentTrack;else{if(r=G(n)?this[e]:n,G(r)&&(r=this.config[e].default),!G(this.options[e])&&!this.options[e].includes(r))return void this.debug.warn(`Unsupported value of '${r}' for ${e}`);if(!this.config[e].options.includes(r))return void this.debug.warn(`Disabled value of '${r}' for ${e}`)}if(N(s)||(s=i&&i.querySelector('[role="menu"]')),!N(s))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=$e.getLabel.call(this,e,r);const a=s&&s.querySelector(`[value="${r}"]`);N(a)&&(a.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?Me.get("normal",this.config):`${t}&times;`;case"quality":if(R(t)){const e=Me.get(`qualityLabel.${t}`,this.config);return e.length?e:`${t}p`}return Ie(t);case"captions":return qe.getLabel.call(this);default:return null}},setQualityMenu(e){if(!N(this.elements.settings.panels.quality))return;const t="quality",n=this.elements.settings.panels.quality.querySelector('[role="menu"]');M(e)&&(this.options.quality=be(e).filter((e=>this.config.quality.options.includes(e))));const i=!G(this.options.quality)&&this.options.quality.length>1;if($e.toggleMenuButton.call(this,t,i),J(n),$e.checkMenu.call(this),!i)return;const r=e=>{const t=Me.get(`qualityBadge.${e}`,this.config);return t.length?$e.createBadge.call(this,t):null};this.options.quality.sort(((e,t)=>{const n=this.config.quality.options;return n.indexOf(e)>n.indexOf(t)?1:-1})).forEach((e=>{$e.createMenuItem.call(this,{value:e,list:n,type:t,title:$e.getLabel.call(this,"quality",e),badge:r(e)})})),$e.updateSetting.call(this,t,n)},setCaptionsMenu(){if(!N(this.elements.settings.panels.captions))return;const e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),n=qe.getTracks.call(this),i=Boolean(n.length);if($e.toggleMenuButton.call(this,e,i),J(t),$e.checkMenu.call(this),!i)return;const r=n.map(((e,n)=>({value:n,checked:this.captions.toggled&&this.currentTrack===n,title:qe.getLabel.call(this,e),badge:e.language&&$e.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"})));r.unshift({value:-1,checked:!this.captions.toggled,title:Me.get("disabled",this.config),list:t,type:"language"}),r.forEach($e.createMenuItem.bind(this)),$e.updateSetting.call(this,e,t)},setSpeedMenu(){if(!N(this.elements.settings.panels.speed))return;const e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((e=>e>=this.minimumSpeed&&e<=this.maximumSpeed));const n=!G(this.options.speed)&&this.options.speed.length>1;$e.toggleMenuButton.call(this,e,n),J(t),$e.checkMenu.call(this),n&&(this.options.speed.forEach((n=>{$e.createMenuItem.call(this,{value:n,list:t,type:e,title:$e.getLabel.call(this,"speed",n)})})),$e.updateSetting.call(this,e,t))},checkMenu(){const{buttons:e}=this.elements.settings,t=!G(e)&&Object.values(e).some((e=>!e.hidden));te(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let n=e;N(n)||(n=Object.values(this.elements.settings.panels).find((e=>!e.hidden)));const i=n.querySelector('[role^="menuitem"]');oe.call(this,i,t)},toggleMenu(e){const{popup:t}=this.elements.settings,n=this.elements.buttons.settings;if(!N(t)||!N(n))return;const{hidden:i}=t;let r=i;if(D(e))r=e;else if(B(e)&&"Escape"===e.key)r=!1;else if(F(e)){const i=P(e.composedPath)?e.composedPath()[0]:e.target,s=t.contains(i);if(s||!s&&e.target!==n&&r)return}n.setAttribute("aria-expanded",r),te(t,!r),ne(this.elements.container,this.config.classNames.menu.open,r),r&&B(e)?$e.focusFirstMenuItem.call(this,null,!0):r||i||oe.call(this,n,B(e))},getMenuSize(e){const t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const n=t.scrollWidth,i=t.scrollHeight;return Z(t),{width:n,height:i}},showMenuPanel(e="",t=!1){const n=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!N(n))return;const i=n.parentNode,r=Array.from(i.children).find((e=>!e.hidden));if(ce.transitions&&!ce.reducedMotion){i.style.width=`${r.scrollWidth}px`,i.style.height=`${r.scrollHeight}px`;const e=$e.getMenuSize.call(this,n),t=e=>{e.target===i&&["width","height"].includes(e.propertyName)&&(i.style.width="",i.style.height="",pe.call(this,i,H,t))};he.call(this,i,H,t),i.style.width=`${e.width}px`,i.style.height=`${e.height}px`}te(r,!0),te(n,!1),$e.focusFirstMenuItem.call(this,n,t)},setDownloadUrl(){const e=this.elements.buttons.download;N(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:t,createButton:n,createProgress:i,createRange:r,createTime:s,setQualityMenu:a,setSpeedMenu:o,showMenuPanel:l}=$e;this.elements.controls=null,M(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(n.call(this,"play-large"));const c=W("div",ee(this.config.selectors.controls.wrapper));this.elements.controls=c;const d={class:"plyr__controls__item"};return be(M(this.config.controls)?this.config.controls:[]).forEach((a=>{if("restart"===a&&c.appendChild(n.call(this,"restart",d)),"rewind"===a&&c.appendChild(n.call(this,"rewind",d)),"play"===a&&c.appendChild(n.call(this,"play",d)),"fast-forward"===a&&c.appendChild(n.call(this,"fast-forward",d)),"progress"===a){const t=W("div",{class:`${d.class} plyr__progress__container`}),n=W("div",ee(this.config.selectors.progress));if(n.appendChild(r.call(this,"seek",{id:`plyr-seek-${e.id}`})),n.appendChild(i.call(this,"buffer")),this.config.tooltips.seek){const e=W("span",{class:this.config.classNames.tooltip},"00:00");n.appendChild(e),this.elements.display.seekTooltip=e}this.elements.progress=n,t.appendChild(this.elements.progress),c.appendChild(t)}if("current-time"===a&&c.appendChild(s.call(this,"currentTime",d)),"duration"===a&&c.appendChild(s.call(this,"duration",d)),"mute"===a||"volume"===a){let{volume:t}=this.elements;if(N(t)&&c.contains(t)||(t=W("div",V({},d,{class:`${d.class} plyr__volume`.trim()})),this.elements.volume=t,c.appendChild(t)),"mute"===a&&t.appendChild(n.call(this,"mute")),"volume"===a&&!z.isIos){const n={max:1,step:.05,value:this.config.volume};t.appendChild(r.call(this,"volume",V(n,{id:`plyr-volume-${e.id}`})))}}if("captions"===a&&c.appendChild(n.call(this,"captions",d)),"settings"===a&&!G(this.config.settings)){const i=W("div",V({},d,{class:`${d.class} plyr__menu`.trim(),hidden:""}));i.appendChild(n.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const r=W("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),s=W("div"),a=W("div",{id:`plyr-settings-${e.id}-home`}),o=W("div",{role:"menu"});a.appendChild(o),s.appendChild(a),this.elements.settings.panels.home=a,this.config.settings.forEach((n=>{const i=W("button",V(ee(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,i,n),he.call(this,i,"click",(()=>{l.call(this,n,!1)}));const r=W("span",null,Me.get(n,this.config)),a=W("span",{class:this.config.classNames.menu.value});a.innerHTML=e[n],r.appendChild(a),i.appendChild(r),o.appendChild(i);const c=W("div",{id:`plyr-settings-${e.id}-${n}`,hidden:""}),d=W("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});d.appendChild(W("span",{"aria-hidden":!0},Me.get(n,this.config))),d.appendChild(W("span",{class:this.config.classNames.hidden},Me.get("menuBack",this.config))),he.call(this,c,"keydown",(e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))}),!1),he.call(this,d,"click",(()=>{l.call(this,"home",!1)})),c.appendChild(d),c.appendChild(W("div",{role:"menu"})),s.appendChild(c),this.elements.settings.buttons[n]=i,this.elements.settings.panels[n]=c})),r.appendChild(s),i.appendChild(r),c.appendChild(i),this.elements.settings.popup=r,this.elements.settings.menu=i}if("pip"===a&&ce.pip&&c.appendChild(n.call(this,"pip",d)),"airplay"===a&&ce.airplay&&c.appendChild(n.call(this,"airplay",d)),"download"===a){const e=V({},d,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(e.download="");const{download:t}=this.config.urls;!$(t)&&this.isEmbed&&V(e,{icon:`logo-${this.provider}`,label:this.provider}),c.appendChild(n.call(this,"download",e))}"fullscreen"===a&&c.appendChild(n.call(this,"fullscreen",d))})),this.isHTML5&&a.call(this,Le.getQualityOptions.call(this)),o.call(this),c},inject(){if(this.config.loadSprite){const e=$e.getIconUrl.call(this);e.cors&&Fe(e.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let e=null;this.elements.controls=null;const t={id:this.id,seektime:this.config.seekTime,title:this.config.title};let n,i=!0;if(P(this.config.controls)&&(this.config.controls=this.config.controls.call(this,t)),this.config.controls||(this.config.controls=[]),N(this.config.controls)||I(this.config.controls)?e=this.config.controls:(e=$e.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:qe.getLabel.call(this)}),i=!1),i&&I(this.config.controls)&&(e=(e=>{let n=e;return Object.entries(t).forEach((([e,t])=>{n=Re(n,`{${e}}`,t)})),n})(e)),I(this.config.selectors.controls.container)&&(n=document.querySelector(this.config.selectors.controls.container)),N(n)||(n=this.elements.container),n[N(e)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",e),N(this.elements.controls)||$e.findElements.call(this),!G(this.elements.buttons)){const e=e=>{const t=this.config.classNames.controlPressed;e.setAttribute("aria-pressed","false"),Object.defineProperty(e,"pressed",{configurable:!0,enumerable:!0,get:()=>ie(e,t),set(n=!1){ne(e,t,n),e.setAttribute("aria-pressed",n?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach((t=>{M(t)||O(t)?Array.from(t).filter(Boolean).forEach(e):e(t)}))}if(z.isEdge&&q(n),this.config.tooltips.controls){const{classNames:e,selectors:t}=this.config,n=`${t.controls.wrapper} ${t.labels} .${e.hidden}`,i=se.call(this,n);Array.from(i).forEach((e=>{ne(e,this.config.classNames.hidden,!1),ne(e,this.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t;if(!this.duration||this.elements.markers)return;const n=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter((({time:e})=>e>0&&e<this.duration));if(null==n||!n.length)return;const i=document.createDocumentFragment(),r=document.createDocumentFragment();let s=null;const a=`${this.config.classNames.tooltip}--visible`,o=e=>ne(s,a,e);n.forEach((e=>{const t=W("span",{class:this.config.classNames.marker},""),n=e.time/this.duration*100+"%";s&&(t.addEventListener("mouseenter",(()=>{e.label||(s.style.left=n,s.innerHTML=e.label,o(!0))})),t.addEventListener("mouseleave",(()=>{o(!1)}))),t.addEventListener("click",(()=>{this.currentTime=e.time})),t.style.left=n,r.appendChild(t)})),i.appendChild(r),this.config.tooltips.seek||(s=W("span",{class:this.config.classNames.tooltip},""),i.appendChild(s)),this.elements.markers={points:r,tip:s},this.elements.progress.appendChild(i)}};function Ge(e,t=!0){let n=e;if(t){const e=document.createElement("a");e.href=n,n=e.href}try{return new URL(n)}catch(e){return null}}function He(e){const t=new URLSearchParams;return A(e)&&Object.entries(e).forEach((([e,n])=>{t.set(e,n)})),t}const qe={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!ce.textTracks)return void(M(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&$e.setCaptionsMenu.call(this));var e,t;if(N(this.elements.captions)||(this.elements.captions=W("div",ee(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),e=this.elements.captions,t=this.elements.wrapper,N(e)&&N(t)&&t.parentNode.insertBefore(e,t.nextSibling)),z.isIE&&window.URL){const e=this.media.querySelectorAll("track");Array.from(e).forEach((e=>{const t=e.getAttribute("src"),n=Ge(t);null!==n&&n.hostname!==window.location.href.hostname&&["http:","https:"].includes(n.protocol)&&Ne(t,"blob").then((t=>{e.setAttribute("src",window.URL.createObjectURL(t))})).catch((()=>{Z(e)}))}))}const n=be((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((e=>e.split("-")[0])));let i=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===i&&([i]=n);let r=this.storage.get("captions");if(D(r)||({active:r}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:r,language:i,languages:n}),this.isHTML5){const e=this.config.captions.update?"addtrack removetrack":"removetrack";he.call(this,this.media.textTracks,e,qe.update.bind(this))}setTimeout(qe.update.bind(this),0)},update(){const e=qe.getTracks.call(this,!0),{active:t,language:n,meta:i,currentTrackNode:r}=this.captions,s=Boolean(e.find((e=>e.language===n)));this.isHTML5&&this.isVideo&&e.filter((e=>!i.get(e))).forEach((e=>{this.debug.log("Track added",e),i.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),he.call(this,e,"cuechange",(()=>qe.updateCues.call(this)))})),(s&&this.language!==n||!e.includes(r))&&(qe.setLanguage.call(this,n),qe.toggle.call(this,t&&s)),this.elements&&ne(this.elements.container,this.config.classNames.captions.enabled,!G(e)),M(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&$e.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;const{toggled:n}=this.captions,i=this.config.classNames.captions.active,r=L(e)?!n:e;if(r!==n){if(t||(this.captions.active=r,this.storage.set({captions:r})),!this.language&&r&&!t){const e=qe.getTracks.call(this),t=qe.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=t.language,void qe.set.call(this,e.indexOf(t))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=r),ne(this.elements.container,i,r),this.captions.toggled=r,$e.updateSetting.call(this,"captions"),me.call(this,this.media,r?"captionsenabled":"captionsdisabled")}setTimeout((()=>{r&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(e,t=!0){const n=qe.getTracks.call(this);if(-1!==e)if(R(e))if(e in n){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const i=n[e],{language:r}=i||{};this.captions.currentTrackNode=i,$e.updateSetting.call(this,"captions"),t||(this.captions.language=r,this.storage.set({language:r})),this.isVimeo&&this.embed.enableTextTrack(r),me.call(this,this.media,"languagechange")}qe.toggle.call(this,!0,t),this.isHTML5&&this.isVideo&&qe.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else qe.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!I(e))return void this.debug.warn("Invalid language argument",e);const n=e.toLowerCase();this.captions.language=n;const i=qe.getTracks.call(this),r=qe.findTrack.call(this,[n]);qe.set.call(this,i.indexOf(r),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter((t=>!this.isHTML5||e||this.captions.meta.has(t))).filter((e=>["captions","subtitles"].includes(e.kind)))},findTrack(e,t=!1){const n=qe.getTracks.call(this),i=e=>Number((this.captions.meta.get(e)||{}).default),r=Array.from(n).sort(((e,t)=>i(t)-i(e)));let s;return e.every((e=>(s=r.find((t=>t.language===e)),!s))),s||(t?r[0]:void 0)},getCurrentTrack(){return qe.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!U(t)&&ce.textTracks&&this.captions.toggled&&(t=qe.getCurrentTrack.call(this)),U(t)?G(t.label)?G(t.language)?Me.get("enabled",this.config):e.language.toUpperCase():t.label:Me.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!N(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!L(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){const e=qe.getCurrentTrack.call(this);t=Array.from((e||{}).activeCues||[]).map((e=>e.getCueAsHTML())).map(De)}const n=t.map((e=>e.trim())).join("\n");if(n!==this.elements.captions.innerHTML){J(this.elements.captions);const e=W("span",ee(this.config.selectors.caption));e.innerHTML=n,this.elements.captions.appendChild(e),me.call(this,this.media,"cuechange")}}},ze={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.3/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isIos:"plyr--is-ios",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},tabFocus:"plyr__tab-focus",previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},je="picture-in-picture",Ve={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Ye="video",Ke=()=>{};class We{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Ke}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Ke}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Ke}}class Xe{constructor(t){e(this,"onChange",(()=>{if(!this.enabled)return;const e=this.player.elements.buttons.fullscreen;N(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;me.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)})),e(this,"toggleFallback",((e=!1)=>{if(e?this.scrollPosition={x:window.scrollX||0,y:window.scrollY||0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",ne(this.target,this.player.config.classNames.fullscreen.fallback,e),z.isIos){let t=document.head.querySelector('meta[name="viewport"]');const n="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const i=I(t.content)&&t.content.includes(n);e?(this.cleanupViewport=!i,i||(t.content+=`,${n}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter((e=>e.trim()!==n)).join(","))}this.onChange()})),e(this,"trapFocus",(e=>{if(z.isIos||!this.active||"Tab"!==e.key)return;const t=document.activeElement,n=se.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[i]=n,r=n[n.length-1];t!==r||e.shiftKey?t===i&&e.shiftKey&&(r.focus(),e.preventDefault()):(i.focus(),e.preventDefault())})),e(this,"update",(()=>{if(this.enabled){let e;e=this.forceFallback?"Fallback (forced)":Xe.native?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");ne(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.enabled)})),e(this,"enter",(()=>{this.enabled&&(z.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Xe.native||this.forceFallback?this.toggleFallback(!0):this.prefix?G(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),e(this,"exit",(()=>{if(this.enabled)if(z.isIos&&this.player.config.fullscreen.iosNative)this.target.webkitExitFullscreen(),ve(this.player.play());else if(!Xe.native||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!G(this.prefix)){const e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),e(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=t,this.prefix=Xe.prefix,this.property=Xe.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===t.config.fullscreen.fallback,this.player.elements.fullscreen=t.config.fullscreen.container&&function(e,t){const{prototype:n}=Element;return(n.closest||function(){let e=this;do{if(re.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,t.config.fullscreen.container),he.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),he.call(this.player,this.player.elements.container,"dblclick",(e=>{N(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")})),he.call(this,this.player.elements.container,"keydown",(e=>this.trapFocus(e))),this.update()}static get native(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get usingNative(){return Xe.native&&!this.forceFallback}static get prefix(){if(P(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some((t=>!(!P(document[`${t}ExitFullscreen`])&&!P(document[`${t}CancelFullScreen`])||(e=t,0)))),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get enabled(){return(Xe.native||this.player.config.fullscreen.fallback)&&this.player.config.fullscreen.enabled&&this.player.supported.ui&&this.player.isVideo}get active(){if(!this.enabled)return!1;if(!Xe.native||this.forceFallback)return ie(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return z.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen||this.player.elements.container}}function Ze(e,t=1){return new Promise(((n,i)=>{const r=new Image,s=()=>{delete r.onload,delete r.onerror,(r.naturalWidth>=t?n:i)(r)};Object.assign(r,{onload:s,onerror:s,src:e})}))}const Je={addStyleHook(){ne(this.elements.container,this.config.selectors.container.replace(".",""),!0),ne(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void Je.toggleNativeControls.call(this,!0);N(this.elements.controls)||($e.inject.call(this),this.listeners.controls()),Je.toggleNativeControls.call(this),this.isHTML5&&qe.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,$e.updateVolume.call(this),$e.timeUpdate.call(this),$e.durationUpdate.call(this),Je.checkPlaying.call(this),ne(this.elements.container,this.config.classNames.pip.supported,ce.pip&&this.isHTML5&&this.isVideo),ne(this.elements.container,this.config.classNames.airplay.supported,ce.airplay&&this.isHTML5),ne(this.elements.container,this.config.classNames.isIos,z.isIos),ne(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{me.call(this,this.media,"ready")}),0),Je.setTitle.call(this),this.poster&&Je.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&$e.durationUpdate.call(this),this.config.mediaMetadata&&$e.setMediaMetadata.call(this)},setTitle(){let e=Me.get("play",this.config);if(I(this.config.title)&&!G(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((t=>{t.setAttribute("aria-label",e)})),this.isEmbed){const e=ae.call(this,"iframe");if(!N(e))return;const t=G(this.config.title)?"video":this.config.title,n=Me.get("frameTitle",this.config);e.setAttribute("title",n.replace("{title}",t))}},togglePoster(e){ne(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),ye.call(this).then((()=>Ze(e))).catch((t=>{throw e===this.poster&&Je.togglePoster.call(this,!1),t})).then((()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),Je.togglePoster.call(this,!0),e))))},checkPlaying(e){ne(this.elements.container,this.config.classNames.playing,this.playing),ne(this.elements.container,this.config.classNames.paused,this.paused),ne(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",Me.get(this.playing?"pause":"play",this.config))})),F(e)&&"timeupdate"===e.type||Je.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{ne(this.elements.container,this.config.classNames.loading,this.loading),Je.toggleControls.call(this)}),this.loading?250:0)},toggleControls(e){const{controls:t}=this.elements;if(t&&this.config.hideControls){const n=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||n))}},migrateStyles(){Object.values({...this.media.style}).filter((e=>!G(e)&&I(e)&&e.startsWith("--plyr"))).forEach((e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)})),G(this.media.style)&&this.media.removeAttribute("style")}};class Qe{constructor(t){e(this,"firstTouch",(()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,ne(t.container,e.config.classNames.isTouch,!0)})),e(this,"setTabFocus",(e=>{const{player:t}=this,{elements:n}=t,{key:i,type:r,timeStamp:s}=e;if(clearTimeout(this.focusTimer),"keydown"===r&&"Tab"!==i)return;"keydown"===r&&(this.lastKeyDown=s);const a=s-this.lastKeyDown<=20;("focus"!==r||a)&&((()=>{const e=t.config.classNames.tabFocus;ne(se.call(t,`.${e}`),e,!1)})(),"focusout"!==r&&(this.focusTimer=setTimeout((()=>{const e=document.activeElement;n.container.contains(e)&&ne(document.activeElement,t.config.classNames.tabFocus,!0)}),10)))})),e(this,"global",((e=!0)=>{const{player:t}=this;t.config.keyboard.global&&ue.call(t,window,"keydown keyup",this.handleKey,e,!1),ue.call(t,document.body,"click",this.toggleMenu,e),fe.call(t,document.body,"touchstart",this.firstTouch),ue.call(t,document.body,"keydown focus blur focusout",this.setTabFocus,e,!1,!0)})),e(this,"container",(()=>{const{player:e}=this,{config:t,elements:n,timers:i}=e;!t.keyboard.global&&t.keyboard.focused&&he.call(e,n.container,"keydown keyup",this.handleKey,!1),he.call(e,n.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(t=>{const{controls:r}=n;r&&"enterfullscreen"===t.type&&(r.pressed=!1,r.hover=!1);let s=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(Je.toggleControls.call(e,!0),s=e.touch?3e3:2e3),clearTimeout(i.controls),i.controls=setTimeout((()=>Je.toggleControls.call(e,!1)),s)}));const r=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const t=n.wrapper,{active:i}=e.fullscreen,[r,s]=xe.call(e),a=we(`aspect-ratio: ${r} / ${s}`);if(!i)return void(a?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));const[o,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],c=o/l>r/s;a?(t.style.width=c?"auto":"100%",t.style.height=c?"100%":"auto"):(t.style.maxWidth=c?l/s*r+"px":null,t.style.margin=c?"0 auto":null)},s=()=>{clearTimeout(i.resized),i.resized=setTimeout(r,50)};he.call(e,n.container,"enterfullscreen exitfullscreen",(t=>{const{target:i}=e.fullscreen;i===n.container&&(!e.isEmbed&&G(e.config.ratio)||(r(),("enterfullscreen"===t.type?he:pe).call(e,window,"resize",s)))}))})),e(this,"media",(()=>{const{player:e}=this,{elements:t}=e;if(he.call(e,e.media,"timeupdate seeking seeked",(t=>$e.timeUpdate.call(e,t))),he.call(e,e.media,"durationchange loadeddata loadedmetadata",(t=>$e.durationUpdate.call(e,t))),he.call(e,e.media,"ended",(()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),he.call(e,e.media,"progress playing seeking seeked",(t=>$e.updateProgress.call(e,t))),he.call(e,e.media,"volumechange",(t=>$e.updateVolume.call(e,t))),he.call(e,e.media,"playing play pause ended emptied timeupdate",(t=>Je.checkPlaying.call(e,t))),he.call(e,e.media,"waiting canplay seeked playing",(t=>Je.checkLoading.call(e,t))),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const n=ae.call(e,`.${e.config.classNames.video}`);if(!N(n))return;he.call(e,t.container,"click",(i=>{([t.container,n].includes(i.target)||n.contains(i.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(i,e.restart,"restart"),this.proxy(i,(()=>{ve(e.play())}),"play")):this.proxy(i,(()=>{ve(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&he.call(e,t.wrapper,"contextmenu",(e=>{e.preventDefault()}),!1),he.call(e,e.media,"volumechange",(()=>{e.storage.set({volume:e.volume,muted:e.muted})})),he.call(e,e.media,"ratechange",(()=>{$e.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),he.call(e,e.media,"qualitychange",(t=>{$e.updateSetting.call(e,"quality",null,t.detail.quality)})),he.call(e,e.media,"ready qualitychange",(()=>{$e.setDownloadUrl.call(e)}));const n=e.config.events.concat(["keyup","keydown"]).join(" ");he.call(e,e.media,n,(n=>{let{detail:i={}}=n;"error"===n.type&&(i=e.media.error),me.call(e,t.container,n.type,!0,i)}))})),e(this,"proxy",((e,t,n)=>{const{player:i}=this,r=i.config.listeners[n];let s=!0;P(r)&&(s=r.call(i,e)),!1!==s&&P(t)&&t.call(i,e)})),e(this,"bind",((e,t,n,i,r=!0)=>{const{player:s}=this,a=s.config.listeners[i],o=P(a);he.call(s,e,t,(e=>this.proxy(e,n,i)),r&&!o)})),e(this,"controls",(()=>{const{player:e}=this,{elements:t}=e,n=z.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((t=>{this.bind(t,"click",(()=>{ve(e.togglePlay())}),"play")})),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",(()=>{e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),this.bind(t.buttons.fastForward,"click",(()=>{e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),this.bind(t.buttons.mute,"click",(()=>{e.muted=!e.muted}),"mute"),this.bind(t.buttons.captions,"click",(()=>e.toggleCaptions())),this.bind(t.buttons.download,"click",(()=>{me.call(e,e.media,"download")}),"download"),this.bind(t.buttons.fullscreen,"click",(()=>{e.fullscreen.toggle()}),"fullscreen"),this.bind(t.buttons.pip,"click",(()=>{e.pip="toggle"}),"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",(t=>{t.stopPropagation(),t.preventDefault(),$e.toggleMenu.call(e,t)}),null,!1),this.bind(t.buttons.settings,"keyup",(t=>{["Space","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),$e.toggleMenu.call(e,t)):$e.focusFirstMenuItem.call(e,null,!0))}),null,!1),this.bind(t.settings.menu,"keydown",(t=>{"Escape"===t.key&&$e.toggleMenu.call(e,t)})),this.bind(t.inputs.seek,"mousedown mousemove",(e=>{const n=t.progress.getBoundingClientRect(),i=100/n.width*(e.pageX-n.left);e.currentTarget.setAttribute("seek-value",i)})),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(t=>{const n=t.currentTarget,i="play-on-seeked";if(B(t)&&!["ArrowLeft","ArrowRight"].includes(t.key))return;e.lastSeekTime=Date.now();const r=n.hasAttribute(i),s=["mouseup","touchend","keyup"].includes(t.type);r&&s?(n.removeAttribute(i),ve(e.play())):!s&&e.playing&&(n.setAttribute(i,""),e.pause())})),z.isIos){const t=se.call(e,'input[type="range"]');Array.from(t).forEach((e=>this.bind(e,n,(e=>q(e.target)))))}this.bind(t.inputs.seek,n,(t=>{const n=t.currentTarget;let i=n.getAttribute("seek-value");G(i)&&(i=n.value),n.removeAttribute("seek-value"),e.currentTime=i/n.max*e.duration}),"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",(t=>$e.updateSeekTooltip.call(e,t))),this.bind(t.progress,"mousemove touchmove",(t=>{const{previewThumbnails:n}=e;n&&n.loaded&&n.startMove(t)})),this.bind(t.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)})),this.bind(t.progress,"mousedown touchstart",(t=>{const{previewThumbnails:n}=e;n&&n.loaded&&n.startScrubbing(t)})),this.bind(t.progress,"mouseup touchend",(t=>{const{previewThumbnails:n}=e;n&&n.loaded&&n.endScrubbing(t)})),z.isWebkit&&Array.from(se.call(e,'input[type="range"]')).forEach((t=>{this.bind(t,"input",(t=>$e.updateRangeFill.call(e,t.target)))})),e.config.toggleInvert&&!N(t.display.duration)&&this.bind(t.display.currentTime,"click",(()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,$e.timeUpdate.call(e))})),this.bind(t.inputs.volume,n,(t=>{e.volume=t.target.value}),"volume"),this.bind(t.controls,"mouseenter mouseleave",(n=>{t.controls.hover=!e.touch&&"mouseenter"===n.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((e=>!e.contains(t.container))).forEach((n=>{this.bind(n,"mouseenter mouseleave",(n=>{t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===n.type)}))})),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),this.bind(t.controls,"focusin",(()=>{const{config:n,timers:i}=e;ne(t.controls,n.classNames.noTransition,!0),Je.toggleControls.call(e,!0),setTimeout((()=>{ne(t.controls,n.classNames.noTransition,!1)}),0);const r=this.touch?3e3:4e3;clearTimeout(i.controls),i.controls=setTimeout((()=>Je.toggleControls.call(e,!1)),r)})),this.bind(t.inputs.volume,"wheel",(t=>{const n=t.webkitDirectionInvertedFromDevice,[i,r]=[t.deltaX,-t.deltaY].map((e=>n?-e:e)),s=Math.sign(Math.abs(i)>Math.abs(r)?i:r);e.increaseVolume(s/50);const{volume:a}=e.media;(1===s&&a<1||-1===s&&a>0)&&t.preventDefault()}),"volume",!1)})),this.player=t,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.setTabFocus=this.setTabFocus.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:n}=t,{key:i,type:r,altKey:s,ctrlKey:a,metaKey:o,shiftKey:l}=e,c="keydown"===r,d=c&&i===this.lastKey;var u;if(!(s||a||o||l)&&i)if(c){const r=document.activeElement;if(N(r)){const{editable:i}=t.config.selectors,{seek:s}=n.inputs;if(r!==s&&re(r,i))return;if("Space"===e.key&&re(r,'button, [role^="menuitem"]'))return}switch(["Space","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(i)&&(e.preventDefault(),e.stopPropagation()),i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":d||(u=parseInt(i,10),t.currentTime=t.duration/10*u);break;case"Space":case"k":d||ve(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":d||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":d||t.toggleCaptions();break;case"l":t.loop=!t.loop}"Escape"===i&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=i}else this.lastKey=null}toggleMenu(e){$e.toggleMenu.call(this.player,e)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var et=function(e,t){return function(e,t){e.exports=function(){var e=function(){},t={},n={},i={};function r(e,t){e=e.push?e:[e];var r,s,a,o=[],l=e.length,c=l;for(r=function(e,n){n.length&&o.push(e),--c||t(o)};l--;)s=e[l],(a=n[s])?r(s,a):(i[s]=i[s]||[]).push(r)}function s(e,t){if(e){var r=i[e];if(n[e]=t,r)for(;r.length;)r[0](e,t),r.splice(0,1)}}function a(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function o(t,n,i,r){var s,a,l=document,c=i.async,d=(i.numRetries||0)+1,u=i.before||e,h=t.replace(/[\?|#].*$/,""),p=t.replace(/^(css|img)!/,"");r=r||0,/(^css!|\.css$)/.test(h)?((a=l.createElement("link")).rel="stylesheet",a.href=p,(s="hideFocus"in a)&&a.relList&&(s=0,a.rel="preload",a.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(a=l.createElement("img")).src=p:((a=l.createElement("script")).src=t,a.async=void 0===c||c),a.onload=a.onerror=a.onbeforeload=function(e){var l=e.type[0];if(s)try{a.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((r+=1)<d)return o(t,n,i,r)}else if("preload"==a.rel&&"style"==a.as)return a.rel="stylesheet";n(t,l,e.defaultPrevented)},!1!==u(t,a)&&l.head.appendChild(a)}function l(e,t,n){var i,r,s=(e=e.push?e:[e]).length,a=s,l=[];for(i=function(e,n,i){if("e"==n&&l.push(e),"b"==n){if(!i)return;l.push(e)}--s||t(l)},r=0;r<a;r++)o(e[r],i,n)}function c(e,n,i){var r,o;if(n&&n.trim&&(r=n),o=(r?i:n)||{},r){if(r in t)throw"LoadJS";t[r]=!0}function c(t,n){l(e,(function(e){a(o,e),t&&a({success:t,error:n},e),s(r,e)}),o)}if(o.returnPromise)return new Promise(c);c()}return c.ready=function(e,t){return r(e,(function(e){a(t,e)})),c},c.done=function(e){s(e,[])},c.reset=function(){t={},n={},i={}},c.isDefined=function(e){return e in t},c}()}(t={exports:{}}),t.exports}();function tt(e){return new Promise(((t,n)=>{et(e,{success:t,error:n})}))}function nt(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,me.call(this,this.media,e?"play":"pause"))}const it={setup(){const e=this;ne(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,ke.call(e),A(window.Vimeo)?it.ready.call(e):tt(e.config.urls.vimeo.sdk).then((()=>{it.ready.call(e)})).catch((t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)}))},ready(){const e=this,t=e.config.vimeo,{premium:n,referrerPolicy:i,...r}=t;let s=e.media.getAttribute("src"),a="";G(s)?(s=e.media.getAttribute(e.config.attributes.embed.id),a=e.media.getAttribute(e.config.attributes.embed.hash)):a=function(e){const t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(s);const o=a?{h:a}:{};n&&Object.assign(r,{controls:!1,sidedock:!1});const l=He({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:!this.config.fullscreen.iosNative,...o,...r}),c=G(d=s)?null:R(Number(d))?d:d.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:d;var d;const u=W("iframe"),h=Ae(e.config.urls.vimeo.iframe,c,l);if(u.setAttribute("src",h),u.setAttribute("allowfullscreen",""),u.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),G(i)||u.setAttribute("referrerPolicy",i),n||!t.customControls)u.setAttribute("data-poster",e.poster),e.media=Q(u,e.media);else{const t=W("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});t.appendChild(u),e.media=Q(t,e.media)}t.customControls||Ne(Ae(e.config.urls.vimeo.api,h)).then((t=>{!G(t)&&t.thumbnail_url&&Je.setPoster.call(e,t.thumbnail_url).catch((()=>{}))})),e.embed=new window.Vimeo.Player(u,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(nt.call(e,!0),e.embed.play()),e.media.pause=()=>(nt.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:p}=e.media;Object.defineProperty(e.media,"currentTime",{get:()=>p,set(t){const{embed:n,media:i,paused:r,volume:s}=e,a=r&&!n.hasPlayed;i.seeking=!0,me.call(e,i,"seeking"),Promise.resolve(a&&n.setVolume(0)).then((()=>n.setCurrentTime(t))).then((()=>a&&n.pause())).then((()=>a&&n.setVolume(s))).catch((()=>{}))}});let f=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get:()=>f,set(t){e.embed.setPlaybackRate(t).then((()=>{f=t,me.call(e,e.media,"ratechange")})).catch((()=>{e.options.speed=[1]}))}});let{volume:m}=e.config;Object.defineProperty(e.media,"volume",{get:()=>m,set(t){e.embed.setVolume(t).then((()=>{m=t,me.call(e,e.media,"volumechange")}))}});let{muted:g}=e.config;Object.defineProperty(e.media,"muted",{get:()=>g,set(t){const n=!!D(t)&&t;e.embed.setVolume(n?0:e.config.volume).then((()=>{g=n,me.call(e,e.media,"volumechange")}))}});let y,{loop:v}=e.config;Object.defineProperty(e.media,"loop",{get:()=>v,set(t){const n=D(t)?t:e.config.loop.active;e.embed.setLoop(n).then((()=>{v=n}))}}),e.embed.getVideoUrl().then((t=>{y=t,$e.setDownloadUrl.call(e)})).catch((e=>{this.debug.warn(e)})),Object.defineProperty(e.media,"currentSrc",{get:()=>y}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then((t=>{const[n,i]=t;e.embed.ratio=Ce(n,i),ke.call(this)})),e.embed.setAutopause(e.config.autopause).then((t=>{e.config.autopause=t})),e.embed.getVideoTitle().then((t=>{e.config.title=t,Je.setTitle.call(this)})),e.embed.getCurrentTime().then((t=>{p=t,me.call(e,e.media,"timeupdate")})),e.embed.getDuration().then((t=>{e.media.duration=t,me.call(e,e.media,"durationchange")})),e.embed.getTextTracks().then((t=>{e.media.textTracks=t,qe.setup.call(e)})),e.embed.on("cuechange",(({cues:t=[]})=>{const n=t.map((e=>function(e){const t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}(e.text)));qe.updateCues.call(e,n)})),e.embed.on("loaded",(()=>{e.embed.getPaused().then((t=>{nt.call(e,!t),t||me.call(e,e.media,"playing")})),N(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)})),e.embed.on("bufferstart",(()=>{me.call(e,e.media,"waiting")})),e.embed.on("bufferend",(()=>{me.call(e,e.media,"playing")})),e.embed.on("play",(()=>{nt.call(e,!0),me.call(e,e.media,"playing")})),e.embed.on("pause",(()=>{nt.call(e,!1)})),e.embed.on("timeupdate",(t=>{e.media.seeking=!1,p=t.seconds,me.call(e,e.media,"timeupdate")})),e.embed.on("progress",(t=>{e.media.buffered=t.percent,me.call(e,e.media,"progress"),1===parseInt(t.percent,10)&&me.call(e,e.media,"canplaythrough"),e.embed.getDuration().then((t=>{t!==e.media.duration&&(e.media.duration=t,me.call(e,e.media,"durationchange"))}))})),e.embed.on("seeked",(()=>{e.media.seeking=!1,me.call(e,e.media,"seeked")})),e.embed.on("ended",(()=>{e.media.paused=!0,me.call(e,e.media,"ended")})),e.embed.on("error",(t=>{e.media.error=t,me.call(e,e.media,"error")})),t.customControls&&setTimeout((()=>Je.build.call(e)),0)}};function rt(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,me.call(this,this.media,e?"play":"pause"))}function st(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const at={setup(){if(ne(this.elements.wrapper,this.config.classNames.embed,!0),A(window.YT)&&P(window.YT.Player))at.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{P(e)&&e(),at.ready.call(this)},tt(this.config.urls.youtube.sdk).catch((e=>{this.debug.warn("YouTube API failed to load",e)}))}},getTitle(e){Ne(Ae(this.config.urls.youtube.api,e)).then((e=>{if(A(e)){const{title:t,height:n,width:i}=e;this.config.title=t,Je.setTitle.call(this),this.embed.ratio=Ce(i,n)}ke.call(this)})).catch((()=>{ke.call(this)}))},ready(){const e=this,t=e.config.youtube,n=e.media&&e.media.getAttribute("id");if(!G(n)&&n.startsWith("youtube-"))return;let i=e.media.getAttribute("src");G(i)&&(i=e.media.getAttribute(this.config.attributes.embed.id));const r=G(s=i)?null:s.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:s;var s;const a=W("div",{id:`${e.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":t.customControls?e.poster:void 0});if(e.media=Q(a,e.media),t.customControls){const t=e=>`https://i.ytimg.com/vi/${r}/${e}default.jpg`;Ze(t("maxres"),121).catch((()=>Ze(t("sd"),121))).catch((()=>Ze(t("hq")))).then((t=>Je.setPoster.call(e,t.src))).then((t=>{t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}e.embed=new window.YT.Player(e.media,{videoId:r,host:st(t),playerVars:V({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.fullscreen.iosNative?0:1,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){const n=t.data,i={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[n]||"An unknown error occured";e.media.error={code:n,message:i},me.call(e,e.media,"error")}},onPlaybackRateChange(t){const n=t.target;e.media.playbackRate=n.getPlaybackRate(),me.call(e,e.media,"ratechange")},onReady(n){if(P(e.media.play))return;const i=n.target;at.getTitle.call(e,r),e.media.play=()=>{rt.call(e,!0),i.playVideo()},e.media.pause=()=>{rt.call(e,!1),i.pauseVideo()},e.media.stop=()=>{i.stopVideo()},e.media.duration=i.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:()=>Number(i.getCurrentTime()),set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,me.call(e,e.media,"seeking"),i.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:()=>i.getPlaybackRate(),set(e){i.setPlaybackRate(e)}});let{volume:s}=e.config;Object.defineProperty(e.media,"volume",{get:()=>s,set(t){s=t,i.setVolume(100*s),me.call(e,e.media,"volumechange")}});let{muted:a}=e.config;Object.defineProperty(e.media,"muted",{get:()=>a,set(t){const n=D(t)?t:a;a=n,i[n?"mute":"unMute"](),i.setVolume(100*s),me.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:()=>i.getVideoUrl()}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration});const o=i.getAvailablePlaybackRates();e.options.speed=o.filter((t=>e.config.speed.options.includes(t))),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),me.call(e,e.media,"timeupdate"),me.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((()=>{e.media.buffered=i.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&me.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),me.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((()=>Je.build.call(e)),50)},onStateChange(n){const i=n.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(n.data)&&(e.media.seeking=!1,me.call(e,e.media,"seeked")),n.data){case-1:me.call(e,e.media,"timeupdate"),e.media.buffered=i.getVideoLoadedFraction(),me.call(e,e.media,"progress");break;case 0:rt.call(e,!1),e.media.loop?(i.stopVideo(),i.playVideo()):me.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(rt.call(e,!0),me.call(e,e.media,"playing"),e.timers.playing=setInterval((()=>{me.call(e,e.media,"timeupdate")}),50),e.media.duration!==i.getDuration()&&(e.media.duration=i.getDuration(),me.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),rt.call(e,!1);break;case 3:me.call(e,e.media,"waiting")}me.call(e,e.elements.container,"statechange",!1,{code:n.data})}}})}},ot={setup(){this.media?(ne(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),ne(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&ne(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=W("div",{class:this.config.classNames.video}),Y(this.media,this.elements.wrapper),this.elements.poster=W("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?Le.setup.call(this):this.isYouTube?at.setup.call(this):this.isVimeo&&it.setup.call(this)):this.debug.warn("No media element found!")}};class lt{constructor(t){e(this,"load",(()=>{this.enabled&&(A(window.google)&&A(window.google.ima)?this.ready():tt(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),e(this,"ready",(()=>{var e;this.enabled||((e=this).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),e(this,"setupIMA",(()=>{this.elements.container=W("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>this.onAdsManagerLoaded(e)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e)),!1),this.requestAds()})),e(this,"requestAds",(()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}})),e(this,"pollCountdown",((e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const e=Ue(Math.max(this.manager.getRemainingTime(),0)),t=`${Me.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)}),100)})),e(this,"onAdsManagerLoaded",(e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e))),Object.keys(google.ima.AdEvent.Type).forEach((e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],(e=>this.onAdEvent(e)))})),this.trigger("loaded")})),e(this,"addCuePoints",(()=>{G(this.cuePoints)||this.cuePoints.forEach((e=>{if(0!==e&&-1!==e&&e<this.player.duration){const t=this.player.elements.progress;if(N(t)){const n=100/this.player.duration*e,i=W("span",{class:this.player.config.classNames.cues});i.style.left=`${n.toString()}%`,t.appendChild(i)}}}))})),e(this,"onAdEvent",(e=>{const{container:t}=this.player.elements,n=e.getAd(),i=e.getAdData();switch((e=>{me.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),n.isLinear()||(n.width=t.offsetWidth,n.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:i.adError&&this.player.debug.warn(`Non-fatal ad error: ${i.adError.getMessage()}`)}})),e(this,"onAdError",(e=>{this.cancel(),this.player.debug.warn("Ads error",e)})),e(this,"listeners",(()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{t=this.player.currentTime})),this.player.on("seeked",(()=>{const e=this.player.currentTime;G(this.cuePoints)||this.cuePoints.forEach(((n,i)=>{t<n&&n<e&&(this.manager.discardAdBreak(),this.cuePoints.splice(i,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)}))})),e(this,"play",(()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(e){this.onAdError(e)}})).catch((()=>{}))})),e(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,ve(this.player.media.play())})),e(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),e(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),e(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((e=>{this.on("loaded",e),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),e(this,"trigger",((e,...t)=>{const n=this.events[e];M(n)&&n.forEach((e=>{P(e)&&e.apply(this,t)}))})),e(this,"on",((e,t)=>(M(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this))),e(this,"startSafetyTimer",((e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),e)})),e(this,"clearSafetyTimer",(e=>{L(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=t,this.config=t.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((e,t)=>{this.on("loaded",e),this.on("error",t)})),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!G(e.publisherId)||$(e.tagUrl))}get tagUrl(){const{config:e}=this;return $(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${He({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}function ct(e=0,t=0,n=255){return Math.min(Math.max(e,t),n)}const dt=e=>{const t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((e=>{const n={};e.split(/\r\n|\n|\r/).forEach((e=>{if(R(n.startTime)){if(!G(e.trim())&&G(n.text)){const t=e.trim().split("#xywh=");[n.text]=t,t[1]&&([n.x,n.y,n.w,n.h]=t[1].split(","))}}else{const t=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);t&&(n.startTime=60*Number(t[1]||0)*60+60*Number(t[2])+Number(t[3])+Number(`0.${t[4]}`),n.endTime=60*Number(t[6]||0)*60+60*Number(t[7])+Number(t[8])+Number(`0.${t[9]}`))}})),n.text&&t.push(n)})),t},ut=(e,t)=>{const n={};return e>t.width/t.height?(n.width=t.width,n.height=1/e*t.width):(n.height=t.height,n.width=e*t.height),n};class ht{constructor(t){e(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.loaded=!0)}))})),e(this,"getThumbnails",(()=>new Promise((e=>{const{src:t}=this.player.config.previewThumbnails;if(G(t))throw new Error("Missing previewThumbnails.src config attribute");const n=()=>{this.thumbnails.sort(((e,t)=>e.height-t.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(P(t))t((e=>{this.thumbnails=e,n()}));else{const e=(I(t)?[t]:t).map((e=>this.getThumbnail(e)));Promise.all(e).then(n)}})))),e(this,"getThumbnail",(e=>new Promise((t=>{Ne(e).then((n=>{const i={frames:dt(n),height:null,urlPrefix:""};i.frames[0].text.startsWith("/")||i.frames[0].text.startsWith("http://")||i.frames[0].text.startsWith("https://")||(i.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const r=new Image;r.onload=()=>{i.height=r.naturalHeight,i.width=r.naturalWidth,this.thumbnails.push(i),t()},r.src=i.urlPrefix+i.frames[0].text}))})))),e(this,"startMove",(e=>{if(this.loaded&&F(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t,n;const i=this.player.elements.progress.getBoundingClientRect(),r=100/i.width*(e.pageX-i.left);this.seekTime=this.player.media.duration*(r/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=Ue(this.seekTime);const s=null===(t=this.player.config.markers)||void 0===t||null===(n=t.points)||void 0===n?void 0:n.find((({time:e})=>e===Math.round(this.seekTime)));s&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${s.label}<br>`)}this.showImageAtCurrentTime()}})),e(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),e(this,"startScrubbing",(e=>{(L(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),e(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):fe.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),e(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),e(this,"render",(()=>{this.elements.thumb.container=W("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=W("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=W("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=W("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),N(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=W("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),e(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),e(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex((e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime)),t=e>=0;let n=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach(((t,i)=>{this.loadedImages.includes(t.frames[e].text)&&(n=i)})),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(n)))})),e(this,"loadImage",((e=0)=>{const t=this.showingThumb,n=this.thumbnails[e],{urlPrefix:i}=n,r=n.frames[t],s=n.frames[t].text,a=i+s;if(this.currentImageElement&&this.currentImageElement.dataset.filename===s)this.showImage(this.currentImageElement,r,e,t,s,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const n=new Image;n.src=a,n.dataset.index=t,n.dataset.filename=s,this.showingThumbFilename=s,this.player.debug.log(`Loading image: ${a}`),n.onload=()=>this.showImage(n,r,e,t,s,!0),this.loadingImage=n,this.removeOldImages(n)}})),e(this,"showImage",((e,t,n,i,r,s=!0)=>{this.player.debug.log(`Showing thumb: ${r}. num: ${i}. qual: ${n}. newimg: ${s}`),this.setImageSizeAndOffset(e,t),s&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(r)||this.loadedImages.push(r)),this.preloadNearby(i,!0).then(this.preloadNearby(i,!1)).then(this.getHigherQuality(n,e,t,r))})),e(this,"removeOldImages",(e=>{Array.from(this.currentImageContainer.children).forEach((t=>{if("img"!==t.tagName.toLowerCase())return;const n=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:e}=this;setTimeout((()=>{e.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)}),n)}}))})),e(this,"preloadNearby",((e,t=!0)=>new Promise((n=>{setTimeout((()=>{const i=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===i){let r;r=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let s=!1;r.forEach((e=>{const t=e.text;if(t!==i&&!this.loadedImages.includes(t)){s=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);const{urlPrefix:e}=this.thumbnails[0],i=e+t,r=new Image;r.src=i,r.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),n()}}})),s||n()}}),300)})))),e(this,"getHigherQuality",((e,t,n,i)=>{if(e<this.thumbnails.length-1){let r=t.naturalHeight;this.usingSprites&&(r=n.h),r<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===i&&(this.player.debug.log(`Showing higher quality thumb for: ${i}`),this.loadImage(e+1))}),300)}})),e(this,"toggleThumbContainer",((e=!1,t=!1)=>{const n=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(n,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"toggleScrubbingContainer",((e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),e(this,"setThumbContainerSizeAndPos",(()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){const t=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${t}px`}}else{const t=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${t}px`}this.setThumbContainerPos()})),e(this,"setThumbContainerPos",(()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:n}=this.elements.thumb,i=t.left-e.left+10,r=t.right-e.left-n.clientWidth-10,s=this.mousePosX-e.left-n.clientWidth/2,a=ct(s,i,r);n.style.left=`${a}px`,n.style.setProperty("--preview-arrow-offset",s-a+"px")})),e(this,"setScrubbingContainerSize",(()=>{const{width:e,height:t}=ut(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`})),e(this,"setImageSizeAndOffset",((e,t)=>{if(!this.usingSprites)return;const n=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*n+"px",e.style.width=e.naturalWidth*n+"px",e.style.left=`-${t.x*n}px`,e.style.top=`-${t.y*n}px`})),this.player=t,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=ut(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const pt={insertElements(e,t){I(t)?X(e,this.media,{src:t}):M(t)&&t.forEach((t=>{X(e,this.media,t)}))},change(e){j(e,"sources.length")?(Le.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],Z(this.media),this.media=null,N(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:t,type:n}=e,[{provider:i=Ve.html5,src:r}]=t,s="html5"===i?n:"div",a="html5"===i?{}:{src:r};Object.assign(this,{provider:i,type:n,supported:ce.check(n,i,this.config.playsinline),media:W(s,a)}),this.elements.container.appendChild(this.media),D(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),G(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Je.addStyleHook.call(this),this.isHTML5&&pt.insertElements.call(this,"source",t),this.config.title=e.title,ot.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&pt.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Je.build.call(this),this.isHTML5&&this.media.load(),G(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new ht(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class ft{constructor(t,n){if(e(this,"play",(()=>P(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>ve(this.media.play()))),this.media.play()):null)),e(this,"pause",(()=>this.playing&&P(this.media.pause)?this.media.pause():null)),e(this,"togglePlay",(e=>(D(e)?e:!this.playing)?this.play():this.pause())),e(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):P(this.media.stop)&&this.media.stop()})),e(this,"restart",(()=>{this.currentTime=0})),e(this,"rewind",(e=>{this.currentTime-=R(e)?e:this.config.seekTime})),e(this,"forward",(e=>{this.currentTime+=R(e)?e:this.config.seekTime})),e(this,"increaseVolume",(e=>{const t=this.media.muted?0:this.volume;this.volume=t+(R(e)?e:0)})),e(this,"decreaseVolume",(e=>{this.increaseVolume(-e)})),e(this,"airplay",(()=>{ce.airplay&&this.media.webkitShowPlaybackTargetPicker()})),e(this,"toggleControls",(e=>{if(this.supported.ui&&!this.isAudio){const t=ie(this.elements.container,this.config.classNames.hideControls),n=void 0===e?void 0:!e,i=ne(this.elements.container,this.config.classNames.hideControls,n);if(i&&M(this.config.controls)&&this.config.controls.includes("settings")&&!G(this.config.settings)&&$e.toggleMenu.call(this,!1),i!==t){const e=i?"controlshidden":"controlsshown";me.call(this,this.media,e)}return!i}return!1})),e(this,"on",((e,t)=>{he.call(this,this.elements.container,e,t)})),e(this,"once",((e,t)=>{fe.call(this,this.elements.container,e,t)})),e(this,"off",((e,t)=>{pe(this.elements.container,e,t)})),e(this,"destroy",((e,t=!1)=>{if(!this.ready)return;const n=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(Z(this.elements.buttons.play),Z(this.elements.captions),Z(this.elements.controls),Z(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),P(e)&&e()):(ge.call(this),Le.cancelRequests.call(this),Q(this.elements.original,this.elements.container),me.call(this,this.elements.original,"destroyed",!0),P(e)&&e.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Je.toggleNativeControls.call(this,!0),n()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&P(this.embed.destroy)&&this.embed.destroy(),n()):this.isVimeo&&(null!==this.embed&&this.embed.unload().then(n),setTimeout(n,200))})),e(this,"supports",(e=>ce.mime.call(this,e))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=ce.touch,this.media=t,I(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||O(this.media)||M(this.media))&&(this.media=this.media[0]),this.config=V({},ze,ft.defaults,n||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new We(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",ce),L(this.media)||!N(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!ce.check().api)return void this.debug.error("Setup failed: no support");const i=this.media.cloneNode(!0);i.autoplay=!1,this.elements.original=i;const r=this.media.tagName.toLowerCase();let s=null,a=null;switch(r){case"div":if(s=this.media.querySelector("iframe"),N(s)){if(a=Ge(s.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Ve.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Ve.vimeo:null}(a.toString()),this.elements.container=this.media,this.media=s,this.elements.container.className="",a.search.length){const e=["1","true"];e.includes(a.searchParams.get("autoplay"))&&(this.config.autoplay=!0),e.includes(a.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=e.includes(a.searchParams.get("playsinline")),this.config.youtube.hl=a.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(G(this.provider)||!Object.values(Ve).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Ye;break;case"video":case"audio":this.type=r,this.provider=Ve.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=ce.check(this.type,this.provider,this.config.playsinline),this.supported.api?(this.eventListeners=[],this.listeners=new Qe(this),this.storage=new Oe(this),this.media.plyr=this,N(this.elements.container)||(this.elements.container=W("div",{tabindex:0}),Y(this.media,this.elements.container)),Je.migrateStyles.call(this),Je.addStyleHook.call(this),ot.setup.call(this),this.config.debug&&he.call(this,this.elements.container,this.config.events.join(" "),(e=>{this.debug.log(`event: ${e.type}`)})),this.fullscreen=new Xe(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Je.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new lt(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>ve(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new ht(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Ve.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===Ve.youtube}get isVimeo(){return this.provider===Ve.vimeo}get isVideo(){return this.type===Ye}get isAudio(){return"audio"===this.type}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;const t=R(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return R(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const e=parseFloat(this.config.duration),t=(this.media||{}).duration,n=R(t)&&t!==1/0?t:0;return e||n}set volume(e){let t=e;I(t)&&(t=Number(t)),R(t)||(t=this.storage.get("volume")),R(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!G(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;D(t)||(t=this.storage.get("muted")),D(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;R(e)&&(t=e),R(t)||(t=this.storage.get("speed")),R(t)||(t=this.config.speed.selected);const{minimumSpeed:n,maximumSpeed:i}=this;t=ct(t,n,i),this.config.speed.selected=t,setTimeout((()=>{this.media&&(this.media.playbackRate=t)}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,n=this.options.quality;if(!n.length)return;let i=[!G(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(R),r=!0;if(!n.includes(i)){const e=_e(n,i);this.debug.warn(`Unsupported quality option: ${i}, using ${e} instead`),i=e,r=!1}t.selected=i,this.media.quality=i,r&&this.storage.set({quality:i})}get quality(){return this.media.quality}set loop(e){const t=D(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){pt.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return $(e)?e:this.source}set download(e){$(e)&&(this.config.urls.download=e,$e.setDownloadUrl.call(this))}set poster(e){this.isVideo?Je.setPoster.call(this,e,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=Se(xe.call(this));return M(e)?e.join(":"):e}set ratio(e){this.isVideo?I(e)&&Te(e)?(this.config.ratio=Se(e),ke.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){this.config.autoplay=D(e)?e:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){qe.toggle.call(this,e,!1)}set currentTrack(e){qe.set.call(this,e,!1),qe.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){qe.setLanguage.call(this,e,!1)}get language(){return(qe.getCurrentTrack.call(this)||{}).language}set pip(e){if(!ce.pip)return;const t=D(e)?e:!this.pip;P(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?je:"inline"),P(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return ce.pip?G(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===je:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new ht(this))}static supported(e,t,n){return ce.check(e,t,n)}static loadSprite(e,t){return Fe(e,t)}static setup(e,t={}){let n=null;return I(e)?n=Array.from(document.querySelectorAll(e)):O(e)?n=Array.from(e):M(e)&&(n=e.filter(N)),G(n)?null:n.map((e=>new ft(e,t)))}}var mt;return ft.defaults=(mt=ze,JSON.parse(JSON.stringify(mt))),ft}())},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var s={},a=[],o=0;o<e.length;o++){var l=e[o],c=i.base?l[0]+i.base:l[0],d=s[c]||0,u="".concat(c," ").concat(d);s[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=r(p,i);i.byIndex=o,t.splice(o,0,{identifier:u,updater:f,references:1})}a.push(u)}return a}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=i(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var o=n(s[a]);t[o].references--}for(var l=i(e,r),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},740:(e,t,n)=>{var i={"./en.json":700,"./es.json":980,"./pt.json":193};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id=740},700:e=>{"use strict";e.exports=JSON.parse('{"aboutPanda":"About Panda Video","aboutPandaLink":"https://pandavideo.com?utm_source=player&utm_campaign=rightclick","abstract":"E-Book","activateSound":"ACTIVATE SOUND","advertisement":"Advertisement","all":"All","buffered":"Stored in the buffer","cancel":"Cancel","captionPreview":"This is a preview of the caption setup","captions":"Subtitles","chapters":"Chapters","copy_button":"Copy","currentTime":"Current time","disableCaptions":"Disable Subtitles","disabled":"Disabled","download":"Transfer","download_button":"Download","drmPreload":"Setting up video security","duration":"Duration","enableCaptions":"Turn on subtitles","enabled":"Enabled","end":"End","enterFullscreen":"Enter fullscreen mode","exitFullscreen":"Exit full screen mode","fastForward":"Forward {seektime}s","frameTitle":"Reader for {title}","keepWatching":"Continue watching","panda_assist":{"sugestionsTitle":"QUESTION SUGGESTIONS:","generalError":"Chat is not available.","generalErorOpenChat":"Try opening it again in a few moments","resumeContent":"Resume content","importantTopics":"Important topics","chatWarning":"The chat is generated by artificial intelligence and may contain errors. Verify the information.","typeHere":"Type here...","waitAMoment":"Wait a moment...","source":"Source","watchVideo":"Watch video","copy":"Copy","copied":"Copied","excerptVideoTitle":"EXCERPT OF THE ANSWER"},"live_chat":{"removedMessage":"This message has been removed","you":"You","registerModal":{"title":"Join chat","actionBtn":"Join chat","namePlaceholder":"Name"}},"liveFinished":"LIVE FINISHED","loop":"Repeat","menuBack":"Back to previous menu","mindmap":"Mind Map","mute":"No sound","normal":"Normal","pause":"Pause","pip":"PIP","play":"Play","played":"Reproduced","quality":"Quality","qualityBadge":{"480":"SD","576":"SD","720":"HD","1080":"HD","1440":"HD","2160":"4K"},"questions":"Questions","reportModalAction1":"Submit","reportModalAction2":"Cancel","reportModalField":"Describe your problem...","reportModalOption1":"Video does not load even with a good internet connection.","reportModalOption2":"The video content does not match the description.","reportModalOption3":"The video is low quality or pixelated.","reportModalOption4":"Other","reportModalText1":"Please wait a moment, your feedback","reportModalText2":"is being sent.","reportModalText3":"Thanks for helping us improve!","reportModalTitle":"Report error","reset":"Reset","reset_button":"reset","restart":"Restart","rewind":"Rewind {seektime}s","seek":"Search","seekLabel":"{currentTime} of {duration}","settings":"Settings","smart_search_placeholder":"Search in the caption","speed":"Speed","start":"Start","trialWarning":"Panda Video trial mode.<br>Start billing to remove this message.","unmute":"With sound","volume":"Volume","waitingForLive":"WAITING FOR LIVE STREAM","watermark_question":"Enter your access key","watchOfflineModal":{"clickHere":"click here","learnMore":"Learn more","title":"Download video","subtitle":"Watch the video offline<br>and in the background","paragraph":"Point your phone\'s camera to download the video<br>on the Panda Video app.","paragraphMobile":"Click the button below to download the video in the Panda Video app.","btnText":"Download video in the app"},"videoNotFound":"Video not found","viewHotKeys":"View hotkeys","playPause":"Play/Pause","seekBackward":"Seek Backward","seekForward":"Seek Forward","increaseVolume":"Increase volume","decreaseVolume":"Decrease volume","muteVolume":"Mute","increaseSpeed":"Increase speed","decreaseSpeed":"Decrease speed","spaceOrK":"Space or K","upArrow":"Up arrow","downArrow":"Down arrow","leftArrow":"Left arrow","rightArrow":"Right arrow","shiftPeriod":"Shift + .","shiftComma":"Shift + ,"}')},980:e=>{"use strict";e.exports=JSON.parse('{"aboutPanda":"Acerca del Panda Video","aboutPandaLink":"https://pandavideo.com?utm_source=player&utm_campaign=rightclick","abstract":"E-Book","activateSound":"ACTIVAR SONIDO","advertisement":"Anuncio","all":"Todos","buffered":"Almacenado en el buffer","cancel":"Cancelar","captionPreview":"Esta es una previsualizacin de la configuracin de subttulos","captions":"Subttulos","chapters":"Captulos","copy_button":"Copiar","currentTime":"Hora actual","disableCaptions":"Deshabilitar Subttulos","disabled":"Deshabilitado","download":"Transferir","download_button":"Download","drmPreload":"Preparando video seguridad","duration":"Duracin","enableCaptions":"Activar subttulos","enabled":"Habilitado","end":"Fin","enterFullscreen":"Entrar en modo de pantalla completa","exitFullscreen":"Salir del modo de pantalla completa","fastForward":"Adelante {seektime}s","frameTitle":"Lector de {title}","keepWatching":"Continuar viendo","panda_assist":{"sugestionsTitle":"SUGERENCIAS DE PREGUNTA:","generalError":"Ups! Algo sali mal con el chat","generalErorOpenChat":"Intenta abrirlo nuevamente en unos instantes","resumeContent":"Resumir contenido","importantTopics":"Temas importantes","chatWarning":"El chat es generado por inteligencia artificial y puede contener errores. Verifique la informacin.","typeHere":"Escribe aqu...","waitAMoment":"Espere un momento...","source":"Fuente","watchVideo":"Ver video","copy":"Copiar","copied":"Copiado","excerptVideoTitle":"FRAGMENTO DE LA RESPUESTA"},"live_chat":{"removedMessage":"Este mensaje ha sido eliminado","you":"Tu","registerModal":{"title":"Participa en la charla","actionBtn":"Entrar al chat","namePlaceholder":"Nombre"}},"liveFinished":"LIVE TERMINADO","loop":"Repetir","menuBack":"Volver al men anterior","mindmap":"Mapa Mental","mute":"Sin sonido","normal":"Normal","pause":"Pausa","pip":"PIP","play":"Tocar","played":"Reproducido","quality":"Calidad","qualityBadge":{"480":"SD","576":"SD","720":"HD","1080":"HD","1440":"HD","2160":"4K"},"questions":"Preguntas","reportModalAction1":"Enviar","reportModalAction2":"Cancelar","reportModalField":"Describe tu problema...","reportModalOption1":"El video no carga, incluso con una buena conexin a Internet.","reportModalOption2":"El contenido del vdeo no coincide con la descripcin.","reportModalOption3":"El video es de baja calidad o est pixelado.","reportModalOption4":"Otro","reportModalText1":"Espera un momento, tus comentarios","reportModalText2":"se est enviando.","reportModalText3":"Gracias por ayudarnos a mejorar!","reportModalTitle":"Informe de error","reset":"Reiniciar","reset_button":"restablecer","restart":"Reiniciar","rewind":"Rebobinar {seektime}s","seek":"Buscar","seekLabel":"{currentTime} de {duration}","settings":"Configuraciones","smart_search_placeholder":"Buscar en el subttulo","speed":"Velocidad","start":"Inicio","trialWarning":"Modo de prueba de video de Panda.<br>Comience la facturacin para eliminar este mensaje.","unmute":"Con sonido","volume":"Volumen","waitingForLive":"ESPERANDO TRANSMISIN EN VIVO","watermark_question":"Ingrese su clave de acceso","watchOfflineModal":{"clickHere":"clic aqu","learnMore":"Infrmate ms","title":"Descargar video","subtitle":"Reproduce el video offline<br>y en segundo plano","paragraph":"Apunta la cmara de tu celular para descargar el video<br>en la aplicacin Panda Video.","paragraphMobile":"Haz clic en el botn de abajo para descargar el video en la aplicacin Panda Video.","btnText":"Descargar video en la app"},"videoNotFound":"Video no encontrado","viewHotKeys":"Ver atajos de teclado","playPause":"Reproducir/Pausar","seekBackward":"Retroceder","seekForward":"Avanzar","increaseVolume":"Aumentar volumen","decreaseVolume":"Disminuir volumen","muteVolume":"Mudo","increaseSpeed":"Aumentar velocidad","decreaseSpeed":"Disminuir velocidad","spaceOrK":"Espacio o K","upArrow":"Flecha arriba","downArrow":"Flecha abajo","leftArrow":"Flecha izquierda","rightArrow":"Flecha derecha","shiftPeriod":"Shift + .","shiftComma":"Shift + ,"}')},193:e=>{"use strict";e.exports=JSON.parse('{"aboutPanda":"Sobre a Panda Video","aboutPandaLink":"https://pandavideo.com.br?utm_source=player&utm_campaign=rightclick","abstract":"E-Book","activateSound":"ATIVAR SOM","advertisement":"Anncio","all":"Tudo","buffered":"Armazenado na memria buffer","cancel":"Cancelar","captionPreview":"Esta  uma pr-visualizao da configurao de legenda","captions":"Legendas","chapters":"Captulos","copy_button":"Copiar","currentTime":"Tempo atual","disableCaptions":"Desativar legendas","disabled":"Desativado","download":"Transferir","download_button":"Download","drmPreload":"Preparando segurana do vdeo","duration":"Durao","enableCaptions":"Ativar legendas","enabled":"Ativado","end":"Fim","enterFullscreen":"Entrar no modo tela cheia (fullscreen)","exitFullscreen":"Sair do modo tela cheia (fullscreen)","fastForward":"Avanar {seektime}s","frameTitle":"Leitor para {title}","keepWatching":"Continuar assistindo","panda_assist":{"sugestionsTitle":"SUGESTES DE PERGUNTA:","generalError":"Ops! Algo deu errado com o chat","generalErorOpenChat":"Tente abri-lo novamente em instantes","resumeContent":"Resumir contedo","importantTopics":"Tpicos importantes","chatWarning":"O chat  gerado por inteligncia artificial e pode ter erros. Verifique as informaes.","typeHere":"Digite aqui...","waitAMoment":"Aguarde um instante...","source":"Fonte","watchVideo":"Assistir vdeo","copy":"Copiar","copied":"Copiado","excerptVideoTitle":"TRECHO DA RESPOSTA"},"live_chat":{"removedMessage":"Esta mensagem foi removida","you":"Voc","registerModal":{"title":"Participe do chat","actionBtn":"Entrar no chat","namePlaceholder":"Nome"}},"liveFinished":"LIVE FINALIZADA","loop":"Repetir","menuBack":"Voltar ao menu anterior","mindmap":"Mapa Mental","mute":"Sem som","normal":"Normal","pause":"Pausar","pip":"PIP","play":"Reproduzir","played":"Reproduzido","quality":"Qualidade","qualityBadge":{"480":"SD","576":"SD","720":"HD","1080":"HD","1440":"HD","2160":"4K"},"questions":"Perguntas","reportModalAction1":"Enviar","reportModalAction2":"Cancelar","reportModalField":"Descreva seu problema...","reportModalOption1":"O vdeo no carrega, mesmo com boa conexo de internet.","reportModalOption2":"O contedo do vdeo no corresponde com a descrio.","reportModalOption3":"O vdeo est em baixa qualidade ou pixelado.","reportModalOption4":"Outro","reportModalText1":"Aguarde um momento, seu feedback","reportModalText2":"est sendo enviado.","reportModalText3":"Obrigado por nos ajudar a melhorar!","reportModalTitle":"Reportar erro","reset":"Repor","reset_button":"resetar","restart":"Reiniciar","rewind":"Recuar {seektime}s","seek":"Procurar","seekLabel":"{currentTime} de {duration}","settings":"Definies","smart_search_placeholder":"Buscar na legenda","speed":"Velocidade","start":"Incio","trialWarning":"Panda Video perodo de teste.<br>Inicie o plano para remover esta mensagem.","unmute":"Com som","volume":"Volume","waitingForLive":"AGUARDANDO LIVE STREAM","watermark_question":"Digite sua chave de acesso","watchOfflineModal":{"clickHere":"clique aqui","learnMore":"Saiba mais","title":"Baixar vdeo","subtitle":"Assista ao vdeo offline<br>e em segundo plano","paragraph":"Aponte a cmera do celular para baixar o vdeo<br>no aplicativo Panda Video.","paragraphMobile":"Clique no boto abaixo para baixar o vdeo no aplicativo Panda Video.","btnText":"Baixar vdeo no app"},"videoNotFound":"Vdeo no encontrado","viewHotKeys":"Ver atalhos de teclado","playPause":"Reproduzir/Pausar","seekBackward":"Retroceder","seekForward":"Avanar","increaseVolume":"Aumentar volume","decreaseVolume":"Diminuir volume","muteVolume":"Mudo","increaseSpeed":"Aumentar velocidade","decreaseSpeed":"Diminuir velocidade","spaceOrK":"Espao ou K","upArrow":"Seta para cima","downArrow":"Seta para baixo","leftArrow":"Seta para a esquerda","rightArrow":"Seta para a direita","shiftPeriod":"Shift + .","shiftComma":"Shift + ,"}')}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{"use strict";var e=n(379),t=n.n(e),i=n(795),r=n.n(i),s=n(569),a=n.n(s),o=n(565),l=n.n(o),c=n(216),d=n.n(c),u=n(589),h=n.n(u),p=n(376),f={};f.styleTagTransform=h(),f.setAttributes=l(),f.insert=a().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=d(),t()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals;var m=n(485),g={};g.styleTagTransform=h(),g.setAttributes=l(),g.insert=a().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=d(),t()(m.Z,g),m.Z&&m.Z.locals&&m.Z.locals;var y=n(615),v={};function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,T(i.key),i)}}function E(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=b(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:String(t)}v.styleTagTransform=h(),v.setAttributes=l(),v.insert=a().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=d(),t()(y.Z,v),y.Z&&y.Z.locals&&y.Z.locals;var S=2147483647,x=function(){function e(t,n,i){_(this,e),this.mouse_over_progressbar=!1,this.title_jumped=!1,this.sections=[],this.moments=[],this.el_pbar=document.querySelector(n),this.el_body=document.querySelector(t),this.el_body.style.pointerEvents="none",this.video_length=i.videoLength,this.ev_config=i,this.c_width=this.el_body.clientWidth-1,this.createElements(),this.startResizeMonitoring()}return E(e,[{key:"updateLengthForLiveStream",value:function(e){this.video_length=e,this.resizeSections()}},{key:"reloadChapters",value:function(){for(;this.el_root.firstChild;)this.el_root.removeChild(this.el_root.firstChild);if(this.sections=[],null==this.ev_config.chapters||0==this.ev_config.chapters.length){var e=new L(this,0,S,"",!1);this.sections.push(e),this.el_root.appendChild(e.GetElement())}else{var t=0;this.ev_config.chapters.sort(k.compare);for(var n=0;n<this.ev_config.chapters.length;n++){var i=this.ev_config.chapters[n];i.start>t&&(e=new L(this,t,i.start,"",!1),this.sections.push(e),this.el_root.appendChild(e.GetElement())),i.start<t&&(i.start=t),e=new L(this,i.start,i.end,i.title,!0),this.sections.push(e),this.el_root.appendChild(e.GetElement()),t=i.end}}}},{key:"createElements",value:function(){this.el_base=document.createElement("div"),this.el_base.className="sp__base",this.el_root=document.createElement("ul"),this.el_root.className="sp__progressbar",this.el_title=document.createElement("div"),this.el_title.className="sp__title",this.el_title.textContent="test",this.el_base.appendChild(this.el_root),this.el_base.appendChild(this.el_title),this.el_body.appendChild(this.el_base),this.reloadChapters();for(var e=0;e<this.ev_config.moments.length;e++){var t=this.ev_config.moments[e],n=new C(this,t.timestamp,t.title);this.el_base.appendChild(n.GetElement()),this.moments.push(n),n.Reposition()}var i=this;function r(e){var t=e.touches[0]||e.changedTouches[0],n=e.target.parentNode.getBoundingClientRect();i.mouse_x=t.pageX-n.left+6,i.mouse_y=t.pageY-n.top,i.mouse_over_progressbar=!0,i.el_root.classList.contains("hover")||i.el_root.classList.add("hover");var r=i.getCurrentMouseSecnds();i.DetectHoverMoments(r),i.moment_active||i.DetectHoverSection(r),i.updateSections("mark",r),i.CallThumbnailJumpDownEvent(),i.CallThumbnailJumpUpEvent(),null==i.c_highlightedSection||i.moment_active||i.PositionTitleAndIndicator(r);var s=document.querySelector(".plyr__preview-thumb"),a=document.querySelector(".plyr__preview-thumb__time-container span");if(s.classList.contains("plyr__tooltip--drag")||s.classList.add("plyr__tooltip--drag"),a.textContent=i.secondsToTimeString(r),null!=i.ev_config.onScrubbingChange&&i.ev_config.onScrubbingChange(i.getCurrentMouseSecnds(),i.SecondsToPixels(i.getCurrentMouseSecnds())),"touchend"===e.type){i.mouse_over_progressbar=!1,i.updateSections("mark",0);for(var o=0;o<i.sections.length;o++)i.sections[o].section_interactive&&(i.sections[o].HideTitle(),i.sections[o].SetInactive());s.classList.remove("plyr__tooltip--drag"),a.textContent=i.secondsToTimeString(i.c_progress),null!=i.ev_config.onScrubbingChange&&i.ev_config.onScrubbingChange(i.getCurrentMouseSecnds(),i.SecondsToPixels(i.getCurrentMouseSecnds()))}}this.el_pbar.addEventListener("mousemove",(function(e){var t=i.el_pbar.parentNode.getBoundingClientRect();i.mouse_x=e.clientX-t.left+6,i.mouse_y=e.clientY-t.top,i.mouse_over_progressbar=!0,i.el_root.classList.contains("hover")||i.el_root.classList.add("hover"),i.el_title.classList.remove("animated");var n=i.getCurrentMouseSecnds();i.DetectHoverMoments(n),i.moment_active||i.DetectHoverSection(n),i.updateSections("mark",n),i.CallThumbnailJumpDownEvent(),i.CallThumbnailJumpUpEvent(),null==i.c_highlightedSection||i.moment_active||i.PositionTitleAndIndicator(n)})),this.el_pbar.addEventListener("mouseleave",(function(e){i.el_title.classList.contains("animated")||i.el_title.classList.add("animated"),i.mouse_over_progressbar=!1,i.DetectHoverMoments(-1e4),i.el_root.classList.remove("hover"),i.updateSections("mark",0),i.c_timeoutEvent=void 0,clearInterval(i.c_timeout)})),this.el_pbar.addEventListener("touchmove",r.bind(this)),this.el_pbar.addEventListener("touchstart",r.bind(this)),this.el_pbar.addEventListener("touchend",r.bind(this))}},{key:"IsMobile",value:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}},{key:"SetDuration",value:function(e){this.video_length=e,this.resizeSections()}},{key:"SecondsToPixels",value:function(e){return this.c_width/this.video_length*e}},{key:"PixelsToSeconds",value:function(e){return e/(this.c_width/this.video_length)}},{key:"SetCurrentProgress",value:function(e){this.updateSections("progress",e),this.c_progress=e,this.mouse_over_progressbar||this.moment_active||(this.moment_active||this.DetectHoverSection(e),null!=this.c_highlightedSection&&this.PositionTitleAndIndicator(this.c_highlightedSection.section_start+(this.c_highlightedSection.section_end-this.c_highlightedSection.section_start)/2))}},{key:"SetBufferProgress",value:function(e){this.updateSections("buffer",e)}},{key:"DetectHoverSection",value:function(e){if(!this.moment_active){for(var t=null,n=0;n<this.sections.length;n++)this.sections[n].section_interactive&&(this.sections[n].section_start<=e&&this.sections[n].section_end>e?t=this.sections[n]:(this.sections[n].HideTitle(),this.sections[n].SetInactive()));if(null!=t)return t.ShowTitle(),t.SetActive(),this.c_highlightedSection=t,!0;this.c_highlightedSection=null}return!1}},{key:"DetectHoverMoments",value:function(e){for(var t=null,n=0;n<this.moments.length;n++){var i=this.PixelsToSeconds(12);this.moments[n].moment_timestamp-i<e&&this.moments[n].moment_timestamp+i>e?t=this.moments[n]:this.moments[n].RemoveHover()}return null!=t?(t.ShowTitle(),this.c_highlightedMoment=t,!0):(null!=this.c_highlightedMoment&&this.c_highlightedMoment.HideTitle(),this.c_highlightedSection=null,!1)}},{key:"PositionTitleAndIndicator",value:function(e){var t=Math.max(this.SecondsToPixels(e)-this.el_title.clientWidth/2,0);t=Math.min(t,this.el_root.clientWidth-this.el_title.clientWidth),this.el_title.style.left=t+"px"}},{key:"updateSections",value:function(e,t){for(var n=0;n<this.sections.length;n++)this.sections[n].SetMark(e,t)}},{key:"resizeSections",value:function(){for(var e=0;e<this.sections.length;e++)this.sections[e].Resize();for(e=0;e<this.moments.length;e++)this.moments[e].Reposition()}},{key:"secondsToTimeString",value:function(e){var t=Math.floor(e/60),n=Math.floor(e%60);t<0&&(t=0),n<0&&(n=0);var i=t.toString(),r=n.toString();return i.length<2&&(i="0"+i),r.length<2&&(r="0"+r),i+":"+r}},{key:"getCurrentMouseSecnds",value:function(){return this.mouse_x/(this.c_width/this.video_length)}},{key:"startResizeMonitoring",value:function(){var e=this;setInterval((function(){var t=e.c_width;e.c_width=e.el_body.clientWidth-1,e.c_width!=t&&e.resizeSections()}),100)}},{key:"CallThumbnailJumpUpEvent",value:function(e){void 0===e&&(e=!1),this.title_jumped||!this.moment_active&&!this.IsThumbnailInTitleHitBox()||(document.querySelector(".plyr__preview-thumb").style.bottom="45px")}},{key:"CallThumbnailJumpDownEvent",value:function(e){void 0===e&&(e=!1),!this.title_jumped||this.IsThumbnailInTitleHitBox()||this.moment_active||(document.querySelector(".plyr__preview-thumb").style.bottom="22px")}},{key:"IsThumbnailInTitleHitBox",value:function(){if(this.moment_active)return this.title_jumped=!0,!0;var e=this.el_title.getBoundingClientRect().left,t=this.el_title.classList.contains("active");if(e<-50||!t)return this.title_jumped=!1,!1;var n=document.querySelector(".plyr__preview-thumb").getBoundingClientRect(),i=this.el_title.getBoundingClientRect();return i.left+i.width<n.left?(this.title_jumped=!1,!1):n.left+n.width>i.left?(this.title_jumped=!0,!0):(this.title_jumped=!1,!1)}}]),e}(),k=function(){function e(){_(this,e)}return E(e,null,[{key:"compare",value:function(e,t){return e.start-t.start}}]),e}(),C=function(){function e(t,n,i){_(this,e),this.pb=t,this.el_body=document.createElement("div"),this.el_body.className="sp__moment",this.moment_timestamp=n,this.moment_title=i,this.Reposition()}return E(e,[{key:"Reposition",value:function(){this.el_body.style.left="".concat(this.pb.SecondsToPixels(this.moment_timestamp)-6,"px")}},{key:"GetElement",value:function(){return this.el_body}},{key:"ShowTitle",value:function(){this.el_body.classList.contains("hover")||this.el_body.classList.add("hover"),this.pb.PositionTitleAndIndicator(this.moment_timestamp),this.pb.moment_active||(this.pb.moment_active=!0,""!=this.moment_title&&this.pb.CallThumbnailJumpUpEvent(),this.pb.el_title.classList.add("active")),this.pb.el_title.textContent=this.moment_title}},{key:"HideTitle",value:function(){if(this.pb.moment_active){this.RemoveHover(),this.pb.PositionTitleAndIndicator(this.moment_timestamp);for(var e=0;e<this.pb.sections.length;e++)this.pb.sections[e].section_interactive&&this.pb.sections[e].SetInactive();this.pb.moment_active=!1,this.pb.DetectHoverSection(this.moment_timestamp)?this.pb.el_title.textContent=this.pb.c_highlightedSection.section_title:(this.pb.el_title.textContent="",this.pb.el_title.classList.remove("active"),""!=this.moment_title&&(this.pb.title_jumped=!0,this.pb.CallThumbnailJumpDownEvent(!0)))}}},{key:"RemoveHover",value:function(){this.el_body.classList.remove("hover")}}]),e}(),L=function(){function e(t,n,i,r,s){_(this,e),this.bars={},this.pb=t,this.section_start=n,this.section_end=i,this.section_interactive=s,this.section_title=r,this.el_body=document.createElement("li"),s&&this.el_body.classList.add("interactive"),this.el_container=document.createElement("div"),this.el_container.className="sp__container",this.el_bg=document.createElement("div"),this.el_bg.className="sp__bg",this.el_body.append(this.el_container),this.el_container.append(this.el_bg);var a=new A(this,1,"#ffffff88");this.bars.mark=a,this.el_container.append(a.GetElement());var o=new A(this,2,"#ffffff50");this.bars.buffer=o,this.el_container.append(o.GetElement());var l=new A(this,3,"var(--plyr-color-main)");this.bars.progress=l,this.el_container.append(l.GetElement()),this.Resize()}return E(e,[{key:"SetInactive",value:function(){this.el_body.classList.remove("active")}},{key:"SetActive",value:function(){this.el_body.classList.contains("active")||this.el_body.classList.add("active")}},{key:"HideTitle",value:function(){this.c_titleShown&&(this.pb.el_title.textContent="",this.pb.el_title.classList.remove("active"),""!=this.section_title&&this.pb.CallThumbnailJumpDownEvent()),this.c_titleShown=!1}},{key:"ShowTitle",value:function(){this.c_titleShown||(this.section_interactive&&!this.pb.el_title.classList.contains("active")&&(this.pb.el_title.classList.add("active"),""!=this.section_title&&this.pb.CallThumbnailJumpUpEvent()),this.pb.el_title.textContent=this.section_interactive?this.section_title:"",this.c_titleShown=!0)}},{key:"Resize",value:function(){var e=this.section_end==S?this.pb.video_length:this.section_end,t=this.pb.SecondsToPixels(e-this.section_start);for(var n in this.el_body.style.width="".concat(t,"px"),this.c_width=t,this.bars)this.bars[n].Measure()}},{key:"SetMark",value:function(e,t){this.bars[e].SetMark(t)}},{key:"GetElement",value:function(){return this.el_body}}]),e}(),A=function(){function e(t,n,i){_(this,e),this.section=t,this.c_zindex=n,this.c_color=i,this.el_body=document.createElement("div"),this.el_body.className="sp__section",this.el_body.style.backgroundColor=this.c_color,this.el_body.style.zIndex=this.c_zindex,this.el_body.style.width="0",this.Measure()}return E(e,[{key:"SetMark",value:function(e){if(e<=this.section.section_start)this.el_body.style.width="0";else{var t=this.section.pb.SecondsToPixels(this.section.section_start),n=this.section.pb.SecondsToPixels(e)-t;this.el_body.style.width="".concat(Math.min(n,this.c_width),"px")}}},{key:"Measure",value:function(){var e=this.section.section_end==S?this.section.pb.video_length:this.section.section_end;this.c_width=this.section.pb.SecondsToPixels(e-this.section.section_start)}},{key:"GetElement",value:function(){return this.el_body}}]),e}();function R(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var I,D,P,M,O,N={exports:{}};I=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,D=/^(?=([^\/?#]*))\1([^]*)$/,P=/(?:\/|^)\.(?=\/)/g,M=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,O={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var i=O.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=O.normalizePath(i.path),O.buildURLFromParts(i)}var r=O.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return n.alwaysNormalize?(r.path=O.normalizePath(r.path),O.buildURLFromParts(r)):t;var s=O.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var a=D.exec(s.path);s.netLoc=a[1],s.path=a[2]}s.netLoc&&!s.path&&(s.path="/");var o={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){var l=s.path,c=l.substring(0,l.lastIndexOf("/")+1)+r.path;o.path=O.normalizePath(c)}else o.path=s.path,r.params||(o.params=s.params,r.query||(o.query=s.query));return null===o.path&&(o.path=n.alwaysNormalize?O.normalizePath(r.path):r.path),O.buildURLFromParts(o)},parseURL:function(e){var t=I.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(P,"");e.length!==(e=e.replace(M,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},N.exports=O;var F=N.exports;function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n){return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var i}function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},G.apply(this,arguments)}const H=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},q=Number.isSafeInteger||function(e){return"number"==typeof e&&Math.abs(e)<=z},z=Number.MAX_SAFE_INTEGER||9007199254740991;let j=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e}({}),V=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),Y=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({});const K=function(){},W={trace:K,debug:K,log:K,warn:K,info:K,error:K};let X=W;const Z=X,J=/^(\d+)x(\d+)$/,Q=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ee{constructor(e){"string"==typeof e&&(e=ee.parseAttrList(e)),G(this,e)}get clientAttrs(){return Object.keys(this).filter((e=>"X-"===e.substring(0,2)))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=J.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={};for(Q.lastIndex=0;null!==(t=Q.exec(e));){let e=t[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1)),n[t[1].trim()]=e}return n}}function te(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class ne{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){Z.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=G(new ee({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);H(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(H(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&H(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class ie{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var re="audio",se="video",ae="audiovideo";class oe{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[re]:null,[se]:null,[ae]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let i;i=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=F.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class le extends oe{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new ie,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!H(this.programDateTime))return null;const e=H(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r,s=!1){const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:s}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[re]=null,e[se]=null,e[ae]=null}}class ce extends oe{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new ie,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class de{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&H(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function ue(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function he(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(e=>e.charCodeAt(0)))}const pe="undefined"!=typeof self?self:void 0;var fe={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},me="org.w3.clearkey",ge="com.apple.streamingkeydelivery",ye="com.microsoft.playready",ve="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function be(e){switch(e){case ge:return fe.FAIRPLAY;case ye:return fe.PLAYREADY;case ve:return fe.WIDEVINE;case me:return fe.CLEARKEY}}var _e="edef8ba979d64acea3c827dcd51d21ed";function we(e){return e===_e?fe.WIDEVINE:"9a04f07998404286ab92e65be0885f95"===e?fe.PLAYREADY:"1077efecc0b24d02ace33c1e52e2fb4b"===e||"e2719d58a985b3c9781ab030af78d30e"===e?fe.CLEARKEY:void 0}function Ee(e){switch(e){case fe.FAIRPLAY:return ge;case fe.PLAYREADY:return ye;case fe.WIDEVINE:return ve;case fe.CLEARKEY:return me}}function Te(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[fe.FAIRPLAY,fe.WIDEVINE,fe.PLAYREADY,fe.CLEARKEY].filter((e=>!!t[e])):[];return!i[fe.WIDEVINE]&&n&&i.push(fe.WIDEVINE),i}const Se=null!=pe&&null!=(xe=pe.navigator)&&xe.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var xe;function ke(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}const Ce=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,Le=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,Ae=(e,t)=>{const n=t;let i=0;for(;Ce(e,t);)i+=10,i+=Re(e,t+6),Le(e,t+10)&&(i+=10),t+=i;if(i>0)return e.subarray(n,n+i)},Re=(e,t)=>{let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n},Ie=(e,t)=>Ce(e,t)&&Re(e,t+6)+10<=e.length-t,De=e=>{const t=Oe(e);for(let e=0;e<t.length;e++){const n=t[e];if(Pe(n))return $e(n)}},Pe=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,Me=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=Re(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},Oe=e=>{let t=0;const n=[];for(;Ce(e,t);){const i=Re(e,t+6);t+=10;const r=t+i;for(;t+8<r;){const i=Me(e.subarray(t)),r=Ne(i);r&&n.push(r),t+=i.size+10}Le(e,t)&&(t+=10)}return n},Ne=e=>"PRIV"===e.type?Fe(e):"W"===e.type[0]?Ue(e):Be(e),Fe=e=>{if(e.size<2)return;const t=Ge(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}},Be=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=Ge(e.data.subarray(t),!0);t+=n.length+1;const i=Ge(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Ge(e.data.subarray(1));return{key:e.type,data:t}},Ue=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=Ge(e.data.subarray(t),!0);t+=n.length+1;const i=Ge(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Ge(e.data);return{key:e.type,data:t}},$e=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}},Ge=(e,t=!1)=>{const n=qe();if(n){const i=n.decode(e);if(t){const e=i.indexOf("\0");return-1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}const i=e.length;let r,s,a,o="",l=0;for(;l<i;){if(r=e[l++],0===r&&t)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:s=e[l++],o+=String.fromCharCode((31&r)<<6|63&s);break;case 14:s=e[l++],a=e[l++],o+=String.fromCharCode((15&r)<<12|(63&s)<<6|(63&a)<<0)}}return o};let He;function qe(){if(!navigator.userAgent.includes("PlayStation 4"))return He||void 0===self.TextDecoder||(He=new self.TextDecoder("utf-8")),He}const ze=function(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t},je=Math.pow(2,32)-1,Ve=[].push,Ye={video:1,audio:2,id3:3,text:4};function Ke(e){return String.fromCharCode.apply(null,e)}function We(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function Xe(e,t){const n=Je(e,t);return n<0?4294967296+n:n}function Ze(e,t){let n=Xe(e,t);return n*=Math.pow(2,32),n+=Xe(e,t+4),n}function Je(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function Qe(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function et(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const s=Xe(e,r),a=s>1?r+s:i;if(Ke(e.subarray(r+4,r+8))===t[0])if(1===t.length)n.push(e.subarray(r+8,a));else{const i=et(e.subarray(r+8,a),t.slice(1));i.length&&Ve.apply(n,i)}r=a}return n}function tt(e){const t=[],n=e[0];let i=8;const r=Xe(e,i);i+=4;let s=0,a=0;0===n?(s=Xe(e,i),a=Xe(e,i+4),i+=8):(s=Ze(e,i),a=Ze(e,i+8),i+=16),i+=2;let o=e.length+a;const l=We(e,i);i+=2;for(let n=0;n<l;n++){let n=i;const s=Xe(e,n);n+=4;const a=2147483647&s;if(1==(2147483648&s)>>>31)return Z.warn("SIDX has hierarchical references (not supported)"),null;const l=Xe(e,n);n+=4,t.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,n+=4,i=n}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:l,references:t}}function nt(e){const t=[],n=et(e,["moov","trak"]);for(let e=0;e<n.length;e++){const i=n[e],r=et(i,["tkhd"])[0];if(r){let e=r[0];const n=Xe(r,0===e?12:20),s=et(i,["mdia","mdhd"])[0];if(s){e=s[0];const r=Xe(s,0===e?12:20),a=et(i,["mdia","hdlr"])[0];if(a){const e=Ke(a.subarray(8,12)),s={soun:re,vide:se}[e];if(s){const e=it(et(i,["mdia","minf","stbl","stsd"])[0]);t[n]={timescale:r,type:s},t[s]=U({timescale:r,id:n},e)}}}}}return et(e,["moov","mvex","trex"]).forEach((e=>{const n=Xe(e,4),i=t[n];i&&(i.default={duration:Xe(e,12),flags:Xe(e,20)})})),t}function it(e){const t=e.subarray(8),n=t.subarray(86),i=Ke(t.subarray(4,8));let r=i;const s="enca"===i||"encv"===i;if(s){const e=et(t,[i])[0];et(e.subarray("enca"===i?28:78),["sinf"]).forEach((e=>{const t=et(e,["schm"])[0];if(t){const n=Ke(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=et(e,["frma"])[0];t&&(r=Ke(t))}}}))}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const e=et(n,["avcC"])[0];r+="."+st(e[1])+st(e[2])+st(e[3]);break}case"mp4a":{const e=et(t,[i])[0],n=et(e.subarray(28),["esds"])[0];if(n&&n.length>12){let e=4;if(3!==n[e++])break;e=rt(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=rt(n,e);const i=n[e++];if(64!==i)break;if(r+="."+st(i),e+=12,5!==n[e++])break;e=rt(n,e);const s=n[e++];let a=(248&s)>>3;31===a&&(a+=1+((7&s)<<3)+((224&n[e])>>5)),r+="."+a}break}case"hvc1":case"hev1":{const e=et(n,["hvcC"])[0],t=e[1],i=["","A","B","C"][t>>6],s=31&t,a=Xe(e,2),o=(32&t)>>5?"H":"L",l=e[12],c=e.subarray(6,12);r+="."+i+s,r+="."+a.toString(16).toUpperCase(),r+="."+o+l;let d="";for(let e=c.length;e--;){const t=c[e];(t||d)&&(d="."+t.toString(16).toUpperCase()+d)}r+=d;break}case"dvh1":case"dvhe":{const e=et(n,["dvcC"])[0],t=e[2]>>1&127,i=e[2]<<5&32|e[3]>>3&31;r+="."+at(t)+"."+at(i);break}case"vp09":{const e=et(n,["vpcC"])[0],t=e[4],i=e[5],s=e[6]>>4&15;r+="."+at(t)+"."+at(i)+"."+at(s);break}case"av01":{const e=et(n,["av1C"])[0],t=e[1]>>>5,i=31&e[1],s=e[2]>>>7?"H":"M",a=(64&e[2])>>6,o=(32&e[2])>>5,l=2===t&&a?o?12:10:a?10:8,c=(16&e[2])>>4,d=(8&e[2])>>3,u=(4&e[2])>>2,h=3&e[2],p=1,f=1,m=1,g=0;r+="."+t+"."+at(i)+s+"."+at(l)+"."+c+"."+d+u+h+"."+at(p)+"."+at(f)+"."+at(m)+"."+g;break}}return{codec:r,encrypted:s}}function rt(e,t){const n=t+5;for(;128&e[t++]&&t<n;);return t}function st(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function at(e){return(e<10?"0":"")+e}function ot(e){const t=et(e,["schm"])[0];if(t){const n=Ke(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return et(e,["schi","tenc"])[0]}return null}function lt(e){const t=Xe(e,0);let n=8;1&t&&(n+=4),4&t&&(n+=4);let i=0;const r=Xe(e,4);for(let s=0;s<r;s++)256&t&&(i+=Xe(e,n),n+=4),512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4);return i}function ct(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function dt(e,t){const n=[],i=t.samples,r=t.timescale,s=t.id;let a=!1;return et(i,["moof"]).map((o=>{const l=o.byteOffset-8;et(o,["traf"]).map((o=>{const c=et(o,["tfdt"]).map((e=>{const t=e[0];let n=Xe(e,4);return 1===t&&(n*=Math.pow(2,32),n+=Xe(e,8)),n/r}))[0];return void 0!==c&&(e=c),et(o,["tfhd"]).map((c=>{const d=Xe(c,4),u=16777215&Xe(c,0);let h=0;const p=0!=(16&u);let f=0;const m=0!=(32&u);let g=8;d===s&&(0!=(1&u)&&(g+=8),0!=(2&u)&&(g+=4),0!=(8&u)&&(h=Xe(c,g),g+=4),p&&(f=Xe(c,g),g+=4),m&&(g+=4),"video"===t.type&&(a=function(e){if(!e)return!1;const t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}(t.codec)),et(o,["trun"]).map((s=>{const o=s[0],c=16777215&Xe(s,0),d=0!=(1&c);let u=0;const p=0!=(4&c),m=0!=(256&c);let g=0;const y=0!=(512&c);let v=0;const b=0!=(1024&c),_=0!=(2048&c);let w=0;const E=Xe(s,4);let T=8;d&&(u=Xe(s,T),T+=4),p&&(T+=4);let S=u+l;for(let l=0;l<E;l++){if(m?(g=Xe(s,T),T+=4):g=h,y?(v=Xe(s,T),T+=4):v=f,b&&(T+=4),_&&(w=0===o?Xe(s,T):Je(s,T),T+=4),t.type===se){let t=0;for(;t<v;){const s=Xe(i,S);S+=4,ut(a,i[S])&&ht(i.subarray(S,S+s),a?2:1,e+w/r,n),S+=s,t+=s+4}}e+=g/r}})))}))}))})),n}function ut(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6==(31&t)}function ht(e,t,n,i){const r=pt(e);let s=0;s+=t;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(255===l);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(255===l);const e=r.length-s;let t=s;if(o<e)s+=o;else if(o>e){Z.error(`Malformed SEI payload. ${o} is too small, only ${e} bytes left to parse.`);break}if(4===a){if(181===r[t++]){const e=We(r,t);if(t+=2,49===e){const e=Xe(r,t);if(t+=4,1195456820===e){const e=r[t++];if(3===e){const s=r[t++],o=64&s,l=o?2+3*(31&s):0,c=new Uint8Array(l);if(o){c[0]=s;for(let e=1;e<l;e++)c[e]=r[t++]}i.push({type:e,payloadType:a,pts:n,bytes:c})}}}}}else if(5===a&&o>16){const e=[];for(let n=0;n<16;n++){const i=r[t++].toString(16);e.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const s=o-16,l=new Uint8Array(s);for(let e=0;e<s;e++)l[e]=r[t++];i.push({payloadType:a,pts:n,uuid:e.join(""),userData:Ge(l),userDataBytes:l})}}}function pt(e){const t=e.byteLength,n=[];let i=1;for(;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=e[a];return s}function ft(e){const t=e.getUint32(0),n=e.byteOffset,i=e.byteLength;if(i<t)return{offset:n,size:i};if(1886614376!==e.getUint32(4))return{offset:n,size:t};const r=e.getUint32(8)>>>24;if(0!==r&&1!==r)return{offset:n,size:t};const s=e.buffer,a=ze(new Uint8Array(s,n+12,16)),o=e.getUint32(28);let l=null,c=null;if(0===r){if(t-32<o||o<22)return{offset:n,size:t};c=new Uint8Array(s,n+32,o)}else if(1===r){if(!o||i<n+32+16*o+16)return{offset:n,size:t};l=[];for(let e=0;e<o;e++)l.push(new Uint8Array(s,n+32+16*e,16))}return{version:r,systemId:a,kids:l,data:c,offset:n,size:t}}let mt={};class gt{static clearKeyUriToKeyIdMap(){mt={}}constructor(e,t,n,i=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case ge:case ve:case ye:case me:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"!==this.method||this.iv||Z.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=function(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}(e);return new gt(this.method,this.uri,"identity",this.keyFormatVersions,t)}const t=function(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=ue(r)):n=function(e){const t=he(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}(r)}}return n}(this.uri);if(t)switch(this.keyFormat){case ve:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case ye:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,s;if(t){i=1,r=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){const n=t[e];if(16!==n.byteLength)throw new RangeError("Invalid key");r.set(n,16*e)}}else i=0,r=new Uint8Array;i>0?(s=new Uint8Array(4),t.length>0&&new DataView(s.buffer).setUint32(0,t.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),function(e,...t){const n=t.length;let i=8,r=n;for(;r--;)i+=t[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),r=0,i=8;r<n;r++)s.set(t[r],i),i+=t[r].byteLength;return s}([112,115,115,104],new Uint8Array([i,0,0,0]),e,s,r,a,n||new Uint8Array)}(e,null,t);const n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),i=String.fromCharCode.apply(null,Array.from(n)),r=i.substring(i.indexOf("<"),i.length),s=(new DOMParser).parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(s){const e=s.childNodes[0]?s.childNodes[0].nodeValue:s.getAttribute("VALUE");if(e){const t=ue(e).subarray(0,16);!function(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=mt[this.uri];if(!e){const t=Object.keys(mt).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16),new DataView(e.buffer,12,4).setUint32(0,t),mt[this.uri]=e}this.keyId=e}return this}}const yt=/\{\$([a-zA-Z0-9-_]+)\}/g;function vt(e){return yt.test(e)}function bt(e,t,n){if(null!==e.variableList||e.hasVariableRefs)for(let i=n.length;i--;){const r=n[i],s=t[r];s&&(t[r]=_t(e,s))}}function _t(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(yt,(t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),t):r}))}return t}function wt(e,t,n){let i,r,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${n}"`);r=e.get(i)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else i=t.NAME,r=t.VALUE;i in s?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):s[i]=r||""}function Et(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function Tt(e=!0){if("undefined"!=typeof self)return(e||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}const St={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function xt(e,t,n=!0){return!e.split(",").some((e=>!kt(e,t,n)))}function kt(e,t,n=!0){var i;const r=Tt(n);return null!=(i=null==r?void 0:r.isTypeSupported(Ct(e,t)))&&i}function Ct(e,t){return`${t}/mp4;codecs="${e}"`}function Lt(e){if(e){const t=e.substring(0,4);return St.video[t]}return 2}function At(e){return e.split(",").reduce(((e,t)=>{const n=St.video[t];return n?(2*n+e)/(e?3:2):(St.audio[t]+e)/(e?2:1)}),0)}const Rt={},It=/flac|opus/i;function Dt(e,t=!0){return e.replace(It,(e=>function(e,t=!0){if(Rt[e])return Rt[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[e];for(let i=0;i<n.length;i++)if(kt(n[i],"audio",t))return Rt[e]=n[i],n[i];return e}(e.toLowerCase(),t)))}function Pt(e,t){return e&&"mp4a"!==e?e:t?t.split(",")[0]:t}const Mt=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ot=/#EXT-X-MEDIA:(.*)/g,Nt=/^#EXT(?:INF|-X-TARGETDURATION):/m,Ft=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Bt=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Ut{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return F.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Nt.test(e)}static parseMasterPlaylist(e,t){const n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:vt(e)},i=[];let r;for(Mt.lastIndex=0;null!=(r=Mt.exec(e));)if(r[1]){var s;const e=new ee(r[1]);bt(n,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const a=_t(n,r[2]),o={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:Ut.resolve(a,t)},l=e.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),Ht(e.CODECS,o),null!=(s=o.unknownCodecs)&&s.length||i.push(o),n.levels.push(o)}else if(r[3]){const e=r[3],i=r[4];switch(e){case"SESSION-DATA":{const e=new ee(i);bt(n,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[t]=e);break}case"SESSION-KEY":{const e=$t(i,t,n);e.encrypted&&e.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(e)):Z.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${i}"`);break}case"DEFINE":{const e=new ee(i);bt(n,e,["NAME","VALUE","QUERYPARAM"]),wt(n,e,t)}break;case"CONTENT-STEERING":{const e=new ee(i);bt(n,e,["SERVER-URI","PATHWAY-ID"]),n.contentSteering={uri:Ut.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":n.startTimeOffset=Gt(i)}}const a=i.length>0&&i.length<n.levels.length;return n.levels=a?i:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,n){let i;const r={},s=n.levels,a={AUDIO:s.map((e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec}))),SUBTITLES:s.map((e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec}))),"CLOSED-CAPTIONS":[]};let o=0;for(Ot.lastIndex=0;null!==(i=Ot.exec(e));){const e=new ee(i[1]),s=e.TYPE;if(s){const i=a[s],l=r[s]||[];r[s]=l,bt(n,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const c=e.LANGUAGE,d=e["ASSOC-LANGUAGE"],u=e.CHANNELS,h=e.CHARACTERISTICS,p=e["INSTREAM-ID"],f={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",name:e.NAME||c||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:c,url:e.URI?Ut.resolve(e.URI,t):""};if(d&&(f.assocLang=d),u&&(f.channels=u),h&&(f.characteristics=h),p&&(f.instreamId=p),null!=i&&i.length){const e=Ut.findGroup(i,f.groupId)||i[0];qt(f,e,"audioCodec"),qt(f,e,"textCodec")}l.push(f)}}return r}static parseLevelPlaylist(e,t,n,i,r,s){const a=new de(t),o=a.fragments;let l,c,d,u=null,h=0,p=0,f=0,m=0,g=null,y=new le(i,t),v=-1,b=!1,_=null;for(Ft.lastIndex=0,a.m3u8=e,a.hasVariableRefs=vt(e);null!==(l=Ft.exec(e));){b&&(b=!1,y=new le(i,t),y.start=f,y.sn=h,y.cc=m,y.level=n,u&&(y.initSegment=u,y.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null,_&&(y.setByteRange(_),_=null)));const e=l[1];if(e){y.duration=parseFloat(e);const t=(" "+l[2]).slice(1);y.title=t||null,y.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if(H(y.duration)){y.start=f,d&&Vt(y,d,a),y.sn=h,y.level=n,y.cc=m,o.push(y);const e=(" "+l[3]).slice(1);y.relurl=_t(a,e),zt(y,g),g=y,f+=y.duration,h++,p=0,b=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);g?y.setByteRange(e,g):y.setByteRange(e)}else if(l[5])y.rawProgramDateTime=(" "+l[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),-1===v&&(v=o.length);else{if(l=l[0].match(Bt),!l){Z.warn("No matches on slow regex match for level playlist!");continue}for(c=1;c<l.length&&void 0===l[c];c++);const e=(" "+l[c]).slice(1),r=(" "+l[c+1]).slice(1),f=l[c+2]?(" "+l[c+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":a.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":h=a.startSN=parseInt(r);break;case"SKIP":{const e=new ee(r);bt(a,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if(H(t)){a.skippedSegments=t;for(let e=t;e--;)o.unshift(null);h+=t}const n=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");n&&(a.recentlyRemovedDateranges=n.split("\t"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(r),1);break;case"VERSION":a.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(r||f)&&y.tagList.push(f?[r,f]:[r]);break;case"DISCONTINUITY":m++,y.tagList.push(["DIS"]);break;case"GAP":y.gap=!0,y.tagList.push([e]);break;case"BITRATE":y.tagList.push([e,r]);break;case"DATERANGE":{const e=new ee(r);bt(a,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),bt(a,e,e.clientAttrs);const t=new ne(e,a.dateRanges[e.ID]);t.isValid||a.skippedSegments?a.dateRanges[t.id]=t:Z.warn(`Ignoring invalid DATERANGE tag: "${r}"`),y.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const e=new ee(r);bt(a,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?Et(a,e,s):wt(a,e,t)}break;case"DISCONTINUITY-SEQUENCE":m=parseInt(r);break;case"KEY":{const e=$t(r,t,a);if(e.isSupported()){if("NONE"===e.method){d=void 0;break}d||(d={}),d[e.keyFormat]&&(d=G({},d)),d[e.keyFormat]=e}else Z.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${r}"`);break}case"START":a.startTimeOffset=Gt(r);break;case"MAP":{const e=new ee(r);if(bt(a,e,["BYTERANGE","URI"]),y.duration){const r=new le(i,t);jt(r,e,n,d),u=r,y.initSegment=u,u.rawProgramDateTime&&!y.rawProgramDateTime&&(y.rawProgramDateTime=u.rawProgramDateTime)}else{const t=y.byteRangeEndOffset;if(t){const e=y.byteRangeStartOffset;_=`${t-e}@${e}`}else _=null;jt(y,e,n,d),u=y,b=!0}break}case"SERVER-CONTROL":{const e=new ee(r);a.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),a.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new ee(r);a.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=a.partList;e||(e=a.partList=[]);const n=p>0?e[e.length-1]:void 0,i=p++,s=new ee(r);bt(a,s,["BYTERANGE","URI"]);const o=new ce(s,y,t,i,n);e.push(o),y.duration+=o.duration;break}case"PRELOAD-HINT":{const e=new ee(r);bt(a,e,["URI"]),a.preloadHint=e;break}case"RENDITION-REPORT":{const e=new ee(r);bt(a,e,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(e);break}default:Z.warn(`line parsed but not handled: ${l}`)}}}g&&!g.relurl?(o.pop(),f-=g.duration,a.partList&&(a.fragmentHint=g)):a.partList&&(zt(y,g),y.cc=m,a.fragmentHint=y,d&&Vt(y,d,a));const w=o.length,E=o[0],T=o[w-1];if(f+=a.skippedSegments*a.targetduration,f>0&&w&&T){a.averagetargetduration=f/w;const e=T.sn;a.endSN="initSegment"!==e?e:0,a.live||(T.endList=!0),E&&(a.startCC=E.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(f+=a.fragmentHint.duration),a.totalduration=f,a.endCC=m,v>0&&function(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(o,v),a}}function $t(e,t,n){var i,r;const s=new ee(e);bt(n,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=null!=(i=s.METHOD)?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,d=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!l&&Z.error(`Invalid IV: ${s.IV}`);const u=o?Ut.resolve(o,t):"",h=(c||"1").split("/").map(Number).filter(Number.isFinite);return new gt(a,u,d,h,l)}function Gt(e){const t=new ee(e).decimalFloatingPoint("TIME-OFFSET");return H(t)?t:null}function Ht(e,t){let n=(e||"").split(/[ ,]+/).filter((e=>e));["video","audio","text"].forEach((e=>{const i=n.filter((t=>function(e,t){const n=St[t];return!!n&&!!n[e.slice(0,4)]}(t,e)));i.length&&(t[`${e}Codec`]=i.join(","),n=n.filter((e=>-1===i.indexOf(e))))})),t.unknownCodecs=n}function qt(e,t,n){const i=t[n];i&&(e[n]=i)}function zt(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),H(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function jt(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function Vt(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some((e=>t[e].isCommonEncryption))||i.push(e)}var Yt="manifest",Kt="level",Wt="audioTrack",Xt="subtitleTrack",Zt="main",Jt="audio",Qt="subtitle";function en(e){const{type:t}=e;switch(t){case Wt:return Jt;case Xt:return Qt;default:return Zt}}function tn(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class nn{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.LEVEL_LOADING,this.onLevelLoading,this),e.on(j.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(j.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.LEVEL_LOADING,this.onLevelLoading,this),e.off(j.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(j.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=new(n||i)(t);return this.loaders[e.type]=r,r}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Yt,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:s,deliveryDirectives:a}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:Kt,url:s,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Wt,url:r,deliveryDirectives:s})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Xt,url:r,deliveryDirectives:s})}load(e){var t;const n=this.hls.config;let i,r=this.getInternalLoader(e);if(r){const t=r.context;if(t&&t.url===e.url&&t.level===e.level)return void Z.trace("[playlist-loader]: playlist request ongoing");Z.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(i=e.type===Yt?n.manifestLoadPolicy.default:G({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),H(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===Kt&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Wt&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===Xt&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);i=G({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}const s=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},o={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=e.data;0===s.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),Ut.isMediaPlaylist(s)?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),i||null,t)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};r.load(e,a,o)}handleMasterPlaylist(e,t,n,i){const r=this.hls,s=e.data,a=tn(e,n),o=Ut.parseMasterPlaylist(s,a);if(o.playlistParsingError)return void this.handleManifestParsingError(e,n,o.playlistParsingError,i,t);const{contentSteering:l,levels:c,sessionData:d,sessionKeys:u,startTimeOffset:h,variableList:p}=o;this.variableList=p;const{AUDIO:f=[],SUBTITLES:m,"CLOSED-CAPTIONS":g}=Ut.parseMasterPlaylistMedia(s,a,o);f.length&&(f.some((e=>!e.url))||!c[0].audioCodec||c[0].attrs.AUDIO||(Z.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),f.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ee({}),bitrate:0,url:""}))),r.trigger(j.MANIFEST_LOADED,{levels:c,audioTracks:f,subtitles:m,captions:g,contentSteering:l,url:a,stats:t,networkDetails:i,sessionData:d,sessionKeys:u,startTimeOffset:h,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,i,r){const s=this.hls,{id:a,level:o,type:l}=n,c=tn(e,n),d=H(o)?o:H(a)?a:0,u=en(n),h=Ut.parseLevelPlaylist(e.data,c,d,u,0,this.variableList);if(l===Yt){const e={attrs:new ee({}),bitrate:0,details:h,name:"",url:c};s.trigger(j.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:c,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=h,this.handlePlaylistLoaded(h,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(j.ERROR,{type:V.NETWORK_ERROR,details:Y.MANIFEST_PARSING_ERROR,fatal:t.type===Yt,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let s=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===Kt?s+=`: ${e.level} id: ${e.id}`:e.type!==Wt&&e.type!==Xt||(s+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(s);Z.warn(`[playlist-loader]: ${s}`);let o=Y.UNKNOWN,l=!1;const c=this.getInternalLoader(e);switch(e.type){case Yt:o=n?Y.MANIFEST_LOAD_TIMEOUT:Y.MANIFEST_LOAD_ERROR,l=!0;break;case Kt:o=n?Y.LEVEL_LOAD_TIMEOUT:Y.LEVEL_LOAD_ERROR,l=!1;break;case Wt:o=n?Y.AUDIO_TRACK_LOAD_TIMEOUT:Y.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case Xt:o=n?Y.SUBTITLE_TRACK_LOAD_TIMEOUT:Y.SUBTITLE_LOAD_ERROR,l=!1}c&&this.resetInternalLoader(e.type);const d={type:V.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:c,context:e,error:a,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;d.response=U({url:n,data:void 0},i)}this.hls.trigger(j.ERROR,d)}handlePlaylistLoaded(e,t,n,i,r,s){const a=this.hls,{type:o,level:l,id:c,groupId:d,deliveryDirectives:u}=i,h=tn(t,i),p=en(i),f="number"==typeof i.level&&p===Zt?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void a.trigger(j.ERROR,{type:V.NETWORK_ERROR,details:Y.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:e,reason:e.message,response:t,context:i,level:f,parent:p,networkDetails:r,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const m=e.playlistParsingError;if(m)a.trigger(j.ERROR,{type:V.NETWORK_ERROR,details:Y.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:i,level:f,parent:p,networkDetails:r,stats:n});else switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case Yt:case Kt:a.trigger(j.LEVEL_LOADED,{details:e,level:f||0,id:c||0,stats:n,networkDetails:r,deliveryDirectives:u});break;case Wt:a.trigger(j.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:u});break;case Xt:a.trigger(j.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:u})}}}function rn(e,t){let n;try{n=new Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function sn(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(n){Z.debug(`[texttrack-utils]: ${n}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){Z.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===n&&(e.mode=n)}function an(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function on(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=function(e,t,n){const i=[],r=function(e,t){if(t<e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i=0,r=n;for(;i<=r;){const s=Math.floor((r+i)/2);if(t<e[s].startTime)r=s-1;else{if(!(t>e[s].startTime&&i<n))return s;i=s+1}}return e[i].startTime-t<t-e[r].startTime?i:r}(e,t);if(r>-1)for(let s=r,a=e.length;s<a;s++){const r=e[s];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}function ln(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}var cn="org.id3",dn="https://aomedia.org/emsg/ID3";function un(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function hn(e,t,n,i,r){let s=new e(t,n,"");try{s.value=i,r&&(s.type=r)}catch(a){s=new e(t,n,JSON.stringify(r?U({type:r},i):i))}return s}const pn=(()=>{const e=un();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function fn(e,t){return e.getTime()/1e3-t}class mn{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(j.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(j.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(an(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return rn(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=un();if(s)for(let e=0;e<r.length;e++){const t=r[e].type;if(t===dn&&!n||!i)continue;const a=Oe(r[e].data);if(a){const n=r[e].pts;let i=n+r[e].duration;i>pn&&(i=pn),i-n<=0&&(i=n+.25);for(let e=0;e<a.length;e++){const r=a[e];if(!Pe(r)){this.updateId3CueEnds(n,t);const e=hn(s,n,i,r,t);e&&this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let n=i.length;n--;){const r=i[n];r.type===t&&r.startTime<e&&r.endTime===pn&&(r.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:s}=this;if(!s)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}=s;if(r&&(a||o)){let e;e="audio"===i?e=>e.type===cn&&o:"video"===i?e=>e.type===dn&&a:e=>e.type===cn&&o||e.type===dn&&a,on(r,t,n,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:r}=t,s=Object.keys(r);if(i){const e=Object.keys(n).filter((e=>!s.includes(e)));for(let t=e.length;t--;){const r=e[t];Object.keys(n[r].cues).forEach((e=>{i.removeCue(n[r].cues[e])})),delete n[r]}}const a=t.fragments[t.fragments.length-1];if(0===s.length||!H(null==a?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=a.programDateTime/1e3-a.start,l=un();for(let e=0;e<s.length;e++){const t=s[e],i=r[t],a=fn(i.startDate,o),u=n[t],h=(null==u?void 0:u.cues)||{};let p=(null==u?void 0:u.durationKnown)||!1,f=pn;const m=i.endDate;if(m)f=fn(m,o),p=!0;else if(i.endOnNext&&!p){const e=s.reduce(((e,t)=>{if(t!==i.id){const n=r[t];if(n.class===i.class&&n.startDate>i.startDate&&(!e||i.startDate<e.startDate))return n}return e}),null);e&&(f=fn(e.startDate,o),p=!0)}const g=Object.keys(i.attr);for(let e=0;e<g.length;e++){const n=g[e];if("ID"===(d=n)||"CLASS"===d||"START-DATE"===d||"DURATION"===d||"END-DATE"===d||"END-ON-NEXT"===d)continue;const r=h[n];if(r)p&&!u.durationKnown&&(r.endTime=f);else if(l){let e=i.attr[n];te(n)&&(c=e,e=Uint8Array.from(c.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);const r=hn(l,a,f,{key:n,data:e},"com.apple.quicktime.HLS");r&&(r.id=t,this.id3Track.addCue(r),h[n]=r)}}n[t]={cues:h,dateRange:i,durationKnown:p}}var c,d}}class gn{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&n||t;(o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:s*i);const c=i;return l+Math.min(1*this.stallCount,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(j.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(j.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(j.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(j.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(j.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(j.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===Y.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&Z.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!t.live)return;const s=this.targetLatency;if(null===s)return;const a=n-s;if(a<Math.min(this.maxLatency,s+t.targetduration)&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,n))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const yn=["NONE","TYPE-0","TYPE-1",null],vn=["SDR","PQ","HLG"];function bn(e){const{canSkipUntil:t,canSkipDateRanges:n,age:i}=e;return t&&i<t/2?n?"v2":"YES":""}class _n{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class wn{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter((e=>!!e)).map((e=>e.substring(0,4))).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return En(this._audioGroups,e)}hasSubtitleGroup(e){return En(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function En(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function Tn(e,t){const n=t.startPTS;if(H(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&(i.duration=r)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function Sn(e,t,n,i,r,s){i-n<=0&&(Z.warn("Fragment should have a positive duration",t),i=n+t.duration,s=r+t.duration);let a=n,o=i;const l=t.startPTS,c=t.endPTS;if(H(l)){const e=Math.abs(l-n);H(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,a=Math.max(n,l),n=Math.min(n,l),r=Math.min(r,t.startDTS),o=Math.min(i,c),i=Math.max(i,c),s=Math.max(s,t.endDTS)}const d=n-t.start;0!==t.start&&(t.start=n),t.duration=i-t.start,t.startPTS=n,t.maxStartPTS=a,t.startDTS=r,t.endPTS=i,t.minEndPTS=o,t.endDTS=s;const u=t.sn;if(!e||u<e.startSN||u>e.endSN)return 0;let h;const p=u-e.startSN,f=e.fragments;for(f[p]=t,h=p;h>0;h--)Tn(f[h],f[h-1]);for(h=p;h<f.length-1;h++)Tn(f[h],f[h+1]);return e.fragmentHint&&Tn(f[f.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function xn(e,t){const n=t.startSN+t.skippedSegments-e.startSN,i=e.fragments;n<0||n>=i.length||kn(t,i[n].start)}function kn(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Cn(e,t,n){var i;return null!=e&&e.details?Ln(null==(i=e.details)?void 0:i.partList,t,n):null}function Ln(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function An(e){e.forEach(((e,t)=>{const{details:n}=e;null!=n&&n.fragments&&n.fragments.forEach((e=>{e.level=t}))}))}function Rn(e){switch(e.details){case Y.FRAG_LOAD_TIMEOUT:case Y.KEY_LOAD_TIMEOUT:case Y.LEVEL_LOAD_TIMEOUT:case Y.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function In(e,t){const n=Rn(t);return e.default[(n?"timeout":"error")+"Retry"]}function Dn(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Pn(e){return U(U({},e),{errorRetry:null,timeoutRetry:null})}function Mn(e,t,n,i){if(!e)return!1;const r=null==i?void 0:i.code,s=t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(r)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,s):s}const On=function(e,t){let n=0,i=e.length-1,r=null,s=null;for(;n<=i;){r=(n+i)/2|0,s=e[r];const a=t(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null};function Nn(e,t,n=0,i=0,r=.005){let s=null;if(e){s=t[e.sn-t[0].sn+1]||null;const i=e.endDTS-n;i>0&&i<15e-7&&(n+=15e-7)}else 0===n&&0===t[0].start&&(s=t[0]);if(s&&((!e||e.level===s.level)&&0===Fn(n,i,s)||function(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const i=t.tagList.reduce(((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e)),n);return e.start<=i}return!1}(s,e,Math.min(r,i))))return s;const a=On(t,Fn.bind(null,n,i));return!a||a===e&&s?s:a}function Fn(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function Bn(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-i>e}class Un{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=Z.log.bind(Z,`${t}:`),this.warn=Z.warn.bind(Z,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=null==t?void 0:t.renditionReports;if(i){let r=-1;for(let n=0;n<i.length;n++){const s=i[n];let a;try{a=new self.URL(s.URI,t.url).href}catch(e){Z.warn(`Could not construct new URL for Rendition Report: ${e}`),a=s.URI||""}if(a===e){r=n;break}a===e.substring(0,a.length)&&(r=n)}if(-1!==r){const e=i[r],s=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let a=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}const o=n&&bn(n);return new _n(s,a>=0?a:void 0,o)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:r}=t,s=self.performance.now(),a=r.loading.first?Math.max(0,s-r.loading.first):0;if(i.advancedDateTime=Date.now()-a,i.live||null!=n&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),n&&i.fragments.length>0&&function(e,t){let n=null;const i=e.fragments;for(let e=i.length-1;e>=0;e--){const t=i[e].initSegment;if(t){n=t;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let r,s=0;if(function(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let e=r;e<=s;e++){const r=l[a+e];let s=o[e];i&&!s&&e<i&&(s=t.fragments[e]=r),r&&s&&n(r,s)}}(e,t,((e,i)=>{e.relurl&&(s=e.cc-i.cc),H(e.startPTS)&&H(e.endPTS)&&(i.start=i.startPTS=e.startPTS,i.startDTS=e.startDTS,i.maxStartPTS=e.maxStartPTS,i.endPTS=e.endPTS,i.endDTS=e.endDTS,i.minEndPTS=e.minEndPTS,i.duration=e.endPTS-e.startPTS,i.duration&&(r=i),t.PTSKnown=t.alignedSliding=!0),i.elementaryStreams=e.elementaryStreams,i.loader=e.loader,i.stats=e.stats,e.initSegment&&(i.initSegment=e.initSegment,n=e.initSegment)})),n&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)})),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((e=>!e)),t.deltaUpdateFailed){Z.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,n){const i=G({},e);return n&&n.forEach((e=>{delete i[e]})),Object.keys(t).forEach((e=>{const n=new ne(t[e].attr,i[e]);n.isValid?i[e]=n:Z.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)})),i}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const a=t.fragments;if(s){Z.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<a.length;e++)a[e].cc+=s}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,n){if(e&&t){let i=0;for(let r=0,s=e.length;r<=s;r++){const s=e[r],a=t[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}(e.partList,t.partList,((e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),r?Sn(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):xn(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const o=t.advancedDateTime;if(t.advanced&&o){const e=t.edge;t.driftStart||(t.driftStartTime=o,t.driftStart=e),t.driftEndTime=o,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}(n,i),!this.canLoad||!i.live)return;let a,o,l;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,s=i.endSN,c=i.lastPartIndex,d=r===s;-1!==c?(o=d?s+1:r,l=d?e?0:c:c+1):o=s+1;const u=i.age,h=u+i.ageHeader;let p=Math.min(h-i.partTarget,1.5*i.targetduration);if(p>0){if(n&&p>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${p} with playlist age: ${i.age}`),p=0;else{const e=Math.floor(p/i.targetduration);o+=e,void 0!==l&&(l+=Math.round(p%i.targetduration/i.partTarget)),this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${u.toFixed(2)}s goal: ${p} skip sn ${e} to part ${l}`)}i.tuneInGoal=p}if(a=this.getDeliveryDirectives(i,t.deliveryDirectives,o,l),e||!d)return void this.loadPlaylist(a)}else(i.canBlockReload||i.canSkipUntil)&&(a=this.getDeliveryDirectives(i,t.deliveryDirectives,o,l));const c=this.hls.mainForwardBufferInfo,d=c?c.end-c.len:0,u=function(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}(i,1e3*(i.edge-d));i.updated&&s>this.requestScheduled+u&&(this.requestScheduled=r.loading.start),void 0!==o&&i.canBlockReload?this.requestScheduled=r.loading.first+u-(1e3*i.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+u<s?this.requestScheduled=s:this.requestScheduled-s<=0&&(this.requestScheduled+=u);let h=this.requestScheduled-s;h=Math.max(0,h),this.log(`reload live playlist ${e} in ${Math.round(h)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(a)),h)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let r=bn(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=""),new _n(n,i,r)}checkRetry(e){const t=e.details,n=Rn(e),i=e.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(5===r||!i.resolved&&2===r);if(o){var l;if(this.requestScheduled=-1,s>=a.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Dn(a,s);this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,i.resolved=!0}return o}}class $n{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class Gn{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new $n(e),this.fast_=new $n(t),this.defaultTTFB_=i,this.ttfb_=new $n(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new $n(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new $n(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new $n(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){const n=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/n;this.fast_.sample(n,i),this.slow_.sample(n,i)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const Hn={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},qn={};function zn(e,t,n,i,r,s){const a=e.audioCodec?e.audioGroups:null,o=null==s?void 0:s.audioCodec,l=null==s?void 0:s.channels,c=l?parseInt(l):o?1/0:2;let d=null;if(null!=a&&a.length)try{d=1===a.length&&a[0]?t.groups[a[0]].channels:a.reduce(((e,n)=>{if(n){const i=t.groups[n];if(!i)throw new Error(`Audio track group ${n} not found`);Object.keys(i.channels).forEach((t=>{e[t]=(e[t]||0)+i.channels[t]}))}return e}),{2:0})}catch(e){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(i,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(r,8e6))||!!d&&H(c)&&Object.keys(d).some((e=>parseInt(e)>c))}function jn(e,t,n){const i=e.videoCodec,r=e.audioCodec;if(!i||!r||!n)return Promise.resolve(Hn);const s={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},a=e.videoRange;"SDR"!==a&&(s.transferFunction=a.toLowerCase());const o=i.split(",").map((e=>({type:"media-source",video:U(U({},s),{},{contentType:Ct(e,"video")})})));return r&&e.audioGroups&&e.audioGroups.forEach((e=>{var n;e&&(null==(n=t.groups[e])||n.tracks.forEach((t=>{if(t.groupId===e){const e=t.channels||"",n=parseFloat(e);H(n)&&n>2&&o.push.apply(o,r.split(",").map((e=>({type:"media-source",audio:{contentType:Ct(e,"audio"),channels:""+n}}))))}})))})),Promise.all(o.map((e=>{const t=function(e){const{audio:t,video:n}=e,i=n||t;if(i){const e=i.contentType.split('"')[1];if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${e}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${e}`}return""}(e);return qn[t]||(qn[t]=n.decodingInfo(e))}))).then((e=>({supported:!e.some((e=>!e.supported)),configurations:o,decodingInfoResults:e}))).catch((e=>({supported:!1,configurations:o,decodingInfoResults:[],error:e})))}function Vn(e,t){Z.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function Yn(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let i=0;i<t.length;i++)if(Kn(e,t[i],n))return i;return-1}function Kn(e,t,n){const{groupId:i,name:r,lang:s,assocLang:a,characteristics:o,default:l}=e,c=e.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===s||t.lang===s)&&(void 0===s||t.assocLang===a)&&(void 0===l||t.default===l)&&(void 0===c||t.forced===c)&&(void 0===o||function(e,t=""){const n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some((e=>-1===i.indexOf(e)))}(o,t.characteristics))&&(void 0===n||n(e,t))}function Wn(e,t){const{audioCodec:n,channels:i}=e;return!(void 0!==n&&(t.audioCodec||"").substring(0,4)!==n.substring(0,4)||void 0!==i&&i!==(t.channels||"2"))}function Xn(e,t,n){for(let i=t;i>-1;i--)if(n(e[i]))return i;for(let i=t+1;i<e.length;i++)if(n(e[i]))return i;return-1}class Zn{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Jn="NOT_LOADED",Qn="APPENDING",ei="PARTIAL",ti="OK";class ni{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(j.BUFFER_APPENDED,this.onBufferAppended,this),e.on(j.FRAG_BUFFERED,this.onFragBuffered,this),e.on(j.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(j.BUFFER_APPENDED,this.onBufferAppended,this),e.off(j.FRAG_BUFFERED,this.onFragBuffered,this),e.off(j.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let t=n.length;t--;){const i=n[t];if(!i)break;const r=i.end;if(i.start<=e&&null!==r&&e<=r)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let r=i.length;r--;){const s=n[i[r]];if((null==s?void 0:s.body.type)===t&&s.buffered){const t=s.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const r=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach((i=>{const s=this.fragments[i];if(!s)return;if(r>=s.body.sn)return;if(!s.buffered&&!s.loaded)return void(s.body.type===n&&this.removeFragment(s.body));const a=s.range[e];a&&a.time.some((e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(s.body),n}))}))}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||"initSegment"===n.sn)return;const r=ri(n),s=this.fragments[r];if(!s||s.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach((e=>{const r=n.elementaryStreams[e];if(!r)return;const o=t[e],l=a||!0===r.partial;s.range[e]=this.getBufferedTimes(n,i,l,o)})),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=n.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),ii(s)||this.removeParts(n.sn-1,n.type)):this.removeFragment(s.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter((t=>t.fragment.sn>=e)))}fragBuffered(e,t){const n=ri(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},s=e.start,a=e.end,o=e.minEndPTS||a,l=e.maxStartPTS||s;for(let e=0;e<i.length;e++){const t=i.start(e)-this.bufferPadding,n=i.end(e)+this.bufferPadding;if(l>=t&&o<=n){r.time.push({startPTS:Math.max(s,i.start(e)),endPTS:Math.min(a,i.end(e))});break}if(s<n&&a>t){const t=Math.max(s,i.start(e)),n=Math.min(a,i.end(e));n>t&&(r.partial=!0,r.time.push({startPTS:t,endPTS:n}))}else if(a<=t)break}return r}getPartialFragment(e){let t,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach((l=>{const c=o[l];c&&ii(c)&&(n=c.body.start-a,i=c.body.end+a,e>=n&&e<=i&&(t=Math.min(e-n,i-e),s<=t&&(r=c.body,s=t)))})),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||ii(t))}getState(e){const t=ri(e),n=this.fragments[t];return n?n.buffered?ii(n)?ei:ti:Qn:Jn}isTimeBuffered(e,t,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if("initSegment"===n.sn||n.bitrateTest)return;const r=i?null:t,s=ri(n);this.fragments[s]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r}=t;if("initSegment"===n.sn)return;const s=n.type;if(i){let e=this.activePartLists[s];e||(this.activePartLists[s]=e=[]),e.push(i)}this.timeRanges=r,Object.keys(r).forEach((e=>{const t=r[e];this.detectEvictedFragments(e,t,s,i)}))}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=ri(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach((s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)}))}removeFragment(e){const t=ri(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=n.filter((e=>e.fragment.sn!==t))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function ii(e){var t,n,i;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(i=e.range.audiovideo)?void 0:i.partial))}function ri(e){return`${e.type}_${e.level}_${e.sn}`}const si={length:0,start:()=>0,end:()=>0};class ai{static isBuffered(e,t){try{if(e){const n=ai.getBuffered(e);for(let e=0;e<n.length;e++)if(t>=n.start(e)&&t<=n.end(e))return!0}}catch(e){}return!1}static bufferInfo(e,t,n){try{if(e){const i=ai.getBuffered(e),r=[];let s;for(s=0;s<i.length;s++)r.push({start:i.start(s),end:i.end(s)});return this.bufferedInfo(r,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort((function(e,t){return e.start-t.start||t.end-e.end}));let i=[];if(n)for(let t=0;t<e.length;t++){const r=i.length;if(r){const s=i[r-1].end;e[t].start-s<n?e[t].end>s&&(i[r-1].end=e[t].end):i.push(e[t])}else i.push(e[t])}else i=e;let r,s=0,a=t,o=t;for(let e=0;e<i.length;e++){const l=i[e].start,c=i[e].end;if(t+n>=l&&t<c)a=l,o=c,s=o-t;else if(t+n<l){r=l;break}}return{len:s,start:a||0,end:o||0,nextStart:r}}static getBuffered(e){try{return e.buffered}catch(e){return Z.log("failed to get media.buffered",e),si}}}class oi{constructor(e,t,n,i=0,r=-1,s=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=s}}function li(e,t){for(let i=0,r=e.length;i<r;i++){var n;if((null==(n=e[i])?void 0:n.cc)===t)return e[i]}return null}function ci(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function di(e,t){const n=t.fragments;for(let t=0,i=n.length;t<i;t++)ci(n[t],e);t.fragmentHint&&ci(t.fragmentHint,e),t.alignedSliding=!0}function ui(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(t.endCC,e.endCC);t.startCC<a&&e.startCC<a&&(r=li(i,a),s=li(n,a)),r&&s||(r=i[Math.floor(i.length/2)],s=li(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,l=s.programDateTime;o&&l&&di((l-o)/1e3-(s.start-r.start),e)}const hi=Math.pow(2,17);class pi{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new gi({type:V.NETWORK_ERROR,details:Y.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some((e=>"GAP"===e[0])))return void o(mi(e));e.gap=!1}const l=this.loader=e.loader=r?new r(i):new s(i),c=fi(e),d=Pn(i.fragLoadPolicy.default),u={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:hi};e.stats=l.stats,l.load(c,u,{onSuccess:(t,n,i,r)=>{this.resetLoader(e,l);let s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:e,part:null,payload:s,networkDetails:r})},onError:(t,i,r,s)=>{this.resetLoader(e,l),o(new gi({type:V.NETWORK_ERROR,details:Y.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:U({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:s}))},onAbort:(t,n,i)=>{this.resetLoader(e,l),o(new gi({type:V.NETWORK_ERROR,details:Y.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,l),o(new gi({type:V.NETWORK_ERROR,details:Y.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${u.timeout}ms`),networkDetails:i,stats:t}))},onProgress:(n,i,r,s)=>{t&&t({frag:e,part:null,payload:r,networkDetails:s})}})}))}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void o(mi(e,t));const l=this.loader=e.loader=r?new r(i):new s(i),c=fi(e,t),d=Pn(i.fragLoadPolicy.default),u={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:hi};t.stats=l.stats,l.load(c,u,{onSuccess:(i,r,s,o)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const c={frag:e,part:t,payload:i.data,networkDetails:o};n(c),a(c)},onError:(n,i,r,s)=>{this.resetLoader(e,l),o(new gi({type:V.NETWORK_ERROR,details:Y.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:U({url:c.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),o(new gi({type:V.NETWORK_ERROR,details:Y.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,l),o(new gi({type:V.NETWORK_ERROR,details:Y.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${u.timeout}ms`),networkDetails:r,stats:n}))}})}))}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),s=Math.min(Math.round(n.loaded/r),i),a=(i-s)*Math.round(n.loaded/s);n.total=n.loaded+a}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function fi(e,t=null){const n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if(H(r)&&H(s)){var a;let t=r,n=s;if("initSegment"===e.sn&&"AES-128"===(null==(a=e.decryptdata)?void 0:a.method)){const e=s-r;e%16&&(n=s+(16-e%16)),0!==r&&(i.resetIV=!0,t=r-16)}i.rangeStart=t,i.rangeEnd=n}return i}function mi(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),i={type:V.MEDIA_ERROR,details:Y.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new gi(i)}class gi extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class yi{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class vi{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class bi{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let e=0;e<4;e++)n[e]=t.getUint32(4*e);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,l=o[0],c=o[1],d=o[2],u=o[3],h=new Uint32Array(256);let p=0,f=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let n=f^f<<1^f<<2^f<<3^f<<4;n=n>>>8^255&n^99,e[p]=n,t[n]=p;const o=h[p],m=h[o],g=h[m];let y=257*h[n]^16843008*n;i[p]=y<<24|y>>>8,r[p]=y<<16|y>>>16,s[p]=y<<8|y>>>24,a[p]=y,y=16843009*g^65537*m^257*o^16843008*p,l[n]=y<<24|y>>>8,c[n]=y<<16|y>>>16,d[n]=y<<8|y>>>24,u[n]=y,p?(p=o^h[h[h[g^o]]],f^=h[h[f]]):p=f=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),d=this.sBox,u=this.rcon,h=this.invSubMix,p=h[0],f=h[1],m=h[2],g=h[3];let y,v;for(a=0;a<s;a++)a<r?y=l[a]=t[a]:(v=y,a%r==0?(v=v<<8|v>>>24,v=d[v>>>24]<<24|d[v>>>16&255]<<16|d[v>>>8&255]<<8|d[255&v],v^=u[a/r|0]<<24):r>6&&a%r==4&&(v=d[v>>>24]<<24|d[v>>>16&255]<<16|d[v>>>8&255]<<8|d[255&v]),l[a]=y=(l[a-r]^v)>>>0);for(o=0;o<s;o++)a=s-o,v=3&o?l[a]:l[a-4],c[o]=o<4||a<=4?v:p[d[v>>>24]]^f[d[v>>>16&255]]^m[d[v>>>8&255]]^g[d[255&v]],c[o]=c[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],c=a[2],d=a[3],u=this.uint8ArrayToUint32Array_(n);let h=u[0],p=u[1],f=u[2],m=u[3];const g=new Int32Array(e),y=new Int32Array(g.length);let v,b,_,w,E,T,S,x,k,C,L,A,R,I;const D=this.networkToHostOrderSwap;for(;t<g.length;){for(k=D(g[t]),C=D(g[t+1]),L=D(g[t+2]),A=D(g[t+3]),E=k^r[0],T=A^r[1],S=L^r[2],x=C^r[3],R=4,I=1;I<i;I++)v=o[E>>>24]^l[T>>16&255]^c[S>>8&255]^d[255&x]^r[R],b=o[T>>>24]^l[S>>16&255]^c[x>>8&255]^d[255&E]^r[R+1],_=o[S>>>24]^l[x>>16&255]^c[E>>8&255]^d[255&T]^r[R+2],w=o[x>>>24]^l[E>>16&255]^c[T>>8&255]^d[255&S]^r[R+3],E=v,T=b,S=_,x=w,R+=4;v=s[E>>>24]<<24^s[T>>16&255]<<16^s[S>>8&255]<<8^s[255&x]^r[R],b=s[T>>>24]<<24^s[S>>16&255]<<16^s[x>>8&255]<<8^s[255&E]^r[R+1],_=s[S>>>24]<<24^s[x>>16&255]<<16^s[E>>8&255]<<8^s[255&T]^r[R+2],w=s[x>>>24]<<24^s[E>>16&255]<<16^s[T>>8&255]<<8^s[255&S]^r[R+3],y[t]=D(v^h),y[t+1]=D(w^p),y[t+2]=D(_^f),y[t+3]=D(b^m),h=k,p=C,f=L,m=A,t+=4}return y.buffer}}class _i{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?ke(e,0,t-n):e}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise(((i,r)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const s=this.flush();s?i(s.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:r,remainderData:s}=this;this.logOnce("JS AES decrypt"),s&&(e=ct(s,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;i&&(n=i);let o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new bi),o.expandKey(t);const l=r;return this.currentResult=o.decrypt(a.buffer,0,n),this.currentIV=ke(a,-16).buffer,l||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new vi(this.subtle,t)}return this.fastAesKey.expandKey().then((t=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new yi(this.subtle,new Uint8Array(n)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized")))).catch((i=>(Z.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,n))))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%16;return n!==e.length&&(t=ke(e,0,n),this.remainderData=ke(e,n)),t}logOnce(e){this.logEnabled&&(Z.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const wi="STOPPED",Ei="IDLE",Ti="KEY_LOADING",Si="FRAG_LOADING",xi="FRAG_LOADING_WAITING_RETRY",ki="WAITING_TRACK",Ci="PARSING",Li="PARSED",Ai="ENDED",Ri="ERROR",Ii="WAITING_INIT_PTS",Di="WAITING_LEVEL";class Pi extends Zn{constructor(e,t,n,i,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=wi,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=i,this.log=Z.log.bind(Z,`${i}:`),this.warn=Z.warn.bind(Z,`${i}:`),this.hls=e,this.fragmentLoader=new pi(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new _i(e.config),e.on(j.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=wi}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(null!=n&&n.length){const e=n[n.length-1];return ai.isBuffered(this.media,e.start+e.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===wi&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,s=n?n.currentTime:0,a=ai.bufferInfo(i||n,s,e.maxBufferHole);if(this.log(`media seeking to ${H(s)?s.toFixed(3):s}, state: ${r}`),this.state===Ai)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(!a.len||r<a.start||i>a.end){const e=s>r;(s<i||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0),this.lastCurrentTime=s),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=s),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(j.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=wi,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){this._doFragLoad(e,t,n,(t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const n=this.state;this.fragContextChanged(e)?(n===Si||!this.fragCurrent&&n===Ci)&&(this.fragmentTracker.removeFragment(e),this.state=Ei):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(j.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((t=>{this.state!==wi&&this.state!==Ri&&(this.warn(`Frag error: ${(null==t?void 0:t.message)||t}`),this.resetFragmentLoading(e))}))}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Qn){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength),s=this.backtrackFragment;(1==(s?e.sn-s.sn:0)||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===ei&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(j.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then((t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:n}=this,{payload:i}=t,r=e.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&"AES-128"===r.method){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch((t=>{throw n.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((i=>{const r=self.performance.now();return n.trigger(j.FRAG_DECRYPTED,{frag:e,payload:i,stats:{tstart:s,tdecrypt:r}}),t.payload=i,this.completeInitSegmentLoad(t)}))}return this.completeInitSegmentLoad(t)})).catch((t=>{this.state!==wi&&this.state!==Ri&&(this.warn(t),this.resetFragmentLoading(e))}))}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=Ei,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,i,r,s;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Zt?"level":"track"} ${e.level} (frag:[${(null!=(n=e.startPTS)?n:NaN).toFixed(3)}-${(null!=(i=e.endPTS)?i:NaN).toFixed(3)}] > buffer:${a?function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+=`[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;return t}(ai.getBuffered(a)):"(detached)"})`),"initSegment"!==e.sn){var o;if(e.type!==Qt){const t=e.elementaryStreams;if(!Object.keys(t).some((e=>!!t[e])))return void(this.state=Ei)}const t=null==(o=this.levels)?void 0:o[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=Ei,a&&(!this.loadedmetadata&&e.type==Zt&&a.buffered.length&&(null==(r=this.fragCurrent)?void 0:r.sn)===(null==(s=this.fragPrevious)?void 0:s.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,s=!r||0===r.length||r.some((e=>!e)),a=new oi(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var r;const s=null==t?void 0:t.details;if(!this.levels||!s)throw new Error(`frag load aborted, missing level${s?"":" detail"}s`);let a=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key?!e.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(e,s.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${s.startSN}-${s.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=Ti,this.fragCurrent=e,a=this.keyLoader.load(e).then((e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(j.KEY_LOADED,e),this.state===Ti&&(this.state=Ei),e})),this.hls.trigger(j.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const r=s.partList;if(r&&i){n>e.end&&s.fragmentHint&&(e=s.fragmentHint);const o=this.getNextPart(r,e,n);if(o>-1){const l=r[o];let c;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${s.startSN}-${s.endSN}] parts [0-${o}-${r.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Si,c=a?a.then((n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,i))).catch((e=>this.handleFragLoadError(e))):this.doFragPartsLoad(e,l,t,i).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(j.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(r,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${s?"of ["+s.startSN+"-"+s.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),H(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Si;const o=this.config.progressive;let l;return l=o&&a?a.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,i))).catch((e=>this.handleFragLoadError(e))):Promise.all([this.fragmentLoader.load(e,o?i:void 0),a]).then((([e])=>(!o&&e&&i&&i(e),e))).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(j.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,n,i){return new Promise(((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,c=t=>{this.fragmentLoader.loadPart(e,t,i).then((i=>{o[t.index]=i;const s=i.part;this.hls.trigger(j.FRAG_LOADED,i);const a=Cn(n,e.sn,t.index+1)||Ln(l,e.sn,t.index+1);if(!a)return r({frag:e,part:s,partsLoaded:o});c(a)})).catch(s)};c(t)}))}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Y.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(j.ERROR,t)}else this.hls.trigger(j.ERROR,{type:V.OTHER_ERROR,details:Y.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Ci)return void(this.fragCurrent||this.state===wi||this.state===Ri||(this.state=Ei));const{frag:n,part:i,level:r}=t,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s),this.updateLevelTiming(n,i,r,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:s}=e;if(null==t||!t[i])return this.warn(`Levels object was unset while buffering fragment ${r} of level ${i}. The current chunk will not be buffered.`),null;const a=t[i],o=s>-1?Cn(a,r,s):null,l=o?o.fragment:function(e,t,n){if(null==e||!e.details)return null;const i=e.details;let r=i.fragments[t-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===t?r:t<i.startSN&&n&&n.sn===t?n:null)}(a,r,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:o,level:a}):null}bufferFragmentData(e,t,n,i,r){var s;if(!e||this.state!==Ci)return;const{data1:a,data2:o}=e;let l=a;if(a&&o&&(l=ct(a,o)),null==(s=l)||!s.length)return;const c={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};if(this.hls.trigger(j.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!ai.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=ai.bufferInfo(t,n,0),r=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-s,i.end-s),n+s);e.start-a>s&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return H(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,r=ai.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,n);if(s&&r.nextStart<s.end)return ai.bufferInfo(e,t,Math.max(r.nextStart,i))}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0)}getAppendedFrag(e,t=Zt){const n=this.fragmentTracker.getAppendedFrag(e,Zt);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start;let a;if(t.live){const o=r.initialLiveManifestSize;if(i<o)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${o})`),null;(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<s)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=s&&(a=n[0]);if(!a){const n=r.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,n,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===ti||n===ei&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){const s=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(null===a)return a;if(e=a,s&&e&&!e.gap&&n.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(null!==t&&n.len+t.len>=r)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,s=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const l=o.loaded;l?i=-1:(r||o.independent||s)&&o.fragment===t&&(i=a),r=l}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=function(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!H(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(let i=0;i<e.length;++i){const r=e[i];if(Bn(t,n,r))return r}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const s=t[r-e.startSN];n.cc===s.cc&&(i=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=function(e,t){return On(e,(e=>e.cc<t?1:e.cc>t?-1:0))}(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,{maxFragLookUpTolerance:l}=i,c=n.partList,d=!!(i.lowLatencyMode&&null!=c&&c.length&&o);let u;if(d&&o&&!this.bitrateTest&&(s=s.concat(o),a=o.sn),u=e<t?Nn(r,s,e,e>t-l?0:l):s[s.length-1],u){const e=u.sn-n.startSN,t=this.fragmentTracker.getState(u);if((t===ti||t===ei&&u.gap)&&(r=u),r&&u.sn===r.sn&&(!d||c[0].fragment.sn>u.sn)&&r&&u.level===r.level){const t=s[e+1];u=u.sn<a&&this.fragmentTracker.getState(t)!==ti?t:null}}return u}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=n.currentTime,s=e.fragments[0].start,a=e.edge,o=r>=s-t.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!o&&n.readyState<4||r<a-s)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragments[0].start,s=!t,a=e.alignedSliding&&H(r);if(s||!a&&!r){const{fragPrevious:r}=this;!function(e,t,n){t&&(function(e,t,n){if(function(e,t,n){return!(!t||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}(e,n,t)){const e=function(e,t){const n=e.fragments,i=t.fragments;if(!i.length||!n.length)return void Z.log("No fragments to align");const r=li(n,i[0].cc);if(r&&(!r||r.startPTS))return r;Z.log("No frag in previous level to align on")}(n,t);e&&H(e.start)&&(Z.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),di(e.start,t))}}(e,n,t),!n.alignedSliding&&t&&ui(n,t),n.alignedSliding||!t||n.skippedSegments||xn(t,n))}(r,n,e);const s=e.fragments[0].start;return this.log(`Live playlist sliding: ${s.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${r?r.sn:"na"} fragments: ${i}`),s}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){const i=null!==this.startTimeOffset,r=i?this.startTimeOffset:e.startTimeOffset;null!==r&&H(r)?(n=t+r,r<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${r} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===xi)||(this.state=Ei)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var i;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);const r=t.details===Y.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const s=t.errorAction,{action:a,retryCount:o=0,retryConfig:l}=s||{};if(s&&5===a&&l){this.resetStartWhenNotLoaded(this.levelLastLoaded);const i=Dn(l,o);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${o+1}/${l.maxNumRetry} in ${i}ms`),s.resolved=!0,this.retryDate=self.performance.now()+i,this.state=xi}else if(l&&s){if(this.resetFragmentErrors(e),!(o<l.maxNumRetry))return void Z.warn(`${t.details} reached or exceeded max retry (${o})`);r||3===a||(s.resolved=!0)}else 2===(null==s?void 0:s.action)?this.state=Di:this.state=Ri;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Ci||this.state===Li){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===Jt&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==wi&&(this.state=Ei)}afterBufferFlushed(e,t,n){if(!e)return;const i=ai.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Ai&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Ei}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var r;const s=n.details;if(s){if(!Object.keys(e.elementaryStreams).reduce(((t,r)=>{const a=e.elementaryStreams[r];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${r} duration reliably (${o})`),t||!1;const l=i?0:Sn(s,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(j.LEVEL_PTS_UPDATED,{details:s,level:n,drift:l,type:r,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t}),!1)&&null===(null==(r=this.transmuxer)?void 0:r.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Li,this.hls.trigger(j.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class Mi{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:function(e,t){const n=new Uint8Array(t);let i=0;for(let t=0;t<e.length;t++){const r=e[t];n.set(r,i),i+=r.length}return n}(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Oi(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Ni{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=ct(this.cachedData,e),this.cachedData=null);let n,i=Ae(e,0),r=i?i.length:0;const s=this._audioTrack,a=this._id3Track,o=i?De(i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&H(o))&&(this.basePTS=Fi(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:cn,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(e,r)){const t=this.appendFrame(s,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,n=r):r=l}else Ie(e,r)?(i=Ae(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:cn,duration:Number.POSITIVE_INFINITY}),r+=i.length,n=r):r++;if(r===l&&n!==l){const t=ke(e,n);this.cachedData?this.cachedData=ct(this.cachedData,t):this.cachedData=t}}return{audioTrack:s,videoTrack:Oi(),id3Track:a,textTrack:Oi()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Oi(),id3Track:this._id3Track,textTrack:Oi()}}destroy(){}}const Fi=(e,t,n)=>H(e)?90*e:9e4*t+(n?9e4*n.baseTime/n.timescale:0);function Bi(e,t){return 255===e[t]&&240==(246&e[t+1])}function Ui(e,t){return 1&e[t+1]?7:9}function $i(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function Gi(e,t){return t+1<e.length&&Bi(e,t)}function Hi(e,t){if(Gi(e,t)){const n=Ui(e,t);if(t+n>=e.length)return!1;const i=$i(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||Gi(e,r)}return!1}function qi(e,t,n,i,r){if(!e.samplerate){const s=function(e,t,n,i){let r,s,a,o;const l=navigator.userAgent.toLowerCase(),c=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&t[n+2])>>>6);const u=(60&t[n+2])>>>2;if(!(u>d.length-1))return a=(1&t[n+2])<<2,a|=(192&t[n+3])>>>6,Z.log(`manifest codec:${i}, ADTS type:${r}, samplingIndex:${u}`),/firefox/i.test(l)?u>=6?(r=5,o=new Array(4),s=u-3):(r=2,o=new Array(2),s=u):-1!==l.indexOf("android")?(r=2,o=new Array(2),s=u):(r=5,o=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&u>=6?s=u-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(u>=6&&1===a||/vivaldi/i.test(l))||!i&&1===a)&&(r=2,o=new Array(2)),s=u)),o[0]=r<<3,o[0]|=(14&u)>>1,o[1]|=(1&u)<<7,o[1]|=a<<3,5===r&&(o[1]|=(14&s)>>1,o[2]=(1&s)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:d[u],channelCount:a,codec:"mp4a.40."+r,manifestCodec:c};{const t=new Error(`invalid ADTS sampling index:${u}`);e.emit(j.ERROR,j.ERROR,{type:V.MEDIA_ERROR,details:Y.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}}(t,n,i,r);if(!s)return;e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,Z.log(`parsed codec:${e.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function zi(e){return 9216e4/e}function ji(e,t,n,i,r){const s=i+r*zi(e.samplerate),a=function(e,t){const n=Ui(e,t);if(t+n<=e.length){const i=$i(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}(t,n);let o;if(a){const{frameLength:i,headerLength:r}=a,l=r+i,c=Math.max(0,n+l-t.length);c?(o=new Uint8Array(l-r),o.set(t.subarray(n+r,t.length),0)):o=t.subarray(n+r,n+l);const d={unit:o,pts:s};return c||e.samples.push(d),{sample:d,length:l,missing:c}}const l=t.length-n;return o=new Uint8Array(l),o.set(t.subarray(n,t.length),0),{sample:{unit:o,pts:s},length:l,missing:-1}}let Vi=null;const Yi=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Ki=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Wi=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Xi=[0,1,1,4];function Zi(e,t,n,i,r){if(n+24>t.length)return;const s=Ji(t,n);if(s&&n+s.frameLength<=t.length){const a=i+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:t.subarray(n,n+s.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(o),{sample:o,length:s.frameLength,missing:0}}}function Ji(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*Yi[14*(3===n?3-i:3===i?3:4)+r-1],c=Ki[3*(3===n?0:2===n?1:2)+s],d=3===o?1:2,u=Wi[n][i],h=Xi[i],p=8*u*h,f=Math.floor(u*l/c+a)*h;if(null===Vi){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Vi=e?parseInt(e[1]):0}return!!Vi&&Vi<=87&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:c,channelCount:d,frameLength:f,samplesPerFrame:p}}}function Qi(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function er(e,t){return t+1<e.length&&Qi(e,t)}function tr(e,t){if(t+1<e.length&&Qi(e,t)){const n=4,i=Ji(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===e.length||er(e,s)}return!1}const nr=/\/emsg[-/]ID3/i,ir=(e,t)=>{let n=0,i=5;t+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=e[t];const o=Math.min(i,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,n=n?n<<o|r[0]:r[0],t+=1,i-=o}return n};function rr(e,t,n,i,r){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const s=t[n+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],o=63&t[n+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+s];if(n+l>t.length)return-1;const c=t[n+6]>>5;let d=0;2===c?d+=2:(1&c&&1!==c&&(d+=2),4&c&&(d+=2));const u=(t[n+6]<<8|t[n+7])>>12-d&1,h=[2,1,2,3,3,4,4,5][c]+u,p=t[n+5]>>3,f=7&t[n+5],m=new Uint8Array([s<<6|p<<1|f>>2,(3&f)<<6|c<<3|u<<2|o>>4,o<<4&224]),g=i+r*(1536/a*9e4),y=t.subarray(n,n+l);return e.config=m,e.channelCount=h,e.samplerate=a,e.samples.push({unit:y,pts:g}),l}class sr{constructor(){this.VideoSample=null}createVideoSample(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}getLastNalUnit(e){var t;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&Z.log(e.pts+"/"+e.dts+":"+e.debug)}}class ar{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&Z.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,n=8,i=8;for(let r=0;r<e;r++)0!==i&&(t=this.readEG(),i=(n+t+256)%256),n=0===i?n:i}readSPS(){let e,t,n,i=0,r=0,s=0,a=0;const o=this.readUByte.bind(this),l=this.readBits.bind(this),c=this.readUEG.bind(this),d=this.readBoolean.bind(this),u=this.skipBits.bind(this),h=this.skipEG.bind(this),p=this.skipUEG.bind(this),f=this.skipScalingList.bind(this);o();const m=o();if(l(5),u(3),o(),p(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){const e=c();if(3===e&&u(1),p(),p(),u(1),d())for(t=3!==e?8:12,n=0;n<t;n++)d()&&f(n<6?16:64)}p();const g=c();if(0===g)c();else if(1===g)for(u(1),h(),h(),e=c(),n=0;n<e;n++)h();p(),u(1);const y=c(),v=c(),b=l(1);0===b&&u(1),u(1),d()&&(i=c(),r=c(),s=c(),a=c());let _=[1,1];if(d()&&d())switch(o()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[o()<<8|o(),o()<<8|o()]}return{width:Math.ceil(16*(y+1)-2*i-2*r),height:(2-b)*(v+1)*16-(b?2:4)*(s+a),pixelRatio:_}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class or extends sr{parseAVCPES(e,t,n,i,r){const s=this.parseAVCNALu(e,n.data);let a,o=this.VideoSample,l=!1;n.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),s.forEach((i=>{var s;switch(i.type){case 1:{let t=!1;a=!0;const r=i.data;if(l&&r.length>4){const e=new ar(r).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var c;t&&null!=(c=o)&&c.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.frame=!0,o.key=t;break}case 5:a=!0,null!=(s=o)&&s.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.key=!0,o.frame=!0;break;case 6:a=!0,ht(i.data,1,n.pts,t.samples);break;case 7:{var d,u;a=!0,l=!0;const t=i.data,n=new ar(t).readSPS();if(!e.sps||e.width!==n.width||e.height!==n.height||(null==(d=e.pixelRatio)?void 0:d[0])!==n.pixelRatio[0]||(null==(u=e.pixelRatio)?void 0:u[1])!==n.pixelRatio[1]){e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t],e.duration=r;const i=t.subarray(1,4);let s="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),s+=t}e.codec=s}break}case 8:a=!0,e.pps=[i.data];break;case 9:a=!0,e.audFound=!0,o&&this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:a=!0;break;default:a=!1,o&&(o.debug+="unknown NAL "+i.type+" ")}o&&a&&o.units.push(i)})),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const r=i,s=[];let a,o,l,c=0,d=-1,u=0;for(-1===i&&(d=0,u=31&t[0],i=0,c=1);c<n;)if(a=t[c++],i)if(1!==i)if(a)if(1===a){if(o=c-i-1,d>=0){const e={data:t.subarray(d,o),type:u};s.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(r&&c<=4-r&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-r)),o>0&&(n.data=ct(n.data,t.subarray(0,o)),n.state=0))}c<n?(l=31&t[c],d=c,u=l,i=0):i=-1}else i=0;else i=3;else i=a?0:2;else i=a?0:1;if(d>=0&&i>=0){const e={data:t.subarray(d,n),type:u,state:i};s.push(e)}if(0===s.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=ct(n.data,t))}return e.naluState=i,s}}class lr{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new _i(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then((r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}))}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,n),this.decrypter.isSync())))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)n.set(e.subarray(t,t+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)e.set(n.subarray(i,i+16),t);return e}decryptAvcSample(e,t,n,i,r){const s=pt(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then((a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)}))}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;!(n>=r.length);n++){const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type||(this.decryptAvcSample(e,t,n,i,s),this.decrypter.isSync())))return}}}}const cr=188;class dr{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new or}static probe(e){const t=dr.syncOffset(e);return t>0&&Z.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let n=Math.min(940,t-cr)+1,i=0;for(;i<n;){let r=!1,s=-1,a=0;for(let o=i;o<t;o+=cr){if(71!==e[o]||t-o!==cr&&71!==e[o+cr]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+18612,e.length-cr)+1)),r||(r=0===ur(e,o)),r&&a>1&&(0===s&&a>2||o+cr>n))return s}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Ye[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=dr.createTrack("video"),this._audioTrack=dr.createTrack("audio",i),this._id3Track=dr.createTrack("id3"),this._txtTrack=dr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){let r;n||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let c=s.pid,d=s.pesData,u=a.pid,h=o.pid,p=a.pesData,f=o.pesData,m=null,g=this.pmtParsed,y=this._pmtId,v=e.length;if(this.remainderData&&(v=(e=ct(this.remainderData,e)).length,this.remainderData=null),v<cr&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};const b=Math.max(0,dr.syncOffset(e));v-=(v-b)%cr,v<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,v,e.buffer.byteLength-v));let _=0;for(let t=b;t<v;t+=cr)if(71===e[t]){const i=!!(64&e[t+1]),v=ur(e,t);let _;if((48&e[t+3])>>4>1){if(_=t+5+e[t+4],_===t+cr)continue}else _=t+4;switch(v){case c:i&&(d&&(r=gr(d))&&this.videoParser.parseAVCPES(s,l,r,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(e.subarray(_,t+cr)),d.size+=t+cr-_);break;case u:if(i){if(p&&(r=gr(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r);break;case"ac3":this.parseAC3PES(a,r)}p={data:[],size:0}}p&&(p.data.push(e.subarray(_,t+cr)),p.size+=t+cr-_);break;case h:i&&(f&&(r=gr(f))&&this.parseID3PES(o,r),f={data:[],size:0}),f&&(f.data.push(e.subarray(_,t+cr)),f.size+=t+cr-_);break;case 0:i&&(_+=e[_]+1),y=this._pmtId=hr(e,_);break;case y:{i&&(_+=e[_]+1);const r=pr(e,_,this.typeSupported,n,this.observer);c=r.videoPid,c>0&&(s.pid=c,s.segmentCodec=r.segmentVideoCodec),u=r.audioPid,u>0&&(a.pid=u,a.segmentCodec=r.segmentAudioCodec),h=r.id3Pid,h>0&&(o.pid=h),null===m||g||(Z.warn(`MPEG-TS PMT found at ${t} after unknown PID '${m}'. Backtracking to sync byte @${b} to parse all TS packets.`),m=null,t=b-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=v}}else _++;_>0&&fr(this.observer,new Error(`Found ${_} TS packet/s that do not start with 0x47`)),s.pesData=d,a.pesData=p,o.pesData=f;const w={audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};return i&&this.extractRemainingSamples(w),w}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,s=n.pesData,a=t.pesData,o=i.pesData;let l;if(s&&(l=gr(s))?(this.videoParser.parseAVCPES(n,r,l,!0,this._duration),n.pesData=null):n.pesData=s,a&&(l=gr(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break;case"ac3":this.parseAC3PES(t,l)}t.pesData=null}else null!=a&&a.size&&Z.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(l=gr(o))?(this.parseID3PES(i,l),i.pesData=null):i.pesData=o}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new lr(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise((n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,(()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)})):n(e)})):r.samples&&t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)}))}))}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,s,a,o=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t)o=ct(i.sample.unit,o);else{const s=r-t;i.sample.unit.set(o.subarray(0,t),s),e.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1&&!Gi(o,r);r++);if(r!==n){let e;const t=r<s-1;if(e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",fr(this.observer,new Error(e),t),!t)return}if(qi(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!i)return void Z.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=zi(e.samplerate);a=i.sample.pts+t}}let l,c=0;for(;r<s;){if(l=ji(e,o,r,a,c),r+=l.length,l.missing){this.aacOverFlow=l;break}for(c++;r<s-1&&!Gi(o,r);r++);}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,s=0;const a=t.pts;if(void 0!==a)for(;s<i;)if(er(n,s)){const t=Zi(e,n,s,a,r);if(!t)break;s+=t.length,r++}else s++;else Z.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(void 0===i)return void Z.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let s,a=0,o=0;for(;o<r&&(s=rr(e,n,o,i,a++))>0;)o+=s}}parseID3PES(e,t){if(void 0===t.pts)return void Z.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=G({},t,{type:this._videoTrack?dn:cn,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function ur(e,t){return((31&e[t+1])<<8)+e[t+2]}function hr(e,t){return(31&e[t+10])<<8|e[t+11]}function pr(e,t,n,i,r){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){const a=ur(e,t),o=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){mr("ADTS AAC");break}case 15:-1===s.audioPid&&(s.audioPid=a);break;case 21:-1===s.id3Pid&&(s.id3Pid=a);break;case 219:if(!i){mr("H.264");break}case 27:-1===s.videoPid&&(s.videoPid=a,s.segmentVideoCodec="avc");break;case 3:case 4:n.mpeg||n.mp3?-1===s.audioPid&&(s.audioPid=a,s.segmentAudioCodec="mp3"):Z.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){mr("AC-3");break}case 129:n.ac3?-1===s.audioPid&&(s.audioPid=a,s.segmentAudioCodec="ac3"):Z.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===s.audioPid&&o>0){let i=t+5,r=o;for(;r>2;){106===e[i]&&(!0!==n.ac3?Z.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=a,s.segmentAudioCodec="ac3"));const t=e[i+1]+2;i+=t,r-=t}}break;case 194:case 135:return fr(r,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return fr(r,new Error("Unsupported HEVC in M2TS found")),s}t+=o+5}return s}function fr(e,t,n){Z.warn(`parsing error: ${t.message}`),e.emit(j.ERROR,j.ERROR,{type:V.MEDIA_ERROR,details:Y.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function mr(e){Z.log(`${e} with AES-128-CBC encryption found in unencrypted stream`)}function gr(e){let t,n,i,r,s,a=0;const o=e.data;if(!e||0===e.size)return null;for(;o[0].length<19&&o.length>1;)o[0]=ct(o[0],o[1]),o.splice(1,1);if(t=o[0],1===(t[0]<<16)+(t[1]<<8)+t[2]){if(n=(t[4]<<8)+t[5],n&&n>e.size-6)return null;const l=t[7];192&l&&(r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,r-s>54e5&&(Z.warn(`${Math.round((r-s)/9e4)}s delta between PTS and DTS, align them`),r=s)):s=r),i=t[8];let c=i+9;if(e.size<=c)return null;e.size-=c;const d=new Uint8Array(e.size);for(let e=0,n=o.length;e<n;e++){t=o[e];let n=t.byteLength;if(c){if(c>n){c-=n;continue}t=t.subarray(c),n-=c,c=0}d.set(t,a),a+=n}return n&&(n-=i+3),{data:d,pts:r,dts:s,len:n}}return null}class yr{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const vr=Math.pow(2,32)-1;class br{static init(){let e;for(e in br.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},br.types)br.types.hasOwnProperty(e)&&(br.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);br.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);br.STTS=br.STSC=br.STCO=r,br.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),br.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),br.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),br.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);br.FTYP=br.box(br.types.ftyp,s,o,s,a),br.DINF=br.box(br.types.dinf,br.box(br.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;for(;i--;)n+=t[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(e,4),i=0,n=8;i<r;i++)s.set(t[i],n),n+=t[i].byteLength;return s}static hdlr(e){return br.box(br.types.hdlr,br.HDLR_TYPES[e])}static mdat(e){return br.box(br.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(vr+1)),i=Math.floor(t%(vr+1));return br.box(br.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return br.box(br.types.mdia,br.mdhd(e.timescale,e.duration),br.hdlr(e.type),br.minf(e))}static mfhd(e){return br.box(br.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?br.box(br.types.minf,br.box(br.types.smhd,br.SMHD),br.DINF,br.stbl(e)):br.box(br.types.minf,br.box(br.types.vmhd,br.VMHD),br.DINF,br.stbl(e))}static moof(e,t,n){return br.box(br.types.moof,br.mfhd(e),br.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=br.trak(e[t]);return br.box.apply(null,[br.types.moov,br.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(br.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=br.trex(e[t]);return br.box.apply(null,[br.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(vr+1)),i=Math.floor(t%(vr+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return br.box(br.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return br.box(br.types.sdtp,n)}static stbl(e){return br.box(br.types.stbl,br.stsd(e),br.box(br.types.stts,br.STTS),br.box(br.types.stsc,br.STSC),br.box(br.types.stsz,br.STSZ),br.box(br.types.stco,br.STCO))}static avc1(e){let t,n,i,r=[],s=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=br.box(br.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,l=e.height,c=e.pixelRatio[0],d=e.pixelRatio[1];return br.box(br.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,br.box(br.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),br.box(br.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return br.box(br.types.mp4a,br.audioStsd(e),br.box(br.types.esds,br.esds(e)))}static mp3(e){return br.box(br.types[".mp3"],br.audioStsd(e))}static ac3(e){return br.box(br.types["ac-3"],br.audioStsd(e),br.box(br.types.dac3,e.config))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?br.box(br.types.stsd,br.STSD,br.mp3(e)):"ac3"===e.segmentCodec?br.box(br.types.stsd,br.STSD,br.ac3(e)):br.box(br.types.stsd,br.STSD,br.mp4a(e)):br.box(br.types.stsd,br.STSD,br.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,r=e.height,s=Math.floor(n/(vr+1)),a=Math.floor(n%(vr+1));return br.box(br.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=br.sdtp(e),i=e.id,r=Math.floor(t/(vr+1)),s=Math.floor(t%(vr+1));return br.box(br.types.traf,br.box(br.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),br.box(br.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),br.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,br.box(br.types.trak,br.tkhd(e),br.mdia(e))}static trex(e){const t=e.id;return br.box(br.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,l,c,d,u;for(t+=8+r,s.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<i;a++)o=n[a],l=o.duration,c=o.size,d=o.flags,u=o.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*a);return br.box(br.types.trun,s)}static initSegment(e){br.types||br.init();const t=br.moov(e);return ct(br.FTYP,t)}}br.types=void 0,br.HDLR_TYPES=void 0,br.STTS=void 0,br.STSC=void 0,br.STCO=void 0,br.STSZ=void 0,br.VMHD=void 0,br.SMHD=void 0,br.STSD=void 0,br.FTYP=void 0,br.DINF=void 0;function _r(e,t,n=1,i=!1){const r=e*t*n;return i?Math.round(r):r}function wr(e,t=!1){return _r(e,1e3,1/9e4,t)}let Er,Tr=null,Sr=null;class xr{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===Tr){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Tr=e?parseInt(e[1]):0}if(null===Sr){const e=navigator.userAgent.match(/Safari\/(\d+)/i);Sr=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){Z.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){Z.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){Z.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce(((e,i)=>{let r=i.pts,s=r-e;return s<-4294967296&&(t=!0,r=kr(r,n),s=r-e),s>0?e:r}),n);return t&&Z.debug("PTS rollover detected"),i}remux(e,t,n,i,r,s,a,o){let l,c,d,u,h,p,f=r,m=r;const g=e.pid>-1,y=t.pid>-1,v=t.samples.length,b=e.samples.length>0,_=a&&v>0||v>1;if((!g||b)&&(!y||_)||this.ISGenerated||a){if(this.ISGenerated){var w,E,T,S;const e=this.videoTrackConfig;!e||t.width===e.width&&t.height===e.height&&(null==(w=t.pixelRatio)?void 0:w[0])===(null==(E=e.pixelRatio)?void 0:E[0])&&(null==(T=t.pixelRatio)?void 0:T[1])===(null==(S=e.pixelRatio)?void 0:S[1])||this.resetInitSegment()}else d=this.generateIS(e,t,r,s);const n=this.isVideoContiguous;let i,a=-1;if(_&&(a=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,a>0){Z.warn(`[mp4-remuxer]: Dropped ${a} out of ${v} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,m+=(t.samples[0].pts-e)/t.inputTimeScale,i=m}else-1===a&&(Z.warn(`[mp4-remuxer]: No keyframe found out of ${v} video samples`),p=!1);if(this.ISGenerated){if(b&&_){const n=this.getVideoStartPts(t.samples),i=(kr(e.samples[0].pts,n)-n)/t.inputTimeScale;f+=Math.max(0,i),m+=Math.max(0,-i)}if(b){if(e.samplerate||(Z.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,r,s)),c=this.remuxAudio(e,f,this.isAudioContiguous,s,y||_||o===Jt?m:void 0),_){const i=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(Z.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,r,s)),l=this.remuxVideo(t,m,n,i)}}else _&&(l=this.remuxVideo(t,m,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(h=Cr(n,r,this._initPTS,this._initDTS)),i.samples.length&&(u=Lr(i,r,this._initPTS))),{audio:c,video:l,initSegment:d,independent:p,text:u,id3:h}}generateIS(e,t,n,i){const r=e.samples,s=t.samples,a=this.typeSupported,o={},l=this._initPTS;let c,d,u,h=!l||i,p="audio/mp4";if(h&&(c=d=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(p="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}o.audio={id:"audio",container:p,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):br.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(u=e.inputTimeScale,l&&u===l.timescale?h=!1:c=d=r[0].pts-Math.round(u*n))}if(t.sps&&t.pps&&s.length){if(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:br.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(u=t.inputTimeScale,l&&u===l.timescale)h=!1;else{const e=this.getVideoStartPts(s),t=Math.round(u*n);d=Math.min(d,kr(s[0].dts,e)-t),c=Math.min(c,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:c,timescale:u},this._initDTS={baseTime:d,timescale:u}):c=u=void 0,{tracks:o,initPTS:c,timescale:u}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,s=e.samples,a=[],o=s.length,l=this._initPTS;let c,d,u=this.nextAvcDts,h=8,p=this.videoSampleDuration,f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,g=!1;if(!n||null===u){const e=t*r,i=s[0].pts-kr(s[0].dts,s[0].pts);Tr&&null!==u&&Math.abs(e-i-u)<15e3?n=!0:u=e-i}const y=l.baseTime*r/l.timescale;for(let e=0;e<o;e++){const t=s[e];t.pts=kr(t.pts-y,u),t.dts=kr(t.dts-y,u),t.dts<s[e>0?e-1:e].dts&&(g=!0)}g&&s.sort((function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i})),c=s[0].dts,d=s[s.length-1].dts;const v=d-c,b=v?Math.round(v/(o-1)):p||e.inputTimeScale/30;if(n){const e=c-u,n=e>b,i=e<-1;if((n||i)&&(n?Z.warn(`AVC: ${wr(e,!0)} ms (${e}dts) hole between fragments detected at ${t.toFixed(3)}`):Z.warn(`AVC: ${wr(-e,!0)} ms (${e}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!i||u>=s[0].pts||Tr)){c=u;const t=s[0].pts-e;if(n)s[0].dts=c,s[0].pts=t;else for(let n=0;n<s.length&&!(s[n].dts>t);n++)s[n].dts-=e,s[n].pts-=e;Z.log(`Video: Initial PTS/DTS adjusted: ${wr(t,!0)}/${wr(c,!0)}, delta: ${wr(e,!0)} ms`)}}c=Math.max(0,c);let _=0,w=0,E=c;for(let e=0;e<o;e++){const t=s[e],n=t.units,i=n.length;let r=0;for(let e=0;e<i;e++)r+=n[e].data.length;w+=r,_+=i,t.length=r,t.dts<E?(t.dts=E,E+=b/4|0||1):E=t.dts,f=Math.min(t.pts,f),m=Math.max(t.pts,m)}d=s[o-1].dts;const T=w+4*_+8;let S;try{S=new Uint8Array(T)}catch(e){return void this.observer.emit(j.ERROR,j.ERROR,{type:V.MUX_ERROR,details:Y.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:T,reason:`fail allocating video mdat ${T}`})}const x=new DataView(S.buffer);x.setUint32(0,T),S.set(br.types.mdat,4);let k=!1,C=Number.POSITIVE_INFINITY,L=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,R=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e++){const t=s[e],n=t.units;let l,c=0;for(let e=0,t=n.length;e<t;e++){const t=n[e],i=t.data,r=t.data.byteLength;x.setUint32(h,r),h+=4,S.set(i,h),h+=r,c+=4+r}if(e<o-1)p=s[e+1].dts-t.dts,l=s[e+1].pts-t.pts;else{const n=this.config,a=e>0?t.dts-s[e-1].dts:b;if(l=e>0?t.pts-s[e-1].pts:b,n.stretchShortVideoTrack&&null!==this.nextAudioPts){const e=Math.floor(n.maxBufferHole*r),s=(i?f+i*r:this.nextAudioPts)-t.pts;s>e?(p=s-a,p<0?p=a:k=!0,Z.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=a}else p=a}const d=Math.round(t.pts-t.dts);C=Math.min(C,p),A=Math.max(A,p),L=Math.min(L,l),R=Math.max(R,l),a.push(new Ar(t.key,p,c,d))}if(a.length)if(Tr){if(Tr<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(Sr&&R-L<A-C&&b/A<.025&&0===a[0].cts){Z.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=c;for(let t=0,n=a.length;t<n;t++){const i=e+a[t].duration,r=e+a[t].cts;if(t<n-1){const e=i+a[t+1].cts;a[t].duration=e-r}else a[t].duration=t?a[t-1].duration:b;a[t].cts=0,e=i}}p=k||!p?b:p,this.nextAvcDts=u=d+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const I={data1:br.moof(e.sequenceNumber++,c,G({},e,{samples:a})),data2:S,startPTS:f/r,endPTS:(m+p)/r,startDTS:c/r,endDTS:u/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,I}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(e,t,n,i,r){const s=e.inputTimeScale,a=s/(e.samplerate?e.samplerate:s),o=this.getSamplesPerFrame(e),l=o*a,c=this._initPTS,d="mp3"===e.segmentCodec&&this.typeSupported.mpeg,u=[],h=void 0!==r;let p=e.samples,f=d?0:8,m=this.nextAudioPts||-1;const g=t*s,y=c.baseTime*s/c.timescale;if(this.isAudioContiguous=n=n||p.length&&m>0&&(i&&Math.abs(g-m)<9e3||Math.abs(kr(p[0].pts-y,g)-m)<20*l),p.forEach((function(e){e.pts=kr(e.pts-y,g)})),!n||m<0){if(p=p.filter((e=>e.pts>=0)),!p.length)return;m=0===r?0:i&&!h?Math.max(0,g):p[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=m;n<p.length;n++){const r=p[n],a=r.pts,o=a-i,c=Math.abs(1e3*o/s);if(o<=-t*l&&h)0===n&&(Z.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/s)} ms.`),this.nextAudioPts=m=i=a);else if(o>=t*l&&c<1e4&&h){let t=Math.round(o/l);i=a-t*l,i<0&&(t--,i+=l),0===n&&(this.nextAudioPts=m=i),Z.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(i/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let s=0;s<t;s++){const t=Math.max(i,0);let s=yr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);s||(Z.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),s=r.unit.subarray()),p.splice(n,0,{unit:s,pts:t}),i+=l,n++}}r.pts=i,i+=l}}let v,b=null,_=null,w=0,E=p.length;for(;E--;)w+=p[E].unit.byteLength;for(let t=0,i=p.length;t<i;t++){const i=p[t],r=i.unit;let s=i.pts;if(null!==_)u[t-1].duration=Math.round((s-_)/a);else{if(n&&"aac"===e.segmentCodec&&(s=m),b=s,!(w>0))return;w+=f;try{v=new Uint8Array(w)}catch(e){return void this.observer.emit(j.ERROR,j.ERROR,{type:V.MUX_ERROR,details:Y.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:w,reason:`fail allocating audio mdat ${w}`})}d||(new DataView(v.buffer).setUint32(0,w),v.set(br.types.mdat,4))}v.set(r,f);const l=r.byteLength;f+=l,u.push(new Ar(!0,o,l,0)),_=s}const T=u.length;if(!T)return;const S=u[u.length-1];this.nextAudioPts=m=_+a*S.duration;const x=d?new Uint8Array(0):br.moof(e.sequenceNumber++,b/a,G({},e,{samples:u}));e.samples=[];const k=b/s,C=m/s,L={data1:x,data2:v,startPTS:k,endPTS:C,startDTS:k,endDTS:C,type:"audio",hasAudio:!0,hasVideo:!1,nb:T};return this.isAudioContiguous=!0,L}remuxEmptyAudio(e,t,n,i){const r=e.inputTimeScale,s=r/(e.samplerate?e.samplerate:r),a=this.nextAudioPts,o=this._initDTS,l=9e4*o.baseTime/o.timescale,c=(null!==a?a:i.startDTS*r)+l,d=i.endDTS*r+l,u=1024*s,h=Math.ceil((d-c)/u),p=yr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(Z.warn("[mp4-remuxer]: remux empty Audio"),!p)return void Z.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const f=[];for(let e=0;e<h;e++){const t=c+e*u;f.push({unit:p,pts:t,dts:t})}return e.samples=f,this.remuxAudio(e,t,n,!1)}}function kr(e,t){let n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function Cr(e,t,n,i){const r=e.samples.length;if(!r)return;const s=e.inputTimeScale;for(let a=0;a<r;a++){const r=e.samples[a];r.pts=kr(r.pts-n.baseTime*s/n.timescale,t*s)/s,r.dts=kr(r.dts-i.baseTime*s/i.timescale,t*s)/s}const a=e.samples;return e.samples=[],{samples:a}}function Lr(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let s=0;s<i;s++){const i=e.samples[s];i.pts=kr(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort(((e,t)=>e.pts-t.pts));const s=e.samples;return e.samples=[],{samples:s}}class Ar{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}function Rr(e,t){const n=null==e?void 0:e.codec;if(n&&n.length>4)return n;if(t===re){if("ec-3"===n||"ac-3"===n||"alac"===n)return n;if("fLaC"===n||"Opus"===n)return Dt(n,!1);const e="mp4a.40.5";return Z.info(`Parsed audio codec "${n}" or audio object type not handled. Using "${e}"`),e}return Z.warn(`Unhandled video codec "${n}"`),"hvc1"===n||"hev1"===n?"hvc1.1.6.L120.90":"av01"===n?"av01.0.04M.08":"avc1.42e01e"}try{Er=self.performance.now.bind(self.performance)}catch(e){Z.debug("Unable to use Performance API on this environment"),Er=null==pe?void 0:pe.Date.now}const Ir=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=Oi("video",1),s=this.audioTrack=Oi("audio",1),a=this.txtTrack=Oi("text",1);if(this.id3Track=Oi("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=nt(e);if(o.video){const{id:e,timescale:t,codec:n}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=n}if(o.audio){const{id:e,timescale:t,codec:n}=o.audio;s.id=e,s.timescale=t,s.codec=n}a.id=Ye.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return function(e){const t=e.byteLength;for(let n=0;n<t;){const i=Xe(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=ct(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},n=et(e,["moof"]);if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=ke(e,0,i.byteOffset-8),t.remainder=ke(e,i.byteOffset-8),t}(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,t);return r.samples=dt(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=dt(e,t),{videoTrack:t,audioTrack:Oi(),id3Track:i,textTrack:Oi()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=et(e.samples,["emsg"]);i&&i.forEach((e=>{const i=function(e){const t=e[0];let n="",i="",r=0,s=0,a=0,o=0,l=0,c=0;if(0===t){for(;"\0"!==Ke(e.subarray(c,c+1));)n+=Ke(e.subarray(c,c+1)),c+=1;for(n+=Ke(e.subarray(c,c+1)),c+=1;"\0"!==Ke(e.subarray(c,c+1));)i+=Ke(e.subarray(c,c+1)),c+=1;i+=Ke(e.subarray(c,c+1)),c+=1,r=Xe(e,12),s=Xe(e,16),o=Xe(e,20),l=Xe(e,24),c=28}else if(1===t){c+=4,r=Xe(e,c),c+=4;const t=Xe(e,c);c+=4;const s=Xe(e,c);for(c+=4,a=2**32*t+s,q(a)||(a=Number.MAX_SAFE_INTEGER,Z.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Xe(e,c),c+=4,l=Xe(e,c),c+=4;"\0"!==Ke(e.subarray(c,c+1));)n+=Ke(e.subarray(c,c+1)),c+=1;for(n+=Ke(e.subarray(c,c+1)),c+=1;"\0"!==Ke(e.subarray(c,c+1));)i+=Ke(e.subarray(c,c+1)),c+=1;i+=Ke(e.subarray(c,c+1)),c+=1}return{schemeIdUri:n,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:e.subarray(c,e.byteLength)}}(e);if(nr.test(i.schemeIdUri)){const e=H(i.presentationTime)?i.presentationTime/i.timeScale:t+i.presentationTimeDelta/i.timeScale;let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:dn,duration:r})}}))}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(function(e,t){if(!e||!t)return e;const n=t.keyId;return n&&t.isCommonEncryption&&et(e,["moov","trak"]).forEach((e=>{const t=et(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let i=et(t,["enca"]);const r=i.length>0;r||(i=et(t,["encv"])),i.forEach((e=>{et(r?e.subarray(28):e.subarray(78),["sinf"]).forEach((e=>{const t=ot(e);if(t){const e=t.subarray(8,24);e.some((e=>0!==e))||(Z.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${ze(e)} -> ${ze(n)}`),t.set(n,8))}}))}))})),e}(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const i=this.initData=nt(e);i.audio&&(t=Rr(i.audio,re)),i.video&&(n=Rr(i.video,se));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:Z.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,i,r,s){var a,o;let{initPTS:l,lastEndTime:c}=this;const d={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};H(c)||(c=this.lastEndTime=r||0);const u=t.samples;if(null==u||!u.length)return d;const h={initPTS:void 0,timescale:1};let p=this.initData;if(null!=(a=p)&&a.length||(this.generateInitSegment(u),p=this.initData),null==(o=p)||!o.length)return Z.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const f=function(e,t){let n=0,i=0,r=0;const s=et(e,["moof","traf"]);for(let e=0;e<s.length;e++){const a=s[e],o=et(a,["tfhd"])[0],l=t[Xe(o,4)];if(!l)continue;const c=l.default,d=Xe(o,0)|(null==c?void 0:c.flags);let u=null==c?void 0:c.duration;8&d&&(u=Xe(o,2&d?12:8));const h=l.timescale||9e4,p=et(a,["trun"]);for(let e=0;e<p.length;e++)n=lt(p[e]),!n&&u&&(n=u*Xe(p[e],4)),l.type===se?i+=n/h:l.type===re&&(r+=n/h)}if(0===i&&0===r){let t=1/0,n=0,i=0;const r=et(e,["sidx"]);for(let e=0;e<r.length;e++){const s=tt(r[e]);if(null!=s&&s.references){t=Math.min(t,s.earliestPresentationTime/s.timescale);const e=s.references.reduce(((e,t)=>e+t.info.duration||0),0);n=Math.max(n,e+s.earliestPresentationTime/s.timescale),i=n-t}}if(i&&H(i))return i}return i||r}(u,p),m=function(e,t){return et(t,["moof","traf"]).reduce(((t,n)=>{const i=et(n,["tfdt"])[0],r=i[0],s=et(n,["tfhd"]).reduce(((t,n)=>{const s=Xe(n,4),a=e[s];if(a){let e=Xe(i,4);if(1===r){if(e===je)return Z.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=je+1,e+=Xe(i,8)}const n=e/(a.timescale||9e4);if(H(n)&&(null===t||n<t))return n}return t}),null);return null!==s&&H(s)&&(null===t||s<t)?s:t}),null)}(p,u),g=null===m?r:m;(function(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),s=t-e.baseTime/e.timescale;return Math.abs(s-n)>r}(l,g,r,f)||h.timescale!==l.timescale&&s)&&(h.initPTS=g-r,l&&1===l.timescale&&Z.warn("Adjusting initPTS by "+(h.initPTS-l.baseTime)),this.initPTS=l={baseTime:h.initPTS,timescale:1});const y=e?g-l.baseTime/l.timescale:c,v=y+f;!function(e,t,n){et(t,["moof","traf"]).forEach((t=>{et(t,["tfhd"]).forEach((i=>{const r=Xe(i,4),s=e[r];if(!s)return;const a=s.timescale||9e4;et(t,["tfdt"]).forEach((e=>{const t=e[0],i=n*a;if(i){let n=Xe(e,4);if(0===t)n-=i,n=Math.max(n,0),Qe(e,4,n);else{n*=Math.pow(2,32),n+=Xe(e,8),n-=i,n=Math.max(n,0);const t=Math.floor(n/(je+1)),r=Math.floor(n%(je+1));Qe(e,4,t),Qe(e,8,r)}}}))}))}))}(p,u,l.baseTime/l.timescale),f>0?this.lastEndTime=v:(Z.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const b=!!p.audio,_=!!p.video;let w="";b&&(w+="audio"),_&&(w+="video");const E={data1:u,startPTS:y,startDTS:y,endPTS:v,endDTS:v,type:w,hasAudio:b,hasVideo:_,nb:1,dropped:0};return d.audio="audio"===E.type?E:void 0,d.video="audio"!==E.type?E:void 0,d.initSegment=h,d.id3=Cr(n,r,l,l),i.samples.length&&(d.text=Lr(i,r,l)),d}}},{demux:dr,remux:xr},{demux:class extends Ni{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Ae(e,0);let n=(null==t?void 0:t.length)||0;if(tr(e,n))return!1;for(let t=e.length;n<t;n++)if(Hi(e,n))return Z.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&Bi(e,t)&&$i(e,t)<=e.length-t}(e,t)}appendFrame(e,t,n){qi(e,this.observer,t,n,e.manifestCodec);const i=ji(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}},remux:xr},{demux:class extends Ni{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Ae(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==De(t)&&ir(e,n)<=16)return!1;for(let t=e.length;n<t;n++)if(tr(e,n))return Z.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return Qi(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return Zi(e,t,n,this.basePTS,this.frameIndex)}},remux:xr}];Ir.splice(2,0,{demux:class extends Ni{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=rr(e,t,n,this.basePTS,this.frameIndex);if(-1!==i)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=Ae(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==De(t)&&ir(e,n)<16}},remux:xr});class Dr{constructor(e,t,n,i,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=r}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=Er();let s=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:o}=this;i&&(this.currentTransmuxState=i);const{contiguous:l,discontinuity:c,trackSwitch:d,accurateTimeOffset:u,timeOffset:h,initSegmentChange:p}=i||a,{audioCodec:f,videoCodec:m,defaultInitPts:g,duration:y,initSegmentData:v}=o,b=function(e,t){let n=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t),n}(s,t);if(b&&"AES-128"===b.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(s,b.key.buffer,b.iv.buffer).then((e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t})),this.decryptionPromise;{let t=e.softwareDecrypt(s,b.key.buffer,b.iv.buffer);if(n.part>-1&&(t=e.flush()),!t)return r.executeEnd=Er(),Pr(n);s=new Uint8Array(t)}}const _=this.needsProbing(c,d);if(_){const e=this.configureTransmuxer(s);if(e)return Z.warn(`[transmuxer] ${e.message}`),this.observer.emit(j.ERROR,j.ERROR,{type:V.MEDIA_ERROR,details:Y.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=Er(),Pr(n)}(c||d||p||_)&&this.resetInitSegment(v,f,m,y,t),(c||p||_)&&this.resetInitialTimestamp(g),l||this.resetContiguity();const w=this.transmux(s,b,h,u,n),E=this.currentTransmuxState;return E.contiguous=!0,E.discontinuity=!1,E.trackSwitch=!1,r.executeEnd=Er(),w}flush(e){const t=e.transmuxing;t.executeStart=Er();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return r.then((()=>this.flush(e)));const s=[],{timeOffset:a}=i;if(n){const t=n.flush();t&&s.push(this.push(t,null,e))}const{demuxer:o,remuxer:l}=this;if(!o||!l)return t.executeEnd=Er(),[Pr(e)];const c=o.flush(a);return Mr(c)?c.then((t=>(this.flushRemux(s,t,e),s))):(this.flushRemux(s,c,e),s)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;Z.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const c=this.remuxer.remux(i,r,s,a,l,o,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=Er()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),s}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,s,a,o,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then((e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id),chunkMeta:r})))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:r}=this;let s;for(let t=0,n=Ir.length;t<n;t++){var a;if(null!=(a=Ir[t].demux)&&a.probe(e)){s=Ir[t];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,c=s.remux,d=s.demux;l&&l instanceof c||(this.remuxer=new c(n,t,i,r)),o&&o instanceof d||(this.demuxer=new d(n,t,i),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new _i(this.config)),e}}const Pr=e=>({remuxResult:{},chunkMeta:e});function Mr(e){return"then"in e&&e.then instanceof Function}class Or{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class Nr{constructor(e,t,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}var Fr={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,d=this._events[o],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,i),!0;case 4:return d.fn.call(d.context,t,i,r),!0;case 5:return d.fn.call(d.context,t,i,r,s),!0;case 6:return d.fn.call(d.context,t,i,r,s,a),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var h,p=d.length;for(c=0;c<p;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,i);break;case 4:d[c].fn.call(d[c].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];d[c].fn.apply(d[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],d=o.length;l<d;l++)(o[l].fn!==t||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(Fr);var Br=R(Fr.exports);class Ur{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(e,t)=>{(t=t||{}).frag=this.frag,t.id=this.id,e===j.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new Br,this.observer.on(j.FRAG_DECRYPTED,s),this.observer.on(j.ERROR,s);const a=Tt(r.preferManagedMediaSource)||{isTypeSupported:()=>!1},o={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(!this.useWorker||"undefined"==typeof Worker||!r.workerPath&&"function"!=typeof __HLS_WORKER_BUNDLE__)this.transmuxer=new Dr(this.observer,o,r,"",t);else try{r.workerPath?(Z.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=function(e){const t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}(r.workerPath)):(Z.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e);return{worker:new self.Worker(t),objectURL:t}}()),this.onwmsg=e=>this.onWorkerMessage(e);const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{const n=new Error(`${e.message}  (${e.filename}:${e.lineno})`);r.enableWorker=!1,Z.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(j.ERROR,{type:V.OTHER_ERROR,details:Y.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:n})},e.postMessage({cmd:"init",typeSupported:o,vendor:"",id:t,config:JSON.stringify(r)})}catch(e){Z.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new Dr(this.observer,o,r,"",t)}}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,r,s,a,o,l,c){var d,u;l.transmuxing.start=self.performance.now();const{transmuxer:h}=this,p=s?s.start:r.start,f=r.decryptdata,m=this.frag,g=!(m&&r.cc===m.cc),y=!(m&&l.level===m.level),v=m?l.sn-m.sn:-1,b=this.part?l.part-this.part.index:-1,_=0===v&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),w=!y&&(1===v||0===v&&(1===b||_&&b<=0)),E=self.performance.now();(y||v||0===r.stats.parsing.start)&&(r.stats.parsing.start=E),!s||!b&&w||(s.stats.parsing.start=E);const T=!(m&&(null==(d=r.initSegment)?void 0:d.url)===(null==(u=m.initSegment)?void 0:u.url)),S=new Nr(g,w,o,y,p,T);if(!w||g||T){Z.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${g}\n        trackSwitch: ${y}\n        contiguous: ${w}\n        accurateTimeOffset: ${o}\n        timeOffset: ${p}\n        initSegmentChange: ${T}`);const e=new Or(n,i,t,a,c);this.configureTransmuxer(e)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:f,chunkMeta:l,state:S},e instanceof ArrayBuffer?[e]:[]);else if(h){const t=h.push(e,f,l,S);Mr(t)?(h.async=!0,t.then((e=>{this.handleTransmuxComplete(e)})).catch((e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);Mr(n)||t.async?(Mr(n)||(n=Promise.resolve(n)),n.then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}))):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach((e=>{this.handleTransmuxComplete(e)})),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(null==t||!t.event)return void Z.warn("worker message received with no "+(t?"event name":"data"));const n=this.hls;if(this.hls)switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":Z[t.data.logType]&&Z[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function $r(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Gr(e[n].attrs,t[n].attrs))return!1;return!0}function Gr(e,t,n){const i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((n=>e[n]!==t[n]))}function Hr(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}class qr{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if((n>>>=0)>i-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${i})`);return e[n][t]};this.buffered={get length(){return e.length},end:n=>t("end",n,e.length),start:n=>t("start",n,e.length)}}}class zr{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise((e=>{t=e})),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(t){Z.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${t}`),n.onError(t);const i=this.buffers[e];null!=i&&i.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const jr=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;function Vr(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach((t=>{e.removeChild(t)}))}const Yr={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Kr=e=>String.fromCharCode(Yr[e]||e),Wr=15,Xr=100,Zr={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Jr={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Qr={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},es={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ts=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class ns{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"==typeof t?t():t;Z.log(`${this.time} [${e}] ${n}`)}}}const is=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class rs{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class ss{constructor(){this.uchar=" ",this.penState=new rs}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class as{constructor(e){this.chars=[],this.pos=0,this.currPenState=new rs,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<Xr;e++)this.chars.push(new ss);this.logger=e}equals(e){for(let t=0;t<Xr;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Xr;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Xr;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Xr&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Xr)}moveCursor(e){const t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Kr(e);this.pos>=Xr?this.logger.log(0,(()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<Xr;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Xr;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class os{constructor(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Wr;t++)this.rows.push(new as(e));this.logger=e}reset(){for(let e=0;e<Wr;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let n=0;n<Wr;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Wr;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Wr;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,(()=>"pacData = "+JSON.stringify(e)));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<Wr;e++)this.rows[e].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let i=0;i<this.nrRollUpRows;i++)this.rows[t-this.nrRollUpRows+i+1].copy(n.rows[e+i])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(e))),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let n=0;n<Wr;n++){const r=this.rows[n].getTextString();r&&(i=n+1,e?t.push("Row "+i+": '"+r+"'"):t.push(r.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class ls{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new os(n),this.nonDisplayedMemory=new os(n),this.lastOutputScreen=new os(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(()=>"MODE="+e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class cs{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const i=this.logger=new ns;this.channels=[null,new ls(e,t,i),new ls(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let e=0;e<t.length;e+=2){const n=127&t[e],i=127&t[e+1];let r=!1,s=null;if(0===n&&0===i)continue;this.logger.log(3,(()=>"["+is([t[e],t[e+1]])+"] -> ("+is([n,i])+")"));const a=this.cmdHistory;if(n>=16&&n<=31){if(us(n,i,a)){ds(null,null,a),this.logger.log(3,(()=>"Repeated command ("+is([n,i])+") is dropped"));continue}ds(n,i,this.cmdHistory),r=this.parseCmd(n,i),r||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i))}else ds(null,null,a);if(!r&&(s=this.parseChars(n,i),s)){const e=this.currentChannel;e&&e>0?this.channels[e].insertChars(s):this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,(()=>"Couldn't parse cleaned data "+is([n,i])+" orig: "+is([t[e],t[e+1]])))}}parseCmd(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;const n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.currentChannel=n,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,(()=>"MIDROW ("+is([e,t])+")")),!0)}return!1}parsePAC(e,t){let n;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;const i=e<=23?1:2;n=t>=64&&t<=95?1===i?Zr[e]:Qr[e]:1===i?Jr[e]:es[e];const r=this.channels[i];return!!r&&(r.setPAC(this.interpretPAC(n,t)),this.currentChannel=i,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1==(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,(()=>"Special char '"+Kr(e)+"' in channel "+n)),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);return i&&this.logger.log(3,(()=>"Char codes =  "+is(i).join(","))),i}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;let n;const i={};16===e||24===e?(n=Math.floor((t-32)/2),i.background=ts[n],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));const r=e<=23?1:2;return this.channels[r].setBkgData(i),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}ds(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function ds(e,t,n){n.a=e,n.b=t}function us(e,t,n){return n.a===e&&n.b===t}class hs{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var ps=function(){if(null!=pe&&pe.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(e){return n(t,e)}function r(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function s(t,s,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let c="",d=!1,u=t,h=s,p=a,f=null,m="",g=!0,y="auto",v="start",b=50,_="middle",w=50,E="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return m},set:function(t){const i=function(t){return n(e,t)}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");m=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return v},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return _},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return w},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return E},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),o.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class fs{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function ms(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class gs{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function ys(e,t,n,i){const r=i?e.split(i):[e];for(const e in r){if("string"!=typeof r[e])continue;const i=r[e].split(n);2===i.length&&t(i[0],i[1])}}const vs=new ps(0,0,""),bs="middle"===vs.align?"middle":"center";function _s(e,t,n){const i=e;function r(){const t=ms(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}if(s(),t.startTime=r(),s(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),s(),t.endTime=r(),s(),function(e,t){const i=new gs;ys(e,(function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",bs,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",bs,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",bs,"end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===vs.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",bs);let s=i.get("position","auto");"auto"===s&&50===vs.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function ws(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Es{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new fs,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;for(e=ws(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^()?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let i=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:e=n(),t.state){case"HEADER":/:/.test(e)?ys(e,(function(e,t){}),/:/):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new ps(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{_s(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(i=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Ts=/\r\n|\n\r|\n|\r/g,Ss=function(e,t,n=0){return e.slice(n,n+t.length)===t},xs=function(e){let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function ks(e,t,n){return xs(e.toString())+xs(t.toString())+xs(n)}const Cs="stpp.ttml.im1t",Ls=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,As=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Rs={left:"start",center:"center",right:"end",start:"start",end:"end"};function Is(e,t,n,i){const r=et(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map((e=>Ge(e))),a=function(e,t,n=1,i=!1){return _r(e,t,1/n,i)}(t.baseTime,1,t.timescale);try{s.forEach((e=>n(function(e,t){const n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},r=Object.keys(i).reduce(((e,t)=>(e[t]=n.getAttribute(`ttp:${t}`)||i[t],e)),{}),s="preserve"!==n.getAttribute("xml:space"),a=Ps(Ds(n,"styling","style")),o=Ps(Ds(n,"layout","region")),l=Ds(n,"body","[begin]");return[].map.call(l,(e=>{const n=Ms(e,s);if(!n||!e.hasAttribute("begin"))return null;const i=Fs(e.getAttribute("begin"),r),l=Fs(e.getAttribute("dur"),r);let c=Fs(e.getAttribute("end"),r);if(null===i)throw Ns(e);if(null===c){if(null===l)throw Ns(e);c=i+l}const d=new ps(i-t,c-t,n);d.id=ks(d.startTime,d.endTime,d.text);const u=function(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return s&&n.hasOwnProperty(s)&&(r=n[s]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(((n,s)=>{const a=Os(t,i,s)||Os(e,i,s)||Os(r,i,s);return a&&(n[s]=a),n}),{})}(o[e.getAttribute("region")],a[e.getAttribute("style")],a),{textAlign:h}=u;if(h){const e=Rs[h];e&&(d.lineAlign=e),d.align=h}return G(d,u),d})).filter((e=>null!==e))}(e,a))))}catch(e){i(e)}}function Ds(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Ps(e){return e.reduce(((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e}),{})}function Ms(e,t){return[].slice.call(e.childNodes).reduce(((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?Ms(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent}),"")}function Os(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Ns(e){return new Error(`Could not parse ttml timestamp ${e}`)}function Fs(e,t){if(!e)return null;let n=ms(e);return null===n&&(Ls.test(e)?n=function(e,t){const n=Ls.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}(e,t):As.test(e)&&(n=function(e,t){const n=As.exec(e),i=Number(n[1]);switch(n[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(e,t))),n}function Bs(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function Us(e,t){return!!e&&e.kind===Bs(t)&&Hr(t,e)}class $s{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(j.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(j.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(j.MANIFEST_PARSED,this.onManifestParsed,this),e.on(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(j.BUFFER_CODECS,this.onBufferCodecs,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(j.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(j.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(j.MANIFEST_PARSED,this.onManifestParsed,this),e.off(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(j.BUFFER_CODECS,this.onBufferCodecs,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&H(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&Z.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter(((t,n)=>this.isLevelAllowed(t)&&n<=e));return this.clientRect=null,$s.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){return!this.restrictedLevels.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;let i=e.length-1;const r=Math.max(t,n);for(let t=0;t<e.length;t+=1){const n=e[t];if((n.width>=r||n.height>=r)&&(s=n,!(a=e[t+1])||s.width!==a.width||s.height!==a.height)){i=t;break}}var s,a;return i}}const Gs="[eme]";class Hs{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Hs.CDMCleanupPromise?[Hs.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=Z.debug.bind(Z,Gs),this.log=Z.log.bind(Z,Gs),this.warn=Z.warn.bind(Z,Gs),this.error=Z.error.bind(Z,Gs),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(j.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(j.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(j.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(j.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(j.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(j.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===fe.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map((e=>e.audioCodec)).filter(n),r=t.map((e=>e.videoCodec)).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise(((t,n)=>{const s=e=>{const a=e.shift();this.getMediaKeysPromise(a,i,r).then((e=>t({keySystem:a,mediaKeys:e}))).catch((t=>{e.length?s(e):n(t instanceof qs?t:new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};s(e)}))}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!=typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===Se&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=function(e,t,n,i){let r;switch(e){case fe.FAIRPLAY:r=["cenc","sinf"];break;case fe.WIDEVINE:case fe.PLAYREADY:r=["cenc"];break;case fe.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,n,i){return[{initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map((e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null}))),videoCapabilities:n.map((e=>({contentType:`video/mp4; codecs="${e}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null})))}]}(r,t,n,i)}(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let s=null==r?void 0:r.keySystemAccess;if(!s){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),s=this.requestMediaKeySystemAccess(e,i);const t=this.keySystemAccessPromises[e]={keySystemAccess:s};return s.catch((t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)})),s.then((n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const i=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then((t=>(this.log(`Media-keys created for "${e}"`),i.then((n=>n?this.setMediaKeysServerCertificate(t,e,n):t))))),t.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)})),t.mediaKeys}))}return s.then((()=>r.mediaKeys))}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${ze(e.keyId||[])}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return ze(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${ze((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise(((t,n)=>{const i=Te(this.config),r=e.map(be).filter((e=>!!e&&-1!==i.indexOf(e)));return this.getKeySystemSelectionPromise(r).then((({keySystem:e})=>{const i=Ee(e);i?t(i):n(new Error(`Unable to find format for key-system "${e}"`))})).catch(n)}))}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];return r||(r=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then((({keySystem:n,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(n,r).then((()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:n,mediaKeys:r,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,"cenc",t.pssh,"playlist-key")}))))),r.catch((e=>this.handleError(e)))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof qs?this.hls.trigger(j.ERROR,e.data):this.hls.trigger(j.ERROR,{type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=be(e.keyFormat),n=t?[t]:Te(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Te(this.config)),0===e.length)throw new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e,i=`"${e.type}" event: init data type: "${t}"`;if(this.debug(i),null===n)return;let r,s;if("sinf"===t&&this.config.drmSystems[fe.FAIRPLAY]){const e=Ke(new Uint8Array(n));try{const t=ue(JSON.parse(e).sinf),n=ot(new Uint8Array(t));if(!n)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");r=n.subarray(8,24),s=fe.FAIRPLAY}catch(e){return void this.warn(`${i} Failed to parse sinf: ${e}`)}}else{const e=function(e){const t=[];if(e instanceof ArrayBuffer){const n=e.byteLength;let i=0;for(;i+32<n;){const n=ft(new DataView(e,i));t.push(n),i+=n.size}}return t}(n),t=e.filter((e=>e.systemId===_e))[0];if(!t)return void(0===e.length||e.some((e=>!e.systemId))?this.warn(`${i} contains incomplete or invalid pssh data`):this.log(`ignoring ${i} for ${e.map((e=>we(e.systemId))).join(",")} pssh data in favor of playlist keys`));if(s=we(t.systemId),0===t.version&&t.data){const e=t.data.length-22;r=t.data.subarray(e,e+16)}}if(!s||!r)return;const a=ze(r),{keyIdToKeySessionPromise:o,mediaKeySessions:l}=this;let c=o[a];for(let e=0;e<l.length;e++){const i=l[e],s=i.decryptdata;if(!s.keyId)continue;const d=ze(s.keyId);if(a===d||-1!==s.uri.replace(/-/g,"").indexOf(a)){if(c=o[d],s.pssh)break;delete o[d],s.pssh=new Uint8Array(n),s.keyId=r,c=o[a]=c.then((()=>this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-key-match")));break}}c||(c=o[a]=this.getKeySystemSelectionPromise([s]).then((({keySystem:e,mediaKeys:i})=>{var s;this.throwIfDestroyed();const o=new gt("ISO-23001-7",a,null!=(s=Ee(e))?s:"");return o.pssh=new Uint8Array(n),o.keyId=r,this.attemptSetMediaKeys(e,i).then((()=>{this.throwIfDestroyed();const r=this.createMediaKeySessionContext({decryptdata:o,keySystem:e,mediaKeys:i});return this.generateRequestWithPreferredKeySession(r,t,n,"encrypted-event-no-match")}))}))),c.catch((e=>this.handleError(e)))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(i),i.then((()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((e=>-1===n.indexOf(e)))}))}generateRequestWithPreferredKeySession(e,t,n,i){var r,s;const a=null==(r=this.config.drmSystems)||null==(s=r[e.keySystem])?void 0:s.generateRequest;if(a)try{const i=a.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=e.decryptdata.pssh=i.initData?new Uint8Array(i.initData):null}catch(e){var o;if(this.warn(e.message),null!=(o=this.hls)&&o.config.debug)throw e}if(null===n)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${l} (init data type: ${t} length: ${n?n.byteLength:null})`);const c=new Br,d=e._onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void c.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log(`"${i}" message event for session "${n.sessionId}" message size: ${r.byteLength}`),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch((e=>{this.handleError(e),c.emit("error",e)})):"license-release"===i?e.keySystem===fe.FAIRPLAY&&(this.updateKeySession(e,he("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${i}"`)},u=e._onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void c.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const n=e.keyStatus;c.emit("keyStatus",n),"expired"===n&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",d),e.mediaKeysSession.addEventListener("keystatuseschange",u);const h=new Promise(((e,t)=>{c.on("error",t),c.on("keyStatus",(n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)}))}));return e.mediaKeysSession.generateRequest(t,n).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)})).catch((e=>{throw new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>h)).catch((t=>{throw c.removeAllListeners(),this.removeSession(e),t})).then((()=>(c.removeAllListeners(),e)))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach(((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${ze("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${ze(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t}))}fetchServerCertificate(e){const t=this.config,n=new(0,t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise(((r,s)=>{const a={responseType:"arraybuffer",url:i},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{r(e.data)},onError:(t,n,r,o)=>{s(new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:U({url:a.url,data:void 0},t)},`"${e}" certificate request failed (${i}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,r)=>{s(new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(e,t,n)=>{s(new Error("aborted"))}};n.load(a,l,c)}))):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise(((i,r)=>{e.setServerCertificate(n).then((r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),i(e)})).catch((e=>{r(new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((e=>{throw new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let t;for(let n=0,i=r.length;n<i;n++){var s,a;t=r[n];const i=null==(s=t.querySelector("name"))?void 0:s.textContent,o=null==(a=t.querySelector("value"))?void 0:a.textContent;i&&o&&e.setRequestHeader(i,o)}}const o=i.querySelector("Challenge"),l=null==o?void 0:o.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return he(atob(l))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then((()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)})).catch((s=>{if(!n.decryptdata)throw s;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)})).then((n=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:n||i}))):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise(((i,r)=>{const s=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${s}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,a,s,e)}catch(e){this.error(e)}i(t)}else{const o=n.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new qs({type:V.KEY_SYSTEM_ERROR,details:Y.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:s,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${s}). Status: ${a.status} (${a.statusText})`));else{const n=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,s,e,t).then((({xhr:t,licenseChallenge:n})=>{e.keySystem==fe.PLAYREADY&&(n=this.unpackPlayReadyKeyMessage(t,n)),t.send(n)}))}))}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},gt.clearKeyUriToKeyIdMap();const n=t.length;Hs.CDMCleanupPromise=Promise.all(t.map((e=>this.removeSession(e))).concat(null==e?void 0:e.setMediaKeys(null).catch((e=>{this.log(`Could not clear media keys: ${e}`)})))).then((()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)})).catch((e=>{this.log(`Could not close sessions and clear media keys: ${e}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce(((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e)),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch((e=>{this.log(`Could not remove session: ${e}`)})).then((()=>t.close())).catch((e=>{this.log(`Could not close session: ${e}`)}))}}}Hs.CDMCleanupPromise=void 0;class qs extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var zs,js,Vs;!function(e){e.MANIFEST="m",e.AUDIO="a",e.VIDEO="v",e.MUXED="av",e.INIT="i",e.CAPTION="c",e.TIMED_TEXT="tt",e.KEY="k",e.OTHER="o"}(zs||(zs={})),function(e){e.DASH="d",e.HLS="h",e.SMOOTH="s",e.OTHER="o"}(js||(js={})),function(e){e.OBJECT="CMCD-Object",e.REQUEST="CMCD-Request",e.SESSION="CMCD-Session",e.STATUS="CMCD-Status"}(Vs||(Vs={}));const Ys={[Vs.OBJECT]:["br","d","ot","tb"],[Vs.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Vs.SESSION]:["cid","pr","sf","sid","st","v"],[Vs.STATUS]:["bs","rtp"]};class Ks{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map((e=>e instanceof Ks?e:new Ks(e)))),this.value=e,this.params=t}}class Ws{constructor(e){this.description=void 0,this.description=e}}const Xs="Dict";const Zs="Bare Item",Js="Boolean",Qs="Byte Sequence",ea="Decimal",ta="Integer",na=/[\x00-\x1f\x7f]+/,ia="Token",ra="Key";function sa(e,t,n){return function(e,t,n,i){return new Error(`failed to ${e} "${r=t,Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":"object"==typeof r?JSON.stringify(r):String(r)}" as ${n}`,{cause:i});var r}("serialize",e,t,n)}function aa(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw sa(e,ta);return e.toString()}function oa(e,t){if(e<0)return-oa(-e,t);const n=Math.pow(10,t);if(Math.abs(e*n%1-.5)<Number.EPSILON){const t=Math.floor(e*n);return(t%2==0?t:t+1)/n}return Math.round(e*n)/n}function la(e){const t=oa(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw sa(e,ea);const n=t.toString();return n.includes(".")?n:`${n}.0`}const ca="String";function da(e){const t=(n=e).description||n.toString().slice(7,-1);var n;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw sa(t,ia);return t}function ua(e){switch(typeof e){case"number":if(!H(e))throw sa(e,Zs);return Number.isInteger(e)?aa(e):la(e);case"string":return function(e){if(na.test(e))throw sa(e,ca);return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(e);case"symbol":return da(e);case"boolean":return function(e){if("boolean"!=typeof e)throw sa(e,Js);return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return`@${aa(e.getTime()/1e3)}`}(e);if(e instanceof Uint8Array)return function(e){if(!1===ArrayBuffer.isView(e))throw sa(e,Qs);return`:${t=e,btoa(String.fromCharCode(...t))}:`;var t}(e);if(e instanceof Ws)return da(e);default:throw sa(e,Zs)}}function ha(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw sa(e,ra);return e}function pa(e){return null==e?"":Object.entries(e).map((([e,t])=>!0===t?`;${ha(e)}`:`;${ha(e)}=${ua(t)}`)).join("")}function fa(e){return e instanceof Ks?`${ua(e.value)}${pa(e.params)}`:ua(e)}const ma=e=>"ot"===e||"sf"===e||"st"===e,ga=e=>"number"==typeof e?H(e):null!=e&&""!==e&&!1!==e,ya=e=>Math.round(e),va=e=>100*ya(e/100),ba={br:ya,d:ya,bl:va,dl:va,mtp:va,nor:(e,t)=>(null!=t&&t.baseUrl&&(e=function(e,t){const n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}(e,t.baseUrl)),encodeURIComponent(e)),rtp:va,tb:ya};function _a(e,t={}){return e?function(e,t){return function(e,t={whitespace:!0}){if("object"!=typeof e)throw sa(e,Xs);const n=e instanceof Map?e.entries():Object.entries(e),i=null!=t&&t.whitespace?" ":"";return Array.from(n).map((([e,t])=>{t instanceof Ks==0&&(t=new Ks(t));let n=ha(e);var i;return!0===t.value?n+=pa(t.params):(n+="=",Array.isArray(t.value)?n+=`(${(i=t).value.map(fa).join(" ")})${pa(i.params)}`:n+=fa(t)),n})).join(`,${i}`)}(e,t)}(function(e,t){const n={};if(null==e||"object"!=typeof e)return n;const i=Object.keys(e).sort(),r=G({},ba,null==t?void 0:t.formatters),s=null==t?void 0:t.filter;return i.forEach((i=>{if(null!=s&&s(i))return;let a=e[i];const o=r[i];o&&(a=o(a,t)),"v"===i&&1===a||"pr"==i&&1===a||ga(a)&&(ma(i)&&"string"==typeof a&&(a=new Ws(a)),n[i]=a)})),n}(e,t),G({whitespace:!1},t)):""}const wa=/CMCD=[^&#]+/;function Ea(e,t,n,i){e&&Object.keys(t).forEach((r=>{const s=e.filter((e=>e.groupId===r)).map((e=>{const s=G({},e);return s.details=void 0,s.attrs=new ee(s.attrs),s.url=s.attrs.URI=Ta(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=t[r],s.attrs["PATHWAY-ID"]=i,s}));e.push(...s)}))}function Ta(e,t,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const l=new self.URL(e);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach((e=>{e&&l.searchParams.set(e,s[e])})),l.href}const Sa=/^age:\s*[\d.]+\s*$/im;class xa{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new ie,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then((()=>{if(this.loader===n&&!this.stats.aborted)return r(n,t.url)})).catch((e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),r(n,t.url)})).then((()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)})).catch((e=>{this.callbacks.onError({code:n.status,text:e.message},t,n,i)})):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:s}=n.loadPolicy;if(i)for(const t in i)e.setRequestHeader(t,i[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&H(r)?r:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,s="text"===t.responseType?t.responseText:null;if(i>=200&&i<300){const r=null!=s?s:t.response;if(null!=r){n.loading.end=Math.max(self.performance.now(),n.loading.first);const s="arraybuffer"===t.responseType?r.byteLength:r.length;if(n.loaded=n.total=s,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;const a=this.callbacks.onProgress;if(a&&a(n,e,r,t),!this.callbacks)return;const o={url:t.responseURL,data:r,code:i};return void this.callbacks.onSuccess(o,n,e,t)}}const a=r.loadPolicy.errorRetry;Mn(a,n.retry,!1,{url:e.url,data:void 0,code:i})?this.retry(a):(Z.error(`${i} while loading ${e.url}`),this.callbacks.onError({code:i,text:t.statusText},e,t,n))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry;if(Mn(e,this.stats.retry,!0))this.retry(e);else{var t;Z.warn(`timeout while loading ${null==(t=this.context)?void 0:t.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Dn(e,n.retry),n.retry++,Z.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Sa.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const ka=/(\d+)-(\d+)\/(\d+)/;class Ca{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||La,this.controller=new self.AbortController,this.stats=new ie}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=function(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(G({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}(e,this.controller.signal),s=n.onProgress,a="arraybuffer"===e.responseType,o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=l&&H(l)?l:c,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(i,e,this.response)}),t.timeout),self.fetch(this.request).then((r=>{this.response=this.loader=r;const o=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(i,e,this.response)}),c-(o-i.loading.start)),!r.ok){const{status:e,statusText:t}=r;throw new Aa(t||"fetch, bad network response",e,r)}return i.loading.first=o,i.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=ka.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(H(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}(r.headers)||i.total,s&&H(t.highWaterMark)?this.loadProgressively(r,i,e,t.highWaterMark,s):a?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((r=>{const a=this.response;if(!a)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=r[o];l&&(i.loaded=i.total=l);const c={url:a.url,data:r,code:a.status};s&&!H(t.highWaterMark)&&s(i,e,r,a),n.onSuccess(c,i,e,a)})).catch((t=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const r=t&&t.code||0,s=t?t.message:null;n.onError({code:r,text:s},e,t?t.details:null,i)}))}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const s=new Mi,a=e.body.getReader(),o=()=>a.read().then((a=>{if(a.done)return s.dataLength&&r(t,n,s.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=a.value,c=l.length;return t.loaded+=c,c<i||s.dataLength?(s.push(l),s.dataLength>=i&&r(t,n,s.flush(),e)):r(t,n,l,e),o()})).catch((()=>Promise.reject()));return o()}}function La(e,t){return new self.Request(e.url,t)}class Aa extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const Ra=/\s/,Ia={newCue(e,t,n,i){const r=[];let s,a,o,l,c;const d=self.VTTCue||self.TextTrackCue;for(let h=0;h<i.rows.length;h++)if(s=i.rows[h],o=!0,l=0,c="",!s.isEmpty()){var u;for(let e=0;e<s.chars.length;e++)Ra.test(s.chars[e].uchar)&&o?l++:(c+=s.chars[e].uchar,o=!1);s.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const i=ws(c.trim()),p=ks(t,n,i);null!=e&&null!=(u=e.cues)&&u.getCueById(p)||(a=new d(t,n,i),a.id=p,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return e&&r.length&&(r.sort(((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line)),r.forEach((t=>sn(e,t)))),r}},Da=U(U({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:xa,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:i,media:r}=n;if(!e||!r)return;const s=performance.now(),a=t?t.stats:e.stats,o=t?t.duration:e.duration,l=s-a.loading.start,c=n.minAutoLevel;if(a.aborted||a.loaded&&a.loaded===a.total||e.level<=c)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!i||r.paused||!r.playbackRate||!r.readyState)return;const d=n.mainForwardBufferInfo;if(null===d)return;const u=this.bwEstimator.getEstimateTTFB(),h=Math.abs(r.playbackRate);if(l<=Math.max(u,o/(2*h)*1e3))return;const p=d.len/h,f=a.loading.first?a.loading.first-a.loading.start:-1,m=a.loaded&&f>-1,g=this.getBwEstimate(),y=n.levels,v=y[e.level],b=a.total||Math.max(a.loaded,Math.round(o*v.averageBitrate/8));let _=m?l-f:l;_<1&&m&&(_=Math.min(l,8*a.loaded/g));const w=m?1e3*a.loaded/_:0,E=w?(b-a.loaded)/w:8*b/g+u/1e3;if(E<=p)return;const T=w?8*w:g;let S,x=Number.POSITIVE_INFINITY;for(S=e.level-1;S>c;S--){const e=y[S].maxBitrate;if(x=this.getTimeToLoadFrag(u/1e3,T,o*e,!y[S].details),x<p)break}if(x>=E)return;if(x>10*o)return;n.nextLoadLevel=n.nextAutoLevel=S,m?this.bwEstimator.sample(l-Math.min(u,f),a.loaded):this.bwEstimator.sampleTTFB(l);const k=y[S].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>k&&this.resetEstimator(k),this.clearTimer(),Z.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${p.toFixed(3)} s\n      Estimated load time for current fragment: ${E.toFixed(3)} s\n      Estimated load time for down switch fragment: ${x.toFixed(3)} s\n      TTFB estimate: ${0|f} ms\n      Current BW estimate: ${H(g)?0|g:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${S} @ ${0|k} bps`),n.trigger(j.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:a})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(Z.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new Gn(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.FRAG_LOADING,this.onFragLoading,this),e.on(j.FRAG_LOADED,this.onFragLoaded,this),e.on(j.FRAG_BUFFERED,this.onFragBuffered,this),e.on(j.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(j.LEVEL_LOADED,this.onLevelLoaded,this),e.on(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(j.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(j.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.FRAG_LOADING,this.onFragLoading,this),e.off(j.FRAG_LOADED,this.onFragLoaded,this),e.off(j.FRAG_BUFFERED,this.onFragBuffered,this),e.off(j.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(j.LEVEL_LOADED,this.onLevelLoaded,this),e.off(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(j.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(j.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;var i;this.ignoreFragment(n)||(n.bitrateTest||(this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Y.BUFFER_ADD_CODEC_ERROR:case Y.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Y.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:i}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=i?i.stats:e.stats,r=t-n.loading.start,s=n.loading.first?n.loading.first-n.loading.start:-1;if(n.loaded&&s>-1){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(e,s),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(e,t,n,i){return e+n/t+(i?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.start;H(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===Zt&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,r=this.hls.levels[t.level],s=(r.loaded?r.loaded.bytes:0)+i.loaded,a=(r.loaded?r.loaded.duration:0)+e;r.loaded={bytes:s,duration:a},r.realBitrate=Math.round(8*s/a)}if(t.bitrateTest){const e={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(j.FRAG_BUFFERED,e),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Zt||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,t),e);return Z.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(!(-1===e||t&&n&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;const i=t&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,i)&&t[e].loadError<=t[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:r,minAutoLevel:s}=n,a=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay();let c=r.abrBandWidthFactor,d=r.abrBandWidthUpFactor;if(l){const e=this.findBestLevel(o,s,i,l,0,c,d);if(e>=0)return e}let u=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const e=this.bitrateTestDelay;e&&(u=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-e,Z.info(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*u)} ms`),c=d=1)}const h=this.findBestLevel(o,s,i,l,u,c,d);if(Z.info(`[abr] ${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${h}`),h>-1)return h;const p=n.levels[s],f=n.levels[n.loadLevel];return(null==p?void 0:p.bitrate)<(null==f?void 0:f.bitrate)?s:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,s,a){var o;const l=i+r,c=this.lastLoadedFragLevel,d=-1===c?this.hls.firstLevel:c,{fragCurrent:u,partCurrent:h}=this,{levels:p,allAudioTracks:f,loadLevel:m,config:g}=this.hls;if(1===p.length)return 0;const y=p[d],v=!(null==y||null==(o=y.details)||!o.live),b=-1===m||-1===c;let _,w="SDR",E=(null==y?void 0:y.frameRate)||0;const{audioPreference:T,videoPreference:S}=g,x=this.audioTracksByGroup||(this.audioTracksByGroup=function(e){return e.reduce(((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}(f));if(b){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=function(e,t,n,i){return e.slice(n,i+1).reduce(((e,n)=>{if(!n.codecSet)return e;const i=n.audioGroups;let r=e[n.codecSet];r||(e[n.codecSet]=r={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!i,fragmentError:0}),r.minBitrate=Math.min(r.minBitrate,n.bitrate);const s=Math.min(n.height,n.width);return r.minHeight=Math.min(r.minHeight,s),r.minFramerate=Math.min(r.minFramerate,n.frameRate),r.maxScore=Math.max(r.maxScore,n.score),r.fragmentError+=n.fragmentError,r.videoRanges[n.videoRange]=(r.videoRanges[n.videoRange]||0)+1,i&&i.forEach((e=>{if(!e)return;const n=t.groups[e];n&&(r.hasDefaultAudio=r.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach((e=>{r.channels[e]=(r.channels[e]||0)+n.channels[e]})))})),e}),{})}(p,x,t,n)),r=function(e,t,n,i,r){const s=Object.keys(e),a=null==i?void 0:i.channels,o=null==i?void 0:i.audioCodec,l=a&&2===parseInt(a);let c=!0,d=!1,u=1/0,h=1/0,p=1/0,f=0,m=[];const{preferHDR:g,allowedVideoRanges:y}=function(e,t){let n=!1,i=[];return e&&(n="SDR"!==e,i=[e]),t&&(i=t.allowedVideoRanges||vn.slice(0),n=void 0!==t.preferHDR?t.preferHDR:function(){if("function"==typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}(),i=n?i.filter((e=>"SDR"!==e)):["SDR"]),{preferHDR:n,allowedVideoRanges:i}}(t,r);for(let t=s.length;t--;){const n=e[s[t]];c=n.channels[2]>0,u=Math.min(u,n.minHeight),h=Math.min(h,n.minFramerate),p=Math.min(p,n.minBitrate);const i=y.filter((e=>n.videoRanges[e]>0));i.length>0&&(d=!0,m=i)}u=H(u)?u:0,h=H(h)?h:0;const v=Math.max(1080,u),b=Math.max(30,h);return p=H(p)?p:n,n=Math.max(p,n),d||(t=void 0,m=[]),{codecSet:s.reduce(((t,i)=>{const r=e[i];if(i===t)return t;if(r.minBitrate>n)return Vn(i,`min bitrate of ${r.minBitrate} > current estimate of ${n}`),t;if(!r.hasDefaultAudio)return Vn(i,"no renditions with default or auto-select sound found"),t;if(o&&i.indexOf(o.substring(0,4))%5!=0)return Vn(i,`audio codec preference "${o}" not found`),t;if(a&&!l){if(!r.channels[a])return Vn(i,`no renditions with ${a} channel sound found (channels options: ${Object.keys(r.channels)})`),t}else if((!o||l)&&c&&0===r.channels[2])return Vn(i,"no renditions with stereo sound found"),t;return r.minHeight>v?(Vn(i,`min resolution of ${r.minHeight} > maximum of ${v}`),t):r.minFramerate>b?(Vn(i,`min framerate of ${r.minFramerate} > maximum of ${b}`),t):m.some((e=>r.videoRanges[e]>0))?r.maxScore<f?(Vn(i,`max score of ${r.maxScore} < selected max of ${f}`),t):t&&(At(i)>=At(t)||r.fragmentError>e[t].fragmentError)?t:(f=r.maxScore,i):(Vn(i,`no variants with VIDEO-RANGE of ${JSON.stringify(m)} found`),t)}),void 0),videoRanges:m,preferHDR:g,minFramerate:h,minBitrate:p}}(i,w,e,T,S),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:l,preferHDR:c}=r;_=s,w=c?a[a.length-1]:a[0],E=o,e=Math.max(e,l),Z.log(`[abr] picked start tier ${JSON.stringify(r)}`)}else _=null==y?void 0:y.codecSet,w=null==y?void 0:y.videoRange;const k=h?h.duration:u?u.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3,L=[];for(let o=n;o>=t;o--){var A;const t=p[o],u=o>d;if(!t)continue;if(g.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"==typeof(null==n?void 0:n.decodingInfo)&&zn(t,x,w,E,e,T)?(t.supportedPromise=jn(t,x,n),t.supportedPromise.then((e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,i=n.indexOf(t);e.error?Z.warn(`[abr] MediaCapabilities decodingInfo error: "${e.error}" for level ${i} ${JSON.stringify(e)}`):e.supported||(Z.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${i} ${JSON.stringify(e)}`),i>-1&&n.length>1&&(Z.log(`[abr] Removing unsupported level ${i}`),this.hls.removeLevel(i)))}))):t.supportedResult=Hn}if(_&&t.codecSet!==_||w&&t.videoRange!==w||u&&E>t.frameRate||!u&&E>0&&E<t.frameRate||t.supportedResult&&(null==(A=t.supportedResult.decodingInfoResults)||!A[0].smooth)){L.push(o);continue}const f=t.details,S=(h?null==f?void 0:f.partTarget:null==f?void 0:f.averagetargetduration)||k;let R;R=u?a*e:s*e;const I=k&&i>=2*k&&0===r?p[o].averageBitrate:p[o].maxBitrate,D=this.getTimeToLoadFrag(C,R,I*S,void 0===f);if(R>=I&&(o===c||0===t.loadError&&0===t.fragmentError)&&(D<=C||!H(D)||v&&!this.bitrateTestDelay||D<l)){const e=this.forcedAutoLevel;return o===m||-1!==e&&e===m||(L.length&&Z.trace(`[abr] Skipped level(s) ${L.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${p[L[0]].codecs}" ${p[L[0]].videoRange}; not compatible with "${y.codecs}" ${w}`),Z.info(`[abr] switch candidate:${d}->${o} adjustedbw(${Math.round(R)})-bitrate=${Math.round(R-I)} ttfb:${C.toFixed(1)} avgDuration:${S.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${D.toFixed(1)} firstSelection:${b} codecSet:${_} videoRange:${w} hls.loadLevel:${m}`)),b&&(this.firstSelection=o),o}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,i=Math.min(Math.max(e,n),t);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}},bufferController:class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=e=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:e,mediaSource:t}=this;this.log("Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(j.MEDIA_ATTACHED,{media:e,mediaSource:t})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&Z.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)},this.hls=e;const t="[buffer-controller]";var n;this.appendSource=(n=Tt(e.config.preferManagedMediaSource),"undefined"!=typeof self&&n===self.ManagedMediaSource),this.log=Z.log.bind(Z,t),this.warn=Z.warn.bind(Z,t),this.error=Z.error.bind(Z,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(j.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.MANIFEST_PARSED,this.onManifestParsed,this),e.on(j.BUFFER_RESET,this.onBufferReset,this),e.on(j.BUFFER_APPENDING,this.onBufferAppending,this),e.on(j.BUFFER_CODECS,this.onBufferCodecs,this),e.on(j.BUFFER_EOS,this.onBufferEos,this),e.on(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(j.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(j.FRAG_PARSED,this.onFragParsed,this),e.on(j.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(j.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.MANIFEST_PARSED,this.onManifestParsed,this),e.off(j.BUFFER_RESET,this.onBufferReset,this),e.off(j.BUFFER_APPENDING,this.onBufferAppending,this),e.off(j.BUFFER_CODECS,this.onBufferCodecs,this),e.off(j.BUFFER_EOS,this.onBufferEos,this),e.off(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(j.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(j.FRAG_PARSED,this.onFragParsed,this),e.off(j.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new zr(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,i=Tt(this.appendSource);if(n&&i){var r;const e=this.mediaSource=new i;this.log(`created media source: ${null==(r=e.constructor)?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming));const t=this._objectUrl=self.URL.createObjectURL(e);if(this.appendSource)try{n.removeAttribute("src");const i=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||i&&e instanceof i,Vr(n),function(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}(n,t),n.load()}catch(e){n.src=t}else n.src=t;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){this.warn(`onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&Vr(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(j.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((e=>{this.resetBuffer(e)})),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{var n;t&&(this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t))}catch(t){this.warn(`onBufferReset ${e}`,t)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,i=Object.keys(t);if(i.forEach((e=>{if(n){const n=this.tracks[e];if(n&&"function"==typeof n.buffer.changeType){var i;const{id:r,codec:s,levelCodec:a,container:o,metadata:l}=t[e],c=Pt(n.codec,n.levelCodec),d=null==c?void 0:c.replace(jr,"$1");let u=Pt(s,a);const h=null==(i=u)?void 0:i.replace(jr,"$1");if(u&&d!==h){"audio"===e.slice(0,5)&&(u=Dt(u,this.appendSource));const t=`${o};codecs=${u}`;this.appendChangeType(e,t),this.log(`switching codec ${c} to ${u}`),this.tracks[e]={buffer:n.buffer,codec:s,container:o,levelCodec:a,metadata:l,id:r}}}}else this.pendingTracks[e]=t[e]})),n)return;const r=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==r&&(this.log(`${r} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=r),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const i=this.sourceBuffer[e];i&&(this.log(`changing ${e} sourceBuffer type to ${t}`),i.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};n.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:r}=this,{data:s,type:a,frag:o,part:l,chunkMeta:c}=t,d=c.buffering[a],u=self.performance.now();d.start=u;const h=o.stats.buffering,p=l?l.stats.buffering:null;0===h.start&&(h.start=u),p&&0===p.start&&(p.start=u);const f=r.audio;let m=!1;"audio"===a&&"audio/mpeg"===(null==f?void 0:f.container)&&(m=!this.lastMpegAudioChunk||1===c.id||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const g=o.start,y={execute:()=>{if(d.executeStart=self.performance.now(),m){const e=this.sourceBuffer[a];if(e){const t=g-e.timestampOffset;Math.abs(t)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${g} (delta: ${t}) sn: ${o.sn})`),e.timestampOffset=g)}}this.appendExecutor(s,a)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();d.executeEnd=d.end=e,0===h.first&&(h.first=e),p&&0===p.first&&(p.first=e);const{sourceBuffer:t}=this,n={};for(const e in t)n[e]=ai.getBuffered(t[e]);this.appendErrors[a]=0,"audio"===a||"video"===a?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(j.BUFFER_APPENDED,{type:a,frag:o,part:l,chunkMeta:c,parent:o.type,timeRanges:n})},onError:e=>{const t={type:V.MEDIA_ERROR,parent:o.type,details:Y.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:o,part:l,chunkMeta:c,error:e,err:e,fatal:!1};if(e.code===DOMException.QUOTA_EXCEEDED_ERR)t.details=Y.BUFFER_FULL_ERROR;else{const e=++this.appendErrors[a];t.details=Y.BUFFER_APPEND_ERROR,this.warn(`Failed ${e}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),e>=n.config.appendErrorMaxRetry&&(t.fatal=!0)}n.trigger(j.ERROR,t)}};i.append(y,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:n}=this,i=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(j.BUFFER_FLUSHED,{type:e})},onError:t=>{this.warn(`Failed to remove from ${e} SourceBuffer`,t)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach((e=>{n.append(i(e),e)}))}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s[ae]?r.push("audiovideo"):(s[re]&&r.push("audio"),s[se]&&r.push("video")),0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers((()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger(j.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})}),r)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce(((e,n)=>{const i=this.sourceBuffer[n];return!i||t.type&&t.type!==n||(i.ending=!0,i.ended||(i.ended=!0,this.log(`${n} sourceBuffer now EOS`))),e&&!(i&&!i.ended)}),!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)}));const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream()):e&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;if(!this.getSourceBufferTypes().length)return;const i=e.config,r=n.currentTime,s=t.levelTargetDuration,a=t.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(H(a)&&a>0){const e=Math.max(a,s),t=Math.floor(r/s)*s-e;this.flushBackBuffer(r,s,t)}if(H(i.frontBufferFlushThreshold)&&i.frontBufferFlushThreshold>0){const e=Math.max(i.maxBufferLength,i.frontBufferFlushThreshold),t=Math.max(e,s),n=Math.floor(r/s)*s+t;this.flushFrontBuffer(r,s,n)}}flushBackBuffer(e,t,n){const{details:i,sourceBuffer:r}=this;this.getSourceBufferTypes().forEach((s=>{const a=r[s];if(a){const r=ai.getBuffered(a);if(r.length>0&&n>r.start(0)){if(this.hls.trigger(j.BACK_BUFFER_REACHED,{bufferEnd:n}),null!=i&&i.live)this.hls.trigger(j.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(a.ended&&r.end(r.length-1)-e<2*t)return void this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);this.hls.trigger(j.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:s})}}}))}flushFrontBuffer(e,t,n){const{sourceBuffer:i}=this;this.getSourceBufferTypes().forEach((r=>{const s=i[r];if(s){const i=ai.getBuffered(s),a=i.length;if(a<2)return;const o=i.start(a-1),l=i.end(a-1);if(n>o||e>=o&&e<=l)return;if(s.ended&&e-l<2*t)return void this.log(`Cannot flush ${r} front buffer while SourceBuffer is in ended state`);this.hls.trigger(j.BUFFER_FLUSHING,{startOffset:o,endOffset:1/0,type:r})}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:n,mediaSource:i}=this,r=e.fragments[0].start+e.totalduration,s=n.duration,a=H(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(r>a&&r>s||!H(s))&&(this.log(`Updating Media Source duration to ${r.toFixed(3)}`),i.duration=r)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){const i=Math.max(0,n[0].start),r=Math.max(i,i+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${i}-${r}.`),t.setLiveSeekableRange(i,r)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&(!e||2===i||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(j.BUFFER_CREATED,{tracks:this.tracks}),e.forEach((e=>{t.executeNext(e)}));else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){var i;const s=e[r];if(!s)throw Error(`source buffer exists for track ${r}, however track does not`);let a=-1===(null==(i=s.levelCodec)?void 0:i.indexOf(","))?s.levelCodec:s.codec;a&&"audio"===r.slice(0,5)&&(a=Dt(a,this.appendSource));const o=`${s.container};codecs=${a}`;this.log(`creating sourceBuffer(${o})`);try{const e=t[r]=n.addSourceBuffer(o),i=r;this.addBufferListener(i,"updatestart",this._onSBUpdateStart),this.addBufferListener(i,"updateend",this._onSBUpdateEnd),this.addBufferListener(i,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(i,"bufferedchange",((e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger(j.BUFFER_FLUSHED,{type:r})})),this.tracks[r]={buffer:e,codec:a,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(e){this.error(`error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:r,mimeType:o})}}}get mediaSrc(){var e,t;const n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(n=this.mediaSource)?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:r,operationQueue:s,sourceBuffer:a}=this,o=a[e];if(!i||!r||!o)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void s.shiftAndExecuteNext(e);const l=H(i.duration)?i.duration:1/0,c=H(r.duration)?r.duration:1/0,d=Math.max(0,t),u=Math.min(n,l,c);u>d&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${d},${u}] from the ${e} SourceBuffer`),o.remove(d,u)):s.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(n)n.ended=!1,n.appendBuffer(e);else if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map((e=>n.appendBlocker(e)));Promise.all(i).then((()=>{e(),t.forEach((e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const r=n.bind(this,e);this.listeners[e].push({event:t,listener:r}),i.addEventListener(t,r)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach((e=>{t.removeEventListener(e.event,e.listener)}))}},capLevelController:$s,errorController:class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=Z.log.bind(Z,"[info]:"),this.warn=Z.warn.bind(Z,"[warning]:"),this.error=Z.error.bind(Z,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(j.ERROR,this.onError,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(j.ERROR,this.onError,this),e.off(j.ERROR,this.onErrorOut,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===Zt?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,i;if(t.fatal)return;const r=this.hls,s=t.context;switch(t.details){case Y.FRAG_LOAD_ERROR:case Y.FRAG_LOAD_TIMEOUT:case Y.KEY_LOAD_ERROR:case Y.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case Y.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:0,flags:0});case Y.FRAG_GAP:case Y.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case Y.LEVEL_EMPTY_ERROR:case Y.LEVEL_PARSING_ERROR:{var a,o;const e=t.parent===Zt?t.level:r.loadLevel;t.details===Y.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(o=a.levelDetails)&&o.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case Y.LEVEL_LOAD_ERROR:case Y.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==s?void 0:s.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level)));case Y.AUDIO_TRACK_LOAD_ERROR:case Y.AUDIO_TRACK_LOAD_TIMEOUT:case Y.SUBTITLE_LOAD_ERROR:case Y.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const e=r.levels[r.loadLevel];if(e&&(s.type===Wt&&e.hasAudioGroup(s.groupId)||s.type===Xt&&e.hasSubtitleGroup(s.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case Y.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=r.levels[r.loadLevel],n=null==e?void 0:e.attrs["HDCP-LEVEL"];n?t.errorAction={action:2,flags:2,hdcpLevel:n}:this.keySystemError(t)}return;case Y.BUFFER_ADD_CODEC_ERROR:case Y.REMUX_ALLOC_ERROR:case Y.BUFFER_APPEND_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(i=t.level)?i:r.loadLevel));case Y.INTERNAL_EXCEPTION:case Y.BUFFER_APPENDING_ERROR:case Y.BUFFER_FULL_ERROR:case Y.LEVEL_SWITCH_ERROR:case Y.BUFFER_STALLED_ERROR:case Y.BUFFER_SEEK_OVER_HOLE:case Y.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:0,flags:0})}t.type===V.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=In(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++;if(Mn(n,i,Rn(e),e.response))return{action:5,flags:0,retryConfig:n,retryCount:i};const r=this.getLevelSwitchAction(e,t);return n&&(r.retryConfig=n,r.retryCount=i),r}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=t.config,a=In(e.details.startsWith("key")?s:r,e),o=t.levels.reduce(((e,t)=>e+t.fragmentError),0);if(i&&(e.details!==Y.FRAG_GAP&&i.fragmentError++,Mn(a,o,Rn(e),e.response)))return{action:5,flags:0,retryConfig:a,retryCount:o};const l=this.getLevelSwitchAction(e,n);return a&&(l.retryConfig=a,l.retryCount=o),l}getLevelSwitchAction(e,t){const n=this.hls;null==t&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,s;const t=e.details;i.loadError++,t===Y.BUFFER_APPEND_ERROR&&i.fragmentError++;let l=-1;const{levels:c,loadLevel:d,minAutoLevel:u,maxAutoLevel:h}=n;n.autoLevelEnabled||(n.loadLevel=-1);const p=null==(r=e.frag)?void 0:r.type,f=(p===Jt&&t===Y.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===Y.BUFFER_ADD_CODEC_ERROR||t===Y.BUFFER_APPEND_ERROR))&&c.some((({audioCodec:e})=>i.audioCodec!==e)),m="video"===e.sourceBufferName&&(t===Y.BUFFER_ADD_CODEC_ERROR||t===Y.BUFFER_APPEND_ERROR)&&c.some((({codecSet:e,audioCodec:t})=>i.codecSet!==e&&i.audioCodec===t)),{type:g,groupId:y}=null!=(s=e.context)?s:{};for(let n=c.length;n--;){const r=(n+d)%c.length;if(r!==d&&r>=u&&r<=h&&0===c[r].loadError){var a,o;const n=c[r];if(t===Y.FRAG_GAP&&p===Zt&&e.frag){const t=c[r].details;if(t){const n=Nn(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(g===Wt&&n.hasAudioGroup(y)||g===Xt&&n.hasSubtitleGroup(y))continue;if(p===Jt&&null!=(a=i.audioGroups)&&a.some((e=>n.hasAudioGroup(e)))||p===Qt&&null!=(o=i.subtitleGroups)&&o.some((e=>n.hasSubtitleGroup(e)))||f&&i.audioCodec===n.audioCodec||!f&&i.audioCodec!==n.audioCodec||m&&i.codecSet===n.codecSet)continue}l=r;break}}if(l>-1&&n.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:l}}return{action:2,flags:1}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===Y.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:s}=n;switch(i){case 0:this.switchLevel(e,s);break;case 2:r&&(t.maxHdcpLevel=yn[yn.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}n.resolved||this.switchLevel(e,s)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(j.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(j.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger(j.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let e=o.currentLevel;Z.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(j.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Se,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:Ia,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Pi{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Qt),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.LEVEL_LOADED,this.onLevelLoaded,this),e.on(j.ERROR,this.onError,this),e.on(j.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(j.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(j.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(j.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(j.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.LEVEL_LOADED,this.onLevelLoaded,this),e.off(j.ERROR,this.onError,this),e.off(j.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(j.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(j.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(j.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(j.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Ei,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=Ei,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let e=0;e<r.length;e++)if(a>=r[e].start&&a<=r[e].end){s=r[e];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach((t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}})),this.fragmentTracker.removeFragmentsInRange(n,e,Qt)}}onFragBuffered(e,t){var n;this.loadedmetadata||t.frag.type!==Zt||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===Qt&&(t.details===Y.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==wi&&(this.state=Ei))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){this.levels&&$r(this.levels,t)?this.levels=t.map((e=>new wn(e))):(this.tracksBuffered=[],this.levels=t.map((e=>{const t=new wn(e);return this.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Qt),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:s,id:a}=t;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const o=r[a];if(a>=r.length||!o)return;this.log(`Subtitle track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(n=o.details)&&n.live){const e=this.mainDetails;if(s.deltaUpdateFailed||!e)return;const t=e.fragments[0];var c;o.details?(l=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details),0===l&&t&&(l=t.start,kn(s,l))):s.hasProgramDateTime&&e.hasProgramDateTime?(ui(s,e),l=s.fragments[0].start):t&&(l=t.start,kn(s,l))}o.details=s,this.levelLastLoaded=o,a===i&&(this.startFragRequested||!this.mainDetails&&s.live||this.setStartPosition(this.mainDetails||s,l),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===Ei)&&(Nn(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&"AES-128"===i.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch((e=>{throw r.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e})).then((n=>{const i=performance.now();r.trigger(j.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})})).catch((e=>{this.warn(`${e.name}: ${e.message}`),this.state=Ei}))}}doTick(){if(this.media){if(this.state===Ei){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:i}=this,r=this.getLoadPosition(),s=ai.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,l=this.getFwdBufferInfo(this.media,Zt),c=n.details;if(o>this.getMaxBufferLength(null==l?void 0:l.len)+c.levelTargetDuration)return;const d=c.fragments,u=d.length,h=c.edge;let p=null;const f=this.fragPrevious;if(a<h){const e=i.maxFragLookUpTolerance,t=a>h-e?0:e;p=Nn(f,d,Math.max(d[0].start,a),t),!p&&f&&f.start<d[0].start&&(p=d[0])}else p=d[u-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),"initSegment"!==p.sn){const e=d[p.sn-c.startSN-1];e&&e.cc===p.cc&&this.fragmentTracker.getState(e)===Jn&&(p=e)}this.fragmentTracker.getState(p)===Jn&&this.loadFragment(p,n,a)}}else this.state=Ei}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new qr(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Un{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=ln(this.media.textTracks);for(let n=0;n<t.length;n++)if("hidden"===t[n].mode)e=t[n];else if("showing"===t[n].mode){e=t[n];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.MANIFEST_PARSED,this.onManifestParsed,this),e.on(j.LEVEL_LOADING,this.onLevelLoading,this),e.on(j.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(j.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(j.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.MANIFEST_PARSED,this.onManifestParsed,this),e.off(j.LEVEL_LOADING,this.onLevelLoading,this),e.off(j.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(j.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(j.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),ln(this.media.textTracks).forEach((e=>{an(e)})),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Subtitle track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((e=>-1===(null==i?void 0:i.indexOf(e))))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter((e=>!n||-1!==n.indexOf(e.groupId)));if(e.length)this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),e.forEach(((e,t)=>{e.id=t}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!r&&t){this.selectDefaultTrack=!1;const n=Yn(t,e);if(n>-1)r=e[n];else{const e=Yn(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const s={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==n?void 0:n.join(",")}" group-id`),this.hls.trigger(j.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if((!n||r.default)&&(n||e)&&(!e||Kn(r,e)))return i}if(e){for(let n=0;n<t.length;n++){const i=t[n];if(Gr(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(Gr(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++)if(Hr(t[n],e))return n}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Xt||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Kn(e,n))return n;const i=Yn(e,this.tracksInGroup);if(i>-1){const e=this.tracksInGroup[i];return this.setSubtitleTrack(i),e}if(n)return null;{const n=Yn(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(j.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=ln(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter((e=>Hr(n,e)))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach((e=>{"disabled"!==e.mode&&e!==i&&(e.mode="disabled")})),i){const e=this.subtitleDisplay?"showing":"hidden";i.mode!==e&&(i.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!H(e))return void this.warn(`Invalid subtitle track id: ${e}`);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i)return void this.hls.trigger(j.SUBTITLE_TRACK_SWITCH,{id:e});const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:s,groupId:a="",name:o,type:l,url:c}=i;this.hls.trigger(j.SUBTITLE_TRACK_SWITCH,{id:s,groupId:a,name:o,type:l,url:c});const d=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(d)}},timelineController:class{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(j.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(j.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(j.FRAG_LOADING,this.onFragLoading,this),e.on(j.FRAG_LOADED,this.onFragLoaded,this),e.on(j.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(j.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(j.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(j.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(j.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(j.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(j.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(j.FRAG_LOADING,this.onFragLoading,this),e.off(j.FRAG_LOADED,this.onFragLoaded,this),e.off(j.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(j.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(j.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(j.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(j.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new hs(this,"textTrack1"),t=new hs(this,"textTrack2"),n=new hs(this,"textTrack3"),i=new hs(this,"textTrack4");this.cea608Parser1=new cs(1,e,t),this.cea608Parser2=new cs(3,n,i)}}addCues(e,t,n,i,r){let s=!1;for(let e=r.length;e--;){const i=r[e],d=(a=i[0],o=i[1],l=t,c=n,Math.min(o,c)-Math.max(a,l));if(d>=0&&(i[0]=Math.min(i[0],t),i[1]=Math.max(i[1],n),s=!0,d/(n-t)>.5))return}var a,o,l,c;if(s||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger(j.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){const{unparsedVttFrags:s}=this;"main"===n&&(this.initPTS[t.cc]={baseTime:i,timescale:r}),s.length&&(this.unparsedVttFrags=[],s.forEach((e=>{this.onFragLoaded(j.FRAG_LOADED,e)})))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(Us(r,{name:e,lang:t,attrs:{}}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=t[e],a=this.getExistingTrack(r,s);if(a)n[e]=a,an(n[e]),rn(n[e],i);else{const t=this.createTextTrack("captions",r,s);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(j.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach((t=>{an(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let e=0;e<t.length;e++)an(t[e])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some((e=>e.textCodec===Cs));if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if($r(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?ln(e.textTracks):null;if(this.tracks.forEach(((e,n)=>{let i;if(t){let n=null;for(let i=0;i<t.length;i++)if(t[i]&&Us(t[i],e)){n=t[i],t[i]=null;break}n&&(i=n)}if(i)an(i);else{const t=Bs(e);i=this.createTextTrack(t,e.name,e.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)})),null!=t&&t.length){const e=t.filter((e=>null!==e)).map((e=>e.label));e.length&&Z.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map((e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e})));this.hls.trigger(j.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}))}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Zt){var n,i;const{cea608Parser1:e,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=t.frag,l=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;e&&r&&(o!==s+1||o===s&&l!==this.lastPartIndex+1||a!==this.lastCc)&&(e.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Qt)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Cs?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(j.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Is(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),n.trigger(j.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{Z.log(`Failed to parse IMSC1: ${t}`),n.trigger(j.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(e);const o=this.hls;!function(e,t,n,i,r,s,a){const o=new Es,l=Ge(new Uint8Array(e)).trim().replace(Ts,"\n").split("\n"),c=[],d=t?function(e,t=1){return _r(e,9e4,1/t)}(t.baseTime,t.timescale):0;let u,h="00:00.000",p=0,f=0,m=!0;o.oncue=function(e){const s=n[i];let a=n.ccOffset;const o=(p-d)/9e4;if(null!=s&&s.new&&(void 0!==f?a=n.ccOffset=s.start:function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;null!=(s=r)&&s.new;){var s;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n}(n,i,o)),o){if(!t)return void(u=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const l=e.endTime-e.startTime,h=kr(9e4*(e.startTime+a-f),9e4*r)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+l,0);const m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=ks(e.startTime,e.endTime,m)),e.endTime>0&&c.push(e)},o.onparsingerror=function(e){u=e},o.onflush=function(){u?a(u):s(c)},l.forEach((e=>{if(m){if(Ss(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach((e=>{Ss(e,"LOCAL:")?h=e.slice(6):Ss(e,"MPEGTS:")&&(p=parseInt(e.slice(7)))}));try{f=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(H(t)&&H(n)&&H(i)&&H(r)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*i,t+=36e5*r,t}(h)/1e3}catch(e){u=e}return}""===e&&(m=!1)}o.parse(e+"\n")})),o.flush()}(null!=(t=n.initSegment)&&t.data?ct(n.initSegment.data,new Uint8Array(i)):i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(e=>{this._appendCues(e,n.level),o.trigger(j.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?s.push(e):this._fallbackToIMSC1(n,i),Z.log(`Failed to parse VTT cue: ${t}`),r&&a>n.cc||o.trigger(j.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Is(t,this.initPTS[e.cc],(()=>{n.textCodec=Cs,this._parseIMSC1(e,t)}),(()=>{n.textCodec="wvtt"}))}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((e=>sn(n,e)))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(j.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Qt&&this.onFragLoaded(j.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:r,samples:s}=t;if(r.type!==Zt||"NONE"!==this.closedCaptionsForLevel(r))for(let e=0;e<s.length;e++){const t=s[e].bytes;if(t){const r=this.extractCea608Data(t);n.addData(s[e].pts,r[0]),i.addData(s[e].pts,r[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:s}=this;if(s&&!(s.currentTime<n)){if(!r||"video"===r){const{captionsTracks:e}=this;Object.keys(e).forEach((i=>on(e[i],t,n)))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==i){const{textTracks:e}=this;Object.keys(e).forEach((n=>on(e[n],t,i)))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],s=127&e[i++];if((0!==r||0!==s)&&0!=(4&n)){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(s))}}return t}},audioStreamController:class extends Pi{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Jt),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.LEVEL_LOADED,this.onLevelLoaded,this),e.on(j.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(j.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(j.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(j.ERROR,this.onError,this),e.on(j.BUFFER_RESET,this.onBufferReset,this),e.on(j.BUFFER_CREATED,this.onBufferCreated,this),e.on(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(j.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(j.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(j.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.LEVEL_LOADED,this.onLevelLoaded,this),e.off(j.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(j.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(j.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(j.ERROR,this.onError,this),e.off(j.BUFFER_RESET,this.onBufferReset,this),e.off(j.BUFFER_CREATED,this.onBufferCreated,this),e.off(j.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(j.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(j.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(j.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){if("main"===n){const e=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:r},this.log(`InitPTS for cc: ${e} found from main: ${i}`),this.videoTrackCC=e,this.state===Ii&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=wi);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=Ei):(this.loadedmetadata=!1,this.state=ki),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Ei:this.doTickIdle();break;case ki:{var e;const{levels:t,trackId:n}=this,i=null==t||null==(e=t[n])?void 0:e.details;if(i){if(this.waitForCdnTuneIn(i))break;this.state=Ii}break}case xi:{var t;const e=performance.now(),n=this.retryDate;if(!n||e>=n||null!=(t=this.media)&&t.seeking){const{levels:e,trackId:t}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==e?void 0:e[t])||null),this.state=Ei}break}case Ii:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Si;const e={frag:t,part:n,payload:i.flush(),networkDetails:null};this._handleFragmentLoadProgress(e),r&&super._handleFragmentLoadComplete(e)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),n=ai.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole);Fn(n.end,this.config.maxFragLookUpTolerance,t)<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment())}}else this.state=Ei}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Ei)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,r=e.config;if(!this.buffering||!n&&(this.startFragRequested||!r.startFragPrefetch)||null==t||!t[i])return;const s=t[i],a=s.details;if(!a||a.live&&this.levelLastLoaded!==s||this.waitForCdnTuneIn(a))return void(this.state=ki);const o=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&o&&(this.bufferFlushed=!1,this.afterBufferFlushed(o,re,Jt));const l=this.getFwdBufferInfo(o,Jt);if(null===l)return;const{bufferedTrack:c,switchingTrack:d}=this;if(!d&&this._streamEnded(l,a))return e.trigger(j.BUFFER_EOS,{type:"audio"}),void(this.state=Ai);const u=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Zt),h=l.len,p=this.getMaxBufferLength(null==u?void 0:u.len),f=a.fragments,m=f[0].start;let g=this.flushing?this.getLoadPosition():l.end;if(d&&n){const e=this.getLoadPosition();c&&!Gr(d.attrs,c.attrs)&&(g=e),a.PTSKnown&&e<m&&(l.end>m||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=m+.05)}if(h>=p&&!d&&g<f[f.length-1].start)return;let y=this.getNextFragment(g,a),v=!1;if(y&&this.isLoopLoading(y,g)&&(v=!!y.gap,y=this.getNextFragmentLoopLoading(y,a,l,Zt,p)),!y)return void(this.bufferFlushed=!0);const b=u&&y.start>u.end+a.targetduration;if(b||(null==u||!u.len)&&l.len){const e=this.getAppendedFrag(y.start,Zt);if(null===e)return;if(v||(v=!!e.gap||!!b&&0===u.len),b&&!v||v&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(y,s,g)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map((e=>new wn(e)))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=Ei,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=wi),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(j.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:i}=this,{details:r,id:s}=t;if(!i)return void this.warn(`Audio tracks were reset while loading level ${s}`);this.log(`Audio track ${s} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const a=i[s];let o=0;if(r.live||null!=(n=a.details)&&n.live){this.checkLiveUpdate(r);const e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;var l;!a.details&&r.hasProgramDateTime&&e.hasProgramDateTime?(ui(r,e),o=r.fragments[0].start):o=this.alignPlaylists(r,a.details,null==(l=this.levelLastLoaded)?void 0:l.details)}a.details=r,this.levelLastLoaded=a,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(this.mainDetails||r,o),this.state!==ki||this.waitForCdnTuneIn(r)||(this.state=Ei),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const c=l.details;if(!c)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const d=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let u=this.transmuxer;u||(u=this.transmuxer=new Ur(this.hls,Jt,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[n.cc],p=null==(t=n.initSegment)?void 0:t.data;if(void 0!==h){const e=!1,t=i?i.index:-1,s=-1!==t,a=new oi(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,s);u.push(r,p,d,"",n,i,c.totalduration,e,a,h)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new Mi,complete:!1};e.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=Ii}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===Jt)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==n.sn){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(j.AUDIO_TRACK_SWITCHED,U({},e)))}this.fragBufferedComplete(n,i)}else if(!this.loadedmetadata&&n.type===Zt){const e=this.videoBuffer||this.media;e&&ai.getBuffered(e).length&&(this.loadedmetadata=!0)}}onError(e,t){var n;if(t.fatal)this.state=Ri;else switch(t.details){case Y.FRAG_GAP:case Y.FRAG_PARSING_ERROR:case Y.FRAG_DECRYPT_ERROR:case Y.FRAG_LOAD_ERROR:case Y.FRAG_LOAD_TIMEOUT:case Y.KEY_LOAD_ERROR:case Y.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Jt,t);break;case Y.AUDIO_TRACK_LOAD_ERROR:case Y.AUDIO_TRACK_LOAD_TIMEOUT:case Y.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==ki||(null==(n=t.context)?void 0:n.type)!==Wt||(this.state=Ei);break;case Y.BUFFER_APPEND_ERROR:case Y.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;if(t.details===Y.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Y.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushing(e,{type:t}){t!==se&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==se){this.flushing=!1,this.bufferFlushed=!0,this.state===Ai&&(this.state=Ei);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,t,Jt),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:d}=c,{audio:u,text:h,id3:p,initSegment:f}=r;if(!this.fragContextChanged(o)&&d){if(this.state=Ci,this.switchingTrack&&u&&this.completeAudioSwitch(this.switchingTrack),null!=f&&f.tracks){const e=o.initSegment||o;this._bufferInitSegment(c,f.tracks,e,s),i.trigger(j.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:f.tracks})}if(u){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=u;l&&(l.elementaryStreams[re]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(re,e,t,n,i),this.bufferFragmentData(u,o,l,s)}if(null!=p&&null!=(t=p.samples)&&t.length){const e=G({id:n,frag:o,details:d},p);i.trigger(j.FRAG_PARSING_METADATA,e)}if(h){const e=G({id:n,frag:o,details:d},h);i.trigger(j.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,n,i){if(this.state!==Ci)return;t.video&&delete t.video;const r=t.audio;if(!r)return;r.id="audio";const s=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${s}/${r.codec}]`),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger(j.BUFFER_CODECS,t);const a=r.initSegment;if(null!=a&&a.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(j.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;if(this.fragCurrent=e,this.switchingTrack||i===Jn||i===ei)if("initSegment"===e.sn)this._loadInitSegment(e,t);else if(null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Ii;const n=this.mainDetails;n&&n.fragments[0].start!==t.details.fragments[0].start&&ui(t.details,n)}else this.startFragRequested=!0,super.loadFragment(e,t,n);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:n}=this,i=null==n?void 0:n.attrs,r=e.attrs;t&&i&&(i.CHANNELS!==r.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(j.AUDIO_TRACK_SWITCHED,U({},e))}},audioTrackController:class extends Un{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.MANIFEST_PARSED,this.onManifestParsed,this),e.on(j.LEVEL_LOADING,this.onLevelLoading,this),e.on(j.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(j.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(j.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.MANIFEST_PARSED,this.onManifestParsed,this),e.off(j.LEVEL_LOADING,this.onLevelLoading,this),e.off(j.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(j.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(j.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Audio track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Audio track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some((e=>-1===(null==i?void 0:i.indexOf(e))))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter((e=>!n||-1!==n.indexOf(e.groupId)));if(e.length)this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),e.forEach(((e,t)=>{e.id=t}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!r&&t){const n=Yn(t,e,Wn);if(n>-1)r=e[n];else{const e=Yn(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const a={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==n?void 0:n.join(",")}`),this.hls.trigger(j.AUDIO_TRACKS_UPDATED,a);const o=this.trackId;if(-1!==i&&-1===o)this.setAudioTrack(i);else if(e.length&&-1===o){var s;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(s=this.groupIds)?void 0:s.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}else this.shouldReloadPlaylist(r)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Wt||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||(this.requestScheduled=-1,this.checkRetry(t)))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Kn(e,i,Wn))return i;const r=Yn(e,this.tracksInGroup,Wn);if(r>-1){const e=this.tracksInGroup[r];return this.setAudioTrack(r),e}if(i){let i=t.loadLevel;-1===i&&(i=t.firstAutoLevel);const r=function(e,t,n,i,r){const s=t[i],a=t.reduce(((e,t,n)=>{const i=t.uri;return(e[i]||(e[i]=[])).push(n),e}),{})[s.uri];a.length>1&&(i=Math.max.apply(Math,a));const o=s.videoRange,l=s.frameRate,c=s.codecSet.substring(0,4),d=Xn(t,i,(t=>{if(t.videoRange!==o||t.frameRate!==l||t.codecSet.substring(0,4)!==c)return!1;const i=t.audioGroups,s=n.filter((e=>!i||-1!==i.indexOf(e.groupId)));return Yn(e,s,r)>-1}));return d>-1?d:Xn(t,i,(t=>{const i=t.audioGroups,s=n.filter((e=>!i||-1!==i.indexOf(e.groupId)));return Yn(e,s,r)>-1}))}(e,t.levels,n,i,Wn);if(-1===r)return null;t.nextLoadLevel=r}if(e.channels||e.audioCodec){const t=Yn(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn(`Invalid audio track id: ${e}`);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;if(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(j.AUDIO_TRACK_SWITCHING,U({},i)),r)return;const s=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(s)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||Kn(e,i,Wn)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=e;for(let e=0;e<t.length;e++)if(Kn({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},t[e],Wn))return e;for(let n=0;n<t.length;n++){const i=t[n];if(Gr(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(Gr(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(j.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}},emeController:Hs,cmcdController:class{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:zs.MANIFEST,su:!this.initialized})}catch(e){Z.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{const t=e.frag,n=this.hls.levels[t.level],i=this.getObjectType(t),r={d:1e3*t.duration,ot:i};i!==zs.VIDEO&&i!==zs.AUDIO&&i!=zs.MUXED||(r.br=n.bitrate/1e3,r.tb=this.getTopBandwidth(i)/1e3,r.bl=this.getBufferLength(i)),this.apply(e,r)}catch(e){Z.warn("Could not generate segment CMCD data.",e)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||function(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)}))}}}(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(j.MEDIA_DETACHED,this.onMediaDetached,this),e.on(j.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(j.MEDIA_DETACHED,this.onMediaDetached,this),e.off(j.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:js.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){G(t,this.createData());const n=t.ot===zs.INIT||t.ot===zs.VIDEO||t.ot===zs.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce(((e,n)=>(i.includes(n)&&(e[n]=t[n]),e)),{})),this.useHeaders?(e.headers||(e.headers={}),function(e,t,n){G(e,function(e,t={}){if(!e)return{};const n=Object.entries(e),i=Object.entries(Ys).concat(Object.entries((null==t?void 0:t.customHeaderMap)||{})),r=n.reduce(((e,t)=>{var n;const[r,s]=t,a=(null==(n=i.find((e=>e[1].includes(r))))?void 0:n[0])||Vs.REQUEST;return null!=e[a]||(e[a]={}),e[a][r]=s,e}),{});return Object.entries(r).reduce(((e,[n,i])=>(e[n]=_a(i,t),e)),{})}(t,n))}(e.headers,t)):e.url=function(e,t,n){const i=function(e,t={}){if(!e)return"";const n=_a(e,t);return`CMCD=${encodeURIComponent(n)}`}(t,n);if(!i)return e;if(wa.test(e))return e.replace(wa,i);const r=e.includes("?")?"&":"?";return`${e}${r}${i}`}(e.url,t)}getObjectType(e){const{type:t}=e;return"subtitle"===t?zs.TIMED_TEXT:"initSegment"===e.sn?zs.INIT:"audio"===t?zs.AUDIO:"main"===t?this.hls.audioTracks.length?zs.VIDEO:zs.MUXED:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===zs.AUDIO)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}for(const e of t)e.bitrate>n&&(n=e.bitrate);return n>0?n:NaN}getBufferLength(e){const t=this.hls.media,n=e===zs.AUDIO?this.audioBuffer:this.videoBuffer;return n&&t?1e3*ai.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}},contentSteeringController:class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=Z.log.bind(Z,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(j.MANIFEST_PARSED,this.onManifestParsed,this),e.on(j.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(j.MANIFEST_PARSED,this.onManifestParsed,this),e.off(j.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(2===(null==n?void 0:n.action)&&1===n.flags){const e=this.levels;let i=this.pathwayPriority,r=this.pathwayId;if(t.context){const{groupId:n,pathwayId:i,type:s}=t.context;n&&e?r=this.getPathwayForGroupId(n,s,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&e&&(i=e.reduce(((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e)),[])),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),n.resolved||Z.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${r} levels: ${e?e.length:e} priorities: ${JSON.stringify(i)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){let t;this.pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach((e=>{i-n[e]>3e5&&delete n[e]}));for(let i=0;i<e.length;i++){const r=e[i];if(r in n)continue;if(r===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(t=this.getLevelsForPathway(r),t.length>0){this.log(`Setting Pathway to "${r}"`),this.pathwayId=r,An(t),this.hls.trigger(j.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let n=0;n<i.length;n++)if(t===Wt&&i[n].hasAudioGroup(e)||t===Xt&&i[n].hasSubtitleGroup(e))return i[n].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach((e=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=e;if(t.some((e=>e.pathwayId===r)))return;const o=this.getLevelsForPathway(s).map((e=>{const t=new ee(e.attrs);t["PATHWAY-ID"]=r;const s=t.AUDIO&&`${t.AUDIO}_clone_${r}`,o=t.SUBTITLES&&`${t.SUBTITLES}_clone_${r}`;s&&(n[t.AUDIO]=s,t.AUDIO=s),o&&(i[t.SUBTITLES]=o,t.SUBTITLES=o);const l=Ta(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),c=new wn({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let t=1;t<e.audioGroups.length;t++)c.addGroupId("audio",`${e.audioGroups[t]}_clone_${r}`);if(e.subtitleGroups)for(let t=1;t<e.subtitleGroups.length;t++)c.addGroupId("text",`${e.subtitleGroups[t]}_clone_${r}`);return c}));t.push(...o),Ea(this.audioTracks,n,a,r),Ea(this.subtitleTracks,i,a,r)}))}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},s=t.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log(`Loaded steering manifest: "${i}"`);const s=e.data;if(1!==s.VERSION)return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o);const c={steeringManifest:s,url:i.toString()};this.hls.trigger(j.STEERING_MANIFEST_LOADED,c),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,r);else{const e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,o,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)}),t)}}});function Pa(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(Pa):Object.keys(e).reduce(((t,n)=>(t[n]=Pa(e[n]),t)),{}):e}let Ma;class Oa extends Un{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(j.LEVEL_LOADED,this.onLevelLoaded,this),e.on(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(j.FRAG_BUFFERED,this.onFragBuffered,this),e.on(j.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(j.LEVEL_LOADED,this.onLevelLoaded,this),e.off(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(j.FRAG_BUFFERED,this.onFragBuffered,this),e.off(j.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach((e=>{e.loadError=0,e.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},s={};let a=!1,o=!1,l=!1;t.levels.forEach((e=>{var t,c;const d=e.attrs;let{audioCodec:u,videoCodec:h}=e;-1!==(null==(t=u)?void 0:t.indexOf("mp4a.40.34"))&&(Ma||(Ma=/chrome|firefox/i.test(navigator.userAgent)),Ma&&(e.audioCodec=u=void 0)),u&&(e.audioCodec=u=Dt(u,n)),0===(null==(c=h)?void 0:c.indexOf("avc1"))&&(h=e.videoCodec=function(e){const t=e.split(",");for(let e=0;e<t.length;e++){const n=t[e].split(".");if(n.length>2){let i=n.shift()+".";i+=parseInt(n.shift()).toString(16),i+=("000"+parseInt(n.shift()).toString(16)).slice(-4),t[e]=i}}return t.join(",")}(h));const{width:p,height:f,unknownCodecs:m}=e;if(a||(a=!(!p||!f)),o||(o=!!h),l||(l=!!u),null!=m&&m.length||u&&!xt(u,"audio",n)||h&&!xt(h,"video",n))return;const{CODECS:g,"FRAME-RATE":y,"HDCP-LEVEL":v,"PATHWAY-ID":b,RESOLUTION:_,"VIDEO-RANGE":w}=d,E=`${b||"."}-${e.bitrate}-${_}-${y}-${g}-${w}-${v}`;if(r[E])if(r[E].uri===e.url||e.attrs["PATHWAY-ID"])r[E].addGroupId("audio",d.AUDIO),r[E].addGroupId("text",d.SUBTITLES);else{const t=s[E]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=new wn(e);r[E]=n,i.push(n)}else{const t=new wn(e);r[E]=t,s[E]=1,i.push(t)}})),this.filterAndSortMediaOptions(i,t,a,o,l)}filterAndSortMediaOptions(e,t,n,i,r){let s=[],a=[],o=e;if((n||i)&&r&&(o=o.filter((({videoCodec:e,videoRange:t,width:n,height:i})=>{return(!!e||!(!n||!i))&&!!(r=t)&&vn.indexOf(r)>-1;var r}))),0===o.length)return void Promise.resolve().then((()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}));if(t.audioTracks){const{preferManagedMediaSource:e}=this.hls.config;s=t.audioTracks.filter((t=>!t.audioCodec||xt(t.audioCodec,"audio",e))),Na(s)}t.subtitles&&(a=t.subtitles,Na(a));const l=o.slice(0);o.sort(((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return vn.indexOf(e.videoRange)-vn.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=Lt(e.videoCodec),i=Lt(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=At(e.codecSet),i=At(t.codecSet);if(n!==i)return i-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));let c=l[0];if(this.steering&&(o=this.steering.filterParsedLevels(o),o.length!==l.length))for(let e=0;e<l.length;e++)if(l[e].pathwayId===o[0].pathwayId){c=l[e];break}this._levels=o;for(let e=0;e<o.length;e++)if(o[e]===c){var d;this._firstLevel=e;const t=c.bitrate,n=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${t}`),void 0===(null==(d=this.hls.userConfig)?void 0:d.abrEwmaDefaultEstimate)){const e=Math.min(t,this.hls.config.abrEwmaDefaultEstimateMax);e>n&&n===Da.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=e)}break}const u=r&&!i,h={levels:o,audioTracks:s,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:!u&&s.some((e=>!!e.url))};this.hls.trigger(j.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(j.ERROR,{type:V.OTHER_ERROR,details:Y.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],a=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,n===e&&s.details&&i&&r===a)return;this.log(`Switching to level ${e} (${s.height?s.height+"p ":""}${s.videoRange?s.videoRange+" ":""}${s.codecSet?s.codecSet+" ":""}@${s.bitrate})${a?" with Pathway "+a:""} from level ${n}${r?" with Pathway "+r:""}`);const o={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(j.LEVEL_SWITCHING,o);const l=s.details;if(!l||l.live){const e=this.switchParams(s.uri,null==i?void 0:i.details,l);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===Kt&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(void 0!==t&&t.type===Zt){const e=t.elementaryStreams;if(!Object.keys(e).some((t=>!!e[t])))return;const n=this._levels[t.level];null!=n&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,s=this._levels[i];var a;if(!s)return this.warn(`Invalid level index ${i}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===s.fragmentError&&(s.loadError=0),this.playlistLoaded(i,t,s.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}const r=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${r?" Pathway "+r:""} ${i}`),this.clearTimer(),this.hls.trigger(j.LEVEL_LOADING,{url:i,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter(((t,n)=>n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((e=>e.level=-1))),!1)));An(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(j.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(j.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function Na(e){const t={};e.forEach((e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++}))}class Fa{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==(null==(t=i.context)?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Y.KEY_LOAD_ERROR,n,i,r){return new gi({type:V.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let e=0;e<t.length;e++){const r=t[e];if(i<=r.cc&&("initSegment"===n||"initSegment"===r.sn||n<r.sn)){this.emeController.selectKeySystemFormat(r).then((e=>{r.setKeyFormat(e)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Y.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,Y.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));let a=this.keyUriToKeyInfo[s];if(null!=(n=a)&&n.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var o;if(null!=(i=a)&&i.keyLoadPromise)switch(null==(o=a.mediaKeySessionContext)?void 0:o.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[s]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,Y.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,n)))).catch((t=>{throw e.keyLoadPromise=null,t}))}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=new(0,n.loader)(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise(((r,s)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=n.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{const{frag:a,keyInfo:o,url:l}=n;if(!a.decryptdata||o!==this.keyUriToKeyInfo[l])return s(this.createKeyLoadError(a,Y.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));o.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(e,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Y.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),i,U({url:a.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Y.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Y.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};i.load(a,l,c)}))}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}function Ba(){return self.SourceBuffer||self.WebKitSourceBuffer}function Ua(){if(!Tt())return!1;const e=Ba();return!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove}class $a{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:r}=this;if(null===i)return;const{currentTime:s,seeking:a}=i,o=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,s!==e){if(this.moved=!0,a||(this.nudgeRetry=0),null!==r){if(this.stallReported){const e=self.performance.now()-r;Z.warn(`playback not stuck anymore @${s}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null}return}if(l||o)return void(this.stalled=null);if(i.paused&&!a||i.ended||0===i.playbackRate||!ai.getBuffered(i).length)return void(this.nudgeRetry=0);const c=ai.bufferInfo(i,s,0),d=c.nextStart||0;if(a){const e=c.len>2,n=!d||t&&t.start<=s||d-s>2&&!this.fragmentTracker.getPartialFragment(s);if(e||n)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var u;if(!(c.len>0||d))return;const e=Math.max(d,c.start||0)-s,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,n=(null==t||null==(u=t.details)?void 0:u.live)?2*t.details.targetduration:2,r=this.fragmentTracker.getPartialFragment(s);if(e>0&&(e<=n||r))return void(i.paused||this._trySkipBufferHole(r))}const h=self.performance.now();if(null===r)return void(this.stalled=h);const p=h-r;if(!a&&p>=250&&(this._reportStall(c),!this.media))return;const f=ai.bufferInfo(i,s,n.maxBufferHole);this._tryFixBufferStall(f,p)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:r}=this;if(null===r)return;const s=r.currentTime,a=i.getPartialFragment(s);(!a||!this._trySkipBufferHole(a)&&this.media)&&(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-s<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(Z.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const i=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);Z.warn(i.message),t.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(null===i)return 0;const r=i.currentTime,s=ai.bufferInfo(i,r,0),a=r<s.start?s.start:s.nextStart;if(a){const o=s.len<=t.maxBufferHole,l=s.len>0&&s.len<1&&i.readyState<3,c=a-r;if(c>0&&(o||l)){if(c>t.maxBufferHole){const{fragmentTracker:t}=this;let n=!1;if(0===r){const e=t.getAppendedFrag(0,Zt);e&&a<e.end&&(n=!0)}if(!n){const n=e||t.getAppendedFrag(r,Zt);if(n){let e=!1,i=n.end;for(;i<a;){const n=t.getPartialFragment(i);if(!n){e=!0;break}i+=n.duration}if(e)return 0}}}const s=Math.max(a+.05,r+.1);if(Z.warn(`skipping hole, adjusting currentTime from ${r} to ${s}`),this.moved=!0,this.stalled=null,i.currentTime=s,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${s}`);n.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return s}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(null===n)return;const r=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const s=r+(i+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${r} to ${s}`);Z.warn(a.message),n.currentTime=s,t.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const n=new Error(`Playhead still not moving while enough data buffered @${r} after ${e.nudgeMaxRetry} nudges`);Z.error(n.message),t.trigger(j.ERROR,{type:V.MEDIA_ERROR,details:Y.BUFFER_STALLED_ERROR,error:n,fatal:!0})}}}class Ga extends Pi{constructor(e,t,n){super(e,t,n,"[stream-controller]",Zt),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(j.MANIFEST_LOADING,this.onManifestLoading,this),e.on(j.MANIFEST_PARSED,this.onManifestParsed,this),e.on(j.LEVEL_LOADING,this.onLevelLoading,this),e.on(j.LEVEL_LOADED,this.onLevelLoaded,this),e.on(j.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(j.ERROR,this.onError,this),e.on(j.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(j.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(j.BUFFER_CREATED,this.onBufferCreated,this),e.on(j.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(j.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(j.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(j.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(j.MANIFEST_LOADING,this.onManifestLoading,this),e.off(j.MANIFEST_PARSED,this.onManifestParsed,this),e.off(j.LEVEL_LOADED,this.onLevelLoaded,this),e.off(j.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(j.ERROR,this.onError,this),e.off(j.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(j.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(j.BUFFER_CREATED,this.onBufferCreated,this),e.off(j.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(j.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(j.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=n.startLevel;-1===e&&(n.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=n.firstAutoLevel),n.nextLoadLevel=e,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=Ei,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=wi}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Di:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n)){if(this.waitForCdnTuneIn(i))break;this.state=Ei;break}if(this.hls.nextLoadLevel!==this.level){this.state=Ei;break}break}case xi:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,level:t}=this,n=null==e?void 0:e[t];this.resetStartWhenNotLoaded(n||null),this.state=Ei}}}this.state===Ei&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(null===t||!i&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(null==n||!n[r])return;const s=n[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(j.BUFFER_EOS,e),void(this.state=Ai)}if(!this.buffering)return;e.loadLevel!==r&&-1===e.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const l=s.details;if(!l||this.state===Di||l.live&&this.levelLastLoaded!==s)return this.level=r,void(this.state=Di);const c=a.len,d=this.getMaxBufferLength(s.maxBitrate);if(c>=d)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const u=this.backtrackFragment?this.backtrackFragment.start:a.end;let h=this.getNextFragment(u,l);if(this.couldBacktrack&&!this.fragPrevious&&h&&"initSegment"!==h.sn&&this.fragmentTracker.getState(h)!==ti){var p;const e=(null!=(p=this.backtrackFragment)?p:h).sn-l.startSN,t=l.fragments[e-1];t&&h.cc===t.cc&&(h=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,u)){if(!h.gap){const e=this.audioOnly&&!this.altAudio?re:se,t=(e===se?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,Zt)}h=this.getNextFragmentLoopLoading(h,l,a,Zt,d)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),this.loadFragment(h,s,u))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===Jn||i===ei?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Zt)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*i)+1:0}else n=0;const s=this.getBufferedFrag(t.currentTime+n);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(s.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Ti:case Si:case xi:case Ci:case Li:this.state=Ei}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new $a(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;H(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(j.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach((e=>{const t=e.audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=n&&i&&!function(){var e;const t=Ba();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Ei)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=Di)}onLevelLoaded(e,t){var n;const{levels:i}=this,r=t.level,s=t.details,a=s.totalduration;if(!i)return void this.warn(`Levels were reset while loading level ${r}`);this.log(`Level ${r} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""}, cc [${s.startCC}, ${s.endCC}] duration:${a}`);const o=i[r],l=this.fragCurrent;!l||this.state!==Si&&this.state!==xi||l.level!==t.level&&l.loader&&this.abortCurrentFrag();let c=0;if(s.live||null!=(n=o.details)&&n.live){var d;if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;c=this.alignPlaylists(s,o.details,null==(d=this.levelLastLoaded)?void 0:d.details)}if(o.details=s,this.levelLastLoaded=o,this.hls.trigger(j.LEVEL_UPDATED,{details:s,level:r}),this.state===Di){if(this.waitForCdnTuneIn(s))return;this.state=Ei}this.startFragRequested?s.live&&this.synchronizeToLiveEdge(s):this.setStartPosition(s,c),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=s[n.level],o=a.details;if(!o)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,c=o.PTSKnown||!o.live,d=null==(t=n.initSegment)?void 0:t.data,u=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new Ur(this.hls,Zt,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=i?i.index:-1,f=-1!==p,m=new oi(n.level,n.sn,n.stats.chunkCount,r.byteLength,p,f),g=this.initPTS[n.cc];h.push(r,d,u,l,n,i,o.totalduration,c,m,g)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;n&&(e.trigger(j.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(j.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,s=!1;for(const e in n){const t=n[e];if("main"===t.id){if(r=e,i=t,"video"===e){const t=n[e];t&&(this.videoBuffer=t.buffer)}}else s=!0}s&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==Zt)return;if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Li&&(this.state=Ei));const r=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal)this.state=Ri;else switch(t.details){case Y.FRAG_GAP:case Y.FRAG_PARSING_ERROR:case Y.FRAG_DECRYPT_ERROR:case Y.FRAG_LOAD_ERROR:case Y.FRAG_LOAD_TIMEOUT:case Y.KEY_LOAD_ERROR:case Y.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Zt,t);break;case Y.LEVEL_LOAD_ERROR:case Y.LEVEL_LOAD_TIMEOUT:case Y.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Di||(null==(n=t.context)?void 0:n.type)!==Kt||(this.state=Ei);break;case Y.BUFFER_APPEND_ERROR:case Y.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;if(t.details===Y.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Y.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!ai.getBuffered(e).length){const e=this.state!==Ei?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Ei,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==re||this.audioOnly&&!this.altAudio){const e=(t===se?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,Zt),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const i=ai.getBuffered(e),r=(i.length?i.start(0):0)-n;r>0&&(r<this.config.maxBufferHole||r<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${r} to match buffer start`),n+=r,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then((n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=Ei,this.startFragRequested=!1,this.bitrateTest=!1;const r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),i.trigger(j.FRAG_LOADED,n),e.bitrateTest=!1}))}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{video:d,text:u,id3:h,initSegment:p}=r,{details:f}=c,m=this.altAudio?void 0:r.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=Ci,p){if(null!=p&&p.tracks){const e=o.initSegment||o;this._bufferInitSegment(c,p.tracks,e,s),i.trigger(j.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}const e=p.initPTS,t=p.timescale;H(e)&&(this.initPTS[o.cc]={baseTime:e,timescale:t},i.trigger(j.INIT_PTS_FOUND,{frag:o,id:n,initPTS:e,timescale:t}))}if(d&&f&&"initSegment"!==o.sn){const e=f.fragments[o.sn-1-f.startSN],t=o.sn===f.startSN,n=!e||o.cc>e.cc;if(!1!==r.independent){const{startPTS:e,endPTS:i,startDTS:r,endDTS:a}=d;if(l)l.elementaryStreams[d.type]={startPTS:e,endPTS:i,startDTS:r,endDTS:a};else if(d.firstKeyFrame&&d.independent&&1===s.id&&!n&&(this.couldBacktrack=!0),d.dropped&&d.independent){const r=this.getMainFwdBufferInfo(),s=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,l=d.firstKeyFramePTS?d.firstKeyFramePTS:e;if(!t&&s<l-this.config.maxBufferHole&&!n)return void this.backtrack(o);n&&(o.gap=!0),o.setElementaryStreamInfo(d.type,o.start,i,o.start,a,!0)}else t&&e>2&&(o.gap=!0);o.setElementaryStreamInfo(d.type,e,i,r,a),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(d,o,l,s,t||n)}else{if(!t&&!n)return void this.backtrack(o);o.gap=!0}}if(m){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=m;l&&(l.elementaryStreams[re]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(re,e,t,n,i),this.bufferFragmentData(m,o,l,s)}if(f&&null!=h&&null!=(t=h.samples)&&t.length){const e={id:n,frag:o,details:f,samples:h.samples};i.trigger(j.FRAG_PARSING_METADATA,e)}if(f&&u){const e={id:n,frag:o,details:f,samples:u.samples};i.trigger(j.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,n,i){if(this.state!==Ci)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:r,video:s,audiovideo:a}=t;if(r){let t=e.audioCodec;const n=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=r.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===n.indexOf("firefox")&&(t="mp4a.40.5")}t&&-1!==t.indexOf("mp4a.40.5")&&-1!==n.indexOf("android")&&"audio/mpeg"!==r.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),r.levelCodec=t,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${r.codec}]`)}s&&(s.levelCodec=e.videoCodec,s.id="main",this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${e.videoCodec||""}/${s.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(j.BUFFER_CODECS,t),Object.keys(t).forEach((e=>{const r=t[e].initSegment;null!=r&&r.byteLength&&this.hls.trigger(j.BUFFER_APPENDING,{type:e,data:r,frag:n,part:null,chunkMeta:i,parent:n.type})})),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Zt)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Ei}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(ai.isBuffered(e,n)?t=this.getAppendedFrag(n):ai.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger(j.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(j.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&H(t)&&H(n.programDateTime)){const e=n.programDateTime+1e3*(t-n.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Ha{static get version(){return"1.5.18"}static isMSESupported(){return Ua()}static isSupported(){return function(){if(!Ua())return!1;const e=Tt();return"function"==typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((t=>e.isTypeSupported(Ct(t,"video"))))||["mp4a.40.2","fLaC"].some((t=>e.isTypeSupported(Ct(t,"audio")))))}()}static getMediaSource(){return Tt()}static get Events(){return j}static get ErrorTypes(){return V}static get ErrorDetails(){return Y}static get DefaultConfig(){return Ha.defaultConfig?Ha.defaultConfig:Da}static set DefaultConfig(e){Ha.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Br,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,function(e,t){if("object"==typeof console&&!0===e||"object"==typeof e){!function(e,...t){t.forEach((function(t){X[t]=e[t]?e[t].bind(e):function(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):K}(t)}))}(e,"debug","log","info","warn","error");try{X.log('Debug logs enabled for "Hls instance" in hls.js version 1.5.18')}catch(e){X=W}}else X=W}(e.debug||!1);const t=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Pa(e),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((e=>{const r=`${"level"===e?"playlist":e}LoadPolicy`,s=void 0===t[r],a=[];i.forEach((i=>{const o=`${e}Loading${i}`,l=t[o];if(void 0!==l&&s){a.push(o);const e=n[r].default;switch(t[r]={default:e},i){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}})),a.length&&Z.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${r}": ${JSON.stringify(t[r])}`)})),U(U({},n),t)}(Ha.DefaultConfig,e);this.userConfig=e,t.progressive&&function(e){const t=e.loader;t!==Ca&&t!==xa?(Z.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=Ca,e.progressive=!0,e.enableSoftwareAES=!0,Z.log("[config]: Progressive streaming enabled, using FetchLoader"))}(t);const{abrController:n,bufferController:i,capLevelController:r,errorController:s,fpsController:a}=t,o=new s(this),l=this.abrController=new n(this),c=this.bufferController=new i(this),d=this.capLevelController=new r(this),u=new a(this),h=new nn(this),p=new mn(this),f=t.contentSteeringController,m=f?new f(this):null,g=this.levelController=new Oa(this,m),y=new ni(this),v=new Fa(this.config),b=this.streamController=new Ga(this,y,v);d.setStreamController(b),u.setStreamController(b);const _=[h,g,b];m&&_.splice(1,0,m),this.networkControllers=_;const w=[l,c,d,u,p,y];this.audioTrackController=this.createController(t.audioTrackController,_);const E=t.audioStreamController;E&&_.push(new E(this,y,v)),this.subtitleTrackController=this.createController(t.subtitleTrackController,_);const T=t.subtitleStreamController;T&&_.push(new T(this,y,v)),this.createController(t.timelineController,w),v.emeController=this.emeController=this.createController(t.emeController,w),this.cmcdController=this.createController(t.cmcdController,w),this.latencyController=this.createController(gn,w),this.coreComponents=w,_.push(o);const S=o.onErrorOut;"function"==typeof S&&this.on(j.ERROR,S,o)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(Z.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;const n=e===j.ERROR;this.trigger(j.ERROR,{type:V.OTHER_ERROR,details:Y.INTERNAL_EXCEPTION,fatal:n,event:e,error:t}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){Z.log("destroy"),this.trigger(j.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((e=>e.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((e=>e.destroy())),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){Z.log("attachMedia"),this._media=e,this.trigger(j.MEDIA_ATTACHING,{media:e})}detachMedia(){Z.log("detachMedia"),this.trigger(j.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=F.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,Z.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(j.MANIFEST_LOADING,{url:e})}startLoad(e=-1){Z.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),this.started&&this.networkControllers);t++);}stopLoad(){Z.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}resumeBuffering(){Z.log("resume buffering"),this.networkControllers.forEach((e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){Z.log("pause buffering"),this.networkControllers.forEach((e=>{e.pauseBuffering&&e.pauseBuffering()}))}swapAudioCodec(){Z.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){Z.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){return this.levelController.levels||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){Z.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){Z.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){Z.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){Z.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){Z.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(Z.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){(function(e){return yn.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let t=i;t--;){const i=e[t].attrs["HDCP-LEVEL"];if(i&&i<=n)return t}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return null==(t=this.audioTrackController)?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return null==(t=this.subtitleTrackController)||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Ha.defaultConfig=void 0;var qa=n(443),za=n.n(qa);n(251);const ja=Object.prototype.toString;function Va(e){switch(ja.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return no(e,Error)}}function Ya(e,t){return ja.call(e)===`[object ${t}]`}function Ka(e){return Ya(e,"ErrorEvent")}function Wa(e){return Ya(e,"DOMError")}function Xa(e){return Ya(e,"String")}function Za(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function Ja(e){return Ya(e,"Object")}function Qa(e){return"undefined"!=typeof Event&&no(e,Event)}function eo(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function to(e){return"number"==typeof e&&e!=e}function no(e,t){try{return e instanceof t}catch(e){return!1}}var io=n(235);const ro=(0,io.Rf)(),so=80;function ao(e,t={}){try{let n=e;const i=5,r=[];let s=0,a=0;const o=" > ",l=o.length;let c;const d=Array.isArray(t)?t:t.keyAttrs,u=!Array.isArray(t)&&t.maxStringLength||so;for(;n&&s++<i&&(c=oo(n,d),!("html"===c||s>1&&a+r.length*l+c.length>=u));)r.push(c),a+=c.length,n=n.parentNode;return r.reverse().join(o)}catch(e){return"<unknown>"}}function oo(e,t){const n=e,i=[];let r,s,a,o,l;if(!n||!n.tagName)return"";i.push(n.tagName.toLowerCase());const c=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(c&&c.length)c.forEach((e=>{i.push(`[${e[0]}="${e[1]}"]`)}));else if(n.id&&i.push(`#${n.id}`),r=n.className,r&&Xa(r))for(s=r.split(/\s+/),l=0;l<s.length;l++)i.push(`.${s[l]}`);const d=["aria-label","type","name","title","alt"];for(l=0;l<d.length;l++)a=d[l],o=n.getAttribute(a),o&&i.push(`[${a}="${o}"]`);return i.join("")}function lo(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function co(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const i=e[t];try{n.push(String(i))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function uo(e,t=[],n=!1){return t.some((t=>function(e,t,n=!1){return!!Xa(e)&&(Ya(t,"RegExp")?t.test(e):!!Xa(t)&&(n?e===t:e.includes(t)))}(e,t,n)))}function ho(e,t,n){if(!(t in e))return;const i=e[t],r=n(i);if("function"==typeof r)try{fo(r,i)}catch(e){}e[t]=r}function po(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}function fo(e,t){const n=t.prototype||{};e.prototype=t.prototype=n,po(e,"__sentry_original__",t)}function mo(e){return e.__sentry_original__}function go(e){if(Va(e))return{message:e.message,name:e.name,stack:e.stack,...vo(e)};if(Qa(e)){const t={type:e.type,target:yo(e.target),currentTarget:yo(e.currentTarget),...vo(e)};return"undefined"!=typeof CustomEvent&&no(e,CustomEvent)&&(t.detail=e.detail),t}return e}function yo(e){try{return"undefined"!=typeof Element&&no(e,Element)?ao(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}}function vo(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function bo(e){return _o(e,new Map)}function _o(e,t){if(Ja(e)){const n=t.get(e);if(void 0!==n)return n;const i={};t.set(e,i);for(const n of Object.keys(e))void 0!==e[n]&&(i[n]=_o(e[n],t));return i}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const i=[];return t.set(e,i),e.forEach((e=>{i.push(_o(e,t))})),i}return e}function wo(){const e=io.n2,t=e.crypto||e.msCrypto;if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");const n=t&&t.getRandomValues?()=>t.getRandomValues(new Uint8Array(1))[0]:()=>16*Math.random();return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function Eo(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function To(e){const{message:t,event_id:n}=e;if(t)return t;const i=Eo(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function So(e,t,n){const i=e.exception=e.exception||{},r=i.values=i.values||[],s=r[0]=r[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function xo(e,t){const n=Eo(e);if(!n)return;const i=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...i,...t},t&&"data"in t){const e={...i&&i.data,...t.data};n.mechanism.data=e}}function ko(e){if(e&&e.__sentry_captured__)return!0;try{po(e,"__sentry_captured__",!0)}catch(e){}return!1}function Co(e){return Array.isArray(e)?e:[e]}const Lo=["debug","info","warn","error","log","assert","trace"];function Ao(e){if(!("console"in io.n2))return e();const t=io.n2.console,n={};Lo.forEach((e=>{const i=t[e]&&t[e].__sentry_original__;e in t&&i&&(n[e]=t[e],t[e]=i)}));try{return e()}finally{Object.keys(n).forEach((e=>{t[e]=n[e]}))}}function Ro(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1}};return"undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?Lo.forEach((n=>{t[n]=(...t)=>{e&&Ao((()=>{io.n2.console[n](`Sentry Logger [${n}]:`,...t)}))}})):Lo.forEach((e=>{t[e]=()=>{}})),t}let Io;Io="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?(0,io.YO)("logger",Ro):Ro();var Do=n(170);const Po="production";var Mo;function Oo(e){return new Fo((t=>{t(e)}))}function No(e){return new Fo(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"}(Mo||(Mo={}));class Fo{constructor(e){Fo.prototype.__init.call(this),Fo.prototype.__init2.call(this),Fo.prototype.__init3.call(this),Fo.prototype.__init4.call(this),this._state=Mo.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new Fo(((n,i)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){i(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){i(e)}else i(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new Fo(((t,n)=>{let i,r;return this.then((t=>{r=!1,i=t,e&&e()}),(t=>{r=!0,i=t,e&&e()})).then((()=>{r?n(i):t(i)}))}))}__init(){this._resolve=e=>{this._setResult(Mo.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(Mo.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===Mo.PENDING&&(eo(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===Mo.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===Mo.RESOLVED&&e[1](this._value),this._state===Mo.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function Bo(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||(0,Do.ph)(),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:wo()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}class Uo{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=Ho()}static clone(e){const t=new Uo;return e&&(t._breadcrumbs=[...e._breadcrumbs],t._tags={...e._tags},t._extra={...e._extra},t._contexts={...e._contexts},t._user=e._user,t._level=e._level,t._span=e._span,t._session=e._session,t._transactionName=e._transactionName,t._fingerprint=e._fingerprint,t._eventProcessors=[...e._eventProcessors],t._requestSession=e._requestSession,t._attachments=[...e._attachments],t._sdkProcessingMetadata={...e._sdkProcessingMetadata},t._propagationContext={...e._propagationContext}),t}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&Bo(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if("function"==typeof e){const t=e(this);return t instanceof Uo?t:this}return e instanceof Uo?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Ja(e)&&(this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=Ho(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const i={timestamp:(0,Do.yW)(),...e};return this._breadcrumbs=[...this._breadcrumbs,i].slice(-n),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(e,t={}){if(this._extra&&Object.keys(this._extra).length&&(e.extra={...this._extra,...e.extra}),this._tags&&Object.keys(this._tags).length&&(e.tags={...this._tags,...e.tags}),this._user&&Object.keys(this._user).length&&(e.user={...this._user,...e.user}),this._contexts&&Object.keys(this._contexts).length&&(e.contexts={...this._contexts,...e.contexts}),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts={trace:this._span.getTraceContext(),...e.contexts};const t=this._span.transaction;if(t){e.sdkProcessingMetadata={dynamicSamplingContext:t.getDynamicSamplingContext(),...e.sdkProcessingMetadata};const n=t.name;n&&(e.tags={transaction:n,...e.tags})}}return this._applyFingerprint(e),e.breadcrumbs=[...e.breadcrumbs||[],...this._breadcrumbs],e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...this._sdkProcessingMetadata,propagationContext:this._propagationContext},this._notifyEventProcessors([...$o(),...this._eventProcessors],e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_notifyEventProcessors(e,t,n,i=0){return new Fo(((r,s)=>{const a=e[i];if(null===t||"function"!=typeof a)r(t);else{const o=a({...t},n);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&a.id&&null===o&&Io.log(`Event processor "${a.id}" dropped event`),eo(o)?o.then((t=>this._notifyEventProcessors(e,t,n,i+1).then(r))).then(null,s):this._notifyEventProcessors(e,o,n,i+1).then(r).then(null,s)}}))}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}_applyFingerprint(e){e.fingerprint=e.fingerprint?Co(e.fingerprint):[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}}function $o(){return(0,io.YO)("globalEventProcessors",(()=>[]))}function Go(e){$o().push(e)}function Ho(){return{traceId:wo(),spanId:wo().substring(16),sampled:!1}}const qo=4,zo=100;class jo{constructor(e,t=new Uo,n=qo){this._version=n,this._stack=[{scope:t}],e&&this.bindClient(e)}isOlderThan(e){return this._version<e}bindClient(e){this.getStackTop().client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=Uo.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1||!this.getStack().pop())}withScope(e){const t=this.pushScope();try{e(t)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){const n=this._lastEventId=t&&t.event_id?t.event_id:wo(),i=new Error("Sentry syntheticException");return this._withClient(((r,s)=>{r.captureException(e,{originalException:e,syntheticException:i,...t,event_id:n},s)})),n}captureMessage(e,t,n){const i=this._lastEventId=n&&n.event_id?n.event_id:wo(),r=new Error(e);return this._withClient(((s,a)=>{s.captureMessage(e,t,{originalException:e,syntheticException:r,...n,event_id:i},a)})),i}captureEvent(e,t){const n=t&&t.event_id?t.event_id:wo();return e.type||(this._lastEventId=n),this._withClient(((i,r)=>{i.captureEvent(e,{...t,event_id:n},r)})),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){const{scope:n,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:r=null,maxBreadcrumbs:s=zo}=i.getOptions&&i.getOptions()||{};if(s<=0)return;const a={timestamp:(0,Do.yW)(),...e},o=r?Ao((()=>r(a,t))):a;null!==o&&(i.emit&&i.emit("beforeAddBreadcrumb",o,t),n.addBreadcrumb(o,s))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t)}configureScope(e){const{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){const t=Yo(this);try{e(this)}finally{Yo(t)}}getIntegration(e){const t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){const n=this._callExtensionMethod("startTransaction",e,t);return"undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__||n||console.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"),n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,t=e.getSession();t&&function(e,t){let n={};"ok"===e.status&&(n={status:"exited"}),Bo(e,n)}(t),this._sendSessionUpdate(),e.setSession()}startSession(e){const{scope:t,client:n}=this.getStackTop(),{release:i,environment:r=Po}=n&&n.getOptions()||{},{userAgent:s}=io.n2.navigator||{},a=function(e){const t=(0,Do.ph)(),n={sid:wo(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return bo({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(n)};return e&&Bo(n,e),n}({release:i,environment:r,user:t.getUser(),...s&&{userAgent:s},...e}),o=t.getSession&&t.getSession();return o&&"ok"===o.status&&Bo(o,{status:"exited"}),this.endSession(),t.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_withClient(e){const{scope:t,client:n}=this.getStackTop();n&&e(n,t)}_callExtensionMethod(e,...t){const n=Vo().__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function Vo(){return io.n2.__SENTRY__=io.n2.__SENTRY__||{extensions:{},hub:void 0},io.n2}function Yo(e){const t=Vo(),n=Wo(t);return Xo(t,e),n}function Ko(){const e=Vo();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return function(e=Vo()){return t=e,!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)&&!Wo(e).isOlderThan(qo)||Xo(e,new jo),Wo(e);var t}(e)}function Wo(e){return(0,io.YO)("hub",(()=>new jo),e)}function Xo(e,t){return!!e&&((e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0)}const Zo=[];function Jo(e){const t=e.defaultIntegrations||[],n=e.integrations;let i;t.forEach((e=>{e.isDefaultInstance=!0})),i=Array.isArray(n)?[...t,...n]:"function"==typeof n?Co(n(t)):t;const r=function(e){const t={};return e.forEach((e=>{const{name:n}=e,i=t[n];i&&!i.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)})),Object.keys(t).map((e=>t[e]))}(i),s=function(e,t){for(let t=0;t<e.length;t++)if(!0==("Debug"===e[t].name))return t;return-1}(r);if(-1!==s){const[e]=r.splice(s,1);r.push(e)}return r}function Qo(e,t){t[e.name]=e,-1===Zo.indexOf(e.name)&&(e.setupOnce(Go,Ko),Zo.push(e.name),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`Integration installed: ${e.name}`))}const el=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],tl=[/^.*healthcheck.*$/,/^.*healthy.*$/,/^.*live.*$/,/^.*ready.*$/,/^.*heartbeat.*$/,/^.*\/health$/,/^.*\/healthz$/];class nl{static __initStatic(){this.id="InboundFilters"}constructor(e={}){this.name=nl.id,this._options=e}setupOnce(e,t){const n=e=>{const n=t();if(n){const t=n.getIntegration(nl);if(t){const i=n.getClient(),r=i?i.getOptions():{},s=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:el],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:tl],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(t._options,r);return function(e,t){return t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${To(e)}`),!0):function(e,t){return!(e.type||!t||!t.length)&&function(e){if(e.message)return[e.message];if(e.exception){const{values:t}=e.exception;try{const{type:e="",value:n=""}=t&&t[t.length-1]||{};return[`${n}`,`${e}: ${n}`]}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.error(`Cannot extract message for event ${To(e)}`),[]}}return[]}(e).some((e=>uo(e,t)))}(e,t.ignoreErrors)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${To(e)}`),!0):function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&uo(n,t)}(e,t.ignoreTransactions)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${To(e)}`),!0):function(e,t){if(!t||!t.length)return!1;const n=il(e);return!!n&&uo(n,t)}(e,t.denyUrls)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${To(e)}.\nUrl: ${il(e)}`),!0):!function(e,t){if(!t||!t.length)return!0;const n=il(e);return!n||uo(n,t)}(e,t.allowUrls)&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${To(e)}.\nUrl: ${il(e)}`),!0)}(e,s)?null:e}}return e};n.id=this.name,e(n)}}function il(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.error(`Cannot extract url for event ${To(e)}`),null}}let rl;nl.__initStatic();class sl{static __initStatic(){this.id="FunctionToString"}constructor(){this.name=sl.id}setupOnce(){rl=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=mo(this)||this;return rl.apply(t,e)}}catch(e){}}}sl.__initStatic();const al=/\(error: (.*)\)/,ol=/captureMessage|captureException/;function ll(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0)=>{const i=[],r=e.split("\n");for(let e=n;e<r.length;e++){const n=r[e];if(n.length>1024)continue;const s=al.test(n)?n.replace(al,"$1"):n;if(!s.match(/\S*Error: /)){for(const e of t){const t=e(s);if(t){i.push(t);break}}if(i.length>=50)break}}return function(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),ol.test(t[t.length-1].function||"")&&(t.pop(),ol.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,50).map((e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"})))}(i)}}const cl="<anonymous>";function dl(e){try{return e&&"function"==typeof e&&e.name||cl}catch(e){return cl}}const ul=(0,io.Rf)();function hl(){if(!("fetch"in ul))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function pl(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}const fl=(0,io.Rf)(),ml=(0,io.Rf)(),gl="__sentry_xhr_v2__",yl={},vl={};function bl(e,t){yl[e]=yl[e]||[],yl[e].push(t),function(e){if(!vl[e])switch(vl[e]=!0,e){case"console":"console"in ml&&Lo.forEach((function(e){e in ml.console&&ho(ml.console,e,(function(t){return function(...n){_l("console",{args:n,level:e}),t&&t.apply(ml.console,n)}}))}));break;case"dom":!function(){if(!("document"in ml))return;const e=_l.bind(null,"dom"),t=Cl(e,!0);ml.document.addEventListener("click",t,!1),ml.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=ml[t]&&ml[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(ho(n,"addEventListener",(function(t){return function(n,i,r){if("click"===n||"keypress"==n)try{const i=this,s=i.__sentry_instrumentation_handlers__=i.__sentry_instrumentation_handlers__||{},a=s[n]=s[n]||{refCount:0};if(!a.handler){const i=Cl(e);a.handler=i,t.call(this,n,i,r)}a.refCount++}catch(e){}return t.call(this,n,i,r)}})),ho(n,"removeEventListener",(function(e){return function(t,n,i){if("click"===t||"keypress"==t)try{const n=this,r=n.__sentry_instrumentation_handlers__||{},s=r[t];s&&(s.refCount--,s.refCount<=0&&(e.call(this,t,s.handler,i),s.handler=void 0,delete r[t]),0===Object.keys(r).length&&delete n.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,n,i)}})))}))}();break;case"xhr":!function(){if(!("XMLHttpRequest"in ml))return;const e=XMLHttpRequest.prototype;ho(e,"open",(function(e){return function(...t){const n=t[1],i=this[gl]={method:Xa(t[0])?t[0].toUpperCase():t[0],url:t[1],request_headers:{}};Xa(n)&&"POST"===i.method&&n.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const r=()=>{const e=this[gl];if(e&&4===this.readyState){try{e.status_code=this.status}catch(e){}_l("xhr",{args:t,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?ho(this,"onreadystatechange",(function(e){return function(...t){return r(),e.apply(this,t)}})):this.addEventListener("readystatechange",r),ho(this,"setRequestHeader",(function(e){return function(...t){const[n,i]=t,r=this[gl];return r&&(r.request_headers[n.toLowerCase()]=i),e.apply(this,t)}})),e.apply(this,t)}})),ho(e,"send",(function(e){return function(...t){const n=this[gl];return n&&void 0!==t[0]&&(n.body=t[0]),_l("xhr",{args:t,startTimestamp:Date.now(),xhr:this}),e.apply(this,t)}}))}();break;case"fetch":(function(){if(!hl())return!1;if(pl(ul.fetch))return!0;let e=!1;const t=ul.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=pl(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e})()&&ho(ml,"fetch",(function(e){return function(...t){const{method:n,url:i}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:El(t),method:wl(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:El(t),method:wl(t,"method")?String(t.method).toUpperCase():"GET"}}(t),r={args:t,fetchData:{method:n,url:i},startTimestamp:Date.now()};return _l("fetch",{...r}),e.apply(ml,t).then((e=>(_l("fetch",{...r,endTimestamp:Date.now(),response:e}),e)),(e=>{throw _l("fetch",{...r,endTimestamp:Date.now(),error:e}),e}))}}));break;case"history":!function(){if(!function(){const e=fl.chrome,t=e&&e.app&&e.app.runtime,n="history"in fl&&!!fl.history.pushState&&!!fl.history.replaceState;return!t&&n}())return;const e=ml.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=Tl,t=String(n);Tl=t,_l("history",{from:e,to:t})}return e.apply(this,t)}}ml.onpopstate=function(...t){const n=ml.location.href,i=Tl;if(Tl=n,_l("history",{from:i,to:n}),e)try{return e.apply(this,t)}catch(e){}},ho(ml.history,"pushState",t),ho(ml.history,"replaceState",t)}();break;case"error":Ll=ml.onerror,ml.onerror=function(e,t,n,i,r){return _l("error",{column:i,error:r,line:n,msg:e,url:t}),!(!Ll||Ll.__SENTRY_LOADER__)&&Ll.apply(this,arguments)},ml.onerror.__SENTRY_INSTRUMENTED__=!0;break;case"unhandledrejection":Al=ml.onunhandledrejection,ml.onunhandledrejection=function(e){return _l("unhandledrejection",e),!(Al&&!Al.__SENTRY_LOADER__)||Al.apply(this,arguments)},ml.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0;break;default:("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("unknown instrumentation type:",e)}}(e)}function _l(e,t){if(e&&yl[e])for(const n of yl[e]||[])try{n(t)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${dl(n)}\nError:`,t)}}function wl(e,t){return!!e&&"object"==typeof e&&!!e[t]}function El(e){return"string"==typeof e?e:e?wl(e,"url")?e.url:e.toString?e.toString():"":""}let Tl;const Sl=1e3;let xl,kl;function Cl(e,t=!1){return n=>{if(!n||kl===n)return;if(function(e){if("keypress"!==e.type)return!1;try{const t=e.target;if(!t||!t.tagName)return!0;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return!1}catch(e){}return!0}(n))return;const i="keypress"===n.type?"input":n.type;(void 0===xl||function(e,t){if(!e)return!0;if(e.type!==t.type)return!0;try{if(e.target!==t.target)return!0}catch(e){}return!1}(kl,n))&&(e({event:n,name:i,global:t}),kl=n),clearTimeout(xl),xl=ml.setTimeout((()=>{xl=void 0}),Sl)}}let Ll=null,Al=null;const Rl=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Il(e,t=!1){const{host:n,path:i,pass:r,port:s,projectId:a,protocol:o,publicKey:l}=e;return`${o}://${l}${t&&r?`:${r}`:""}@${n}${s?`:${s}`:""}/${i?`${i}/`:i}${a}`}function Dl(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function Pl(e,t=100,n=1/0){try{return Ol("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function Ml(e,t=3,n=102400){const i=Pl(e,t);return r=i,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(r))>n?Ml(e,t-1,n):i;var r}function Ol(e,t,i=1/0,r=1/0,s=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[a,o]=s;if(null==t||["number","boolean","string"].includes(typeof t)&&!to(t))return t;const l=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if(void 0!==n.g&&t===n.g)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(Ja(i=t)&&"nativeEvent"in i&&"preventDefault"in i&&"stopPropagation"in i)return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${dl(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var i}(e,t);if(!l.startsWith("[object "))return l;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:i;if(0===c)return l.replace("object ","");if(a(t))return"[Circular ~]";const d=t;if(d&&"function"==typeof d.toJSON)try{return Ol("",d.toJSON(),c-1,r,s)}catch(e){}const u=Array.isArray(t)?[]:{};let h=0;const p=go(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(h>=r){u[e]="[MaxProperties ~]";break}const t=p[e];u[e]=Ol(e,t,c-1,r,s),h++}return o(t),u}function Nl(e,t=[]){return[e,t]}function Fl(e,t){const[n,i]=e;return[n,[...i,t]]}function Bl(e,t){const n=e[1];for(const e of n)if(t(e,e[0].type))return!0;return!1}function Ul(e,t){return(t||new TextEncoder).encode(e)}function $l(e,t){const[n,i]=e;let r=JSON.stringify(n);function s(e){"string"==typeof r?r="string"==typeof e?r+e:[Ul(r,t),e]:r.push("string"==typeof e?Ul(e,t):e)}for(const e of i){const[t,n]=e;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(Pl(n))}s(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let i=0;for(const t of e)n.set(t,i),i+=t.length;return n}(r)}function Gl(e,t){const n="string"==typeof e.data?Ul(e.data,t):e.data;return[bo({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}const Hl={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor"};function ql(e){return Hl[e]}function zl(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}class jl extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}const Vl="7";function Yl(e,t={}){const n="string"==typeof t?t:t.tunnel,i="string"!=typeof t&&t._metadata?t._metadata.sdk:void 0;return n||`${function(e){return`${function(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}(e)}${e.projectId}/envelope/`}(e)}?${function(e,t){return n={sentry_key:e.publicKey,sentry_version:Vl,...t&&{sentry_client:`${t.name}/${t.version}`}},Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&");var n}(e,i)}`}function Kl(e,t,n){const i=t.getOptions(),{publicKey:r}=t.getDsn()||{},{segment:s}=n&&n.getUser()||{},a=bo({environment:i.environment||Po,release:i.release,user_segment:s,public_key:r,trace_id:e});return t.emit&&t.emit("createDsc",a),a}const Wl=new WeakMap,Xl="Not capturing exception because it's already been captured.";class Zl{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},e.dsn?this._dsn=function(e){const t="string"==typeof e?function(e){const t=Rl.exec(e);if(!t)return void console.error(`Invalid Sentry Dsn: ${e}`);const[n,i,r="",s,a="",o]=t.slice(1);let l="",c=o;const d=c.split("/");if(d.length>1&&(l=d.slice(0,-1).join("/"),c=d.pop()),c){const e=c.match(/^\d+/);e&&(c=e[0])}return Dl({host:s,pass:r,path:l,projectId:c,port:a,protocol:n,publicKey:i})}(e):Dl(e);if(t&&function(e){if("undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__)return!0;const{port:t,projectId:n,protocol:i}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(Io.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(i)?t&&isNaN(parseInt(t,10))&&(Io.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(Io.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),1):(Io.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}(e.dsn):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("No DSN provided, client will not do anything."),this._dsn){const t=Yl(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){if(ko(e))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(Xl));let i=t&&t.event_id;return this._process(this.eventFromException(e,t).then((e=>this._captureEvent(e,t,n))).then((e=>{i=e}))),i}captureMessage(e,t,n,i){let r=n&&n.event_id;const s=Za(e)?this.eventFromMessage(String(e),t,n):this.eventFromException(e,n);return this._process(s.then((e=>this._captureEvent(e,n,i))).then((e=>{r=e}))),r}captureEvent(e,t,n){if(t&&t.originalException&&ko(t.originalException))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(Xl));let i=t&&t.event_id;return this._process(this._captureEvent(e,t,n).then((e=>{i=e}))),i}captureSession(e){this._isEnabled()?"string"!=typeof e.release?("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Bo(e,{init:!1})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("SDK not enabled, will not capture session.")}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e)))):Oo(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,e)))}setupIntegrations(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=function(e){const t={};return e.forEach((e=>{e&&Qo(e,t)})),t}(this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){Qo(e,this._integrations)}sendEvent(e,t={}){if(this._dsn){let n=function(e,t,n,i){const r=zl(n),s=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const a=function(e,t,n,i){const r=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&{dsn:Il(i)},...r&&{trace:bo({...r})}}}(e,r,i,t);return delete e.sdkProcessingMetadata,Nl(a,[[{type:s},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=Fl(n,Gl(e,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(n);i&&i.then((t=>this.emit("afterSendEvent",e,t)),null)}}sendSession(e){if(this._dsn){const t=function(e,t,n,i){const r=zl(n);return Nl({sent_at:(new Date).toISOString(),...r&&{sdk:r},...!!i&&{dsn:Il(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const n=`${e}:${t}`;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach((e=>e(...t)))}_updateSessionFromEvent(e,t){let n=!1,i=!1;const r=t.exception&&t.exception.values;if(r){i=!0;for(const e of r){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const s="ok"===e.status;(s&&0===e.errors||s&&n)&&(Bo(e,{...n&&{status:"crashed"},errors:e.errors||Number(i||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Fo((t=>{let n=0;const i=setInterval((()=>{0==this._numProcessing?(clearInterval(i),t(!0)):(n+=1,e&&n>=e&&(clearInterval(i),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._dsn}_prepareEvent(e,t,n){const i=this.getOptions(),r=Object.keys(this._integrations);return!t.integrations&&r.length>0&&(t.integrations=r),function(e,t,n,i){const{normalizeDepth:r=3,normalizeMaxBreadth:s=1e3}=e,a={...t,event_id:t.event_id||n.event_id||wo(),timestamp:t.timestamp||(0,Do.yW)()},o=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:i,dist:r,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:Po),void 0===e.release&&void 0!==i&&(e.release=i),void 0===e.dist&&void 0!==r&&(e.dist=r),e.message&&(e.message=lo(e.message,s));const a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=lo(a.value,s));const o=e.request;o&&o.url&&(o.url=lo(o.url,s))}(a,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(a,o),void 0===t.type&&function(e,t){const n=io.n2._sentryDebugIds;if(!n)return;let i;const r=Wl.get(t);r?i=r:(i=new Map,Wl.set(t,i));const s=Object.keys(n).reduce(((e,r)=>{let s;const a=i.get(r);a?s=a:(s=t(r),i.set(r,s));for(let t=s.length-1;t>=0;t--){const i=s[t];if(i.filename){e[i.filename]=n[r];break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=s[e.filename])}))}))}catch(e){}}(a,e.stackParser);let l=i;n.captureContext&&(l=Uo.clone(l).update(n.captureContext));let c=Oo(a);if(l){if(l.getAttachments){const e=[...n.attachments||[],...l.getAttachments()];e.length&&(n.attachments=e)}c=l.applyToEvent(a,n)}return c.then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach((e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})}))}(e),"number"==typeof r&&r>0?function(e,t,n){if(!e)return null;const i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:Pl(e.data,t,n)}})))},...e.user&&{user:Pl(e.user,t,n)},...e.contexts&&{contexts:Pl(e.contexts,t,n)},...e.extra&&{extra:Pl(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=Pl(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map((e=>(e.data&&(e.data=Pl(e.data,t,n)),e)))),i}(e,r,s):e)))}(i,e,t,n).then((e=>{if(null===e)return e;const{propagationContext:t}=e.sdkProcessingMetadata||{};if((!e.contexts||!e.contexts.trace)&&t){const{traceId:i,spanId:r,parentSpanId:s,dsc:a}=t;e.contexts={trace:{trace_id:i,span_id:r,parent_span_id:s},...e.contexts};const o=a||Kl(i,this,n);e.sdkProcessingMetadata={dynamicSamplingContext:o,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){const t=e;"log"===t.logLevel?Io.log(t.message):Io.warn(t)}}))}_processEvent(e,t,n){const i=this.getOptions(),{sampleRate:r}=i;if(!this._isEnabled())return No(new jl("SDK not enabled, will not capture event.","log"));const s=Ql(e),a=Jl(e),o=e.type||"error",l=`before send for type \`${o}\``;if(a&&"number"==typeof r&&Math.random()>r)return this.recordDroppedEvent("sample_rate","error",e),No(new jl(`Discarding event because it's not included in the random sample (sampling rate = ${r})`,"log"));const c="replay_event"===o?"replay":o;return this._prepareEvent(e,t,n).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",c,e),new jl("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const r=function(e,t,n){const{beforeSend:i,beforeSendTransaction:r}=e;return Jl(t)&&i?i(t,n):Ql(t)&&r?r(t,n):t}(i,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(eo(e))return e.then((e=>{if(!Ja(e)&&null!==e)throw new jl(n);return e}),(e=>{throw new jl(`${t} rejected with ${e}`)}));if(!Ja(e)&&null!==e)throw new jl(n);return e}(r,l)})).then((i=>{if(null===i)throw this.recordDroppedEvent("before_send",c,e),new jl(`${l} returned \`null\`, will not send event.`,"log");const r=n&&n.getSession();!s&&r&&this._updateSessionFromEvent(r,i);const a=i.transaction_info;if(s&&a&&i.transaction!==e.transaction){const e="custom";i.transaction_info={...a,source:e}}return this.sendEvent(i,t),i})).then(null,(e=>{if(e instanceof jl)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new jl(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_sendEnvelope(e){if(this._transport&&this._dsn)return this.emit("beforeEnvelope",e),this._transport.send(e).then(null,(e=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.error("Error while sending event:",e)}));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map((t=>{const[n,i]=t.split(":");return{reason:n,category:i,quantity:e[t]}}))}}function Jl(e){return void 0===e.type}function Ql(e){return"transaction"===e.type}const ec="7.61.1";var tc=n(518);function nc(e,t){const n=rc(e,t),i={type:t&&t.name,value:ac(t)};return n.length&&(i.stacktrace={frames:n}),void 0===i.type&&""===i.value&&(i.value="Unrecoverable error caught"),i}function ic(e,t){return{exception:{values:[nc(e,t)]}}}function rc(e,t){const n=t.stacktrace||t.stack||"",i=function(e){if(e){if("number"==typeof e.framesToPop)return e.framesToPop;if(sc.test(e.message))return 1}return 0}(t);try{return e(n,i)}catch(e){}return[]}const sc=/Minified React error #\d+;/i;function ac(e){const t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function oc(e,t,n,i,r){let s;if(Ka(t)&&t.error)return ic(e,t.error);if(Wa(t)||Ya(t,"DOMException")){const r=t;if("stack"in t)s=ic(e,t);else{const t=r.name||(Wa(r)?"DOMError":"DOMException"),a=r.message?`${t}: ${r.message}`:t;s=lc(e,a,n,i),So(s,a)}return"code"in r&&(s.tags={...s.tags,"DOMException.code":`${r.code}`}),s}return Va(t)?ic(e,t):Ja(t)||Qa(t)?(s=function(e,t,n,i){const r=Ko().getClient(),s=r&&r.getOptions().normalizeDepth,a={exception:{values:[{type:Qa(t)?t.constructor.name:i?"UnhandledRejection":"Error",value:cc(t,{isUnhandledRejection:i})}]},extra:{__serialized__:Ml(t,s)}};if(n){const t=rc(e,n);t.length&&(a.exception.values[0].stacktrace={frames:t})}return a}(e,t,n,r),xo(s,{synthetic:!0}),s):(s=lc(e,t,n,i),So(s,`${t}`,void 0),xo(s,{synthetic:!0}),s)}function lc(e,t,n,i){const r={message:t};if(i&&n){const i=rc(e,n);i.length&&(r.exception={values:[{value:t,stacktrace:{frames:i}}]})}return r}function cc(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(go(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return lo(n[0],t);for(let e=n.length;e>0;e--){const i=n.slice(0,e).join(", ");if(!(i.length>t))return e===n.length?i:lo(i,t)}return""}(e),i=t?"promise rejection":"exception";return Ka(e)?`Event \`ErrorEvent\` captured as ${i} with message \`${e.message}\``:Qa(e)?`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function dc(e,t){return Ko().captureException(e,{captureContext:t})}function uc(e){Ko().withScope(e)}const hc=io.n2;let pc=0;function fc(){return pc>0}function mc(e,t={},n){if("function"!=typeof e)return e;try{const t=e.__sentry_wrapped__;if(t)return t;if(mo(e))return e}catch(t){return e}const i=function(){const i=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);const r=i.map((e=>mc(e,t)));return e.apply(this,r)}catch(e){throw pc++,setTimeout((()=>{pc--})),uc((n=>{n.addEventProcessor((e=>(t.mechanism&&(So(e,void 0,void 0),xo(e,t.mechanism)),e.extra={...e.extra,arguments:i},e))),dc(e)})),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t])}catch(e){}fo(i,e),po(e,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get:()=>e.name})}catch(e){}return i}const gc=["fatal","error","warning","log","info","debug"];function yc(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}const vc="Breadcrumbs";class bc{static __initStatic(){this.id=vc}constructor(e){this.name=bc.id,this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e}}setupOnce(){var e;this.options.console&&bl("console",_c),this.options.dom&&bl("dom",(e=this.options.dom,function(t){let n,i="object"==typeof e?e.serializeAttribute:void 0,r="object"==typeof e&&"number"==typeof e.maxStringLength?e.maxStringLength:void 0;r&&r>1024&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${r} was configured. Sentry will use 1024 instead.`),r=1024),"string"==typeof i&&(i=[i]);try{const e=t.event;n=function(e){return!!e&&!!e.target}(e)?ao(e.target,{keyAttrs:i,maxStringLength:r}):ao(e,{keyAttrs:i,maxStringLength:r})}catch(e){n="<unknown>"}0!==n.length&&Ko().addBreadcrumb({category:`ui.${t.name}`,message:n},{event:t.event,name:t.name,global:t.global})})),this.options.xhr&&bl("xhr",wc),this.options.fetch&&bl("fetch",Ec),this.options.history&&bl("history",Tc)}addSentryBreadcrumb(e){this.options.sentry&&Ko().addBreadcrumb({category:"sentry."+("transaction"===e.type?"transaction":"event"),event_id:e.event_id,level:e.level,message:To(e)},{event:e})}}function _c(e){for(let t=0;t<e.args.length;t++)if("ref=Ref<"===e.args[t]){e.args[t+1]="viewRef";break}const t={category:"console",data:{arguments:e.args,logger:"console"},level:(n=e.level,"warn"===n?"warning":gc.includes(n)?n:"log"),message:co(e.args," ")};var n;if("assert"===e.level){if(!1!==e.args[0])return;t.message=`Assertion failed: ${co(e.args.slice(1)," ")||"console.assert"}`,t.data.arguments=e.args.slice(1)}Ko().addBreadcrumb(t,{input:e.args,level:e.level})}function wc(e){const{startTimestamp:t,endTimestamp:n}=e,i=e.xhr[gl];if(!t||!n||!i)return;const{method:r,url:s,status_code:a,body:o}=i,l={method:r,url:s,status_code:a},c={xhr:e.xhr,input:o,startTimestamp:t,endTimestamp:n};Ko().addBreadcrumb({category:"xhr",data:l,type:"http"},c)}function Ec(e){const{startTimestamp:t,endTimestamp:n}=e;if(n&&(!e.fetchData.url.match(/sentry_key/)||"POST"!==e.fetchData.method))if(e.error){const i=e.fetchData,r={data:e.error,input:e.args,startTimestamp:t,endTimestamp:n};Ko().addBreadcrumb({category:"fetch",data:i,level:"error",type:"http"},r)}else{const i={...e.fetchData,status_code:e.response&&e.response.status},r={input:e.args,response:e.response,startTimestamp:t,endTimestamp:n};Ko().addBreadcrumb({category:"fetch",data:i,type:"http"},r)}}function Tc(e){let t=e.from,n=e.to;const i=yc(hc.location.href);let r=yc(t);const s=yc(n);r.path||(r=i),i.protocol===s.protocol&&i.host===s.host&&(n=s.relative),i.protocol===r.protocol&&i.host===r.host&&(t=r.relative),Ko().addBreadcrumb({category:"navigation",data:{from:t,to:n}})}bc.__initStatic();class Sc extends Zl{constructor(e){const t=hc.SENTRY_SDK_SOURCE||(0,tc.S)();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${t}:@sentry/browser`,version:ec}],version:ec},super(e),e.sendClientReports&&hc.document&&hc.document.addEventListener("visibilitychange",(()=>{"hidden"===hc.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return function(e,t,n,i){const r=oc(e,t,n&&n.syntheticException||void 0,i);return xo(r),r.level="error",n&&n.event_id&&(r.event_id=n.event_id),Oo(r)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",i,r){const s=lc(e,t,i&&i.syntheticException||void 0,r);return s.level=n,i&&i.event_id&&(s.event_id=i.event_id),Oo(s)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}sendEvent(e,t){const n=this.getIntegrationById(vc);n&&n.addSentryBreadcrumb&&n.addSentryBreadcrumb(e),super.sendEvent(e,t)}captureUserFeedback(e){if(!this._isEnabled())return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("SDK not enabled, will not capture user feedback."));const t=function(e,{metadata:t,tunnel:n,dsn:i}){const r={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!i&&{dsn:Il(i)}},s=function(e){return[{type:"user_report"},e]}(e);return Nl(r,[s])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}_flushOutcomes(){const e=this._clearOutcomes();if(0===e.length)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("No outcomes to send"));if(!this._dsn)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("No dsn provided, will not send outcomes"));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("Sending outcomes:",e);const t=(n=e,Nl((i=this._options.tunnel&&Il(this._dsn))?{dsn:i}:{},[[{type:"client_report"},{timestamp:(0,Do.yW)(),discarded_events:n}]]));var n,i;this._sendEnvelope(t)}}class xc{static __initStatic(){this.id="GlobalHandlers"}constructor(e){this.name=xc.id,this._options={onerror:!0,onunhandledrejection:!0,...e},this._installFunc={onerror:kc,onunhandledrejection:Cc}}setupOnce(){Error.stackTraceLimit=50;const e=this._options;for(const n in e){const i=this._installFunc[n];i&&e[n]&&(t=n,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`Global Handler attached: ${t}`),i(),this._installFunc[n]=void 0)}var t}}function kc(){bl("error",(e=>{const[t,n,i]=Rc();if(!t.getIntegration(xc))return;const{msg:r,url:s,line:a,column:o,error:l}=e;if(fc()||l&&l.__sentry_own_request__)return;const c=void 0===l&&Xa(r)?function(e,t,n,i){let r=Ka(e)?e.message:e,s="Error";const a=r.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);a&&(s=a[1],r=a[2]);return Lc({exception:{values:[{type:s,value:r}]}},t,n,i)}(r,s,a,o):Lc(oc(n,l||r,void 0,i,!1),s,a,o);c.level="error",Ac(t,l,c,"onerror")}))}function Cc(){bl("unhandledrejection",(e=>{const[t,n,i]=Rc();if(!t.getIntegration(xc))return;let r=e;try{"reason"in e?r=e.reason:"detail"in e&&"reason"in e.detail&&(r=e.detail.reason)}catch(e){}if(fc()||r&&r.__sentry_own_request__)return!0;const s=Za(r)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(r)}`}]}}:oc(n,r,void 0,i,!0);s.level="error",Ac(t,r,s,"onunhandledrejection")}))}function Lc(e,t,n,i){const r=e.exception=e.exception||{},s=r.values=r.values||[],a=s[0]=s[0]||{},o=a.stacktrace=a.stacktrace||{},l=o.frames=o.frames||[],c=isNaN(parseInt(i,10))?void 0:i,d=isNaN(parseInt(n,10))?void 0:n,u=Xa(t)&&t.length>0?t:function(){try{return ro.document.location.href}catch(e){return""}}();return 0===l.length&&l.push({colno:c,filename:u,function:"?",in_app:!0,lineno:d}),e}function Ac(e,t,n,i){xo(n,{handled:!1,type:i}),e.captureEvent(n,{originalException:t})}function Rc(){const e=Ko(),t=e.getClient(),n=t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[e,n.stackParser,n.attachStacktrace]}xc.__initStatic();const Ic=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class Dc{static __initStatic(){this.id="TryCatch"}constructor(e){this.name=Dc.id,this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e}}setupOnce(){this._options.setTimeout&&ho(hc,"setTimeout",Pc),this._options.setInterval&&ho(hc,"setInterval",Pc),this._options.requestAnimationFrame&&ho(hc,"requestAnimationFrame",Mc),this._options.XMLHttpRequest&&"XMLHttpRequest"in hc&&ho(XMLHttpRequest.prototype,"send",Oc);const e=this._options.eventTarget;e&&(Array.isArray(e)?e:Ic).forEach(Nc)}}function Pc(e){return function(...t){const n=t[0];return t[0]=mc(n,{mechanism:{data:{function:dl(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}}function Mc(e){return function(t){return e.apply(this,[mc(t,{mechanism:{data:{function:"requestAnimationFrame",handler:dl(e)},handled:!0,type:"instrument"}})])}}function Oc(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"==typeof n[e]&&ho(n,e,(function(t){const n={mechanism:{data:{function:e,handler:dl(t)},handled:!0,type:"instrument"}},i=mo(t);return i&&(n.mechanism.data.handler=dl(i)),mc(t,n)}))})),e.apply(this,t)}}function Nc(e){const t=hc,n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(ho(n,"addEventListener",(function(t){return function(n,i,r){try{"function"==typeof i.handleEvent&&(i.handleEvent=mc(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:dl(i),target:e},handled:!0,type:"instrument"}}))}catch(e){}return t.apply(this,[n,mc(i,{mechanism:{data:{function:"addEventListener",handler:dl(i),target:e},handled:!0,type:"instrument"}}),r])}})),ho(n,"removeEventListener",(function(e){return function(t,n,i){const r=n;try{const n=r&&r.__sentry_wrapped__;n&&e.call(this,t,n,i)}catch(e){}return e.call(this,t,r,i)}})))}function Fc(e,t,n=250,i,r,s,a){if(!(s.exception&&s.exception.values&&a&&no(a.originalException,Error)))return;const o=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var l,c;o&&(s.exception.values=(l=Bc(e,t,r,a.originalException,i,s.exception.values,o,0),c=n,l.map((e=>(e.value&&(e.value=lo(e.value,c)),e)))))}function Bc(e,t,n,i,r,s,a,o){if(s.length>=n+1)return s;let l=[...s];if(no(i[r],Error)){Uc(a,o);const s=e(t,i[r]),c=l.length;$c(s,r,c,o),l=Bc(e,t,n,i[r],r,[s,...l],s,c)}return Array.isArray(i.errors)&&i.errors.forEach(((i,s)=>{if(no(i,Error)){Uc(a,o);const c=e(t,i),d=l.length;$c(c,`errors[${s}]`,d,o),l=Bc(e,t,n,i,r,[c,...l],c,d)}})),l}function Uc(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,is_exception_group:!0,exception_id:t}}function $c(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}Dc.__initStatic();class Gc{static __initStatic(){this.id="LinkedErrors"}constructor(e={}){this.name=Gc.id,this._key=e.key||"cause",this._limit=e.limit||5}setupOnce(e,t){e(((e,n)=>{const i=t(),r=i.getClient(),s=i.getIntegration(Gc);if(!r||!s)return e;const a=r.getOptions();return Fc(nc,a.stackParser,a.maxValueLength,s._key,s._limit,e,n),e}))}}Gc.__initStatic();class Hc{static __initStatic(){this.id="HttpContext"}constructor(){this.name=Hc.id}setupOnce(){Go((e=>{if(Ko().getIntegration(Hc)){if(!hc.navigator&&!hc.location&&!hc.document)return e;const t=e.request&&e.request.url||hc.location&&hc.location.href,{referrer:n}=hc.document||{},{userAgent:i}=hc.navigator||{},r={...e.request&&e.request.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},s={...e.request,...t&&{url:t},headers:r};return{...e,request:s}}return e}))}}Hc.__initStatic();class qc{static __initStatic(){this.id="Dedupe"}constructor(){this.name=qc.id}setupOnce(e,t){const n=e=>{if(e.type)return e;const n=t().getIntegration(qc);if(n){try{if(function(e,t){return!!t&&(!!function(e,t){const n=e.message,i=t.message;return!(!n&&!i)&&(!(n&&!i||!n&&i)&&(n===i&&(!!jc(e,t)&&!!zc(e,t))))}(e,t)||!!function(e,t){const n=Vc(t),i=Vc(e);return!(!n||!i)&&(n.type===i.type&&n.value===i.value&&(!!jc(e,t)&&!!zc(e,t)))}(e,t))}(e,n._previousEvent))return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(t){return n._previousEvent=e}return n._previousEvent=e}return e};n.id=this.name,e(n)}}function zc(e,t){let n=Yc(e),i=Yc(t);if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;if(i.length!==n.length)return!1;for(let e=0;e<i.length;e++){const t=i[e],r=n[e];if(t.filename!==r.filename||t.lineno!==r.lineno||t.colno!==r.colno||t.function!==r.function)return!1}return!0}function jc(e,t){let n=e.fingerprint,i=t.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;try{return!(n.join("")!==i.join(""))}catch(e){return!1}}function Vc(e){return e.exception&&e.exception.values&&e.exception.values[0]}function Yc(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}}qc.__initStatic();const Kc="?";function Wc(e,t,n,i){const r={filename:e,function:t,in_app:!0};return void 0!==n&&(r.lineno=n),void 0!==i&&(r.colno=i),r}const Xc=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Zc=/\((\S*)(?::(\d+))(?::(\d+))\)/,Jc=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Qc=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,ed=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,td=ll([30,e=>{const t=Xc.exec(e);if(t){if(t[2]&&0===t[2].indexOf("eval")){const e=Zc.exec(t[2]);e&&(t[2]=e[1],t[3]=e[2],t[4]=e[3])}const[e,n]=nd(t[1]||Kc,t[2]);return Wc(n,e,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,e=>{const t=Jc.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=Qc.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||Kc;return[n,e]=nd(n,e),Wc(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}],[40,e=>{const t=ed.exec(e);return t?Wc(t[2],t[1]||Kc,+t[3],t[4]?+t[4]:void 0):void 0}]),nd=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),i=-1!==e.indexOf("safari-web-extension");return n||i?[-1!==e.indexOf("@")?e.split("@")[0]:Kc,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};const id=6e4;const rd=30;function sd(e,t,n=function(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(i){if(!(void 0===e||t.length<e))return No(new jl("Not adding Promise because buffer limit was reached."));const r=i();return-1===t.indexOf(r)&&t.push(r),r.then((()=>n(r))).then(null,(()=>n(r).then(null,(()=>{})))),r},drain:function(e){return new Fo(((n,i)=>{let r=t.length;if(!r)return n(!0);const s=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{Oo(e).then((()=>{--r||(clearTimeout(s),n(!0))}),i)}))}))}}}(e.bufferSize||rd)){let i={};function r(r){const s=[];if(Bl(r,((t,n)=>{const r=ql(n);if(function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(i,r)){const i=ad(t,n);e.recordDroppedEvent("ratelimit_backoff",r,i)}else s.push(t)})),0===s.length)return Oo();const a=Nl(r[0],s),o=t=>{Bl(a,((n,i)=>{const r=ad(n,i);e.recordDroppedEvent(t,ql(i),r)}))};return n.add((()=>t({body:$l(a,e.textEncoder)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),i=function(e,{statusCode:t,headers:n},i=Date.now()){const r={...e},s=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(s)for(const e of s.trim().split(",")){const[t,n]=e.split(":",2),s=parseInt(t,10),a=1e3*(isNaN(s)?60:s);if(n)for(const e of n.split(";"))r[e]=i+a;else r.all=i+a}else a?r.all=i+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const i=Date.parse(`${e}`);return isNaN(i)?id:i-t}(a,i):429===t&&(r.all=i+6e4);return r}(i,e),e)),(e=>{throw o("network_error"),e})))).then((e=>e),(e=>{if(e instanceof jl)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.error("Skipped sending event because buffer is full."),o("queue_overflow"),Oo();throw e}))}return r.__sentry__baseTransport__=!0,{send:r,flush:e=>n.drain(e)}}function ad(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}let od;function ld(e,t=function(){if(od)return od;if(pl(hc.fetch))return od=hc.fetch.bind(hc);const e=hc.document;let t=hc.fetch;if(e&&"function"==typeof e.createElement)try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);const i=n.contentWindow;i&&i.fetch&&(t=i.fetch),e.head.removeChild(n)}catch(e){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return od=t.bind(hc)}()){let n=0,i=0;return sd(e,(function(r){const s=r.body.length;n+=s,i++;const a={body:r.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&i<15,...e.fetchOptions};try{return t(e.url,a).then((e=>(n-=s,i--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return od=void 0,n-=s,i--,No(e)}}))}function cd(e){return sd(e,(function(t){return new Fo(((n,i)=>{const r=new XMLHttpRequest;r.onerror=i,r.onreadystatechange=()=>{4===r.readyState&&n({statusCode:r.status,headers:{"x-sentry-rate-limits":r.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":r.getResponseHeader("Retry-After")}})},r.open("POST",e.url);for(const t in e.headers)Object.prototype.hasOwnProperty.call(e.headers,t)&&r.setRequestHeader(t,e.headers[t]);r.send(t.body)}))}))}const dd=[new nl,new sl,new Dc,new bc,new xc,new Gc,new qc,new Hc];function ud(e){e.startSession({ignoreDuration:!0}),e.captureSession()}const hd="baggage",pd="sentry-",fd=/^sentry-/,md=8192;function gd(e){if(e)return function(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce(((e,[t,n],i)=>{const r=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,s=0===i?r:`${e},${r}`;return s.length>md?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):s}),"")}(Object.entries(e).reduce(((e,[t,n])=>(n&&(e[`${pd}${t}`]=n),e)),{}))}function yd(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(e[t]=n,e)),{})}const vd=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function bd(e=wo(),t=wo().substring(16),n){let i="";return void 0!==n&&(i=n?"-1":"-0"),`${e}-${t}${i}`}class _d{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class wd{constructor(e){if(this.traceId=wo(),this.spanId=wo().substring(16),this.startTimestamp=(0,Do.ph)(),this.tags={},this.data={},this.instrumenter="sentry",!e)return this;e.traceId&&(this.traceId=e.traceId),e.spanId&&(this.spanId=e.spanId),e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.data&&(this.data=e.data),e.tags&&(this.tags=e.tags),e.status&&(this.status=e.status),e.startTimestamp&&(this.startTimestamp=e.startTimestamp),e.endTimestamp&&(this.endTimestamp=e.endTimestamp),e.instrumenter&&(this.instrumenter=e.instrumenter)}startChild(e){const t=new wd({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t),t.transaction=this.transaction,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&t.transaction){const n=`[Tracing] Starting '${e&&e.op||"< unknown op >"}' span on transaction '${t.transaction.name||"< unknown name >"}' (${t.transaction.spanId}).`;t.transaction.metadata.spanMetadata[t.spanId]={logMessage:n},Io.log(n)}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e)),this.setData("http.response.status_code",e);const t=function(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(e);return"unknown_error"!==t&&this.setStatus(t),this}isSuccess(){return"ok"===this.status}finish(e){if(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:e}=this.transaction.metadata.spanMetadata[this.spanId];e&&Io.log(e.replace("Starting","Finishing"))}this.endTimestamp="number"==typeof e?e:(0,Do.ph)()}toTraceparent(){return bd(this.traceId,this.spanId,this.sampled)}toContext(){return bo({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return bo({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return bo({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}class Ed extends wd{constructor(e,t){super(e),this._measurements={},this._contexts={},this._hub=t||Ko(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;const n=this.metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}setName(e,t="custom"){this._name=e,this.metadata.source=t}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new _d(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this.metadata={...this.metadata,...e}}finish(e){if(void 0!==this.endTimestamp)return;this.name||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(e);const t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this.sampled)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(t&&t.recordDroppedEvent("sample_rate","transaction"));const n=this.spanRecorder?this.spanRecorder.spans.filter((e=>e!==this&&e.endTimestamp)):[];this._trimEnd&&n.length>0&&(this.endTimestamp=n.reduce(((e,t)=>e.endTimestamp&&t.endTimestamp?e.endTimestamp>t.endTimestamp?e:t:e)).endTimestamp);const i=this.metadata,r={contexts:{...this._contexts,trace:this.getTraceContext()},spans:n,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...i,dynamicSamplingContext:this.getDynamicSamplingContext()},...i.source&&{transaction_info:{source:i.source}}};return Object.keys(this._measurements).length>0&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),r.measurements=this._measurements),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(r)}toContext(){return bo({...super.toContext(),name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const e=this._hub||Ko(),t=e.getClient();if(!t)return{};const n=e.getScope(),i=Kl(this.traceId,t,n),r=this.metadata.sampleRate;void 0!==r&&(i.sample_rate=`${r}`);const s=this.metadata.source;return s&&"url"!==s&&(i.transaction=this.name),void 0!==this.sampled&&(i.sampled=String(this.sampled)),i}setHub(e){this._hub=e}}const Td={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},Sd=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class xd extends _d{constructor(e,t,n,i){super(i),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=n}add(e){e.spanId!==this.transactionSpanId&&(e.finish=t=>{e.endTimestamp="number"==typeof t?t:(0,Do.ph)(),this._popActivity(e.spanId)},void 0===e.endTimestamp&&this._pushActivity(e.spanId)),super.add(e)}}class kd extends Ed{constructor(e,t,n=Td.idleTimeout,i=Td.finalTimeout,r=Td.heartbeatInterval,s=!1){super(e,t),this._idleHub=t,this._idleTimeout=n,this._finalTimeout=i,this._heartbeatInterval=r,this._onScope=s,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Sd[4],s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),t.configureScope((e=>e.setSpan(this)))),this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Sd[3],this.finish())}),this._finalTimeout)}finish(e=(0,Do.ph)()){if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setTag("finishReason",this._finishReason),this.spanRecorder){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] finishing IdleTransaction",new Date(1e3*e).toISOString(),this.op);for(const t of this._beforeFinishCallbacks)t(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter((t=>{if(t.spanId===this.spanId)return!0;t.endTimestamp||(t.endTimestamp=e,t.setStatus("cancelled"),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));const n=t.startTimestamp<e,i=(this._finalTimeout+this._idleTimeout)/1e3,r=t.endTimestamp-this.startTimestamp<i;if("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){const e=JSON.stringify(t,void 0,2);n?r||Io.log("[Tracing] discarding Span since it finished after Transaction final timeout",e):Io.log("[Tracing] discarding Span since it happened after Transaction was finished",e)}return n&&r})),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] flushing IdleTransaction")}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] No active IdleTransaction");if(this._onScope){const e=this._idleHub.getScope();e.getTransaction()===this&&e.setSpan(void 0)}return super.finish(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const t=e=>{this._finished||this._pushActivity(e)},n=e=>{this._finished||this._popActivity(e)};this.spanRecorder=new xd(t,n,this.spanId,e),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===t,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Sd[5],this.finish(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=Sd[1],this.finish(e))}),this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] popActivity ${e}`),delete this.activities[e],("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const e=(0,Do.ph)();this._idleTimeoutCanceledPermanently?(this._finishReason=Sd[5],this.finish(e)):this._restartIdleTimeout(e+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Sd[0],this.finish()):this._pingHeartbeat()}_pingHeartbeat(){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}function Cd(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=Ko().getClient(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function Ld(e){return(e||Ko()).getScope().getTransaction()}let Ad=!1;function Rd(){const e=Ld();if(e){const t="internal_error";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}function Id(){const e=this.getScope().getSpan();return e?{"sentry-trace":e.toTraceparent()}:{}}function Dd(e,t,n){if(!Cd(t))return e.sampled=!1,e;if(void 0!==e.sampled)return e.setMetadata({sampleRate:Number(e.sampled)}),e;let i;return"function"==typeof t.tracesSampler?(i=t.tracesSampler(n),e.setMetadata({sampleRate:Number(i)})):void 0!==n.parentSampled?i=n.parentSampled:void 0!==t.tracesSampleRate?(i=t.tracesSampleRate,e.setMetadata({sampleRate:Number(i)})):(i=1,e.setMetadata({sampleRate:i})),(to(r=i)||"number"!=typeof r&&"boolean"!=typeof r?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(r)} of type ${JSON.stringify(typeof r)}.`),0):!(r<0||r>1)||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${r}.`),0))?i?(e.sampled=Math.random()<i,e.sampled?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] starting ${e.op} transaction - ${e.name}`),e):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(i)})`),e)):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] Discarding transaction because "+("function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),e.sampled=!1,e):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e);var r}function Pd(e,t){const n=this.getClient(),i=n&&n.getOptions()||{},r=i.instrumenter||"sentry",s=e.instrumenter||"sentry";r!==s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${r}\` instrumenter.\nThe transaction will not be sampled. Please use the ${r} instrumentation to start transactions.`),e.sampled=!1);let a=new Ed(e,this);return a=Dd(a,i,{parentSampled:e.parentSampled,transactionContext:e,...t}),a.sampled&&a.initSpanRecorder(i._experiments&&i._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",a),a}function Md(e,t,n,i,r,s,a){const o=e.getClient(),l=o&&o.getOptions()||{};let c=new kd(t,e,n,i,a,r);return c=Dd(c,l,{parentSampled:t.parentSampled,transactionContext:t,...s}),c.sampled&&c.initSpanRecorder(l._experiments&&l._experiments.maxSpans),o&&o.emit&&o.emit("startTransaction",c),c}Rd.tag="sentry_tracingErrorCallback";const Od=io.n2,Nd=(e,t,n)=>{let i,r;return s=>{t.value>=0&&(s||n)&&(r=t.value-(i||0),(r||void 0===i)&&(i=t.value,t.delta=r,e(t)))}},Fd=()=>Od.__WEB_VITALS_POLYFILL__?Od.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const e=Od.performance.timing,t=Od.performance.navigation.type,n={entryType:"navigation",startTime:0,type:2==t?"back_forward":1===t?"reload":"navigate"};for(const t in e)"navigationStart"!==t&&"toJSON"!==t&&(n[t]=Math.max(e[t]-e.navigationStart,0));return n})()):Od.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],Bd=()=>{const e=Fd();return e&&e.activationStart||0},Ud=(e,t)=>{const n=Fd();let i="navigate";return n&&(i=Od.document.prerendering||Bd()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:i}},$d=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const i=new PerformanceObserver((e=>{t(e.getEntries())}));return i.observe(Object.assign({type:e,buffered:!0},n||{})),i}}catch(e){}},Gd=(e,t)=>{const n=i=>{"pagehide"!==i.type&&"hidden"!==Od.document.visibilityState||(e(i),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)};let Hd=-1;const qd=()=>(Hd<0&&(Hd="hidden"!==Od.document.visibilityState||Od.document.prerendering?1/0:0,Gd((({timeStamp:e})=>{Hd=e}),!0)),{get firstHiddenTime(){return Hd}}),zd={};function jd(e){return"number"==typeof e&&isFinite(e)}function Vd(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}function Yd(e){return e/1e3}function Kd(){return Od&&Od.addEventListener&&Od.performance}let Wd,Xd,Zd=0,Jd={};function Qd(){const e=Kd();if(e&&Do.Z1){e.mark&&Od.performance.mark("sentry-tracing-init"),(e=>{const t=qd(),n=Ud("FID");let i;const r=e=>{e.startTime<t.firstHiddenTime&&(n.value=e.processingStart-e.startTime,n.entries.push(e),i(!0))},s=e=>{e.forEach(r)},a=$d("first-input",s);i=Nd(e,n),a&&Gd((()=>{s(a.takeRecords()),a.disconnect()}),!0)})((e=>{const t=e.entries.pop();if(!t)return;const n=Yd(Do.Z1),i=Yd(t.startTime);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding FID"),Jd.fid={value:e.value,unit:"millisecond"},Jd["mark.fid"]={value:n+i,unit:"second"}}));const t=(e=>{const t=Ud("CLS",0);let n,i=0,r=[];const s=e=>{e.forEach((e=>{if(!e.hadRecentInput){const s=r[0],a=r[r.length-1];i&&0!==r.length&&e.startTime-a.startTime<1e3&&e.startTime-s.startTime<5e3?(i+=e.value,r.push(e)):(i=e.value,r=[e]),i>t.value&&(t.value=i,t.entries=r,n&&n())}}))},a=$d("layout-shift",s);if(a){n=Nd(e,t);const i=()=>{s(a.takeRecords()),n(!0)};return Gd(i),i}})((e=>{const t=e.entries.pop();t&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding CLS"),Jd.cls={value:e.value,unit:""},Xd=t)})),n=(e=>{const t=qd(),n=Ud("LCP");let i;const r=e=>{const r=e[e.length-1];if(r){const e=Math.max(r.startTime-Bd(),0);e<t.firstHiddenTime&&(n.value=e,n.entries=[r],i())}},s=$d("largest-contentful-paint",r);if(s){i=Nd(e,n);const t=()=>{zd[n.id]||(r(s.takeRecords()),s.disconnect(),zd[n.id]=!0,i(!0))};return["keydown","click"].forEach((e=>{addEventListener(e,t,{once:!0,capture:!0})})),Gd(t,!0),t}})((e=>{const t=e.entries.pop();t&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding LCP"),Jd.lcp={value:e.value,unit:"millisecond"},Wd=t)}));return()=>{t&&t(),n&&n()}}return()=>{}}function eu(e,t,n,i,r,s){const a=s?t[s]:t[`${n}End`],o=t[`${n}Start`];o&&a&&Vd(e,{op:"browser",description:r||n,startTimestamp:i+Yd(o),endTimestamp:i+Yd(a)})}const tu=["localhost",/^\/(?!\/)/],nu={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:tu,tracePropagationTargets:tu};function iu(e){const t=e.data.url,n=new PerformanceObserver((i=>{i.getEntries().forEach((i=>{"fetch"!==i.initiatorType&&"xmlhttprequest"!==i.initiatorType||!i.name.endsWith(t)||(function(e){const{name:t,version:n}=function(e){let t="unknown",n="unknown",i="";for(const r of e){if("/"===r){[t,n]=e.split("/");break}if(!isNaN(Number(r))){t="h"===i?"http":i,n=e.split(i)[1];break}i+=r}return i===e&&(t=i),{name:t,version:n}}(e.nextHopProtocol),i=[];return i.push(["network.protocol.version",n],["network.protocol.name",t]),Do.Z1?[...i,["http.request.redirect_start",ru(e.redirectStart)],["http.request.fetch_start",ru(e.fetchStart)],["http.request.domain_lookup_start",ru(e.domainLookupStart)],["http.request.domain_lookup_end",ru(e.domainLookupEnd)],["http.request.connect_start",ru(e.connectStart)],["http.request.secure_connection_start",ru(e.secureConnectionStart)],["http.request.connection_end",ru(e.connectEnd)],["http.request.request_start",ru(e.requestStart)],["http.request.response_start",ru(e.responseStart)],["http.request.response_end",ru(e.responseEnd)]]:i}(i).forEach((t=>e.setData(...t))),n.disconnect())}))}));n.observe({entryTypes:["resource"]})}function ru(e){return((Do.Z1||performance.timeOrigin)+e)/1e3}function su(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader(hd,n)}catch(e){}}const au={...Td,markBackgroundTransactions:!0,routingInstrumentation:function(e,t=!0,n=!0){if(!Od||!Od.location)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("Could not initialize routing instrumentation due to invalid location"));let i,r=Od.location.href;t&&(i=e({name:Od.location.pathname,startTimestamp:Do.Z1?Do.Z1/1e3:void 0,op:"pageload",metadata:{source:"url"}})),n&&bl("history",(({to:t,from:n})=>{void 0===n&&r&&-1!==r.indexOf(t)?r=void 0:n!==t&&(r=void 0,i&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.finish()),i=e({name:Od.location.pathname,op:"navigation",metadata:{source:"url"}}))}))},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...nu};class ou{constructor(e){this.name="BrowserTracing",this._hasSetTracePropagationTargets=!1,function(){const e=Vo();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=Pd),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=Id),Ad||(Ad=!0,bl("error",Rd),bl("unhandledrejection",Rd)))}(),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&(this._hasSetTracePropagationTargets=!(!e||!e.tracePropagationTargets&&!e.tracingOrigins)),this.options={...au,...e},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=Qd(),this.options.enableLongTask&&$d("longtask",(e=>{for(const t of e){const e=Ld();if(!e)return;const n=Yd(Do.Z1+t.startTime),i=Yd(t.duration);e.startChild({description:"Main UI thread blocked",op:"ui.long-task",startTimestamp:n,endTimestamp:n+i})}})),this.options._experiments.enableInteractions&&$d("event",(e=>{for(const t of e){const e=Ld();if(!e)return;if("click"===t.name){const n=Yd(Do.Z1+t.startTime),i=Yd(t.duration);e.startChild({description:ao(t.target),op:`ui.interaction.${t.name}`,startTimestamp:n,endTimestamp:n+i})}}}),{durationThreshold:0})}setupOnce(e,t){this._getCurrentHub=t;const n=t().getClient(),i=n&&n.getOptions(),{routingInstrumentation:r,startTransactionOnLocationChange:s,startTransactionOnPageLoad:a,markBackgroundTransactions:o,traceFetch:l,traceXHR:c,shouldCreateSpanForRequest:d,enableHTTPTimings:u,_experiments:h}=this.options,p=i&&i.tracePropagationTargets,f=p||this.options.tracePropagationTargets;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&this._hasSetTracePropagationTargets&&p&&Io.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),r((e=>{const n=this._createRouteTransaction(e);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(n,e,t),n}),a,s),o&&(Od&&Od.document?Od.document.addEventListener("visibilitychange",(()=>{const e=Ld();if(Od.document.hidden&&e){const t="cancelled";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${e.op}`),e.status||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.finish()}})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("[Tracing] Could not set up background tab detection due to lack of global document")),h.enableInteractions&&this._registerInteractionListener(),function(e){const{traceFetch:t,traceXHR:n,tracePropagationTargets:i,tracingOrigins:r,shouldCreateSpanForRequest:s,enableHTTPTimings:a}={traceFetch:nu.traceFetch,traceXHR:nu.traceXHR,...e},o="function"==typeof s?s:e=>!0,l=e=>function(e,t){return uo(e,t||tu)}(e,i||r),c={};t&&bl("fetch",(e=>{const t=function(e,t,n,i){if(!Cd()||!e.fetchData)return;const r=t(e.fetchData.url);if(e.endTimestamp&&r){const t=e.fetchData.__span;if(!t)return;const n=i[t];if(n){if(e.response){n.setHttpStatus(e.response.status);const t=e.response&&e.response.headers&&e.response.headers.get("content-length"),i=parseInt(t);i>0&&n.setData("http.response_content_length",i)}else e.error&&n.setStatus("internal_error");n.finish(),delete i[t]}return}const s=Ko(),a=s.getScope(),o=s.getClient(),l=a.getSpan(),{method:c,url:d}=e.fetchData,u=r&&l?l.startChild({data:{url:d,type:"fetch","http.method":c},description:`${c} ${d}`,op:"http.client"}):void 0;if(u&&(e.fetchData.__span=u.spanId,i[u.spanId]=u),n(e.fetchData.url)&&o){const t=e.args[0];e.args[1]=e.args[1]||{};const n=e.args[1];n.headers=function(e,t,n,i,r){const s=r||n.getSpan(),a=s&&s.transaction,{traceId:o,sampled:l,dsc:c}=n.getPropagationContext(),d=s?s.toTraceparent():bd(o,void 0,l),u=gd(a?a.getDynamicSamplingContext():c||Kl(o,t,n)),h="undefined"!=typeof Request&&no(e,Request)?e.headers:i.headers;if(h){if("undefined"!=typeof Headers&&no(h,Headers)){const e=new Headers(h);return e.append("sentry-trace",d),u&&e.append(hd,u),e}if(Array.isArray(h)){const e=[...h,["sentry-trace",d]];return u&&e.push([hd,u]),e}{const e="baggage"in h?h.baggage:void 0,t=[];return Array.isArray(e)?t.push(...e):e&&t.push(e),u&&t.push(u),{...h,"sentry-trace":d,baggage:t.length>0?t.join(","):void 0}}}return{"sentry-trace":d,baggage:u}}(t,o,a,n,u)}return u}(e,o,l,c);a&&t&&iu(t)})),n&&bl("xhr",(e=>{const t=function(e,t,n,i){const r=e.xhr,s=r&&r[gl];if(!Cd()||r&&r.__sentry_own_request__||!r||!s)return;const a=t(s.url);if(e.endTimestamp&&a){const e=r.__sentry_xhr_span_id__;if(!e)return;const t=i[e];return void(t&&(t.setHttpStatus(s.status_code),t.finish(),delete i[e]))}const o=Ko(),l=o.getScope(),c=l.getSpan(),d=a&&c?c.startChild({data:{...s.data,type:"xhr","http.method":s.method,url:s.url},description:`${s.method} ${s.url}`,op:"http.client"}):void 0;if(d&&(r.__sentry_xhr_span_id__=d.spanId,i[r.__sentry_xhr_span_id__]=d),r.setRequestHeader&&n(s.url))if(d){const e=d&&d.transaction,t=gd(e&&e.getDynamicSamplingContext());su(r,d.toTraceparent(),t)}else{const e=o.getClient(),{traceId:t,sampled:n,dsc:i}=l.getPropagationContext();su(r,bd(t,void 0,n),gd(i||(e?Kl(t,e,l):void 0)))}return d}(e,o,l,c);a&&t&&iu(t)}))}({traceFetch:l,traceXHR:c,tracePropagationTargets:f,shouldCreateSpanForRequest:d,enableHTTPTimings:u})}_createRouteTransaction(e){if(!this._getCurrentHub)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`));const t=this._getCurrentHub(),{beforeNavigate:n,idleTimeout:i,finalTimeout:r,heartbeatInterval:s}=this.options,a="pageload"===e.op,o=a?lu("sentry-trace"):"",l=a?lu("baggage"):"",{traceparentData:c,dynamicSamplingContext:d,propagationContext:u}=function(e,t){const n=function(e){if(!e)return;const t=e.match(vd);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}(e),i=function(e){if(!Xa(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce(((e,t)=>({...e,...yd(t)})),{});else{if(!e)return;t=yd(e)}const n=Object.entries(t).reduce(((e,[t,n])=>(t.match(fd)&&(e[t.slice(pd.length)]=n),e)),{});return Object.keys(n).length>0?n:void 0}(t),{traceId:r,parentSpanId:s,parentSampled:a}=n||{},o={traceId:r||wo(),spanId:wo().substring(16),sampled:void 0!==a&&a};return s&&(o.parentSpanId=s),i&&(o.dsc=i),{traceparentData:n,dynamicSamplingContext:i,propagationContext:o}}(o,l),h={...e,...c,metadata:{...e.metadata,dynamicSamplingContext:c&&!d?{}:d},trimEnd:!0},p="function"==typeof n?n(h):h,f=void 0===p?{...h,sampled:!1}:p;f.metadata=f.name!==h.name?{...f.metadata,source:"custom"}:f.metadata,this._latestRouteName=f.name,this._latestRouteSource=f.metadata&&f.metadata.source,!1===f.sampled&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] Will not send ${f.op} transaction because of beforeNavigate.`),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Tracing] Starting ${f.op} transaction on scope`);const{location:m}=Od,g=Md(t,f,i,r,!0,{location:m},s),y=t.getScope();return a&&c?y.setPropagationContext(u):y.setPropagationContext({traceId:g.traceId,spanId:g.spanId,parentSpanId:g.parentSpanId,sampled:!!g.sampled}),g.registerBeforeFinishCallback((e=>{this._collectWebVitals(),function(e){const t=Kd();if(!t||!Od.performance.getEntries||!Do.Z1)return;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Tracing] Adding & adjusting spans using Performance API");const n=Yd(Do.Z1),i=t.getEntries();let r,s;if(i.slice(Zd).forEach((t=>{const i=Yd(t.startTime),a=Yd(t.duration);if(!("navigation"===e.op&&n+i<e.startTimestamp))switch(t.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((i=>{eu(e,t,i,n)})),eu(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),eu(e,t,"fetch",n,"cache","domainLookupStart"),eu(e,t,"domainLookup",n,"DNS"),function(e,t,n){Vd(e,{op:"browser",description:"request",startTimestamp:n+Yd(t.requestStart),endTimestamp:n+Yd(t.responseEnd)}),Vd(e,{op:"browser",description:"response",startTimestamp:n+Yd(t.responseStart),endTimestamp:n+Yd(t.responseEnd)})}(e,t,n)}(e,t,n),r=n+Yd(t.responseStart),s=n+Yd(t.requestStart);break;case"mark":case"paint":case"measure":{!function(e,t,n,i,r){const s=r+n,a=s+i;Vd(e,{description:t.name,endTimestamp:a,op:t.entryType,startTimestamp:s})}(e,t,i,a,n);const r=qd(),s=t.startTime<r.firstHiddenTime;"first-paint"===t.name&&s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding FP"),Jd.fp={value:t.startTime,unit:"millisecond"}),"first-contentful-paint"===t.name&&s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding FCP"),Jd.fcp={value:t.startTime,unit:"millisecond"});break}case"resource":{const r=t.name.replace(Od.location.origin,"");!function(e,t,n,i,r,s){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const a={};"transferSize"in t&&(a["http.response_transfer_size"]=t.transferSize),"encodedBodySize"in t&&(a["http.response_content_length"]=t.encodedBodySize),"decodedBodySize"in t&&(a["http.decoded_response_content_length"]=t.decodedBodySize),"renderBlockingStatus"in t&&(a["resource.render_blocking_status"]=t.renderBlockingStatus);const o=s+i;Vd(e,{description:n,endTimestamp:o+r,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",startTimestamp:o,data:a})}(e,t,r,i,a,n);break}}})),Zd=Math.max(i.length-1,0),function(e){const t=Od.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),jd(n.rtt)&&(Jd["connection.rtt"]={value:n.rtt,unit:"millisecond"})),jd(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),jd(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===e.op){"number"==typeof r&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding TTFB"),Jd.ttfb={value:1e3*(r-e.startTimestamp),unit:"millisecond"},"number"==typeof s&&s<=r&&(Jd["ttfb.requestTime"]={value:1e3*(r-s),unit:"millisecond"})),["fcp","fp","lcp"].forEach((t=>{if(!Jd[t]||n>=e.startTimestamp)return;const i=Jd[t].value,r=n+Yd(i),s=Math.abs(1e3*(r-e.startTimestamp)),a=s-i;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log(`[Measurements] Normalized ${t} from ${i} to ${s} (${a})`),Jd[t].value=s}));const t=Jd["mark.fid"];t&&Jd.fid&&(Vd(e,{description:"first input delay",endTimestamp:t.value+Yd(Jd.fid.value),op:"ui.action",startTimestamp:t.value}),delete Jd["mark.fid"]),"fcp"in Jd||delete Jd.cls,Object.keys(Jd).forEach((t=>{e.setMeasurement(t,Jd[t].value,Jd[t].unit)})),function(e){Wd&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding LCP Data"),Wd.element&&e.setTag("lcp.element",ao(Wd.element)),Wd.id&&e.setTag("lcp.id",Wd.id),Wd.url&&e.setTag("lcp.url",Wd.url.trim().slice(0,200)),e.setTag("lcp.size",Wd.size)),Xd&&Xd.sources&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.log("[Measurements] Adding CLS Data"),Xd.sources.forEach(((t,n)=>e.setTag(`cls.source.${n+1}`,ao(t.node)))))}(e)}Wd=void 0,Xd=void 0,Jd={}}(e)})),g}_registerInteractionListener(){let e;const t=()=>{const{idleTimeout:t,finalTimeout:n,heartbeatInterval:i}=this.options,r="ui.action.click",s=Ld();if(s&&s.op&&["navigation","pageload"].includes(s.op))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`[Tracing] Did not create ${r} transaction because a pageload or navigation transaction is in progress.`));if(e&&(e.setFinishReason("interactionInterrupted"),e.finish(),e=void 0),!this._getCurrentHub)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`[Tracing] Did not create ${r} transaction because _getCurrentHub is invalid.`));if(!this._latestRouteName)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn(`[Tracing] Did not create ${r} transaction because _latestRouteName is missing.`));const a=this._getCurrentHub(),{location:o}=Od,l={name:this._latestRouteName,op:r,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=Md(a,l,t,n,!0,{location:o},i)};["click"].forEach((e=>{addEventListener(e,t,{once:!1,capture:!0})}))}}function lu(e){const t=(n=`meta[name=${e}]`,ro.document&&ro.document.querySelector?ro.document.querySelector(n):null);var n;return t?t.getAttribute("content"):void 0}function cu(e){return cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cu(e)}function du(e,t){if(e){if("string"==typeof e)return uu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uu(e,t):void 0}}function uu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function hu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function pu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hu(Object(n),!0).forEach((function(t){fu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fu(e,t,n){var i;return i=function(e,t){if("object"!=cu(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=cu(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==cu(i)?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mu(e){var t,n,i,r={},s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=du(e))){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}(new URLSearchParams(e).entries());try{for(s.s();!(t=s.n()).done;){var a=(n=t.value,i=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}(n,i)||du(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],l=a[1];r[o]=l}}catch(e){s.e(e)}finally{s.f()}return r}function gu(e){return gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gu(e)}function yu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function vu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yu(Object(n),!0).forEach((function(t){_u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bu(e){return function(e){if(Array.isArray(e))return Cu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ku(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _u(e,t,n){var i;return i=function(e,t){if("object"!=gu(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=gu(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==gu(i)?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wu(){wu=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function d(e,t,n,i){var s=t&&t.prototype instanceof y?t:y,a=Object.create(s.prototype),o=new R(i||[]);return r(a,"_invoke",{value:k(e,n,o)}),a}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function b(){}var _={};c(_,a,(function(){return this}));var w=Object.getPrototypeOf,E=w&&w(w(I([])));E&&E!==n&&i.call(E,a)&&(_=E);var T=b.prototype=y.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(r,s,a,o){var l=u(e[r],e,s);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==gu(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,o)}),(function(e){n("throw",e,a,o)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,o)}))}o(l.arg)}var s;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return s=s?s.then(r,r):r()}})}function k(t,n,i){var r=h;return function(s,a){if(r===f)throw new Error("Generator is already running");if(r===m){if("throw"===s)throw a;return{value:e,done:!0}}for(i.method=s,i.arg=a;;){var o=i.delegate;if(o){var l=C(o,i);if(l){if(l===g)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===h)throw r=m,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=f;var c=u(t,n,i);if("normal"===c.type){if(r=i.done?m:p,c.arg===g)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=m,i.method="throw",i.arg=c.arg)}}}function C(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),g;var s=u(r,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,g;var a=s.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw new TypeError(gu(t)+" is not iterable")}return v.prototype=b,r(T,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:v,configurable:!0}),v.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},S(x.prototype),c(x.prototype,o,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,i,r,s){void 0===s&&(s=Promise);var a=new x(d(e,n,i,r),s);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(T),c(T,l,"Generator"),c(T,a,(function(){return this})),c(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=I,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;A(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:I(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},t}function Eu(e,t,n,i,r,s,a){try{var o=e[s](a),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(i,r)}function Tu(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var s=e.apply(t,n);function a(e){Eu(s,i,r,a,o,"next",e)}function o(e){Eu(s,i,r,a,o,"throw",e)}a(void 0)}))}}function Su(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ku(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function xu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}(e,t)||ku(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ku(e,t){if(e){if("string"==typeof e)return Cu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cu(e,t):void 0}}function Cu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Lu,Au,Ru=n(568);window.pandaLoad=window.pandaLoad||{};try{!function(e={}){void 0===e.defaultIntegrations&&(e.defaultIntegrations=dd),void 0===e.release&&("string"==typeof __SENTRY_RELEASE__&&(e.release=__SENTRY_RELEASE__),hc.SENTRY_RELEASE&&hc.SENTRY_RELEASE.id&&(e.release=hc.SENTRY_RELEASE.id)),void 0===e.autoSessionTracking&&(e.autoSessionTracking=!0),void 0===e.sendClientReports&&(e.sendClientReports=!0);const t={...e,stackParser:(n=e.stackParser||td,Array.isArray(n)?ll(...n):n),integrations:Jo(e),transport:e.transport||(hl()?ld:cd)};var n;!function(e,t){!0===t.debug&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?Io.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));const n=Ko();n.getScope().update(t.initialScope);const i=new e(t);n.bindClient(i)}(Sc,t),e.autoSessionTracking&&function(){if(void 0===hc.document)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Io.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));const e=Ko();e.captureSession&&(ud(e),bl("history",(({from:e,to:t})=>{void 0!==e&&e!==t&&ud(Ko())})))}()}({dsn:"https://2352194d4d5041f997f5c3204c13c862@o1279024.ingest.sentry.io/6479348",release:"player@315",integrations:[new ou],tracesSampleRate:0,beforeSend:function(e,t){var n=t.originalException;if(n){var i=e.exception.values,r=n.message;return r&&["this.enter is not a function","Not 2xx response","Failed to fetch","The play() request was interrupted by a call to pause(). https://goo.gl/LdLk22","The play() request was interrupted by a new load request. https://goo.gl/LdLk22","play() failed because the user didn't interact with the document first","The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission.","play() can only be initiated by a user gesture.","Load failed","play() can only be initiated by a user gesture.","play() failed because the user didn't interact with the document first. https://goo.gl/xX8pDD","AbortError: The operation was aborted.","NetworkError when attempting to fetch resource.","fetch(...).then(...).then(...).catch(...).finally is not a function","Failed to execute 'exitFullscreen' on 'Document': Document not active","Permissions check failed","fullscreen error","The play method is not allowed by the user agent or the platform","The play() request was interrupted because video-only","The operation was aborted","AbortError:","Failed to execute 'requestPictureInPicture","Cannot read properties of null (reading 'trigger')","Fullscreen request denied","Not in fullscreen mode","not granted","Illegal invocation","The play() request was interrupted",'Blocked a frame with origin "null" from accessing a cross-origin frame',"Non-Error promise rejection captured with value: Object Not Found Matching Id"].find((function(e){return-1!==r.indexOf(e)}))||i&&i.length&&function(e){var t=["Object Not Found Matching Id","Non-Error promise rejection captured with value"],n=e.filter((function(e){return"UnhandledRejection"===e.type}));return!!n.length&&n.some((function(e){return t.some((function(t){return e.value.includes(t)}))}))}(i)?null:e}}})}catch(e){}function Iu(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}function Du(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=Number(e.charCodeAt(n)).toString(16);t.push(r)}return t.join("")}void 0!==document.hidden?(Lu="hidden",Au="visibilitychange"):void 0!==document.msHidden?(Lu="msHidden",Au="msvisibilitychange"):void 0!==document.webkitHidden&&(Lu="webkitHidden",Au="webkitvisibilitychange");var Pu=new URL(location.href),Mu="https://api-v2.pandavideo.com.br",Ou="https://subtitles.tv.pandavideo.com.br",Nu="https://config.tv.pandavideo.com.br",Fu="https://thumbs.tv.pandavideo.com.br",Bu="https://config-live.tv.pandavideo.com.br",Uu="https://config-drm.tv.pandavideo.com.br",$u=".tv.pandavideo.com.br",Gu={status:"offline",id:null},Hu=null,qu=[".cdn1.pandavideo.com",".b-cdn.net"],zu=["fragLoadError","fragLoadTimeOut","fragParsingError"],ju=!1,Vu=!1,Yu=0,Ku=0,Wu=!1,Xu=Pu.searchParams.get("v"),Zu=!1,Ju=!1,Qu=Pu.searchParams.get("l"),eh=(Pu.searchParams.get("liveBeta"),Pu.searchParams.get("c")),th=Pu.searchParams.get("j"),nh=!1,ih="true"===Pu.searchParams.get("isLive");Xu&&-1!==Xu.indexOf(Du("live"))&&(ih=!0),Xu&&-1!==Xu.indexOf(Du("comp"))&&(nh=Xu,Xu=null);var rh=!1,sh=!1,ah=!0,oh=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),lh="true"===Pu.searchParams.get("autoplay"),ch="true"===Pu.searchParams.get("isDashboard"),dh=Pu.searchParams.get("title"),uh=Pu.searchParams.get("refreshConfig"),hh=!document[Lu],ph="false"!==Pu.searchParams.get("preload"),fh=!0;"false"===Pu.searchParams.get("preloadUserAgentChecker")&&(fh=!1),fh&&["Kwai_Pro"].some((function(e){return-1!==navigator.userAgent.indexOf(e)}))&&(ph=!1),hh||(ph=!1),/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);var mh,gh=/(iPhone|iPod|iPad)/i.test(navigator.platform),yh=navigator.brave||!1,vh=!1,bh=Ha&&Ha.isSupported()&&!gh,_h=null,wh=Pu.searchParams.get("watermark"),Eh=Pu.searchParams.get("drm_group_id"),Th=!1,Sh=0,xh=0,kh=!1,Ch=null,Lh=100,Ah=100,Rh=null,Ih=!1,Dh="LIVESTREAM",Ph=!1,Mh="NOT_LIVE",Oh=!1,Nh=(Pu.searchParams.get("liveBadge"),[]),Fh=!1,Bh={},Uh=document.querySelector(":root"),$h=!1,Gh=!1,Hh=!1,qh=!1,zh=!1,jh="https://hit-video.pandavideo.com:6443",Vh=Iu(),Yh=[],Kh=function(){var e=location.host,t="pt";try{e.match(/.com$/)&&(t="en")}catch(e){}return t}(),Wh=n(740),Xh={},Zh=Su(Wh.keys());try{for(Zh.s();!(mh=Zh.n()).done;){var Jh=mh.value,Qh=Jh.match(/([A-Za-z0-9-_]+)\./i);if(Qh&&Qh.length>1){var ep=xu(Qh,2)[1];Xh[ep]=Wh(Jh)}}}catch(e){Zh.e(e)}finally{Zh.f()}var tp,np,ip=!1,rp=[],sp=null,ap=0,op=!1,lp=[],cp=15,dp={fullscreen:{enabled:!0,fallback:!0,iosNative:!0},hideControls:!0,captions:{active:!1,language:"",update:!0},controls:["play-large","play","progress","current-time","duration","mute","volume","settings","pip","airplay","fullscreen"],keyboard:{focused:!0,global:!1},i18n:Xh[Kh],iconUrl:"./icons/plyr.svg",thumbnail:{enabled:!1,pic_num:0,width:300,height:168,col:6,row:6,offsetX:0,offsetY:0,urls:[]}},up=["click","mousemove","mouseover","mousemove","touchmove","focus"],hp=(np=xu((tp=Pu.host).match(/(vz-[a-z0-9]{8}-[a-z0-9]{3})/)||[],1)[0])?(tp.match(/vunel/)&&(Ju=!0),np):null,pp=function(){var e="";try{document.location.ancestorOrigins&&document.location.ancestorOrigins.length>0?e=document.location.ancestorOrigins[document.location.ancestorOrigins.length-1]:document.referrer&&(e=document.referrer)}catch(t){e=window.self===window.top||document.referrer?document.referrer:"https://private.pandavideo.com.br/"}return e}();hp&&(Qu=hp);var fp,mp="";try{fp=localStorage.getItem("playerUser")}catch(e){}if(fp)mp=fp;else{mp="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}));try{localStorage.setItem("playerUser",mp)}catch(e){}}function gp(){return'<div style="position:relative;width:100%;height:100%"><iframe src="./live_chat.html?c='.concat(eh,"&l=").concat(Qu,'" style="border:none;position:absolute;top:0;left:0;" width="100%" height="100%" fetchpriority="high"></iframe></<div>')}function yp(){if(!Xu&&eh&&Qu){var e=gp(),t=document.getElementsByClassName("plyr")[0];t&&t.insertAdjacentHTML("beforeend",e)}else{var n="https://b-"+Qu+$u+"/"+Xu+"/playlist.m3u8";wh&&(Vu=!0,n+=".beta?watermark="+wh),ih&&(n="https://b-"+Qu+$u+"/"+Xu+"/live/custom_referrer="+pp+"/playlist.m3u8"),"true"===uh&&(n+="".concat(-1===n.indexOf("?")?"?":"&","nocache=").concat((new Date).getTime()));var i='src="'+n+'"';(th||nh)&&(i="");var r='\n        <div class="container " id="video-container">\n            '.concat(oh?"":'<video controls crossorigin preload="auto" '.concat(lh?"autoplay muted":"",' playsinline ><source type="application/x-mpegURL" ').concat(i,"></video>"),'\n            \x3c!-- Loading indicator --\x3e\n            <div id="error-indicator" class="disabled">\n            </div>\n            <div class="loading-icon">\n                <svg x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve">\n                    <path fill="#9e9e9e"\n                        d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">\n                        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s"\n                            from="0 50 50" to="360 50 50" repeatCount="indefinite" />\n                    </path>\n                </svg>\n            </div>\n            \n            \x3c!-- Live --\x3e\n            <div class="live-offline-badge disabled">\n\n                <img src="icons/panda-icon.svg" alt="">\n                <p id="live-subtitle">AGUARDANDO LIVE STREAM</p>\n                <p id="live-title"></p>\n            </div>\n            <div class="live-thumb disabled">\n                <img src="#" alt="Live Offline">\n            </div>\n        </div>\n    ');if(window.observer||(window.observer=new MutationObserver((function(e){var t,n=Su(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;"childList"===i.type&&i.addedNodes.forEach((function(e){var t;"video-container"===e.id&&(t=document.getElementById("video-container"),new ResizeObserver((function(e){var n,i=Su(e);try{for(i.s();!(n=i.n()).done;){n.value.target.getBoundingClientRect().bottom>window.innerHeight&&(t.style.cssText="margin-top: 0px !important;")}}catch(e){i.e(e)}finally{i.f()}})).observe(t),jf(),th||nh||(window.pandatag?window.pandatag("videoHtmlLoaded",!0):window.pandaLoad.videoHtmlLoaded=!0),window.observer.disconnect())}))}}catch(e){n.e(e)}finally{n.f()}}))),window.observer.observe(document.body,{childList:!0,subtree:!0}),document.addEventListener("DOMContentLoaded",(function e(){jf(),th||nh||(window.pandatag?window.pandatag("videoHtmlLoaded",!0):window.pandaLoad.videoHtmlLoaded=!0),document.removeEventListener("DOMContentLoaded",e)})),ph){if(_h&&document.body.insertAdjacentHTML("beforeend",r),_h||document.write(r),oh){var s=(new DOMParser).parseFromString('<video controls crossorigin preload="auto" '.concat(lh?"autoplay muted":"",' playsinline ><source type="application/x-mpegURL" ').concat(i,"></video>"),"text/html").body.firstChild,a=document.getElementById("video-container");a.insertBefore(s,a.getElementsByTagName("div")[0])}vp()}}}function vp(){!function(){try{var e=document.getElementById("context-menu");e&&e.remove()}catch(e){}}();try{if(!Iu()){var e=document.createElement("div");e.id="context-menu",Yf(e,"disabled"),e.innerHTML='<ul> <li> <a href="'.concat(Xh[Kh].aboutPandaLink,'" target="_blank" id="about-panda">').concat(Xh[Kh].aboutPanda,'</a> </li><li> <button id="report-problem">').concat(Xh[Kh].reportModalTitle,"</button> </li>").concat(Vh?"":'<li> <button id="view-hotkeys">'.concat(Xh[Kh].viewHotKeys,"</button> </li>"),"</ul>"),document.body.appendChild(e),new MutationObserver((function(t,n){var i=document.querySelector(".plyr__video-wrapper");i&&(i.insertAdjacentElement("afterbegin",e),n.disconnect())})).observe(document.body,{childList:!0,subtree:!0}),document.getElementById("report-problem").onclick=function(){window.postMessage({type:"pause"},"*"),_p(),Ap()},document.getElementById("view-hotkeys").onclick=function(){wp(),Ap()}}}catch(e){}}yp();var bp='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12.4713 4.97141C12.7317 4.71107 12.7317 4.28896 12.4713 4.02861C12.211 3.76826 11.7889 3.76826 11.5285 4.02861L7.99992 7.5572L4.47132 4.02861C4.21097 3.76826 3.78886 3.76826 3.52851 4.02861C3.26816 4.28896 3.26816 4.71107 3.52851 4.97141L7.05711 8.50001L3.52851 12.0286C3.26816 12.289 3.26816 12.7111 3.52851 12.9714C3.78886 13.2318 4.21097 13.2318 4.47132 12.9714L7.99992 9.44282L11.5285 12.9714C11.7889 13.2318 12.211 13.2318 12.4713 12.9714C12.7317 12.7111 12.7317 12.289 12.4713 12.0286L8.94273 8.50001L12.4713 4.97141Z" fill="white"/>\n</svg>';function _p(){try{Kf(document.getElementById("report-problem-dialog"),"disabled"),document.getElementById("report-close-dialog-btn").onclick=Sp,document.getElementById("radio-section").addEventListener("click",(function(e){e.target&&e.target.matches("input[type='radio']")&&("report-other"===document.querySelector('input[name="issue-reported"]:checked').value?(Kf(document.getElementById("other-input-wrapper"),"disabled"),document.getElementById("other-input").focus()):Yf(document.getElementById("other-input-wrapper"),"disabled"))})),document.getElementById("report-second-step-btn").onclick=Tu(wu().mark((function e(){var t,n,i,r;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Yf(document.getElementById("report-first-step"),"disabled"),Kf(document.getElementById("report-second-step"),"disabled"),t=document.querySelector('input[name="issue-reported"]:checked').value,n=kp(t),i="player-"+t,e.next=8,Ep();case 8:r=e.sent,n.latencies=r,uc((function(e){var t;e.setTag("section","".concat(i)),e.setLevel("error"),t={category:"user/player info",message:"".concat(JSON.stringify(n)),level:"info"},Ko().addBreadcrumb(t),dc(new Error("USER PLAYER REPORT"))})),xp(),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])})))}catch(e){xp()}}function wp(){try{Kf(document.getElementById("hot-keys-dialog"),"disabled"),document.getElementById("hot-keys-dialog-content").querySelector("button").onclick=function(){Yf(document.getElementById("hot-keys-dialog"),"disabled")}}catch(e){}}function Ep(){return Tp.apply(this,arguments)}function Tp(){return Tp=Tu(wu().mark((function e(){var t,n,i,r,s;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=["BR","RJ"],i=wu().mark((function e(){var n,i,a;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s[r],i=(new Date).valueOf(),a="https://edgezone-"+n.toLowerCase()+".bunnyinfra.net/500b.jpg",e.next=5,fetch(a).then(function(){var e=Tu(wu().mark((function e(r){return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(new Date).valueOf(),e.next=3,fetch(a).then(function(){var e=Tu(wu().mark((function e(r){var s,a;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(new Date).valueOf(),a=s-i,e.next=4,fetch("https://video-91.bunnycdn.com/.metrics/track-performance?zone="+n+"&latency="+a);case 4:t.push({zone:n.toLowerCase(),latency:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}));case 5:case"end":return e.stop()}}),e)})),r=0,s=n;case 4:if(!(r<s.length)){e.next=9;break}return e.delegateYield(i(),"t0",6);case 6:r++,e.next=4;break;case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),Tp.apply(this,arguments)}function Sp(){try{Yf(document.getElementById("report-problem-dialog"),"disabled"),Kf(document.getElementById("report-first-step"),"disabled"),Yf(document.getElementById("report-second-step"),"disabled"),Yf(document.getElementById("report-third-step"),"disabled"),Yf(document.getElementById("other-input-wrapper"),"disabled"),document.getElementById("other-input-wrapper").value="",document.getElementById("report-not-loading").checked=!0}catch(e){console.log("e",e)}}function xp(){try{document.getElementById("report-ok-btn").onclick=Sp,Yf(document.getElementById("report-second-step"),"disabled"),Kf(document.getElementById("report-third-step"),"disabled")}catch(e){}}function kp(e){var t={timestamp:(new Date).toISOString()};if(t.option=e,"report-other"===e)try{var n=document.getElementById("other-input").value;t.reasoning=n}catch(e){}try{t.autoplay=window.player.autoplay}catch(e){}try{t.videoId=Xu}catch(e){}try{t.libraryId=Qu}catch(e){}try{t.currentTime=window.player.currentTime}catch(e){}try{t.duration=window.player.duration}catch(e){}try{t.volume=window.player.volume}catch(e){}try{t.config=JSON.stringify(window.player_configs)}catch(e){}try{t.playerUser=localStorage.getItem("playerUser")}catch(e){}return t}function Cp(e){e&&window.player_configs.troubleshootDialog&&(e.addEventListener("contextmenu",Lp,!1),e.addEventListener("click",Ap,!1))}function Lp(e){if(!e.target.closest("#report-problem-dialog")&&!e.target.closest("#content-ai-dialog")){e.preventDefault();var t=document.getElementById("context-menu");t&&(Kf(t,"disabled"),window.innerWidth-e.clientX<175?t.style.left=e.clientX-175+"px":t.style.left=e.clientX+"px",window.innerHeight-e.clientY<75?t.style.top=e.clientY-75+"px":t.style.top=e.clientY+"px")}}function Ap(){Yf(document.getElementById("context-menu"),"disabled")}function Rp(){if(!function(){try{return window.self!==window.top}catch(e){return!0}}()){var e=document.getElementById("video-container");e&&(Yf(e,"in-page-container"),document.getElementById("body").style.backgroundColor="#000",jf())}}function Ip(e,t){var n,i=document.getElementsByClassName("plyr__controls");if(!i||!i.length)return console.log("Error on getting controls element");var r=i[0],s=null!==(n=null==r?void 0:r.childNodes)&&void 0!==n&&n;player_configs.controls.includes("fullscreen")&&s&&t?r.insertBefore(e,s[s.length-1]):r.appendChild(e)}function Dp(){var e=document.querySelector(".small-muted-icon");e&&Yf(e,"disabled")}function Pp(){Ju&&console.log("onClickPlayMutedIndicator"),qh=!0;var e=document.querySelector(".panda-muted-indicator-item");if(e){var t=document.querySelector(".plyr--video");if(t&&t.classList.remove("plyr--force-hide-controls"),player_configs.mutedIndicatorClickRestart){var n=0;if(player_configs.saveProgress)try{n=parseInt(localStorage.getItem("panda_video:"+Xu))}catch(e){}isNaN(n)&&(n=0),Ju&&console.log("onClickPlayMutedIndicator"),window.postMessage({type:"currentTime",parameter:n},"*")}window.postMessage({type:"increaseVolume",parameter:1},"*"),window.postMessage({type:"play"},"*"),e.style.display="none";try{zf({mutedIndicator:!0})}catch(e){}var i=document.getElementById("wrapper-progress");i&&Kf(i,"disabled"),player_configs.playOpensFullscreenNative?window.player.fullscreen.enter():player_configs.playOpensFullscreen&&window.parent.postMessage({message:"panda_open_window_fullscreen",video:Xu},"*")}}function Mp(){var e;if(ph){if(0===document.getElementsByClassName("plyr--full-ui").length)return;if(document.getElementsByClassName("small-muted-icon").length)return;e=document.getElementsByClassName("plyr--full-ui")[0]}else e=document.getElementById("video-container");var t=document.createElement("button"),n='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="7.999 9.062 46.75 32.563" enable-background="new 7.999 9.062 46.75 32.563" xml:space="preserve"> <style>@keyframes BLINK{0%{opacity: 0;}33%{opacity: 1;}66%{opacity: 1;}100%{opacity: 0;}}.blink_1{animation: BLINK 2s infinite; opacity: 0;}.blink_2{animation: BLINK 2s infinite .3s; opacity: 0;}.blink_3{animation: BLINK 2s infinite .6s; opacity: 0;}</style><style class="darkreader darkreader--sync" media="screen"></style> <g class="adjustable fg" style="fill: rgb(255, 255, 255); --darkreader-inline-fill:#ffffff;" data-darkreader-inline-fill=""> <path d="M53.249,39.616c-0.186,0-0.371-0.051-0.537-0.157l-43.5-27.75c-0.466-0.297-0.603-0.916-0.306-1.381c0.298-0.466,0.917-0.601,1.381-0.306l43.5,27.75c0.467,0.297,0.604,0.916,0.307,1.381C53.901,39.453,53.579,39.616,53.249,39.616z"></path> <path class="blink_3" d="M48.896,33.467l1.699,1.085c3.497-7.791,2.073-17.271-4.313-23.659c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414C50.581,18.019,51.913,26.463,48.896,33.467z"></path> <path class="blink_3" d="M46.926,36.956c-0.612,0.863-1.286,1.695-2.059,2.469c-0.392,0.391-0.392,1.023,0,1.414c0.194,0.195,0.45,0.293,0.707,0.293c0.256,0,0.512-0.098,0.706-0.293c0.878-0.878,1.642-1.824,2.333-2.807L46.926,36.956z"></path> <path class="blink_2" d="M42.543,29.415l1.777,1.135c1.545-5.315,0.229-11.293-3.953-15.476c-0.392-0.391-1.023-0.391-1.414,0c-0.392,0.391-0.392,1.023,0,1.414C42.454,19.987,43.639,24.925,42.543,29.415z"></path> <path class="blink_2" d="M41,33.174c-0.563,0.94-1.235,1.837-2.047,2.646c-0.391,0.392-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293s0.512-0.098,0.707-0.293c0.916-0.914,1.676-1.924,2.317-2.984L41,33.174z"></path> <path class="blink_1" d="M35.771,25.094l2.003,1.277c0.012-0.203,0.029-0.404,0.029-0.609c0-3.079-1.2-5.974-3.381-8.153c-0.391-0.391-1.022-0.391-1.414,0c-0.391,0.391-0.391,1.023,0,1.414C34.652,20.666,35.613,22.802,35.771,25.094z"></path> <path class="blink_1" d="M35.084,29.401c-0.474,1.145-1.172,2.197-2.076,3.1c-0.391,0.391-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293c0.257,0,0.513-0.098,0.707-0.293c1.008-1.006,1.795-2.17,2.361-3.43L35.084,29.401z"></path> <polygon points="28.124,20.215 28.124,14.991 24.635,17.99 "></polygon> <path d="M20.921,20.366h-6.423c-0.553,0-1,0.508-1,1.135v8.229c0,0.627,0.447,1.135,1,1.135h7.375l6.25,5.875V24.96L20.921,20.366z"></path> </g> </svg>';n=n+"<span>"+Xh[Kh].activateSound+"</span>",t.innerHTML=n,t.onclick=function(){if(ih)window.postMessage({type:"increaseVolume",parameter:1},"*"),Dp(),qh=!0,zf({mutedIndicator:!0});else{if(player_configs.mutedIndicatorClickRestart){var e=0;if(player_configs.saveProgress)try{e=parseInt(localStorage.getItem("panda_video:"+Xu))}catch(e){}isNaN(e)&&(e=0),Ju&&console.log("addSmallMutedIcon muted_indicator.onclick"),window.postMessage({type:"currentTime",parameter:e},"*")}window.postMessage({type:"increaseVolume",parameter:1},"*"),window.postMessage({type:"play",parameter:1},"*"),Dp(),qh=!0,zf({mutedIndicator:!0})}};var i=document.querySelector(".plyr__controls");i&&(i.onclick=function(){if(!qh)if(ih)window.postMessage({type:"increaseVolume",parameter:1},"*"),Dp(),qh=!0,zf({mutedIndicator:!0});else{if(player_configs.mutedIndicatorClickRestart){var e=0;if(player_configs.saveProgress)try{e=parseInt(localStorage.getItem("panda_video:"+Xu))}catch(e){}isNaN(e)&&(e=0),Ju&&console.log("addSmallMutedIcon controls.onclick"),window.postMessage({type:"currentTime",parameter:e},"*")}window.postMessage({type:"increaseVolume",parameter:1},"*"),window.postMessage({type:"play",parameter:1},"*"),zf({mutedIndicator:!0}),qh=!0}Dp()}),Yf(t,"small-muted-icon"),e.appendChild(t),qh=!1}function Op(){var e,t=window.player_configs.mutedIndicatorTextTop,n=window.player_configs.mutedIndicatorTextBottom;if(ph){if(0===document.getElementsByClassName("plyr--full-ui").length)return;e=document.getElementsByClassName("plyr--full-ui")[0]}else e=document.getElementById("video-container");var i=document.createElement("button"),r='<svg class="impact" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200" xml:space="preserve"><style>.fg-color{fill:var(--muted-indicator-text)}.bg-color{fill:var(--muted-indicator-background)}.line,.volume,.wave{transform:scale(1);transform-box:fill-box;transform-origin:center;}</style><filter id="panda-muted-indicator-impact-wrapper-highlight"><feDropShadow dx="0" dy="0" stdDeviation="1" flood-color="var(--muted-indicator-text)"/></filter><g class="adjustable fg" style="--darkreader-inline-fill:#ffffff"><path class="volume fg-color" d="M169.8 85.5h-23c-1.9 0-3.1 1.2-3.1 3.1v26.5c0 1.9 1.2 3.1 3.1 3.1h23l19.3 18.4V68.7c.3 0-19.3 16.8-19.3 16.8z"/><path class="wave fg-color" d="M205.9 127.8c-1.2-1.2-.9-3.4.3-5 9.6-12.1 9.6-29.3 0-41.1-1.2-1.6-1.2-3.7-.3-5 1.2-1.2 3.7-.9 5 .9 11.5 14.3 11.5 34.9 0 48.9-1.4 2.6-3.8 2.6-5 1.3z"/><path class="wave fg-color" d="M223.9 138.4c-1.2-1.2-.9-3.4.3-5 14.6-17.1 14.6-42.3 0-59.4-1.2-1.6-1.6-3.7-.3-5 1.2-1.2 3.4-.9 5 .9 16.5 19.3 16.5 48.2 0 67.5-1.5 2.2-3.8 2.6-5 1z"/><path class="wave fg-color" d="M241.6 149.3c-1.2-1.2-.9-3.4.3-5 21.2-24 21.2-60.1 0-84-1.2-1.2-1.6-3.1-.3-4.4 1.2-1.2 3.4-.9 5 .6 23.3 26.1 23.3 66 0 92.1-1.2 1.9-3.7 2.2-5 .7z"/><path class="line bg-color" d="M274 141.2c-.3-1.6-1.2-3.1-2.8-4L135.6 50.6c-.9-.6-2.2-.9-3.4-.9-2.2 0-4 .9-5.3 2.8-.9 1.6-1.2 3.1-.9 4.7.3 1.6 1.2 3.1 2.8 4l135.4 86.2c.9.6 2.2.9 3.4.9 2.2 0 4-.9 5.3-2.8 1.1-.9 1.4-2.7 1.1-4.3z"/><path class="line fg-color" d="M267.8 145.9c-.6 0-1.2-.3-1.6-.6L130.9 58.4c-1.6-.9-1.9-2.8-.9-4 .9-1.6 2.8-1.9 4-.9l135.4 86.2c1.6.9 1.9 2.8.9 4.4-.7.8-1.5 1.8-2.5 1.8z"/></g></svg>';r+='<svg class="blink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200" xml:space="preserve"><style>.fg-color{fill:var(--muted-indicator-text)}.bg-color{fill:var(--muted-indicator-background)}.line,.volume,.wave{transform:scale(1);transform-box:fill-box;transform-origin:center;}</style><g class="adjustable fg" style="--darkreader-inline-fill:#ffffff"><path class="volume fg-color" d="M189.1 68.7c.2 0-5.4 4.8-10.6 9.3l10.6 6.8V68.7z"/><path class="volume fg-color" d="M146.8 85.5c-1.9 0-3.1 1.2-3.1 3.1v26.5c0 1.9 1.2 3.1 3.1 3.1h23l19.3 18.4v-37L167 85.5h-20.2z"/><path class="wave blink_impact_1 fg-color" d="M206.2 122.8c-1.2 1.6-1.5 3.8-.3 5 1.2 1.3 3.6 1.3 5-1.3 2.4-2.9 4.3-6.1 5.7-9.4l-5.3-3.4c-1.2 3.2-2.9 6.3-5.1 9.1z"/><path class="wave blink_impact_1 fg-color" d="M210.9 77.6c-1.3-1.8-3.8-2.1-5-.9-.9 1.3-.9 3.4.3 5 4.4 5.4 6.7 11.9 7.1 18.5l6.1 3.9c.5-9.3-2.3-18.8-8.5-26.5z"/><path class="wave blink_impact_2 fg-color" d="M224.2 133.4c-1.2 1.6-1.5 3.8-.3 5 1.2 1.6 3.5 1.2 5-1 2.3-2.7 4.3-5.6 6-8.7l-5.2-3.3c-1.5 2.8-3.4 5.5-5.5 8z"/><path class="wave blink_impact_2 fg-color" d="M228.9 69.9c-1.6-1.8-3.8-2.1-5-.9-1.3 1.3-.9 3.4.3 5 9.6 11.2 12.9 25.9 9.9 39.5l5.5 3.5c4.2-16.1.6-33.9-10.7-47.1z"/><path class="wave blink_impact_3 fg-color" d="M241.9 144.3c-1.2 1.6-1.5 3.8-.3 5 1.3 1.5 3.8 1.2 5-.7 2.4-2.6 4.5-5.4 6.4-8.4l-5.4-3.4c-1.7 2.6-3.6 5.1-5.7 7.5z"/><path class="wave blink_impact_3 fg-color" d="M246.6 56.5c-1.6-1.5-3.8-1.8-5-.6-1.3 1.3-.9 3.2.3 4.4 16.2 18.3 20 43.8 11.4 65.5l5.5 3.5c9.9-24 5.9-52.6-12.2-72.8z"/><path class="line fg-color" d="m269.4 139.7-11.9-7.6-5.4-3.5-13.4-8.5-5.4-3.4-14.1-9-5.8-3.7-24.2-15.4-13.2-8.4-42-26.7c-1.2-1-3.1-.7-4 .9-1 1.2-.7 3.1.9 4l40.3 25.9 17.9 11.5 23.2 14.9 5.4 3.4 13.4 8.6 5.2 3.4 12.9 8.3 5.4 3.5 11.7 7.5c.4.3 1 .6 1.6.6 1 0 1.8-1 2.5-1.8.9-1.7.6-3.6-1-4.5z"/></g></svg>',(t.length>18||n.length>18)&&Yf(i,"panda-muted-indicator-impact-wrapper-big-text"),r='<span class="panda-muted-indicator-impact-wrapper-canvas"></span>'+r,t&&(r='<span class="text top">'+t+"</span>"+r),n&&(r=r+'<span class="text bottom">'+n+"</span>"),i.innerHTML=r,Yf(i,"panda-muted-indicator-impact-wrapper"),Yf(i,"panda-muted-indicator-item"),Yf(i,"animate"),Yf(i,player_configs.mutedIndicatorSize);var s=player_configs.controls.filter((function(e){return"play-large"!==e}));ph&&gh&&s.length&&player.on("controlsshown",(function(){qh||Pp()})),i.onclick=function(){Pp()};var a=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');a&&Yf(a,"disabled");var o=function(e){return 100*e/(1e3*d)+"%"},l=function(e,t){return"IMPACT_"+e+"{0%{opacity:0;transform:scale(4);}"+o(850*t/1e3)+"{opacity:1;}"+o(t)+",100%{opacity:1;transform:scale(1);}}"},c=window.player_configs.mutedIndicatorLoop,d=window.player_configs.mutedIndicatorLoopDuration,u=document.createElement("style"),h="        @keyframes BLINK_IMPACT{0%,100%{opacity:0;}33%,66%{opacity:1;}}        @keyframes HIGHLIGHT{0%,100%{filter:url(#panda-muted-indicator-impact-wrapper-highlight);}}        @keyframes OPACITY_0{0%,100%{opacity:0;}}        @keyframes OPACITY_1{0%,100%{opacity:1;}}        @keyframes SVG_WRAPPER{0%{width:100%;max-width:100%;}100%{width:var(--size-width);max-width:400px;}}        @keyframes IMPACT{0%{opacity:0;transform:scale(3);}85%{opacity:1;}100%{transform:scale(1);}}        @keyframes IMPACT_CENTER{0%{opacity:0;transform:translate(-50%, -50%) scale(3);}85%{opacity:1;}100%{transform:translate(-50%, -50%) scale(1);}}        button.panda-muted-indicator-impact-wrapper.animate svg.impact {            animation: SVG_WRAPPER 750ms cubic-bezier(.76,.05,.86,.06), OPACITY_0 10s linear infinite 850ms;        }        button.panda-muted-indicator-impact-wrapper.animate .text.bottom {            animation: IMPACT 262ms cubic-bezier(.76,.05,.86,.06);        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.fg-color {            animation: HIGHLIGHT 262ms cubic-bezier(.76,.05,.86,.06), IMPACT 262ms cubic-bezier(.76,.05,.86,.06) 131ms;        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.bg-color {            animation: IMPACT 314ms cubic-bezier(.76,.05,.86,.06) 236ms;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .wave {            animation: IMPACT 314ms cubic-bezier(.76,.05,.86,.06) 340ms;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .volume {            animation: IMPACT 288ms cubic-bezier(.76,.05,.86,.06) 471ms, OPACITY_0 471ms cubic-bezier(.76,.05,.86,.06) 0s;        }        button.panda-muted-indicator-impact-wrapper.animate .panda-muted-indicator-impact-wrapper-canvas {            animation: IMPACT_CENTER 471ms cubic-bezier(.76,.05,.86,.06) 602ms, OPACITY_0 602ms cubic-bezier(.76,.05,.86,.06) 0s;        }        button.panda-muted-indicator-impact-wrapper.animate .text.top {            animation: IMPACT 250ms linear 550ms, OPACITY_0 550ms cubic-bezier(.76,.05,.86,.06) 0s;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .line,        button.panda-muted-indicator-impact-wrapper.animate svg.blink .volume {            animation: OPACITY_0 850ms linear 0s;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_1 {            animation: BLINK_IMPACT 2s infinite 950ms, OPACITY_0 850ms linear 0s;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_2 {            animation: BLINK_IMPACT 2s infinite 1250ms, OPACITY_0 850ms linear 0s;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_3 {            animation: BLINK_IMPACT 2s infinite 1550ms, OPACITY_0 850ms linear 0s;            opacity: 0;        }    ";c&&(h="            @keyframes BLINK_IMPACT{0%,100%{opacity:0;}33%,66%{opacity:1;}}            @keyframes HIGHLIGHT{0%{filter:url(#panda-muted-indicator-impact-wrapper-highlight);}"+o(315)+",100%{filter:initial;}}            @keyframes OPACITY_0{"+o(850)+","+o(9150)+"{opacity:0;}}            @keyframes OPACITY_1{"+o(850)+","+o(9150)+"{opacity:1;}}            @keyframes SVG_WRAPPER{0%{width:100%;}"+o(470)+",100%{width:var(--size-width);}}            @keyframes "+l("P2",262)+"            @keyframes "+l("LINE_FG",262)+"            @keyframes "+l("LINE_BG",314)+"            @keyframes "+l("BLINK",314)+"            @keyframes "+l("VOLUME",288)+"            @keyframes IMPACT_CANVAS{0%{opacity:0;transform:translate(-50%,-50%) scale(4);}"+o(850*471/1e3)+"{opacity:1;}"+o(471)+",100%{opacity:1;transform:translate(-50%,-50%) scale(1);}}            @keyframes "+l("P1",250)+"                        button.panda-muted-indicator-impact-wrapper.animate svg.impact {                animation: SVG_WRAPPER "+d+"s cubic-bezier(.76, .05, .86, .06) infinite, OPACITY_0 "+d+"s linear infinite 850ms;            }            button.panda-muted-indicator-impact-wrapper.animate .text.bottom {                animation: IMPACT_P2 "+d+"s cubic-bezier(.76,.05,.86,.06) infinite;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.fg-color {                animation: HIGHLIGHT "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 131ms, IMPACT_LINE_FG "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 131ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.bg-color {                animation: IMPACT_LINE_BG "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 236ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .wave {                animation: IMPACT_BLINK "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 340ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .volume {                animation: IMPACT_VOLUME "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 471ms, OPACITY_0 "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 0s;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate .panda-muted-indicator-impact-wrapper-canvas {                animation: IMPACT_CANVAS "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 602ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate .text.top {                animation: IMPACT_P1 "+d+"s linear infinite 550ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .line,            button.panda-muted-indicator-impact-wrapper.animate svg.blink .volume {                animation: OPACITY_1 "+d+"s linear infinite 425ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_1 {                animation: BLINK_IMPACT 2s linear infinite 950ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_2 {                animation: BLINK_IMPACT 2s linear infinite 1250ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_3 {                animation: BLINK_IMPACT 2s linear infinite 1550ms;                opacity: 0;            }        "),u.innerHTML=h,document.getElementsByTagName("head")[0].appendChild(u),e.appendChild(i),qh=!1}function Np(){var e,t=window.player_configs.mutedIndicatorTextTop,n=window.player_configs.mutedIndicatorTextBottom;if(ph){if(0===document.getElementsByClassName("plyr--full-ui").length)return;e=document.getElementsByClassName("plyr--full-ui")[0]}else e=document.getElementById("video-container");var i=document.createElement("button"),r='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="7.999 9.062 46.75 32.563" enable-background="new 7.999 9.062 46.75 32.563" xml:space="preserve"> <style>@keyframes BLINK{0%{opacity: 0;}33%{opacity: 1;}66%{opacity: 1;}100%{opacity: 0;}}.blink_1{animation: BLINK 2s infinite; opacity: 0;}.blink_2{animation: BLINK 2s infinite .3s; opacity: 0;}.blink_3{animation: BLINK 2s infinite .6s; opacity: 0;}</style><style class="darkreader darkreader--sync" media="screen"></style> <g class="adjustable fg" style="fill: rgb(255, 255, 255); --darkreader-inline-fill:#ffffff;" data-darkreader-inline-fill=""> <path d="M53.249,39.616c-0.186,0-0.371-0.051-0.537-0.157l-43.5-27.75c-0.466-0.297-0.603-0.916-0.306-1.381c0.298-0.466,0.917-0.601,1.381-0.306l43.5,27.75c0.467,0.297,0.604,0.916,0.307,1.381C53.901,39.453,53.579,39.616,53.249,39.616z"></path> <path class="blink_3" d="M48.896,33.467l1.699,1.085c3.497-7.791,2.073-17.271-4.313-23.659c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414C50.581,18.019,51.913,26.463,48.896,33.467z"></path> <path class="blink_3" d="M46.926,36.956c-0.612,0.863-1.286,1.695-2.059,2.469c-0.392,0.391-0.392,1.023,0,1.414c0.194,0.195,0.45,0.293,0.707,0.293c0.256,0,0.512-0.098,0.706-0.293c0.878-0.878,1.642-1.824,2.333-2.807L46.926,36.956z"></path> <path class="blink_2" d="M42.543,29.415l1.777,1.135c1.545-5.315,0.229-11.293-3.953-15.476c-0.392-0.391-1.023-0.391-1.414,0c-0.392,0.391-0.392,1.023,0,1.414C42.454,19.987,43.639,24.925,42.543,29.415z"></path> <path class="blink_2" d="M41,33.174c-0.563,0.94-1.235,1.837-2.047,2.646c-0.391,0.392-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293s0.512-0.098,0.707-0.293c0.916-0.914,1.676-1.924,2.317-2.984L41,33.174z"></path> <path class="blink_1" d="M35.771,25.094l2.003,1.277c0.012-0.203,0.029-0.404,0.029-0.609c0-3.079-1.2-5.974-3.381-8.153c-0.391-0.391-1.022-0.391-1.414,0c-0.391,0.391-0.391,1.023,0,1.414C34.652,20.666,35.613,22.802,35.771,25.094z"></path> <path class="blink_1" d="M35.084,29.401c-0.474,1.145-1.172,2.197-2.076,3.1c-0.391,0.391-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293c0.257,0,0.513-0.098,0.707-0.293c1.008-1.006,1.795-2.17,2.361-3.43L35.084,29.401z"></path> <polygon points="28.124,20.215 28.124,14.991 24.635,17.99 "></polygon> <path d="M20.921,20.366h-6.423c-0.553,0-1,0.508-1,1.135v8.229c0,0.627,0.447,1.135,1,1.135h7.375l6.25,5.875V24.96L20.921,20.366z"></path> </g> </svg>';(t.length>18||n.length>18)&&Yf(i,"panda-muted-indicator-big-text"),r=t?"<span>"+t+"</span>"+r:"<span> </span>"+r,n?r=r+"<span>"+n+"</span>":r+="<span> </span>",i.innerHTML=r,Yf(i,"panda-muted-indicator"),Yf(i,"panda-muted-indicator-item"),Yf(i,player_configs.mutedIndicatorSize);var s=player_configs.controls.filter((function(e){return"play-large"!==e}));ph&&gh&&s.length&&player.on("controlsshown",(function(){qh||Pp()})),i.onclick=function(){Pp()};var a=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');a&&Yf(a,"disabled"),e.appendChild(i),qh=!1}function Fp(){var e,t=document.getElementById("custom_muted_indicator_iframe");if(t&&t.remove(),player_configs.customMutedIndicatorData.deleted&&(player_configs.mutedIndicatorAnimation="default",Bp()),ph){if(0===document.getElementsByClassName("plyr--full-ui").length)return;e=document.getElementsByClassName("plyr--full-ui")[0]}else e=document.getElementById("video-container");var n=document.createElement("iframe");n.id="custom_muted_indicator_iframe",Yf(n,"panda-muted-indicator-custom"),Yf(n,"panda-muted-indicator-item"),n.onload=function(){Cp(n.contentWindow.document.body);var e=document.getElementById("custom_muted_indicator_iframe"),t=/<script>(.|\n)*?<\/script>/gm;if(player_configs.customMutedIndicatorData.script){var i=player_configs.customMutedIndicatorData.script.match(t),r=player_configs.customMutedIndicatorData.script.replace(t,"");if(i&&i.length){var s=i[0].replace("<script>","").replace("<\/script>",""),a=document.createElement("script");a.type="text/javascript",a.innerHTML=s,e.contentWindow.document.body.innerHTML="".concat(r),e.contentWindow.document.body.appendChild(a)}else e.contentWindow.document.body.innerHTML="".concat(r);var o=document.createElement("script");o.type="text/javascript",o.innerHTML="document.getElementsByTagName('body')[0].onclick = function(){\n            window.parent.postMessage({\n                type: 'muted_indicator_play',\n            }, '*')\n        }",e.contentWindow.document.body.appendChild(o),e.contentWindow.document.body.style="padding:0;margin:0;overflow:hidden;"}};var i=player_configs.controls.filter((function(e){return"play-large"!==e}));ph&&gh&&i.length&&player.on("controlsshown",(function(){qh||Pp()})),n.onclick=function(){Pp()};var r=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');r&&Yf(r,"disabled"),e.appendChild(n),qh=!1}function Bp(){if(!_h){var e,t=document.querySelector(".plyr--video");if(t&&t.classList.add("plyr--force-hide-controls"),""!==player_configs.mutedIndicatorBackgroundColor)Uh.style.setProperty("--muted-indicator-background",player_configs.mutedIndicatorBackgroundColor);else{var n=(e=player_configs.primaryColor.replace("#","").replace("%23","").substring(0,6).match(/.{1,2}/g),[parseInt(e[0],16),parseInt(e[1],16),parseInt(e[2],16)]);n.push(player_configs.mutedIndicatorOpacity),Uh.style.setProperty("--muted-indicator-background","rgba(".concat(n.join(","),")"))}""!==player_configs.mutedIndicatorTextColor?Uh.style.setProperty("--muted-indicator-text",player_configs.mutedIndicatorTextColor):Uh.style.setProperty("--muted-indicator-text",player_configs.controlsColor),Uh.style.setProperty("--muted-indicator-border-size",player_configs.mutedIndicatorBorderSize+"px"),{default:Np,impact:Op,custom:Fp}[window.player_configs.mutedIndicatorAnimation](),player_configs.mutedIndicatorFontSize&&function(){var e,t=document.querySelectorAll("button.panda-muted-indicator-item span");if(t.length){var n=(e=player_configs.mutedIndicatorFontSize)<=21?"small-text":e>=22&&e<=27?"normal-text":e>=28?"large-text":void 0,i={"small-text":[4,4],"normal-text":[6,4],"large-text":[6,8]},r="\n    button.panda-muted-indicator-item span.".concat(n," {\n        font-size: ").concat(player_configs.mutedIndicatorFontSize,"px;\n    }");player_configs.mutedIndicatorFontSize>18&&(r+="\n        @media(max-width: 680px) {\n            button.panda-muted-indicator-item span.".concat(n," {\n                font-size: ").concat(player_configs.mutedIndicatorFontSize-i[n][0],"px;\n            }\n        }\n        @media(max-width: 380px) {\n            button.panda-muted-indicator-item span.").concat(n," {\n                font-size: ").concat(player_configs.mutedIndicatorFontSize-i[n][0]-i[n][1],"px;\n            }\n        }\n        "));var s=document.createElement("style");s.innerText=r,document.head.appendChild(s),t.forEach((function(e){e.classList.add(n)}))}}()}}function Up(){var e=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');if(e){Fh&&Yf(e,"disabled"),_h&&(Yf(e,"disabled"),e.style.visibility="hidden"),e.style.width="".concat(player_configs.bigPlayButtonSize,"px"),e.style.height="".concat(player_configs.bigPlayButtonSize,"px"),e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center";var t=e.querySelector("svg");t&&(t.style.width="".concat(player_configs.bigPlayButtonIconSize,"px"),t.style.height="".concat(player_configs.bigPlayButtonIconSize,"px"),t.style.display="flex",player_configs.bigPlayButtonIconSize>50&&(t.style.paddingLeft="3px"),t.style.alignItems="center")}}function $p(){var e;th?(e=!1,fetch(Mu+"/sharelock?j="+th,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(t){t&&t.status?(Xu=t.video_external_id,e=!0):(Xu="cd676325-3f2d-4ad5-b95c-c2a683d7b0cc",Qu="vz-ded14ebd-85a")})).catch((function(e){Xu="cd676325-3f2d-4ad5-b95c-c2a683d7b0cc",Qu="vz-ded14ebd-85a"})).finally((function(){document.querySelector("video > source").src="https://b-".concat(Qu).concat($u,"/").concat(Xu,"/playlist.m3u8").concat(e?"?sharelock="+th+"version"+Date.now():""),window.pandatag("videoHtmlLoaded",!0),uf()}))):nh?fetch("".concat(Nu,"/").concat(Qu,"/comparison/").concat(nh,".json"),{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){if("COMPLETED"===e.status)Xu=e.winner_video_id;else{var t=e.videos,n=Math.floor(window.crypto.getRandomValues(new Uint32Array(1))[0]/(Math.pow(2,32)-1)*t.length);Xu=t[n]}})).catch((function(e){Xu="cd676325-3f2d-4ad5-b95c-c2a683d7b0cc",Qu="vz-ded14ebd-85a"})).finally((function(){document.querySelector("video > source").src="https://b-"+Qu+$u+"/"+Xu+"/playlist.m3u8",window.pandatag("videoHtmlLoaded",!0),uf()})):uf();var t=Nu+"/"+Qu+"/config.json";"true"===uh&&(t+="?date="+(new Date).getTime()),fetch(t,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){var t=e;Object.keys(player_configs).forEach((function(e){if(Object.keys(t).includes(e)){if("controls"===e){var n=t.controls.findIndex((function(e){return"volume"===e}));-1!==n&&t.controls.splice(n,0,"mute")}"fbPixel"===e&&"string"==typeof t.fbPixel&&(t.fbPixel=t.fbPixel?[t.fbPixel]:[]),player_configs[e]=t[e]}}))})).finally((function(){Gp(["applyColors","setupControls"]),pandatag("configLibraryLoaded",!0),ph||hf()}))}function Gp(e){var t={applyColors:function(){pandatag("applyColors",(function(){Pu.searchParams.get("color")&&("#"===Pu.searchParams.get("color").charAt(0)?player_configs.primaryColor=Pu.searchParams.get("color"):player_configs.primaryColor="#"+Pu.searchParams.get("color")),Uh.style.setProperty("--plyr-color-main",player_configs.primaryColor),Uh.style.setProperty("--plyr-captions-text-color",player_configs.captionsColor),Uh.style.setProperty("--plyr-captions-background",player_configs.captionsBackgroundColor),Uh.style.setProperty("--plyr-video-control-color",player_configs.controlsColor),Uh.style.setProperty("--plyr-video-control-color-hover",player_configs.controlsColor),Uh.style.setProperty("--plyr-menu-color",player_configs.menuColor),Uh.style.setProperty("--live-indicator-color",player_configs.liveColor)}))},setupControls:function(){pandatag("setupControls",(function(){if("online"===Mh){var e=["current-time","duration","captions","rewind","fast-forward"];Oh||e.push("progress"),Hh||e.push("settings");var t=player_configs.controls.filter((function(t){return!e.includes(t)}));player_configs.controls=t}if(player_configs.alternativeProgress){var n=["progress"];player_configs.controls=player_configs.controls.filter((function(e){return!n.includes(e)}))}dp.controls=player_configs.controls}))},setupThumb:function(){pandatag("setupThumb",(function(){var e=sp,t=document.querySelector("video"),n=Pu.searchParams.get("thumbnail");if(!Fh)return n?(t.setAttribute("poster",n),void Pf(n)):void(e.thumb&&""!==e.thumb?(uh?e.thumb.includes("".concat($u,"/"))?t.setAttribute("poster",e.thumb+"?date="+(new Date).getTime()):t.setAttribute("poster",Fu+"/"+Qu+"/"+e.thumb+"?date="+(new Date).getTime()):e.thumb.includes("".concat($u,"/"))?t.setAttribute("poster",e.thumb):t.setAttribute("poster",Fu+"/"+Qu+"/"+e.thumb),Pf(Fu+"/"+Qu+"/"+e.thumb)):(t.setAttribute("poster","https://b-"+Qu+$u+"/"+Xu+"/thumbnail.jpg"),Pf("https://b-"+Qu+$u+"/"+Xu+"/thumbnail.jpg"),setTimeout((function(){var e=document.querySelector(".plyr__poster");e&&Yf(e,"thumbnail-blur")}),0)))}))},applySettingsUnloadedPlayer:function(){pandatag("applySettingsUnloadedPlayer",(function(){player_configs.controls.includes("play-large")&&Up(),pandaLoad.applyColors(),player_configs.mutedIndicatorIcon?Bp():player_configs.muted&&player_configs.smallMutedIcon&&Mp();var e=null;try{e=document.querySelector(".panda-muted-indicator-item")}catch(e){}e&&(e.onclick=function(){document.querySelector("#video-container").remove(),window.pandaLoad.initPlayerLoading()})}))},initPlayerLoading:function(){pandatag("initPlayerLoading",(function(){delete window.pandaLoad,window.pandaLoad={},Gh=!1,_h=!0,ph=!0,yp(),Rp(),$p()}))}};e.forEach((function(e){t[e]()}))}function Hp(){var e=Bu+"/"+Qu+"/"+Xu+"-live.json?nocache="+Date.now();fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){if(Gu.status=e.chat_status,Gu.id=e.chat_id,eh=Gu.id,Mh=e.status,Oh=!!e.active_dvr,Dh=e.title,Yf(document.getElementsByClassName("loading-icon")[0],"disabled"),e.thumb){var t=document.getElementsByClassName("live-thumb")[0];t.getElementsByTagName("img")[0].src=Fu+"/"+Qu+"/"+e.thumb,Kf(t,"disabled")}else{var n=document.getElementsByClassName("live-offline-badge")[0],i=document.getElementById("live-subtitle");i&&(i.innerHTML=Xh[Kh].waitingForLive),document.getElementById("live-title").innerHTML=e.title,Kf(n,"disabled")}"online"===e.status?function t(){var n="https://b-"+Qu+$u+"/"+Xu+"/custom_referrer="+pp+"/playlist.m3u8.live?nocache="+(new Date).getTime()+(ch?"&live_without_cdn=1":"");fetch(n,{method:"GET"}).then((function(t){if(!t.ok)throw new Error("Not 2xx response");window.player_configs.muted=!0,window.player_configs.autoplay=!0,window.player_configs.saveProgress=!1;var n=document.getElementsByClassName("live-thumb")[0];n&&Yf(n,"disabled");var i=document.getElementsByClassName("live-offline-badge")[0];if(i&&Yf(i,"disabled"),e.bitrate)try{Nh=e.bitrate.map((function(e){return parseInt(e.replace("p",""))})),Hh=!0}catch(e){Nh=[],Hh=!1,console.log("Error on parsing live BitRates",e)}$p()})).catch((function(e){try{dc(new Error("live_debug_exception_1"),{tags:{m3u8:n,is_live:!0,video_id:Xu,library_id:Qu}})}catch(e){}setTimeout(t,2e3)}))}():"finished"===e.status||"finished_imported"===e.status?(Yf(document.getElementsByClassName("live-thumb")[0],"disabled"),Yf(document.getElementsByClassName("live-offline-badge")[0],"disabled"),$p()):setTimeout(Hp,5e3)})).catch((function(e){try{dc(new Error("live_debug_exception_2"),{tags:{config:m3u8Url,is_live:!0,video_id:Xu,library_id:Qu}})}catch(e){}setTimeout(Hp,5e3)}))}function qp(e){var t=[];t=e?document.getElementById(e)?[document.getElementById(e)]:document.getElementsByClassName(e):document.getElementsByClassName("cta-element");for(var n=0;n<t.length;n++)t[n]&&t[n].parentNode&&t[n].parentNode.removeChild(t[n])}function zp(){var e=document.getElementsByClassName("plyr--html5")[0];qp("pause-cta");var t,n=Su(player_configs.ctas.filter((function(e){return"pause"===e.type})));try{var i=function(){var n=t.value,i=document.createElement("div");Yf(i,"pause-cta"),Yf(i,"cta-overlay"),Yf(i,"disabled"),Yf(i,"cta-element"),i.style="z-index: 5;",i.id=n.id;var r=document.createElement("iframe");if(r.id="".concat(n.id,"_iframe"),r.onload=function(){Cp(r.contentWindow.document.body);var e=document.getElementById("".concat(n.id,"_iframe")),t=/<script>(.|\n)*?<\/script>/gm,i=n.script.match(t),s=n.script.replace(t,"");if(i&&i.length){var a=i[0].replace("<script>","").replace("<\/script>",""),o=document.createElement("script");o.type="text/javascript",o.innerHTML=a,e.contentWindow.document.body.innerHTML="".concat(s),e.contentWindow.document.body.appendChild(o)}else e.contentWindow.document.body.innerHTML="".concat(s);e.contentWindow.document.body.style="padding:0;margin:0"},i.appendChild(r),n.skipButton){var s=document.createElement("button");s.style="z-index: 6;",s.innerHTML=Xh[Kh].keepWatching,Yf(s,"cta-skip-button"),s.onclick=function(){window.postMessage({type:"play"},"*")},i.appendChild(s)}var a=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');a&&(a.style.zIndex=10),Yf(i,"disabled"),e.appendChild(i)};for(n.s();!(t=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}}function jp(){var e=document.getElementsByClassName("plyr--html5")[0];qp("end-cta");var t=player_configs.ctas.find((function(e){return"end"===e.type}));if(t){var n=document.createElement("div");n.id="end-cta",Yf(n,"cta-overlay"),Yf(n,"disabled"),Yf(n,"cta-element"),t.maxZIndex?n.style.zIndex=99999:n.style="z-index: 5;";var i=document.createElement("iframe");i.id="".concat(t.id,"_iframe"),i.onload=function(){Cp(i.contentWindow.document.body);var e=document.getElementById("".concat(t.id,"_iframe")),n=/<script>(.|\n)*?<\/script>/gm,r=t.script.match(n),s=t.script.replace(n,"");if(r&&r.length){var a=r[0].replace("<script>","").replace("<\/script>",""),o=document.createElement("script");o.type="text/javascript",o.innerText=a,e.contentWindow.document.body.innerHTML="".concat(s),e.contentWindow.document.body.appendChild(o)}else e.contentWindow.document.body.innerHTML="".concat(s);e.contentWindow.document.body.style="padding:0;margin:0"},n.appendChild(i);var r=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');r&&(r.style.zIndex=10),Yf(n,"disabled"),e.appendChild(n),window.onEnd=function(){Kf(n,"disabled")}}}function Vp(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),i=Math.floor(e-3600*t-60*n);return t<10&&(t="0"+t),n<10&&(n="0"+n),i<10&&(i="0"+i),"00"==t?n+":"+i:t+":"+n+":"+i}function Yp(){var e=document.getElementById("bookmarks-container");e&&e.parentNode.removeChild(e);var t='<svg style="width:24px;height:24px" fill="white" viewBox="0 0 24 24"><path fill="white" d="M7,5H21V7H7V5M7,13V11H21V13H7M4,4.5A1.5,1.5 0 0,1 5.5,6A1.5,1.5 0 0,1 4,7.5A1.5,1.5 0 0,1 2.5,6A1.5,1.5 0 0,1 4,4.5M4,10.5A1.5,1.5 0 0,1 5.5,12A1.5,1.5 0 0,1 4,13.5A1.5,1.5 0 0,1 2.5,12A1.5,1.5 0 0,1 4,10.5M7,19V17H21V19H7M4,16.5A1.5,1.5 0 0,1 5.5,18A1.5,1.5 0 0,1 4,19.5A1.5,1.5 0 0,1 2.5,18A1.5,1.5 0 0,1 4,16.5Z" /></svg>',n=document.createElement("div");n.id="bookmarks-container",Yf(n,"panda-bookmarks-div");var i=document.createElement("div");Yf(i,"panda-bookmarks-list-wrapper"),Yf(i,"disabled"),i.innerHTML='<div class="panda-bookmarks-list-title">'.concat(Xh[Kh].chapters,"</div>");var r=document.createElement("ul");Yf(r,"panda-bookmarks-list"),player_configs.bookMarks.sort((function(e,t){return e.time-t.time})).forEach((function(e,t){var n=document.createElement("li"),i=document.createElement("span"),s="index"===window.player_configs.bookmarksLabel?t+1:Vp(e.time);i.innerHTML="<strong>"+s+"</strong> "+e.title,n.appendChild(i),n.onclick=function(){window.postMessage({type:"currentTime",parameter:e.time},"*"),window.postMessage({type:"play"},"*")},r.appendChild(n)}));var s=document.createElement("button");s.setAttribute("class","panda-bookmarks-button"),t=t.replace(/white/gm,"var(--plyr-video-control-color)"),s.innerHTML=t,i.appendChild(r),n.appendChild(s);var a=document.querySelector(".plyr__menu button");a&&(a.onclick=function(e){Yf(i,"disabled"),Kf(s,"active-bookmark"),$h=!1}),s.onclick=function(){($h=!$h)?(Kf(i,"disabled"),Yf(s,"active-bookmark")):(Yf(i,"disabled"),Kf(s,"active-bookmark"))},document.addEventListener("click",(function(e){s.contains(e.target)||(Yf(i,"disabled"),Kf(s,"active-bookmark"),$h=!1)})),n.appendChild(i);var o=player_configs.bookMarks.sort((function(e,t){return e.time-t.time})),l=o.map((function(e,t){var n=o[t+1];return{start:e.time,title:e.title,end:n?n.time:2147483647}}));window.pb.ev_config.chapters=l,window.pb.reloadChapters(),Ip(n,1)}function Kp(e){var t=e.split(":");if(t.length<2)return null;var n=parseInt(t[0],10),i=parseInt(t[1],10),r=parseFloat(t[2]);return 2==t.length&&(n=0,i=parseInt(t[0],10),r=parseFloat(t[1])),3600*n+60*i+r}function Wp(){try{var e=document.getElementById("content-ai-dialog");e&&e.remove()}catch(e){}}function Xp(){Wp();try{var e=function(e){var n=r[e];document.getElementById("question-enunciate").textContent=n.enunciate;var i=document.getElementById("answer-options");i.innerHTML="",n.options.forEach((function(n,r){var a=document.createElement("li");if(a.textContent=n.text,null!==s[e]){var o=s[e];a.classList.add("answered"),r===o.userSelected?a.style.border=o.isCorrect?"2px solid green":"2px solid red":r===o.correctOption?a.style.border="2px solid green":(a.style.opacity="0.6",a.style.pointerEvents="none"),a.style.cursor="default"}else a.addEventListener("click",(function(){return t(r)}));i.appendChild(a)})),document.getElementById("questions-indicator").textContent="".concat(e+1,"/").concat(r.length)},t=function(t){var n=r[i].options.findIndex((function(e){return e.correct})),a=r[i].options[t].correct;!function(e,t,n){var i=r[e].options.findIndex((function(e){return e.correct}));s[e]={userSelected:t,correctOption:i,isCorrect:n}}(i,t,a),e(i),window.parent.postMessage({message:"panda_ai_quiz",video:Xu,question_index:i+1,total_questions:r.length,user_selected_answer:t+1,correct_answer:n+1,is_correct:a},"*")},n=document.createElement("div");n.id="content-ai-dialog",n.innerHTML='<div id="modal-ai">\n            <header>\n                <p class="title-ai-text">'.concat(Xh[Kh].questions,'</p>\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <p id="question-enunciate"></p>\n                <ul id="answer-options"></ul>\n            </div>\n            <div id="questions-footer">\n                <button id="questions-prev-button"><</button>\n                <span id="questions-indicator"></span>\n                <button id="questions-next-button">></button>\n            </div>\n        </div>'),document.getElementsByClassName("plyr")[0].insertAdjacentElement("afterbegin",n),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Wp()}));var i=0,r=player_configs.ai.questions_data,s=new Array(r.length).fill(null),a=document.getElementById("questions-prev-button"),o=document.getElementById("questions-next-button");a.addEventListener("click",(function(){i>0&&(i--,e(i))})),o.addEventListener("click",(function(){i<r.length-1&&(i++,e(i))})),e(i)}catch(e){console.log(e,"err")}}function Zp(){Wp();var e,t,n,i=(e=player_configs.ai.mindmap_data,t="mindmap ".concat(e.theme,"\n"),n=0,function e(i,r){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a="N".concat(n++),o=i.text?i.text:"Node ".concat(a);if(o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return e.replace(new RegExp("(.{1,".concat(t,"})(\\s+|$)"),"g"),"$1\n")}(o),s||(t+="".concat(r).concat(a,'("').concat(o,'")\n')),i.children){var l=r+"    ";i.children.forEach((function(n){t+="".concat(r,"    ").concat(a," --\x3e "),e(n,l)}))}}(e,"",!0),t);try{var r=document.createElement("div"),s='<div id="abstract-footer">\n            <div></div>\n            <button id="mindmap-download-button">'.concat(Xh[Kh].download_button,"</button>\n        </div>");r.id="content-ai-dialog",r.innerHTML='<div id="modal-ai">\n            <header>\n                <p class="title-ai-text">'.concat(Xh[Kh].mindmap,'</p>\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <pre id="mindmap-container" class="mermaid"></pre>\n            </div>\n            ').concat(player_configs.ai.pdf_generated?s:"","\n        </div>"),document.getElementsByClassName("plyr")[0].insertAdjacentElement("afterbegin",r);var a=document.getElementById("mindmap-container");a.textContent=i,window.mermaid.run({querySelector:"#mindmap-container"}),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Wp()}));var o=Panzoom(a,{maxScale:5});o.pan(0,0),a.parentElement.addEventListener("wheel",o.zoomWithWheel),player_configs.ai.pdf_generated&&document.getElementById("mindmap-download-button").addEventListener("click",(function(){var e="".concat(Nu,"/").concat(Qu,"/").concat(Xu,"/mindmap.pdf");fetch(e).then((function(e){return e.blob()})).then((function(e){var t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="mindmap.pdf",document.body.appendChild(n),n.click(),n.remove()})).catch((function(e){console.error("Error while trying to download ebook pdf: ",e)}))})),setTimeout((function(){document.querySelectorAll(".mermaid .mindmap-node").forEach((function(e,t){e.setAttribute("data-nodeid","N".concat(t)),e.addEventListener("click",(function(){var e=function(e,t){var n=null;function i(e){var t=1;if(e.children&&e.children.length>0){var n,r=Su(e.children);try{for(r.s();!(n=r.n()).done;)t+=i(n.value)}catch(e){r.e(e)}finally{r.f()}}return t}return function t(r,s){if("N".concat(s)===e)return n=r.time,!0;if(r.children&&r.children.length>0){var a,o=s+1,l=Su(r.children);try{for(l.s();!(a=l.n()).done;){var c=a.value;if(t(c,o))return!0;o+=i(c)}}catch(e){l.e(e)}finally{l.f()}}return!1}(t,0),n}(this.getAttribute("data-nodeid"),player_configs.ai.mindmap_data);window.postMessage({type:"currentTime",parameter:Kp(e)},"*"),window.postMessage({type:"play"},"*"),Wp()}))}))}),1e3)}catch(e){console.log("err",e)}}function Jp(){Wp();try{var e=player_configs.ai.abstract_data,t=document.createElement("div");t.id="content-ai-dialog",t.innerHTML='<div id="modal-ai">\n            <header>\n                <p class="title-ai-text">'.concat(Xh[Kh].abstract,'</p>\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <div id="abstract-content">\n                    ').concat((n=e,n.replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/^\- (.+)$/gm,"<li>$1</li>").split(/\n/).join("").replace(/<\/li><li>/g,"</li>\n<li>").replace(/<li>(.+?)<\/li>/g,"<ul><li>$1</li></ul>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a target=_blank href="$2">$1</a>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>")),'\n                </div>\n            </div>\n            <div id="abstract-footer">\n                <button id="abstract-copy-button">').concat(Xh[Kh].copy_button,'</button>\n                <button id="abstract-download-button">').concat(Xh[Kh].download_button,"</button>\n            </div>\n        </div>"),document.getElementsByClassName("plyr")[0].insertAdjacentElement("afterbegin",t),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Wp()})),document.getElementById("abstract-copy-button").addEventListener("click",(function(){navigator.clipboard.writeText(e)})),document.getElementById("abstract-download-button").addEventListener("click",(function(){if(player_configs.ai.pdf_generated){var t="".concat(Nu,"/").concat(Qu,"/").concat(Xu,"/abstract.pdf");fetch(t).then((function(e){return e.blob()})).then((function(e){var t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="abstract.pdf",document.body.appendChild(n),n.click(),n.remove()})).catch((function(e){console.error("Error while trying to download ebook pdf: ",e)}))}else!function(e){var t=new jspdf.jsPDF,n=10,i=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.setFontSize(i),t.splitTextToSize(e,180).forEach((function(e){n>280&&(t.addPage(),n=10),r?t.text(" ".concat(e),10,n):t.text(e,10,n),n+=i+2}))};e.split("\n").forEach((function(e){e.startsWith("# ")?i(e.substring(2),22):e.startsWith("## ")?i(e.substring(3),18):e.startsWith("### ")?i(e.substring(4),14):e.startsWith("- ")?i(e.substring(2),12,!0):i(e,12)})),t.save("".concat(Xu,"_ebook.pdf"))}(e)}))}catch(e){console.log(e,"err")}var n}function Qp(e){var t,n=[],i="",r="",s=Su(e.split("\n"));try{for(s.s();!(t=s.n()).done;){var a=t.value,o=(a=a.replace(/\r/g,"").trim()).match(/^\d+$/),l=a.match(/^((\d{2}:)?\d{2}:\d{2}\.\d{3}) --> ((\d{2}:)?\d{2}:\d{2}\.\d{3})$/);!o&&l?(""!==i&&(n.push({text:i,time:r}),i="",r=""),r=l[1]):o||""===a||a.toUpperCase().match(/WEBVTT|X-TIMESTAMP/)||(i+=a+" ")}}catch(e){s.e(e)}finally{s.f()}return""!==i&&n.push({text:i.trim(),time:r}),n}function ef(){return ef=Tu(wu().mark((function e(){var t,n,i;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=player_configs.subtitles.map((function(e){var t="".concat(Ou,"/").concat(Qu,"/").concat(Xu,"/").concat(e.srclang,".vtt");return fetch(t).then((function(t){if(!t.ok)throw new Error("Error downloading subtitles for ".concat(e.srclang));return t.text()})).then((function(e){return Qp(e)}))})),n=[],e.next=4,Promise.all(t);case 4:(i=e.sent)&&i.length&&i.forEach((function(e){return n=[].concat(bu(n),bu(e))})),n&&n.length&&(player_configs.subtitles_search=n);case 7:case"end":return e.stop()}}),e)}))),ef.apply(this,arguments)}function tf(){var e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path fill="white" d="M 21 3 C 11.601563 3 4 10.601563 4 20 C 4 29.398438 11.601563 37 21 37 C 24.355469 37 27.460938 36.015625 30.09375 34.34375 L 42.375 46.625 L 46.625 42.375 L 34.5 30.28125 C 36.679688 27.421875 38 23.878906 38 20 C 38 10.601563 30.398438 3 21 3 Z M 21 7 C 28.199219 7 34 12.800781 34 20 C 34 27.199219 28.199219 33 21 33 C 13.800781 33 8 27.199219 8 20 C 8 12.800781 13.800781 7 21 7 Z"></path></svg>',n=document.createElement("button");n.setAttribute("class","panda-smart-search plyr__control plyr__controls__item"),n.setAttribute("type","button"),n.onclick=function(e){(function(){Wp(),function(){ef.apply(this,arguments)}();try{var e,t=document.createElement("div");t.id="content-ai-dialog",t.innerHTML='<div id="modal-ai" class="smart-search">\n            <header>\n                <input id="input-smart-search" placeholder="'.concat(Xh[Kh].smart_search_placeholder,'" />\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <div id="search-content">\n                    <ul>\n                    </ul>\n                </div>\n            </div>\n        </div>'),document.getElementsByClassName("plyr")[0].insertAdjacentElement("afterbegin",t),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Wp()})),document.getElementById("input-smart-search").addEventListener("input",(function(t){clearTimeout(e);var i=t.target.value.trim();(i.length>=2||!i.length)&&(e=setTimeout((function(){n(i)}),300))}));var n=function(e){var t=player_configs.subtitles_search;if(t&&(!t||t.length)){var n=new Fuse(t,{includeScore:!0,minMatchCharLength:2,threshold:.3,limit:20,keys:[{name:"text",getFn:function(e){return e.text?e.text.replace(/[^a-zA-Z0-9]/g,"").toLowerCase():""}}]}),i=document.querySelector("#search-content > ul"),r="",s=e?n.search(e):[];s&&s.length&&s.forEach((function(e){var t=e.item;r+="<li class=item-smart-search data-time=".concat(t.time,">\n                        <p>").concat(t.text,"</p>\n                        <span>").concat(Vp(Kp(t.time)),"</span>\n                    </li>")})),i.innerHTML=r,window.parent.postMessage({message:"panda_smart_search",video:Xu,query:e},"*")}};document.querySelector("#search-content").addEventListener("click",(function(e){if(e.target.classList.contains("item-smart-search")||e.target.closest(".item-smart-search")){var t=e.target.closest(".item-smart-search").getAttribute("data-time");window.postMessage({type:"currentTime",parameter:Kp(t)},"*"),window.postMessage({type:"play"},"*"),Wp()}}))}catch(e){console.log(e,"err")}})(),e.stopPropagation()},t=t.replace(/white/gm,"var(--plyr-video-control-color)"),n.innerHTML="\n        ".concat(t,"\n    "),Ip(n,1),(e=document.createElement("script")).src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0",document.head.appendChild(e)}function nf(e){if(function(e){var t=Object.keys(e).every((function(e){return e.endsWith("_data")}));if(t)return player_configs.ai.questions=!0,player_configs.ai.mindmap=!0,player_configs.ai.abstract=!0,!0;var n=Object.keys(e).filter((function(e){return"pdf_generated"!==e&&!e.endsWith("_data")})),i=n.every((function(t){return!1===e[t]}));return!i}(e)){var t,n='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="white" d="M176 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64c-35.3 0-64 28.7-64 64H24c-13.3 0-24 10.7-24 24s10.7 24 24 24H64v56H24c-13.3 0-24 10.7-24 24s10.7 24 24 24H64v56H24c-13.3 0-24 10.7-24 24s10.7 24 24 24H64c0 35.3 28.7 64 64 64v40c0 13.3 10.7 24 24 24s24-10.7 24-24V448h56v40c0 13.3 10.7 24 24 24s24-10.7 24-24V448h56v40c0 13.3 10.7 24 24 24s24-10.7 24-24V448c35.3 0 64-28.7 64-64h40c13.3 0 24-10.7 24-24s-10.7-24-24-24H448V280h40c13.3 0 24-10.7 24-24s-10.7-24-24-24H448V176h40c13.3 0 24-10.7 24-24s-10.7-24-24-24H448c0-35.3-28.7-64-64-64V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H280V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H176V24zm32 152c6.4 0 12.1 3.8 14.7 9.6l42 96 14 32c3.5 8.1-.1 17.5-8.2 21.1s-17.5-.2-21.1-8.2L239.5 304H176.5l-9.8 22.4c-3.5 8.1-13 11.8-21.1 8.2s-11.8-13-8.2-21.1l14-32 42-96c2.5-5.8 8.3-9.6 14.7-9.6zm17.5 96L208 231.9 190.5 272h35.1zM336 176c8.8 0 16 7.2 16 16V320c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16z"/></svg>',i=document.createElement("button");i.setAttribute("class","panda-ai-link plyr__control plyr__controls__item"),i.setAttribute("type","button"),i.onclick=function(e){df("context-menu-ai");var t=document.getElementById("context-menu-ai"),n=document.getElementsByClassName("plyr__controls")[0];n.classList.contains("plyr-controls-fix-index")?n.classList.remove("plyr-controls-fix-index"):n.classList.add("plyr-controls-fix-index"),t.classList.contains("active")?t.classList.remove("active"):t.classList.add("active"),e.stopPropagation()},n=n.replace(/white/gm,"var(--plyr-video-control-color)"),i.innerHTML="\n        ".concat(n,'\n        <div id="context-menu-ai" class="plyr__menu__container"><div><div role="menu">\n            ').concat(Object.keys(e).filter((function(e){return"pdf_generated"!==e})).map((function(t){if(e[t]&&!t.match(/_data/))return'<button type="button" data-ai="'.concat(t,'" class="plyr__control ai_button plyr__control--forward"><span>').concat(Xh[Kh][t],"</span></button>")})).join(""),"\n        </div></div></div>\n    "),Ip(i,1),(r=document.querySelectorAll(".plyr__control.ai_button"))&&r.forEach((function(e){e.addEventListener("click",lf)})),document.addEventListener("click",(function(e){document.getElementById("context-menu-ai").classList.remove("active")})),(t=document.createElement("script")).src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js",t.onload=function(){window.mermaid.initialize({startOnLoad:!1})},document.head.appendChild(t),function(){var e=document.createElement("script");e.src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js",document.head.appendChild(e)}(),function(){var e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",document.head.appendChild(e)}()}var r}function rf(e){window.open(e,"_blank")}function sf(){document.querySelector("#video-container").getBoundingClientRect().height,document.querySelector(".live-chat-container").style.height="100%"}function af(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=document.querySelector(".panda-live-chat.plyr__control.plyr__controls__item");t&&t.classList[e]("new-message-badge")}function of(){return(of=Tu(wu().mark((function e(){var t,n,i,r,s;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,n=Nu+"/"+Qu+"/"+Xu+".json?date="+Date.now(),e.next=4,fetch(n,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){e.assistant_id&&(t=!0)})).catch((function(){}));case 4:if(i=new URLSearchParams(document.location.search).get("insideIframe"),t&&!i){e.next=7;break}return e.abrupt("return");case 7:r=(r='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <g clip-path="url(#clip0_7339_26691)">\n      <path fill-rule="evenodd" clip-rule="evenodd" d="M3 2.5C2.86739 2.5 2.74021 2.55268 2.64645 2.64645C2.55268 2.74021 2.5 2.86739 2.5 3V8.45266C2.96831 8.00702 3.51683 7.58339 4.10608 7.33086C4.23056 7.27751 4.36457 7.25 4.5 7.25H9C9.13261 7.25 9.25978 7.19732 9.35355 7.10355C9.44732 7.00978 9.5 6.88261 9.5 6.75V3C9.5 2.86739 9.44732 2.74022 9.35355 2.64645C9.25978 2.55268 9.13261 2.5 9 2.5H3ZM2.34621 11.7829C2.10887 12.1598 1.65084 12.3343 1.22284 12.2108C0.794757 12.0873 0.5 11.6955 0.5 11.25V3C0.5 2.33696 0.763392 1.70107 1.23223 1.23223C1.70107 0.763392 2.33696 0.5 3 0.5H9C9.66304 0.5 10.2989 0.763392 10.7678 1.23223C11.2366 1.70107 11.5 2.33696 11.5 3V6.75C11.5 7.41304 11.2366 8.04893 10.7678 8.51777C10.2989 8.98661 9.66304 9.25 9 9.25H4.72833C4.23771 9.51726 3.6862 10.0508 3.19565 10.6367C2.93789 10.9446 2.72265 11.2353 2.572 11.4491C2.49698 11.5555 2.43876 11.6418 2.40011 11.7001C2.3808 11.7293 2.36643 11.7514 2.35735 11.7655L2.34775 11.7804L2.34621 11.7829Z" fill="white"/>\n      <path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 6.75C12.5 6.19772 12.9477 5.75 13.5 5.75H15C15.663 5.75 16.2989 6.01339 16.7678 6.48223C17.2366 6.95107 17.5 7.58696 17.5 8.25V16.5C17.5 16.9045 17.2564 17.2691 16.8827 17.4239C16.509 17.5787 16.0789 17.4931 15.7929 17.2071L13.0858 14.5H9C8.33696 14.5 7.70107 14.2366 7.23223 13.7678C6.76339 13.2989 6.5 12.663 6.5 12V11.25C6.5 10.6977 6.94771 10.25 7.5 10.25C8.05228 10.25 8.5 10.6977 8.5 11.25V12C8.5 12.1326 8.55268 12.2598 8.64645 12.3536C8.74021 12.4473 8.86739 12.5 9 12.5H13.5C13.7652 12.5 14.0196 12.6054 14.2071 12.7929L15.5 14.0858V8.25C15.5 8.11739 15.4473 7.99022 15.3536 7.89645C15.2598 7.80268 15.1326 7.75 15 7.75H13.5C12.9477 7.75 12.5 7.30228 12.5 6.75Z" fill="white"/>\n      <path d="M5 3.86055C5 3.62095 5.26704 3.47803 5.46641 3.61094L7.10058 4.70038C7.2787 4.81913 7.2787 5.08087 7.10058 5.19962L5.46641 6.28906C5.26704 6.42197 5 6.27905 5 6.03944V3.86055Z" fill="white"/>\n      </g>\n      <defs>\n      <clipPath id="clip0_7339_26691">\n      <rect width="18" height="18" fill="white"/>\n      </clipPath>\n      </defs>\n      </svg>').replace(/white/gm,"var(--plyr-video-control-color)"),(s=document.createElement("button")).setAttribute("class","panda-live-chat plyr__control plyr__controls__item"),s.setAttribute("type","button"),s.addEventListener("click",(function(){event.stopPropagation();var e=document.querySelector(".chat-overlay-container"),t=document.querySelector(".assist-chat-container"),n=document.getElementsByClassName("plyr")[0];if(t)t.classList.contains("disabled")?(e&&(e.style.display="block"),t.classList.remove("disabled"),t.style.display="flex"):(t.style.display="none",e&&(e.style.display="none"),t.classList.add("disabled"));else{var i=document.createElement("div");i.classList.add("chat-overlay-container"),i.style.position="fixed",i.style.width="100%",i.style.height="100%",i.style.zIndex="10",i.addEventListener("click",(function(){var e;event.stopPropagation();var n=r.querySelector("iframe");if(n&&(null==t||null===(e=t.classList)||void 0===e||!e.contains("disabled"))){var s=(n.contentDocument||n.contentWindow.document).querySelector(".btn__header--close");s&&(s.click(),i.style.display="none")}})),n.insertAdjacentElement("beforeend",i);var r=document.createElement("div");r.classList.add("assist-chat-container"),r.innerHTML='<div style="position:relative;width:100%;height:100%"><iframe src="./assist_chat.html?v='.concat(Xu,"&l=").concat(Qu,'" style="border:none;position:absolute;top:0;left:0;" width="100%" height="100%" fetchpriority="high"></iframe></<div>'),n.style.flexDirection="row",n.insertAdjacentElement("beforeend",r)}})),s.innerHTML=r,Ip(s,1),window.addEventListener("message",(function(e){var t=e.data;if("panda_newLiveChatMessage"===t||"panda_closeLiveChat"===t){var n=document.querySelector(".assist-chat-container");"panda_newLiveChatMessage"===t?n.classList.contains("disabled")&&af("add"):"panda_closeLiveChat"===t&&(n.style.height="0px",n.classList.add("disabled"))}}));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lf(e){var t=e.currentTarget.getAttribute("data-ai"),n={mindmap:Zp,questions:Xp,abstract:Jp};n[t]&&n[t]()}function cf(e){e||document.write("Unauthorized"),fetch(Uu+"/"+Qu+"/"+e+"-drm.json?nocache="+Date.now(),{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(t){var n;pandaLoad.setupThumb();var i=Xh[Kh].watermark_question;t&&null!==(n=t.config_player)&&void 0!==n&&n.watermark_question&&(i=t.config_player.watermark_question);var r=document.querySelector("video");Yf(r,"blur");var s=document.getElementsByClassName("loading-icon")[0];Yf(s,"disabled");var a=null,o=document.querySelector("video");if(o&&0!==o.offsetHeight){var l=o.offsetHeight/2-15;a='style="top: '.concat(l,'px !important"')}var c="<form class=container-drm ".concat(a||"",">")+"<h2 id=drm-question "+(player_configs.controlsColor?'style="color: '+player_configs.controlsColor+'"':"")+">"+i.replace(/<\/?[^>]+(>|$)/g,"")+"</h2><input id=drm-answer /><button id=drm-button "+(player_configs.primaryColor?'style="background-color: '+player_configs.primaryColor+'"':"")+'><div class="drm-search-icon"><svg viewBox="-112 0 512 512" '+(player_configs.controlsColor?'fill="'+player_configs.controlsColor+'"':"")+' ><path d="M64 352L160 256 64 160 96 128 224 256 96 384 64 352Z" /></svg></div><div class="drm-loading-icon disabled"><svg x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve"><path '+(player_configs.controlsColor?'fill="'+player_configs.controlsColor+'"':"")+' d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50"><animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="360 50 50" repeatCount="indefinite" /></path></svg></div></button></form>';!function(e,t){var n=document.createElement("div");for(n.innerHTML=t;n.children.length>0;)e.appendChild(n.children[0])}(document.getElementById("video-container"),c);var d,u=document.querySelector("form");function h(t){var n=document.getElementById("drm-answer"),i=document.getElementsByClassName("drm-search-icon")[0],a=document.getElementsByClassName("drm-loading-icon")[0];t.preventDefault(),Kf(a,"disabled"),Yf(i,"disabled"),fetch(Mu+"/drm/token/?jwt=1&key="+n.value.trim()+"&drm_group_id="+e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(t){wh=t.jwt,Kf(a,"disabled"),u.remove(),Kf(s,"disabled"),Kf(r,"blur");try{localStorage.setItem(e,n.value.trim())}catch(e){}var i=document.querySelector("video > source"),o="https://b-".concat(Qu).concat($u,"/").concat(Xu,"/playlist.m3u8?watermark=").concat(wh);i.src=o,window.pandatag("videoHtmlLoaded",!0),uf()})).catch((function(t){Yf(a,"disabled"),Kf(i,"disabled"),n.focus();try{localStorage.removeItem(e)}catch(e){}}))}u.onsubmit=h.bind(u);try{d=localStorage.getItem(e)}catch(e){}d&&(document.getElementById("drm-answer").value=d,h({preventDefault:function(){}})),setTimeout((function(){document.getElementById("drm-answer").focus()}),500)}))}function df(e){var t=document.querySelector(".panda-bookmarks-list-wrapper");t&&!t.classList.contains("disabled")&&"bookmarks"!==e&&document.querySelector(".panda-bookmarks-button").click();var n=document.querySelector("#context-menu-ai");n&&n.classList.contains("active")&&"context-menu-ai"!==e&&document.querySelector(".panda-ai-link").click();var i=document.querySelector('.plyr__control[data-plyr="settings"][aria-expanded="true"]');i&&"settings"!==e&&i.click();var r=document.querySelector("#context-menu");r&&!r.classList.contains("disabled")&&"context-menu"!==e&&r.classList.add("disabled")}function uf(){var e;Ef(),e=Nu+"/"+Qu+"/"+Xu+".json","true"===uh&&(e+="?date="+(new Date).getTime()),fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){var t,n;sp=e,e.video_offline_enabled&&(player_configs.video_offline_enabled=e.video_offline_enabled),(e.ai||0===Object.keys(e).length)&&(0!==Object.keys(e).length&&(player_configs.ai=e.ai),ph&&function(){var e=Nu+"/"+Qu+"/"+Xu+"-ai.json";"true"===uh&&(e+="?date="+(new Date).getTime()),fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){0===Object.keys(player_configs.ai).length&&(player_configs.ai={}),player_configs.ai.mindmap_data=(e||{}).mindmap||!1,e.questions&&(player_configs.ai.questions_data=e.questions),e.abstract&&(player_configs.ai.abstract_data=e.abstract),document.querySelector(".panda-ai-link")||nf(player_configs.ai)}))}(e.profile)),e.subtitles&&(player_configs.subtitles=e.subtitles),e.bookMarks&&(player_configs.bookMarks=e.bookMarks),e.videoRedirect&&(player_configs.videoRedirect=e.videoRedirect),e.ctas&&(player_configs.ctas=e.ctas),e.profile?(window.player_configs.profile=e.profile,t=e.profile,n=Nu+"/"+Qu+"/profiles/"+t+".json","true"===uh&&(n+="?date="+(new Date).getTime()),fetch(n,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];if("controls"===i){if(!e[i])continue;var r=e.controls.findIndex((function(e){return"volume"===e}));-1!==r&&e.controls.splice(r,0,"mute");var s=e.controls.findIndex((function(e){return"current-time"===e}));-1!==s&&e.controls.splice(s+1,0,"duration"),player_configs[i]=e[i]}else"vsl"===i||"colors"===i||"saveProgress"===i||"general"===i?null!=e[i]&&null!=e[i]&&("vsl"===i&&delete e[i].pandaBranding,""==e[i].fbPixel&&delete e[i].fbPixel,""==e[i].gtagIds&&delete e[i].gtagIds,Object.hasOwnProperty.call(e[i],"trialWarning")&&delete e[i].trialWarning,window.player_configs=vu(vu({},window.player_configs),e[i])):"hideControlsOnStart"===i&&(window.player_configs.hideControlsOnStart=e[i]);if(window.player_configs.autoplay){var a=document.querySelector("video");a&&(a.autoplay=!0)}window.player_configs.mutedIndicatorIcon&&(player_configs.muted=!0),e.general&&e.general.default_speed&&(window.player_configs.defaultSpeed=e.general.default_speed)}})).catch((function(e){console.log("Error: falied to fetch video profile",e)})).finally((function(){pandatag("configProfileLoaded",!0),function(e){if(!e)return pandatag("configMutedIndicatorLoaded",!0),void(ph||hf());var t=Nu+"/"+Qu+"/tmi/"+e+".json";"true"===uh&&(t+="?date="+(new Date).getTime()),fetch(t,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){player_configs.customMutedIndicatorData=e})).catch((function(e){console.log("Error: falied to fetch video muted indicator")})).finally((function(){pandatag("configMutedIndicatorLoaded",!0),ph||hf()}))}(player_configs.customMutedIndicatorId)}))):(pandatag("configMutedIndicatorLoaded",!0),pandatag("configProfileLoaded",!0)),Gp(["setupThumb"]),e.defaultSubtitle&&(player_configs.defaultSubtitle=e.defaultSubtitle),e.customPixels&&(player_configs.customPixels=e.customPixels)})).catch((function(){pandatag("configProfileLoaded",!0),pandatag("configMutedIndicatorLoaded",!0),pandatag("setupThumb",(function(){if("online"!==Mh){var e=document.querySelector("video"),t=Pu.searchParams.get("thumbnail");if(t)return e.setAttribute("data-poster",t),void Pf(t);e.setAttribute("data-poster","https://b-"+Qu+$u+"/"+Xu+"/thumbnail.jpg"),Pf("https://b-"+Qu+$u+"/"+Xu+"/thumbnail.jpg")}setTimeout((function(){var e=document.querySelector(".plyr__poster");e&&Yf(e,"thumbnail-blur")}),0)}))})).finally((function(){if(pandatag("configVideoLoaded",!0),!ph){var e=sp?JSON.parse(JSON.stringify(sp)):{},t={LIBRARY_ID:Qu,EMBED_DOMAIN:$u,VIDEO_ID:Xu,THUMBS_URL:Fu,REFRESH_CONFIG:uh};Object.assign(e,t);var n=Ru.setThumbnailUrl(e);window.thumbUrl=n,hf()}})),ph&&Gf()}function hf(){Gp(["applyColors","applySettingsUnloadedPlayer","initPlayerLoading"]);var e=window.pandaLoad,t=e.configLibraryLoaded,n=e.configVideoLoaded,i=e.configMutedIndicatorLoaded,r=e.configProfileLoaded;t&&n&&i&&r&&(Ru.createUnloadedPlayerContainer(window.thumbUrl),Pf(window.thumbUrl),Ru.wireUpEvents())}function pf(){return ff.apply(this,arguments)}function ff(){return(ff=Tu(wu().mark((function e(){var t;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=cast.framework.CastContext.getInstance().getCurrentSession()){e.next=5;break}return e.next=4,cast.framework.CastContext.getInstance().requestSession();case 4:t=cast.framework.CastContext.getInstance().getCurrentSession();case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mf(){return gf.apply(this,arguments)}function gf(){return(gf=Tu(wu().mark((function e(){var t,n,i,r,s,a;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pf();case 3:return t=e.sent,n=document.querySelector("video"),i=n.getElementsByTagName("source")[0].src,Wu&&i.includes("token=")&&(r=i.split("token=")[1].split("&")[0],i=i.replace(r,Mf())),window.player.pause(),(s=new chrome.cast.media.MediaInfo(i)).contentType="application/x-mpegurl",a=new chrome.cast.media.LoadRequest(s),e.next=13,t.loadMedia(a);case 13:vf(window.player.currentTime),yf(),e.next=19;break;case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}function yf(){var e=new cast.framework.RemotePlayer,t=new cast.framework.RemotePlayerController(e);t.addEventListener(cast.framework.RemotePlayerEventType.ANY_CHANGE,(function(e){"PLAYING"==e.value&&window.player.play(),"PAUSED"==e.value&&window.player.pause(),"currentTime"==e.field&&Math.abs(e.value-window.player.currentTime)>=5&&(window.player.currentTime=e.value),"isConnected"!=e.field||e.value||bf()})),window.player.on("play",(function(){e.isPaused&&t.playOrPause()})),window.player.on("pause",(function(){!1===e.isPaused&&t.playOrPause()})),window.player.on("seeked",(function(){var t=window.player.currentTime;Math.abs(t-e.currentTime)>=5&&vf(t)}))}function vf(e){var t=new cast.framework.RemotePlayer,n=new cast.framework.RemotePlayerController(t);t.currentTime=e,n.seek()}function bf(){var e=cast.framework.CastContext.getInstance().getCurrentSession();e&&e.endSession(!0);var t=document.getElementsByClassName("chromecast-btn");t&&(t[0].innerHTML='<svg viewBox="100 -900 800 800"><path d="M481-480Zm340 320H601q0-15-1-30t-3-30h224v-520H141v60q-15-2-30-3t-30-1v-56q0-24.75 17.625-42.375T141-800h680q24.75 0 42.375 17.625T881-740v520q0 24.75-17.625 42.375T821-160Zm-740 0v-104q41.667 0 70.833 30.333Q181-203.333 181-160H81Zm200 0q0-84.66-58-144.33Q165-364 81-364v-60q108.643 0 184.321 77.5Q341-269 341-160h-60Zm160 0q0-75-28-141.5t-77-116q-49-49.5-114.5-78T81-524v-60q87 0 163.5 33.5t133.5 91q57 57.5 90 135T501-160h-60Z" fill="'.concat(player_configs.controlsColor,'" /></svg>')),ip=!1,Wu&&window.location.reload()}function _f(){if(player_configs.fbPixel&&player_configs.fbPixel.length){try{player_configs.fbPixel,"undefined"==typeof fbq&&function(e,t,n,i,r,s,a){e.fbq||(r=e.fbq=function(){r.callMethod?r.callMethod.apply(r,arguments):r.queue.push(arguments)},e._fbq||(e._fbq=r),r.push=r,r.loaded=!0,r.version="2.0",r.queue=[],(s=t.createElement(n)).async=!0,s.src="https://connect.facebook.net/en_US/fbevents.js",(a=t.getElementsByTagName(n)[0]).parentNode.insertBefore(s,a))}(window,document,"script")}catch(e){console.log("Error in fbp init",e)}var e,t=Su(player_configs.fbPixel);try{for(t.s();!(e=t.n()).done;){var n=e.value;try{n&&(fbq("init","".concat(n)),fbq("track","PageView"))}catch(e){}}}catch(e){t.e(e)}finally{t.f()}}if(player_configs.gtagIds&&player_configs.gtagIds.length)try{!function(){if(!document.getElementById("gtag-script")){var e=document.createElement("script");e.id="gtag-script",e.src="https://www.googletagmanager.com/gtag/js?id="+player_configs.gtagIds[0],e.async=!0,document.head.appendChild(e)}window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date);var t,n=Su(player_configs.gtagIds);try{for(n.s();!(t=n.n()).done;){var i=t.value;gtag("config",i)}}catch(e){n.e(e)}finally{n.f()}gtag("event","page_view",{video_id:Xu,library_id:"b-"+Qu})}()}catch(e){console.log("Error in gtag init",e)}var i,r=player_configs.customPixels.filter((function(e){return"view"===e.conditionType})),s=Su(r);try{for(s.s();!(i=s.n()).done;){var a=i.value,o=new Function(a.script);try{o()}catch(e){}}}catch(e){s.e(e)}finally{s.f()}}function wf(){var e;function t(){return(t=Tu(wu().mark((function e(){var t,i,r,s;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ch){e.next=2;break}return e.abrupt("return");case 2:if(t=[],player_configs.videoRedirect&&t.push(player_configs.videoRedirect),player_configs.ctas&&player_configs.ctas.forEach((function(e){"video"===e.type&&e.metadata&&e.metadata.videoRedirectExternalIds&&t.push.apply(t,bu(e.metadata.videoRedirectExternalIds))})),t&&t.length&&t.flat(),!t.length){e.next=30;break}i=Su(t),e.prev=8,i.s();case 10:if((r=i.n()).done){e.next=22;break}if(!(s=r.value)){e.next=20;break}return e.prev=13,e.next=16,n(s);case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(13);case 20:e.next=10;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(8),i.e(e.t1);case 27:return e.prev=27,i.f(),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[8,24,27,30],[13,18]])})))).apply(this,arguments)}function n(e){return i.apply(this,arguments)}function i(){return(i=Tu(wu().mark((function e(t){var n,i,r,s,a,o,l,c,d,u,h,p,f,m;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Nu+"/"+Qu+"/"+t+".json",e.next=3,fetch(n);case 3:return e.next=5,e.sent.json();case 5:if(i=e.sent,!(r=i.profile)){e.next=16;break}return s=Nu+"/"+Qu+"/profiles/"+r+".json",e.prev=9,e.next=12,fetch(s);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(9);case 16:return a="https://b-".concat(Qu).concat($u,"/").concat(t,"/playlist.m3u8"),o=[],e.prev=18,e.next=21,fetch(a);case 21:return e.next=23,e.sent.text();case 23:if(l=e.sent){c=l.split("\n"),d=Su(c);try{for(d.s();!(u=d.n()).done;)(h=u.value).includes(".m3u8")&&o.push(h.split("/")[0])}catch(e){d.e(e)}finally{d.f()}}e.next=29;break;case 27:e.prev=27,e.t1=e.catch(18);case 29:return e.prev=29,e.next=32,fetch(a+"?get_qualities=1");case 32:e.next=36;break;case 34:e.prev=34,e.t2=e.catch(29);case 36:p=0,f=o;case 37:if(!(p<f.length)){e.next=56;break}return m=f[p],e.prev=39,e.next=42,fetch("https://b-".concat(Qu).concat($u,"/").concat(t,"/").concat(m,"/video.m3u8"));case 42:e.next=46;break;case 44:e.prev=44,e.t3=e.catch(39);case 46:return e.prev=46,e.next=49,fetch("https://".concat(Qu,".b-cdn.net/").concat(t,"/").concat(m,"/video0.ts"));case 49:e.next=53;break;case 51:e.prev=51,e.t4=e.catch(46);case 53:p++,e.next=37;break;case 56:case"end":return e.stop()}}),e,null,[[9,14],[18,27],[29,34],[39,44],[46,51]])})))).apply(this,arguments)}window.player_configs=(_u(_u(_u(_u(_u(_u(_u(_u(_u(_u(e={controls:["play-large","play","progress","current-time","duration","mute","volume","captions","settings","pip","airplay","fullscreen"],captionsBackgroundColor:"#000",primaryColor:"#4874F1",captionsColor:"#FFF",menuColor:"#4a5464",initDisabledControls:!1,controlsColor:"#FFF",pandaBranding:!Ju,refCode:"",fbPixel:[],customPixels:[],mutedIndicatorIcon:!1,mutedIndicatorTextTop:"",mutedIndicatorTextBottom:"",mutedIndicatorSize:"small",mutedIndicatorOpacity:.8,muted:!1,autoplay:!1,disablePause:!1,initQuality:0,alternativeProgress:!1,alternativeProgress2xLimit:20,alternativeProgressDefaultVelocity:!1,mutedIndicatorClickRestart:!0,alternativeProgressVelocity:5,alternativeProgressHeight:0,liveColor:"#fc2d2d",bookMarks:[]},"customPixels",[]),"bookmarksLabel","index"),"ctas",[]),"availableSpeeds",[.5,.75,1,1.25,1.5,2]),"defaultSpeed",1),"default_speed",1),"smartSearch",!1),"saveProgress",!0),"saveProgressScreen",!1),"saveProgressTitle","Voc j comeou a assistir esse vdeo"),_u(_u(_u(_u(_u(_u(_u(_u(_u(_u(e,"saveProgressBackgroundOpacity",1),"saveProgressButton1Title","Continuar assistindo"),"saveProgressButton2Title","Voltar ao incio"),"hideControlsOnStart",Fh),"defaultSubtitle",null),"startsWithSubtitle",!1),"restartAfterEnd",!1),"onlyLoopMuted",!1),"realtimeAnalytics",!1),"troubleshootDialog",!0),_u(_u(_u(_u(_u(_u(_u(_u(_u(_u(e,"disableForward",!1),"playOpensFullscreen",!1),"playOpensFullscreenNative",!1),"gtagIds",[]),"showPreviewThumbs",!0),"smartAutoplay",!1),"disableSeeking",!1),"mutedIndicatorAnimation","default"),"mutedIndicatorLoop",!1),"mutedIndicatorLoopDuration",5),_u(_u(_u(_u(_u(_u(_u(_u(_u(_u(e,"mutedIndicatorFontSize",22),"captionsFontSize",20),"smallMutedIcon",!0),"bigPlayButtonSize",100),"bigPlayButtonIconSize",57),"mutedIndicatorBackgroundColor",""),"mutedIndicatorTextColor",""),"mutedIndicatorBorderSize",2),"customMutedIndicatorData",""),"customMutedIndicatorId",""),_u(_u(_u(_u(_u(_u(_u(e,"pauseThumbnail",""),"endThumbnail",""),"defaultLanguage",""),"trialWarning",!1),"iosFakeFullscreen",!1),"ai",!1),"videoRedirect",null)),window.pandatag=function(e,n){if(window.pandaLoad[e]=n,pandaLoad=window.pandaLoad,pandaLoad.videoHtmlLoaded&&pandaLoad.configLibraryLoaded&&pandaLoad.configVideoLoaded&&pandaLoad.configProfileLoaded&&pandaLoad.configMutedIndicatorLoaded&&pandaLoad.playerLoaded&&!Gh){Ef(),window.player_configs.controls.includes("cast")&&"online"!==Mh&&(a=10,o=setInterval((function(){try{chrome.cast.isAvailable&&!yh&&(clearInterval(o),cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED}),function(){var e='<svg viewBox="100 -900 800 800"><path d="M481-480Zm340 320H601q0-15-1-30t-3-30h224v-520H141v60q-15-2-30-3t-30-1v-56q0-24.75 17.625-42.375T141-800h680q24.75 0 42.375 17.625T881-740v520q0 24.75-17.625 42.375T821-160Zm-740 0v-104q41.667 0 70.833 30.333Q181-203.333 181-160H81Zm200 0q0-84.66-58-144.33Q165-364 81-364v-60q108.643 0 184.321 77.5Q341-269 341-160h-60Zm160 0q0-75-28-141.5t-77-116q-49-49.5-114.5-78T81-524v-60q87 0 163.5 33.5t133.5 91q57 57.5 90 135T501-160h-60Z" fill="'.concat(player_configs.controlsColor,'" /></svg>'),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("class","plyr__controls__item plyr__control chromecast-btn"),e=e.replace(/white/gm,"var(--plyr-video-control-color)"),t.innerHTML=e,Ip(t,1),t.onclick=Tu(wu().mark((function e(){return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ip){e.next=4;break}bf(),e.next=6;break;case 4:return e.next=6,mf();case 6:case"end":return e.stop()}}),e)})));var n=new cast.framework.RemotePlayer;new cast.framework.RemotePlayerController(n).addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,(function(e){if(e.value){ip=!0;var t=document.getElementsByClassName("chromecast-btn");t&&(t[0].innerHTML='<svg viewBox="100 -900 800 800"><path d="M741-300H582q-5-16-10-32.5T562-360h119v-240H364q-29-19-60.874-33.909Q271.252-648.818 237-660h504v360ZM480-480ZM81-160v-104q41.667 0 70.833 30.333Q181-203.333 181-160H81Zm200 0q0-84.66-58-144.33Q165-364 81-364v-60q108.643 0 184.321 77.5Q341-269 341-160h-60Zm160 0q0-75-28-141.5t-77-116q-49-49.5-114.5-78T81-524v-60q87 0 163.5 33.5t133.5 91q57 57.5 90 135T501-160h-60Zm380 0H601q0-15-1-30t-3-30h224v-520H141v60q-15-2-30-3t-30-1v-56q0-24.75 17.625-42.375T141-800h680q24.75 0 42.375 17.625T881-740v520q0 24.75-17.625 42.375T821-160Z" fill="'.concat(player_configs.controlsColor,'" /></svg>')),yf()}}))}())}catch(e){}a||clearInterval(o),a--}),1e3));var i=null;try{i=localStorage.getItem("panda_video:"+Xu)}catch(e){}player_configs.mutedIndicatorClickRestart&&player_configs.saveProgress&&!player_configs.saveProgressScreen&&i&&(player_configs.mutedIndicatorClickRestart=!1),pandaLoad.applyColors(),pandaLoad.setupControls(),_h||pandaLoad.setupThumb(),window.player_configs.defaultLanguage&&(Kh=window.player_configs.defaultLanguage,dp.i18n=Xh[Kh]);var r=player_configs.defaultSpeed;dp.speed={selected:player_configs.defaultSpeed,options:player_configs.availableSpeeds.map((function(e){return parseFloat(e)})),turbo:r},player_configs.autoplay&&(player_configs.muted=!0,dp.muted=!0,dp.autoplay=!0),player_configs.disableForward&&(dp.keyboard.global=!1,dp.keyboard.focused=!1),pandaLoad.setupPlayer(dp),hh?!ch&&ah&&(_f(),navigator.sendBeacon(jh+"/icon.gif?type=view&v="+Xu+"&u="+mp+"&p="+Qu+"&referrer="+encodeURIComponent(pp)+"&visibily="+!document[Lu])):document.addEventListener(Au,(function(){hh||rh||Rf(),vh||ch||!ah||(_f(),navigator.sendBeacon(jh+"/icon.gif?type=view&v="+Xu+"&u="+mp+"&p="+Qu+"&referrer="+encodeURIComponent(pp)+"&visibily="+!document[Lu]),vh=!0)}),!1),Cp(document),function(){if(player_configs.controls.includes("rewind")){var e=document.querySelectorAll('[data-plyr="rewind"]')[0];e&&(e.innerHTML='\n              <svg style="width:24px;height:24px" viewBox="0 0 50 50">\n                  <path fill="currentColor" d="M 7.984375 1.9863281 A 1.0001 1.0001 0 0 0 7 3 L 7 13 L 17 13 A 1.0001 1.0001 0 1 0 17 11 L 10.761719 11 C 14.363419 7.3233218 19.405802 5.0234375 25 5.0234375 C 36.109434 5.0234375 45 13.914004 45 25.023438 C 45 36.13287 36.109434 45.023438 25 45.023438 C 13.890566 45.023438 5 36.13287 5 25.023438 A 1.0001 1.0001 0 1 0 3 25.023438 C 3 37.204003 12.819434 47.023438 25 47.023438 C 37.180566 47.023438 47 37.204003 47 25.023438 C 47 12.842871 37.180566 3.0234375 25 3.0234375 C 18.685898 3.0234375 12.985264 5.693158 9 9.9414062 L 9 3 A 1.0001 1.0001 0 0 0 7.984375 1.9863281 z M 29.5 17 C 24.5 17 24.300781 21.7 24.300781 25 C 24.300781 27.5 24.1 33 29.5 33 C 34.4 33 34.699219 28.2 34.699219 25 C 34.699219 21.7 34.4 17 29.5 17 z M 19.5 17.099609 C 19.1 19.499609 17.4 19.999609 15 20.099609 L 15 21.599609 L 19.099609 21.599609 L 19.099609 32.900391 L 21 32.900391 L 21 17.099609 L 19.5 17.099609 z M 29.5 18.800781 C 33.4 18.800781 32.800781 24.699609 32.800781 25.099609 C 32.800781 28.399609 32.2 31.400391 29.5 31.400391 C 25.8 31.400391 26.199219 25.599609 26.199219 25.099609 C 26.199219 24.799609 25.6 18.800781 29.5 18.800781 z"/>\n              </svg>')}if(player_configs.controls.includes("fast-forward")){var t=document.querySelectorAll('[data-plyr="fast-forward"]')[0];t&&(t.innerHTML='<svg style="width:24px;height:24px" viewBox="0 0 50 50">\n              <path fill="currentColor" d="M 41.984375 1.9863281 A 1.0001 1.0001 0 0 0 41 3 L 41 9.9414062 C 37.014556 5.692295 31.313104 3.0234375 25 3.0234375 C 12.819434 3.0234375 3 12.842871 3 25.023438 C 3 37.204003 12.819434 47.023438 25 47.023438 C 37.180566 47.023438 47 37.204003 47 25.023438 A 1.0001 1.0001 0 1 0 45 25.023438 C 45 36.13287 36.109434 45.023438 25 45.023438 C 13.890566 45.023438 5 36.13287 5 25.023438 C 5 13.914003 13.890566 5.0234375 25 5.0234375 C 30.593333 5.0234375 35.63652 7.322796 39.238281 11 L 33 11 A 1.0001 1.0001 0 1 0 33 13 L 43 13 L 43 3 A 1.0001 1.0001 0 0 0 41.984375 1.9863281 z M 29.5 17 C 24.5 17 24.300781 21.7 24.300781 25 C 24.300781 27.5 24.1 33 29.5 33 C 34.4 33 34.699219 28.2 34.699219 25 C 34.699219 21.7 34.4 17 29.5 17 z M 19.5 17.099609 C 19.1 19.499609 17.4 19.999609 15 20.099609 L 15 21.599609 L 19.099609 21.599609 L 19.099609 32.900391 L 21 32.900391 L 21 17.099609 L 19.5 17.099609 z M 29.5 18.800781 C 33.4 18.800781 32.800781 24.699609 32.800781 25.099609 C 32.800781 28.399609 32.2 31.400391 29.5 31.400391 C 25.8 31.400391 26.199219 25.599609 26.199219 25.099609 C 26.199219 24.799609 25.6 18.800781 29.5 18.800781 z"/>\n          </svg>')}}(),function(){var e=document.querySelector(".plyr__menu__container > div");e&&(e.style="max-height: calc(100vh - 50px);");var t=document.querySelector("video");window.innerWidth<400&&(t.onclick=function(){window.postMessage({type:"play_toggle"},"*")})}(),function(){if(!player_configs.controls.includes("progress")){var e=document.querySelector(".plyr__controls");e&&Yf(e,"no-progress")}}(),!player_configs.disableForward&&Vh?function(){var e=document.querySelector(".plyr__video-wrapper"),t=document.createElement("div");t.classList.add("panda-forward-wrapper");var n=document.createElement("div");n.id="forward_touch";var i=function(e){"forward_touch"!==e.target.id&&"backward_touch"!==e.target.id||window.player.toggleControls(!0)};n.ondblclick=function(){window.player.forward()};var r=document.createElement("div");r.id="backward_touch",r.ondblclick=function(){window.player.rewind()},window.player_configs.controls.includes("play")?(n.onclick=i,r.onclick=i):(n.onclick=function(){window.player.togglePlay()},r.onclick=function(){window.player.togglePlay()}),t.appendChild(r),t.appendChild(n),e.appendChild(t)}():Vh&&(player_configs.controls.includes("play")||(document.querySelector("video").onclick=function(){window.player.togglePlay()})),(f=document.querySelector(".plyr__poster"))&&(f.onclick=function(){window.postMessage({type:"play",parameter:1},"*")}),player_configs.controls.includes("play-large")&&Up(),ph&&!player_configs.muted||!player_configs.mutedIndicatorIcon||player_configs.saveProgress?player_configs.initDisabledControls||!player_configs.muted||player_configs.mutedIndicatorIcon||player_configs.saveProgressScreen||!player_configs.smallMutedIcon||Mp():Bp();var s=player_configs.controls.filter((function(e){return"play"!==e&&"play-large"!==e}));dh&&(u=dh,h=document.createElement("div"),(p=document.createElement("p")).innerText=u,h.setAttribute("class","panda-title-wrapper"),h.appendChild(p),Ip(h)),(!s||s&&!s.length)&&(document.querySelector(".plyr__controls").style.background="none"),player_configs.alternativeProgress?function(){var e=document.createElement("div");e.id="wrapper-progress",Yf(e,"alternative-progress-wrapper");var t=document.createElement("div");Yf(t,"alternative-progress"),e.appendChild(t);var n=document.querySelector(".plyr__controls");n&&(n.style="padding-bottom: "+(player_configs.alternativeProgressHeight+5)+"px");var i=document.getElementsByClassName("plyr--html5")[0];player_configs.mutedIndicatorIcon&&Yf(e,"disabled"),i.appendChild(e)}():player_configs.controls.includes("progress")&&function(){var e=null,t=document.querySelector(".plyr__progress__container input"),n=document.querySelector(".plyr__progress__container progress"),i=document.querySelector(".plyr__progress");t&&t.style&&(t.style.top="-5px"),n.style.top="4px",n.style.opacity="0.01";var r=document.createElement("div");r.className="plyr__pb",i.insertBefore(r,i.firstChild);var s=new x(".plyr__pb",".plyr__progress__container input",{keyColor:"#ff7755",videoLength:105,chapters:[],moments:[],onScrubbingChange:function(e,t){var n=document.querySelector(".plyr__preview-thumb").offsetWidth,i=document.querySelector(".plyr__controls").offsetWidth,r=Math.max(n/2,t);r=Math.min(i-n+n/4,r),document.querySelector(".plyr__preview-thumb").style.left=r-5.5+"px"}});!function(t){!e&&t&&t.thumbnails&&(e=t.thumbnails.showImage,t.thumbnails.showImage=function(n,i,r,s,a){var o;n.width>0&&n.height>0&&(t.config.thumbnail.height=(o=n.width/n.height,Math.floor(thumbnail_width/o))),e.call(t.thumbnails,n,i,r,s,a)})}(window.player),window.player.on("loadedmetadata",(function(){s.SetDuration(window.player.duration)})),setInterval((function(){s.SetCurrentProgress(window.player.currentTime),s.SetBufferProgress(window.player.duration*window.player.buffered)}),16),window.pb=s}(),function(){if(window.player_configs.controls.includes("fast-forward")){var e=document.querySelector("button[data-plyr='fast-forward']");e&&(e.style.marginRight="auto")}else if(window.player_configs.controls.includes("play")){var t=document.querySelector("button[data-plyr='play']");t&&(t.style.marginRight="auto")}else if(window.player_configs.controls.includes("rewind")){var n=document.querySelector("button[data-plyr='rewind']");n&&(n.style.marginRight="auto")}if(player_configs.initDisabledControls){var i=document.querySelector('[data-plyr="play"].plyr__control--overlaid');i&&(i.style.display="none");var r=document.querySelector(".plyr__controls");r&&Yf(r,"disabled");var s=document.getElementById("wrapper-progress");s&&Yf(s,"disabled")}}(),function(){if(window.player_configs.iosFakeFullscreen&&gh){var e=document.querySelector('button[data-plyr="fullscreen"]'),t=!1;if(e){var n=e.cloneNode(!0);e.replaceWith(n),n.onclick=function(){if(t){window.parent.postMessage({message:"panda_close_window_fullscreen",video:Xu},"*");var e=n.querySelector("svg.icon--pressed"),i=n.querySelector("svg.icon--not-pressed");e.style.display="none",i.style.display="block",t=!1}else{window.parent.postMessage({message:"panda_open_window_fullscreen",video:Xu},"*");var r=n.querySelector("svg.icon--pressed"),s=n.querySelector("svg.icon--not-pressed");r.style.display="block",s.style.display="none",t=!0}}}}}(),window.addEventListener("keydown",(function(e){if(e.key){var t={" ":function(){window.player.togglePlay()},k:function(){window.player.togglePlay()},">":function(){var e=window.player_configs.availableSpeeds.sort((function(e,t){return e-t})),t=window.player.speed,n=e.find((function(e){return e>t}));n&&(window.player.speed=n)},"<":function(){var e=window.player_configs.availableSpeeds.sort((function(e,t){return e-t})),t=window.player.speed,n=e.reverse().find((function(e){return e<t}));n&&(window.player.speed=n)},ArrowUp:function(){window.player.volume<1&&window.player.increaseVolume()},ArrowDown:function(){window.player.volume>0&&window.player.decreaseVolume()},m:function(){window.player.toggleMute()},f:function(){window.player.fullscreen.toggle()}};t[e.key.toLowerCase()]&&t[e.key]()}})),player_configs.smartSearch&&player_configs.subtitles&&tf(),player_configs.ai&&Object.keys(player_configs.ai).length&&nf(player_configs.ai),player_configs.bookMarks&&player_configs.bookMarks.length>0&&Yp(),player_configs.ctas&&player_configs.ctas.length>0&&(zp(),jp()),!player_configs.pandaBranding||player_configs.alternativeProgress||player_configs.mutedIndicatorIcon||Ju||(function(){if(!new URLSearchParams(document.location.search).get("insideIframe")){var e='<svg width="100" height="20" viewBox="0 0 523 116" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.84 106.728V50.664C3.84 49.192 3.872 48.104 3.936 47.4C4.064 46.696 4.352 45.896 4.8 45C5.696 43.272 7.84 42.408 11.232 42.408C14.624 42.408 16.896 42.856 18.048 43.752C19.264 44.584 19.968 45.832 20.16 47.496C22.592 44.168 26.4 42.504 31.584 42.504C36.832 42.504 41.792 44.968 46.464 49.896C51.136 54.824 53.472 60.552 53.472 67.08C53.472 73.608 51.136 79.336 46.464 84.264C41.856 89.192 36.928 91.656 31.68 91.656C26.432 91.656 22.624 90.184 20.256 87.24V106.632C20.256 108.104 20.192 109.192 20.064 109.896C20 110.6 19.712 111.4 19.2 112.296C18.752 113.256 17.952 113.928 16.8 114.312C15.648 114.696 14.08 114.888 12.096 114.888C10.112 114.888 8.512 114.696 7.296 114.312C6.144 113.928 5.312 113.288 4.8 112.392C4.352 111.496 4.064 110.696 3.936 109.992C3.872 109.288 3.84 108.2 3.84 106.728ZM22.848 61.512C21.376 63.24 20.64 65.128 20.64 67.176C20.64 69.224 21.376 71.112 22.848 72.84C24.384 74.504 26.304 75.336 28.608 75.336C30.976 75.336 32.96 74.504 34.56 72.84C36.224 71.176 37.056 69.288 37.056 67.176C37.056 65.064 36.288 63.176 34.752 61.512C33.216 59.784 31.2 58.92 28.704 58.92C26.272 58.92 24.32 59.784 22.848 61.512ZM88.227 47.784C88.611 44.2 91.139 42.408 95.811 42.408C98.307 42.408 100.163 42.6 101.379 42.984C102.595 43.368 103.427 44.04 103.875 45C104.387 45.96 104.675 46.824 104.739 47.592C104.867 48.296 104.931 49.384 104.931 50.856V84.456C104.931 85.928 104.867 87.048 104.739 87.816C104.675 88.52 104.419 89.352 103.971 90.312C103.075 91.976 100.867 92.808 97.347 92.808C93.891 92.808 91.555 92.392 90.339 91.56C89.187 90.664 88.515 89.384 88.323 87.72C85.955 91.112 81.987 92.808 76.419 92.808C70.915 92.808 65.795 90.28 61.059 85.224C56.323 80.168 53.955 74.312 53.955 67.656C53.955 60.936 56.323 55.08 61.059 50.088C65.859 45.032 71.107 42.504 76.803 42.504C78.979 42.504 80.963 42.888 82.755 43.656C84.547 44.424 85.795 45.16 86.499 45.864C87.203 46.504 87.779 47.144 88.227 47.784ZM70.755 67.752C70.755 69.864 71.587 71.784 73.251 73.512C74.915 75.176 76.931 76.008 79.299 76.008C81.667 76.008 83.619 75.144 85.155 73.416C86.755 71.688 87.555 69.8 87.555 67.752C87.555 65.64 86.787 63.688 85.251 61.896C83.779 60.104 81.763 59.208 79.203 59.208C76.707 59.208 74.659 60.104 73.059 61.896C71.523 63.688 70.755 65.64 70.755 67.752ZM136.391 42.408C142.791 42.408 148.103 44.872 152.327 49.8C156.615 54.664 158.759 60.616 158.759 67.656V84.552C158.759 86.024 158.695 87.144 158.567 87.912C158.503 88.616 158.247 89.416 157.799 90.312C156.903 92.04 154.407 92.904 150.311 92.904C145.767 92.904 143.143 91.72 142.439 89.352C142.055 88.264 141.863 86.632 141.863 84.456V67.56C141.863 64.936 141.095 62.888 139.559 61.416C138.087 59.944 136.071 59.208 133.511 59.208C131.015 59.208 128.967 59.976 127.367 61.512C125.831 63.048 125.063 65.064 125.063 67.56V84.552C125.063 86.024 124.999 87.144 124.871 87.912C124.807 88.616 124.519 89.416 124.007 90.312C123.175 92.04 120.711 92.904 116.615 92.904C112.583 92.904 110.119 92.04 109.223 90.312C108.775 89.352 108.487 88.52 108.359 87.816C108.295 87.048 108.263 85.928 108.263 84.456V50.472C108.263 49.064 108.295 48.008 108.359 47.304C108.487 46.536 108.807 45.704 109.319 44.808C110.215 43.208 112.679 42.408 116.711 42.408C120.615 42.408 123.015 43.144 123.911 44.616C124.551 45.704 124.871 47.016 124.871 48.552C125.127 48.104 125.703 47.464 126.599 46.632C127.495 45.8 128.359 45.128 129.191 44.616C131.367 43.144 133.767 42.408 136.391 42.408ZM196.049 21.384C196.561 20.424 197.425 19.752 198.641 19.368C199.857 18.984 201.457 18.792 203.441 18.792C205.489 18.792 207.121 18.984 208.337 19.368C209.553 19.752 210.385 20.424 210.833 21.384C211.345 22.344 211.633 23.208 211.697 23.976C211.825 24.68 211.889 25.768 211.889 27.24V84.552C211.889 86.024 211.825 87.144 211.697 87.912C211.633 88.616 211.345 89.416 210.833 90.312C209.873 92.04 207.153 92.904 202.673 92.904C198.257 92.904 195.793 91.336 195.281 88.2C192.593 91.272 188.849 92.808 184.049 92.808C178.289 92.808 173.041 90.312 168.305 85.32C163.569 80.264 161.201 74.408 161.201 67.752C161.201 61.032 163.569 55.144 168.305 50.088C173.105 45.032 178.353 42.504 184.049 42.504C188.785 42.504 192.465 44.104 195.089 47.304V27.144C195.089 25.672 195.121 24.584 195.185 23.88C195.313 23.112 195.601 22.28 196.049 21.384ZM180.497 73.512C182.161 75.24 184.177 76.104 186.545 76.104C188.913 76.104 190.865 75.24 192.401 73.512C194.001 71.784 194.801 69.896 194.801 67.848C194.801 65.736 194.033 63.784 192.497 61.992C191.025 60.2 189.009 59.304 186.449 59.304C183.889 59.304 181.841 60.2 180.305 61.992C178.769 63.72 178.001 65.64 178.001 67.752C178.001 69.864 178.833 71.784 180.497 73.512ZM248.048 47.784C248.432 44.2 250.96 42.408 255.632 42.408C258.128 42.408 259.984 42.6 261.2 42.984C262.416 43.368 263.248 44.04 263.696 45C264.208 45.96 264.496 46.824 264.56 47.592C264.688 48.296 264.752 49.384 264.752 50.856V84.456C264.752 85.928 264.688 87.048 264.56 87.816C264.496 88.52 264.24 89.352 263.792 90.312C262.896 91.976 260.688 92.808 257.168 92.808C253.712 92.808 251.376 92.392 250.16 91.56C249.008 90.664 248.336 89.384 248.144 87.72C245.776 91.112 241.808 92.808 236.24 92.808C230.736 92.808 225.616 90.28 220.88 85.224C216.144 80.168 213.776 74.312 213.776 67.656C213.776 60.936 216.144 55.08 220.88 50.088C225.68 45.032 230.928 42.504 236.624 42.504C238.8 42.504 240.784 42.888 242.576 43.656C244.368 44.424 245.616 45.16 246.32 45.864C247.024 46.504 247.6 47.144 248.048 47.784ZM230.576 67.752C230.576 69.864 231.408 71.784 233.072 73.512C234.736 75.176 236.752 76.008 239.12 76.008C241.488 76.008 243.44 75.144 244.976 73.416C246.576 71.688 247.376 69.8 247.376 67.752C247.376 65.64 246.608 63.688 245.072 61.896C243.6 60.104 241.584 59.208 239.024 59.208C236.528 59.208 234.48 60.104 232.88 61.896C231.344 63.688 230.576 65.64 230.576 67.752ZM339.021 43.56C342.349 45.544 344.013 47.656 344.013 49.896C344.013 51.176 343.373 52.936 342.093 55.176L322.221 89.256C321.581 90.344 320.557 91.336 319.149 92.232C317.741 93.064 316.333 93.48 314.925 93.48C313.581 93.48 312.269 93.16 310.989 92.52C309.773 91.816 308.909 91.112 308.397 90.408L307.533 89.352L287.565 55.176C286.285 53.064 285.645 51.336 285.645 49.992C285.645 47.688 287.309 45.544 290.637 43.56C293.069 42.152 294.989 41.448 296.397 41.448C297.805 41.448 298.893 41.896 299.661 42.792C300.493 43.624 301.357 44.904 302.253 46.632L314.829 70.824L327.405 46.632C328.109 45.416 328.621 44.552 328.941 44.04C329.325 43.464 329.901 42.92 330.669 42.408C331.437 41.832 332.461 41.544 333.741 41.544C335.021 41.544 336.781 42.216 339.021 43.56ZM344.944 50.856C344.944 49.384 344.976 48.296 345.04 47.592C345.168 46.824 345.456 45.96 345.904 45C346.8 43.336 349.296 42.504 353.392 42.504C356.464 42.504 358.64 43.048 359.92 44.136C361.008 45.032 361.584 46.408 361.648 48.264C361.712 48.904 361.744 49.832 361.744 51.048V84.648C361.744 86.12 361.68 87.24 361.552 88.008C361.488 88.712 361.2 89.544 360.688 90.504C359.856 92.168 357.392 93 353.296 93C349.264 93 346.8 92.136 345.904 90.408C345.456 89.448 345.168 88.616 345.04 87.912C344.976 87.208 344.944 86.088 344.944 84.552V50.856ZM360.688 33.096C360.24 33.992 359.408 34.632 358.192 35.016C356.976 35.4 355.344 35.592 353.296 35.592C351.312 35.592 349.712 35.4 348.496 35.016C347.28 34.632 346.416 33.96 345.904 33C345.456 32.04 345.168 31.208 345.04 30.504C344.976 29.736 344.944 28.616 344.944 27.144C344.944 25.672 344.976 24.584 345.04 23.88C345.168 23.112 345.456 22.28 345.904 21.384C346.8 19.656 349.296 18.792 353.392 18.792C357.424 18.792 359.856 19.656 360.688 21.384C361.2 22.344 361.488 23.208 361.552 23.976C361.68 24.68 361.744 25.768 361.744 27.24C361.744 28.712 361.68 29.832 361.552 30.6C361.488 31.304 361.2 32.136 360.688 33.096ZM398.981 21.384C399.493 20.424 400.357 19.752 401.573 19.368C402.789 18.984 404.389 18.792 406.373 18.792C408.421 18.792 410.053 18.984 411.269 19.368C412.485 19.752 413.317 20.424 413.765 21.384C414.277 22.344 414.565 23.208 414.629 23.976C414.757 24.68 414.821 25.768 414.821 27.24V84.552C414.821 86.024 414.757 87.144 414.629 87.912C414.565 88.616 414.277 89.416 413.765 90.312C412.805 92.04 410.085 92.904 405.605 92.904C401.189 92.904 398.725 91.336 398.213 88.2C395.525 91.272 391.781 92.808 386.981 92.808C381.221 92.808 375.973 90.312 371.237 85.32C366.501 80.264 364.133 74.408 364.133 67.752C364.133 61.032 366.501 55.144 371.237 50.088C376.037 45.032 381.285 42.504 386.981 42.504C391.717 42.504 395.397 44.104 398.021 47.304V27.144C398.021 25.672 398.053 24.584 398.117 23.88C398.245 23.112 398.533 22.28 398.981 21.384ZM383.429 73.512C385.093 75.24 387.109 76.104 389.477 76.104C391.845 76.104 393.797 75.24 395.333 73.512C396.933 71.784 397.733 69.896 397.733 67.848C397.733 65.736 396.965 63.784 395.429 61.992C393.957 60.2 391.941 59.304 389.381 59.304C386.821 59.304 384.773 60.2 383.237 61.992C381.701 63.72 380.933 65.64 380.933 67.752C380.933 69.864 381.765 71.784 383.429 73.512ZM466.915 61.704C466.915 65.608 465.923 68.52 463.939 70.44C462.019 72.296 459.875 73.224 457.507 73.224H434.755C434.755 75.016 435.811 76.52 437.923 77.736C440.035 78.952 442.147 79.56 444.259 79.56C447.971 79.56 450.883 79.176 452.995 78.408L454.051 78.024C455.587 77.32 456.867 76.968 457.891 76.968C459.939 76.968 461.699 78.408 463.171 81.288C464.003 83.016 464.419 84.488 464.419 85.704C464.419 91.4 457.603 94.248 443.971 94.248C439.235 94.248 435.011 93.448 431.299 91.848C427.651 90.184 424.803 88.008 422.755 85.32C418.723 80.136 416.707 74.344 416.707 67.944C416.707 59.88 419.299 53.448 424.483 48.648C429.731 43.784 436.259 41.352 444.067 41.352C452.963 41.352 459.491 44.488 463.651 50.76C465.827 54.088 466.915 57.736 466.915 61.704ZM446.659 64.488C449.091 64.488 450.307 63.464 450.307 61.416C450.307 59.944 449.731 58.76 448.579 57.864C447.491 56.968 445.891 56.52 443.779 56.52C441.731 56.52 439.683 57.384 437.635 59.112C435.587 60.776 434.563 62.568 434.563 64.488H446.659ZM467.419 67.752C467.419 60.072 470.107 53.736 475.483 48.744C480.859 43.752 487.003 41.256 493.915 41.256C500.827 41.256 506.939 43.752 512.251 48.744C517.563 53.672 520.219 59.976 520.219 67.656C520.219 72.968 518.843 77.704 516.091 81.864C513.339 85.96 509.979 89 506.011 90.984C502.107 92.904 498.043 93.864 493.819 93.864C489.595 93.864 485.499 92.84 481.531 90.792C477.563 88.68 474.203 85.608 471.451 81.576C468.763 77.48 467.419 72.872 467.419 67.752ZM487.483 74.664C489.531 76.2 491.611 76.968 493.723 76.968C495.835 76.968 497.947 76.168 500.059 74.568C502.171 72.968 503.227 70.6 503.227 67.464C503.227 64.328 502.235 61.992 500.251 60.456C498.267 58.92 496.123 58.152 493.819 58.152C491.515 58.152 489.371 58.952 487.387 60.552C485.403 62.152 484.411 64.52 484.411 67.656C484.411 70.728 485.435 73.064 487.483 74.664Z" fill="white"/></svg>',t=document.createElement("a");t.setAttribute("target","_blank"),t.setAttribute("class","panda-branding-link"),player_configs.refCode&&""!==player_configs.refCode?t.setAttribute("href","https://pandavideo.com.br?ref="+player_configs.refCode):t.setAttribute("href","https://pandavideo.com.br?utm_source=player&utm_campaign=logo"),e=e.replace(/white/gm,"var(--plyr-video-control-color)"),t.innerHTML=e,Ip(t)}}(),Zu=!0),player_configs.video_offline_enabled&&function(){var e=document.createElement("button");e.setAttribute("class","plyr__control plyr__controls__item plyr__download"),e.setAttribute("type","button"),e.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C12.5523 2 13 2.44772 13 3V14.5858L17.2929 10.2929C17.6834 9.90237 18.3166 9.90237 18.7071 10.2929C19.0976 10.6834 19.0976 11.3166 18.7071 11.7071L12.7071 17.7071C12.3166 18.0976 11.6834 18.0976 11.2929 17.7071L5.29289 11.7071C4.90237 11.3166 4.90237 10.6834 5.29289 10.2929C5.68342 9.90237 6.31658 9.90237 6.70711 10.2929L11 14.5858V3C11 2.44772 11.4477 2 12 2ZM4 21C4 20.4477 4.44772 20 5 20H19C19.5523 20 20 20.4477 20 21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21Z" fill="white"/>\n        </svg>';var t=document.querySelector(".plyr__controls"),n=t.children[6];n?t.insertBefore(e,n):t.appendChild(e),function(){var e=Xh[Kh].watchOfflineModal,t=!1;if("undefined"!=typeof navigator&&navigator.userAgentData)t=navigator.userAgentData.mobile||!1;else{var n=navigator.userAgent||navigator.vendor||window.opera;t=/android|bb\d+|meego.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)}!t&&/Macintosh/i.test(navigator.userAgent)&&"ontouchend"in document&&(t=!0);var i=document.createElement("div");i.id="modalOverlay",i.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        display: none;\n        align-items: center;\n        justify-content: center;\n        z-index: 1000;\n        text-align: center;\n    ",i.innerHTML='\n      <div id="modalContent" class="modal-content">\n        <div class="modal-header">\n            <span class="modal-title">'.concat(e.title,'</span>\n\n            <div class="modal-container-buttons">\n                <button class="modal-btn-container-learn-more" id="learnMore">\n                    <span class="modal-btn-learn-more" id="learnMoreSpan"></span>\n                </button>\n                <button class="modal-btn-container" id="closeBtn">\n                    <span class="modal-btn" id="closeBtnSpan"></span>\n                </button>\n            </div>\n        </div>\n        <div class="modal-body">\n            <div class="modal-items-container">\n                <div class="modal-content-text">\n                    <h3>').concat(e.subtitle,"</h3>\n                    <p>\n                        ").concat(t?e.paragraphMobile:e.paragraph,'\n                    </p>\n                </div>\n\n                <div class="modal-subcontent">\n                    <button class="modal-body-button" id="clickHere">').concat(e.btnText,'</button>\n                </div>\n            </div>\n            <div class="flex-column watch-offline-qrcode">\n                <img alt="QR Code" class="modal-qr-code" id="qrcode">\n            </div>\n            <div class="flex-column watch-offline-loading">\n                <div id="watch-offline-loading"></div>\n            </div>\n        </div>\n      </div>\n    ');var r=document.createElement("style");r.type="text/css",r.innerHTML="\n      .modal-content {\n          background-color: #1B1B20;\n          opacity: 0.91;\n          padding: 16px;\n          border-radius: 8px;\n          display: ".concat(t?"flex":"inline-block",";\n          position: relative;\n          width: ").concat(t?"100%":"500px",";\n          height: ").concat(t?"100%":"auto",";\n          flex-direction: ").concat(t?"column":"row",";\n      }\n\n      .modal-subcontent {\n          display: flex;\n          flex-direction: column;\n          justify-content: space-between;\n      }\n\n      .modal-items-container {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: right;\n      }\n    \n      .modal-container-buttons {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        gap: 8px;\n      }\n\n      .modal-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 12px;\n          margin-top: ").concat(t?"16px":"0",";\n      }\n\n      .modal-title {\n          font-size: 12px;\n          font-weight: 500;\n          color: #FFFFFF;\n          font-family: 'Rubik', sans-serif;\n          text-transform: uppercase;\n      }\n\n      .modal-btn-container-learn-more {\n          background: #FFFFFF;\n          border: none;\n          border-radius: 8px;\n          cursor: pointer;\n          padding: 7px;\n          align-items: center;\n          justify-content: center;\n      }\n\n       .modal-btn-container {\n          width: 32px;\n          height: 32px;\n          background: #FFFFFF;\n          border: none;\n          border-radius: 8px;\n          cursor: pointer;\n          padding: 10px;\n          align-items: center;\n          justify-content: center;\n        }\n\n      .modal-btn {\n          background: none;\n          border: none;\n          font-size: 12px;\n          font-weight: 700;\n          color: #636578;\n          display: flex;\n        }\n      \n        .modal-btn-learn-more {\n          background: none;\n          border: none;\n          font-size: 16px;\n          font-weight: 700;\n          color: #636578;\n          display: flex;\n        }\n\n      .modal-body {\n          display: flex;\n          flex: ").concat(t?"1":"auto",";\n          flex-direction: row;\n          font-size: 14px;\n          color: #FFFFFF;\n          font-family: 'Rubik', sans-serif;\n          justify-content: ").concat(t?"center":"space-between",";\n      }\n\n      .modal-body h3 {\n          font-size: 18px;\n          font-weight: 500;\n          line-height: 21.6px;\n          align-self: stretch;\n          text-align: ").concat(t?"center":"start",";\n          color: #FFFFFF;\n          margin: 0;\n          font-family: 'Rubik', sans-serif;\n          width: 200px;\n      }\n\n      .modal-body a {\n          color: #697AF2;\n          text-decoration: none;\n          font-family: 'Rubik', sans-serif;\n      }\n\n      .modal-body-button {\n          display: ").concat(t?"block":"none",";\n          background: #697AF2;\n          border: none;\n          color: #FFFFFF;\n          border-radius: 8px;\n          align-items: center;\n          text-decoration: none;\n          font-family: 'Rubik', sans-serif;\n          padding: 10px 16px;\n      }\n\n      .modal-body p {\n          font-size: 14px;\n          font-weight: 400;\n          line-height: 21px;\n          align-self: stretch;\n          text-align: ").concat(t?"center":"start",";\n          color: #D0D1D9;\n          margin: 0;\n          font-family: 'Rubik', sans-serif;\n          width: 200px;\n          padding-bottom: 8px;\n          padding-top: 8px;\n      }\n\n      .modal-body .modal-qr-code {\n          width: 200px;\n          height: 200px;\n          display: ").concat(t?"none":"block",";\n          border-radius: 8px;\n          margin-left: auto;\n          margin-right: auto;\n      }\n      \n      .flex-column {\n          display: flex;\n          flex-direction: column;\n      }\n\n      #watch-offline-loading {\n          display: ").concat(t?"none":"inline-block",";\n          width: 100px;\n          height: 100px;\n          border: 9px solid rgba(255,255,255,.3);\n          border-radius: 50%;\n          border-top-color: #fff;\n          animation: spin 1s ease-in-out infinite;\n          -webkit-animation: spin 1s ease-in-out infinite;\n      }\n\n      .watch-offline-loading {\n          display: ").concat(t?"none":"flex",";\n          justify-content: center;\n          align-items: center;\n          width: 200px;\n          height: 200px;\n      }\n\n      @keyframes spin {\n          to { -webkit-transform: rotate(360deg); }\n      }\n      @-webkit-keyframes spin {\n          to { -webkit-transform: rotate(360deg); }\n      }\n\n      @media (max-width: 768px) {\n        .modal-content {\n            display: flex;\n            flex-direction: column;\n            width: 100%;\n            height: 100%;\n            border-radius: 0px;\n        }\n\n        .modal-header {\n            margin-top: 16px;\n        }\n\n        .modal-body {\n            flex: 1;\n            align-items: center;\n            justify-content: center;\n            gap: 24px;\n        }\n\n        .modal-body h3 {\n            width: 306px;\n            text-align: center;\n        }\n\n        .modal-body p {\n            width: 306px;\n            text-align: center;\n        }\n\n        .modal-items-container {\n          align-items: center;\n        }\n    }\n\n   @media (max-width: 425px) {\n        .modal-content {\n          width: 100%; \n          max-width: 100vw; \n          height: 100%; \n          padding: 2px; \n          box-sizing: border-box; \n          border-radius: 0px;\n        }\n\n        .modal-header {\n          margin-top: 2px;\n          margin-bottom: 2px;\n        }\n\n        .modal-body {\n          align-items: center;\n          justify-content: center;\n          width: 100%;\n          max-width: 100%;\n        }\n\n        .modal-body p {\n          padding: 0px;\n        }\n\n        .modal-btn-container {\n          width: auto;\n          height: auto;\n        }\n\n        .modal-btn-container-learn-more {\n          width: auto;\n          height: auto;\n        }\n\n        .modal-btn {\n          font-size: 10px;\n        }\n\n        .modal-btn-learn-more {\n          font-size: 10px;\n        }\n\n        .modal-body h3 {\n            width: auto;\n            font-size: 12px;\n            text-align: center;\n        }\n        \n        .modal-body p {\n            width: auto;\n            font-size: 10px;\n            text-align: center;\n        }\n\n        .modal-qr-code {\n          width: 50px;\n          height: 50px;\n        }\n\n        #watch-offline-loading {\n          width: 50px;\n          height: 50px;\n        }\n        \n        .watch-offline-loading {\n          width: auto;\n          height: auto;\n        }\n    }\n    "),document.head.appendChild(r),document.getElementsByClassName("plyr")[0].insertAdjacentElement("beforeend",i);var s=document.getElementById("closeBtn"),a=document.getElementById("closeBtnSpan"),o=document.getElementById("learnMoreSpan");a.innerHTML='\n    <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5893 1.58934C11.9148 1.2639 11.9148 0.736263 11.5893 0.410826C11.2639 0.0853888 10.7363 0.0853888 10.4108 0.410826L6.00008 4.82157L1.58934 0.410826C1.2639 0.0853888 0.736263 0.0853888 0.410826 0.410826C0.0853888 0.736263 0.0853888 1.2639 0.410826 1.58934L4.82157 6.00008L0.410826 10.4108C0.0853888 10.7363 0.0853888 11.2639 0.410826 11.5893C0.736263 11.9148 1.2639 11.9148 1.58934 11.5893L6.00008 7.17859L10.4108 11.5893C10.7363 11.9148 11.2639 11.9148 11.5893 11.5893C11.9148 11.2639 11.9148 10.7363 11.5893 10.4108L7.17859 6.00008L11.5893 1.58934Z" fill="#636578"/>\n    </svg>\n    ',o.innerHTML='\n    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M9.00005 1.63636C4.93319 1.63636 1.63636 4.93317 1.63636 8.99999C1.63636 13.0669 4.93319 16.3636 9.00005 16.3636C13.0668 16.3636 16.3637 13.0669 16.3637 8.99999C16.3637 4.93317 13.0668 1.63636 9.00005 1.63636ZM0 8.99999C0 4.02944 4.02944 0 9.00005 0C13.9706 0 18 4.02944 18 8.99999C18 13.9705 13.9706 18 9.00005 18C4.02944 18 0 13.9705 0 8.99999Z" fill="#636578"/>\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M9.19377 6.01818C8.8446 5.95829 8.48552 6.0239 8.18013 6.20339C7.87472 6.38288 7.6427 6.66466 7.52514 6.99882C7.38769 7.38956 6.9595 7.5949 6.56877 7.45744C6.17802 7.31999 5.97269 6.8918 6.11014 6.50106C6.34525 5.83273 6.8093 5.26916 7.42009 4.91019C8.0309 4.55122 8.74904 4.42 9.4473 4.53977C10.1456 4.65955 10.7789 5.02258 11.2352 5.56459C11.6914 6.10648 11.9411 6.7923 11.9401 7.50062C11.9399 8.64839 11.0888 9.40637 10.4811 9.81146C10.1544 10.0293 9.83304 10.1895 9.59634 10.2947C9.47691 10.3478 9.37629 10.3881 9.30384 10.4156C9.26748 10.4295 9.23805 10.4402 9.21663 10.4478L9.19062 10.4569L9.18234 10.4597L9.17937 10.4607L9.17829 10.4612C9.17829 10.4612 9.1773 10.4614 8.94015 9.74999L9.1773 10.4614C8.78436 10.5925 8.35962 10.3801 8.22864 9.98714C8.09773 9.59438 8.30974 9.17003 8.70219 9.03872L8.71416 9.03449C8.7257 9.03035 8.74461 9.02351 8.76982 9.01388C8.8204 8.99465 8.89561 8.96463 8.9871 8.92396C9.17226 8.84168 9.41337 8.72058 9.64908 8.56341C10.1663 8.2186 10.4402 7.8518 10.4402 7.49994V7.49882C10.4406 7.14458 10.3158 6.80159 10.0876 6.53059C9.85959 6.25959 9.54288 6.07807 9.19377 6.01818Z" fill="#636578"/>\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.25014 12.75C8.25014 12.3357 8.58593 12 9.00018 12H9.00765C9.42183 12 9.75762 12.3357 9.75762 12.75C9.75762 13.1642 9.42183 13.4999 9.00765 13.4999H9.00018C8.58593 13.4999 8.25014 13.1642 8.25014 12.75Z" fill="#636578"/>\n    </svg>\n    ',document.querySelector(".plyr__download").addEventListener("click",(function(){i.style.display="flex"})),s.addEventListener("click",(function(){i.style.display="none"})),i.addEventListener("click",(function(e){e.target===i&&(i.style.display="none")})),function(){var e=Mu+"/app/qrcode?v="+Xu,t=document.querySelector(".watch-offline-qrcode");t.style.display="none";var n=document.querySelector(".watch-offline-loading");fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Was not possible to fetch qr code")})).then((function(e){var i=e.base64,r=e.link,s="pt"===Kh?"https://help.pandavideo.com/pt-br/article/como-assistir-videos-da-panda-em-modo-offline-a5zzwa/":"https://help.pandavideo.com/en-us/article/how-to-watch-panda-videos-in-offline-mode-tnww6s/",a=document.getElementById("qrcode"),o="data:image/png;base64,".concat(i);a.src=o,document.getElementById("learnMore").addEventListener("click",(function(e){e.preventDefault(),rf(s)})),document.getElementById("clickHere").addEventListener("click",(function(e){e.preventDefault(),rf(r)})),t.style.display="",n.style.display="none"})).catch((function(e){console.error("Error:",e)}))}()}()}(),Fh&&(player_configs.defaultSpeed=null==Bh?void 0:Bh.defaultSpeed),Fh&&oh&&Yf(document.getElementsByClassName("plyr__controls")[0],"disabled"),(d=document.querySelector(".plyr__menu__container > div"))&&(d.style.maxHeight="calc(-50px + 75vh)",d.style.minHeight="100px",d.style.overflowY="auto"),"online"===Mh&&(l=document.getElementsByClassName("plyr__controls")[0],(c=document.createElement("button")).setAttribute("id","live-time-indicator"),c.onclick=function(){window.postMessage({type:"currentTime",parameter:-1},"*")},c.innerHTML="<div></div> LIVE",l.insertBefore(c,l.childNodes[1]));try{!function(){t.apply(this,arguments)}()}catch(e){}Gh=!0,window.liveAttempts=0}var a,o,l,c,d,u,h,p,f},ih?Hp():$p(),document.getElementsByTagName("head")[0],document.createElement("script").type="text/javascript"}function Ef(){for(var e=0,t=Object.keys(player_configs);e<t.length;e++){var n=t[e],i=Pu.searchParams.get(n);if(i){if("trialWarning"===n)continue;if("controls"===n){player_configs[n]=i.split(",");var r=player_configs.controls.findIndex((function(e){return"volume"===e}));-1!==r&&player_configs.controls.splice(r,0,"mute");var s=player_configs.controls.findIndex((function(e){return"current-time"===e}));-1!==s&&player_configs.controls.splice(s+1,0,"duration")}else"boolean"==typeof player_configs[n]?"true"!==i&&"false"!==i||(player_configs[n]="true"===i):"number"==typeof player_configs[n]?player_configs[n]=parseFloat(i):Array.isArray(player_configs[n])?player_configs[n]=i.split(","):player_configs[n]=i}}}Rp(),((Xu||th||nh||eh)&&Qu||(document.write("Missing videoID (v) or libID (l)"),0))&&wf();var Tf=function(){var e=gh?"ios":"hlsjs",t=document.querySelector("video");if("hlsjs"===e)return window.hls.audioTracks;if("ios"===e){for(var n=[],i=0;i<t.audioTracks.length;i++)n.push({name:t.audioTracks[i].label,id:t.audioTracks[i].id,lang:t.audioTracks[i].language});return n}},Sf=function(){var e=gh?"ios":"hlsjs",t=document.querySelector("video");if("hlsjs"===e)return-1===window.hls.audioTrack?window.hls.audioTracks[0]:window.hls.audioTracks[window.hls.audioTrack];if("ios"===e)for(var n=0;n<t.audioTracks.length;n++)if(t.audioTracks[n].enabled)return{name:t.audioTracks[n].label,id:t.audioTracks[n].id,lang:t.audioTracks[n].language}},xf=function(e){var t=gh?"ios":"hlsjs",n=document.querySelector("video");if("hlsjs"===t)window.hls.audioTrack=e;else if("ios"===t)for(var i=0;i<n.audioTracks.length;i++)n.audioTracks[i].id===e?n.audioTracks[i].enabled=!0:n.audioTracks[i].enabled=!1;window.player&&!gh&&(window.isPlaying=window.player.playing,window.player.pause(),Lf(!0));try{localStorage.setItem("panda_video_audio_lang",Sf().lang)}catch(e){}!function(){var e=document.querySelector("#panda-settings-audio-btn");if(e){var t=Sf();e.innerHTML='<span>udio<span class="plyr__menu__value">'.concat(t.name,"</span></span>");var n=document.querySelector("#plyr-settings-audio");if(n){var i,r=Su(n.querySelectorAll('button[data-plyr="language"]'));try{for(r.s();!(i=r.n()).done;){var s=i.value;s.value==t.id?s.setAttribute("aria-checked",!0):s.setAttribute("aria-checked",!1)}}catch(e){r.e(e)}finally{r.f()}}}}()};function kf(){var e=document.querySelector(".plyr__menu__container > div > div > div");if(e&&!(Tf().length<2)){var t=Sf(),n=document.createElement("button");n.setAttribute("data-plyr","settings"),n.setAttribute("type","button"),n.setAttribute("class","plyr__control plyr__control--forward"),n.setAttribute("role","menuitem"),n.setAttribute("id","panda-settings-audio-btn"),n.setAttribute("aria-haspopup","true"),n.innerHTML='<span>udio<span class="plyr__menu__value">'.concat(t.name,"</span></span>"),n.onclick=function(){var e,t=Su(document.querySelector(".plyr__menu__container > div ").childNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.id.includes("audio")?n.removeAttribute("hidden"):n.setAttribute("hidden","")}}catch(e){t.e(e)}finally{t.f()}},e.insertBefore(n,e.childNodes[0]);var i=document.querySelector(".plyr__menu__container > div"),r=document.createElement("div");r.setAttribute("id","plyr-settings-audio"),r.setAttribute("hidden","");var s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("class","plyr__control plyr__control--back"),s.innerHTML='<span aria-hidden="true">udio</span><span class="plyr__sr-only">Voltar ao menu anterior</span>',s.onclick=function(){var e,t=Su(document.querySelector(".plyr__menu__container > div ").childNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.id.includes("home")?n.removeAttribute("hidden"):n.setAttribute("hidden","")}}catch(e){t.e(e)}finally{t.f()}};var a=document.createElement("div");a.setAttribute("role","menu");var o,l=Su(Tf());try{var c=function(){var e=o.value,n=document.createElement("button");n.setAttribute("data-plyr","language"),n.setAttribute("type","button"),n.setAttribute("role","menuitemradio"),n.setAttribute("class","plyr__control"),n.setAttribute("aria-checked",t.id===e.id),n.setAttribute("value",e.id),n.innerHTML="<span>".concat(e.name).concat("default"!==e.lang?'<span class="plyr__menu__value"><span class="plyr__badge">'.concat(e.lang.toUpperCase(),"</span></span>"):"","</span>"),n.onclick=function(){xf(e.id),s.click(),document.querySelector("button[data-plyr='settings']").click()},a.appendChild(n)};for(l.s();!(o=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}r.appendChild(s),r.appendChild(a),i.appendChild(r)}}function Cf(e){try{if(0===e)window.hls.currentLevel=-1;else{if("online"===Mh){var t=Nh.reverse().indexOf(e);t>=0&&(window.hls.currentLevel=t)}window.hls.levels.forEach((function(t,n){t.height===e&&(window.hls.currentLevel=n)}))}}catch(e){}Vu&&!gh&&window.player&&(Th=!0,window.player.pause(),Lf(!0))}function Lf(e){var t=document.querySelector(".loading-icon"),n=document.querySelector(".plyr__control--overlaid"),i=!1;Vu&&document.getElementById("drm-loader")&&"none"!==document.getElementById("drm-loader").style.display&&(i=!0),e&&!i?(t.style.opacity=.8,n&&Yf(n,"disabled"),Kf(t,"disabled")):(n&&Kf(n,"disabled"),Yf(t,"disabled"))}function Af(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{recoverFromError:!1};t.recoverFromError&&window.hls&&window.hls.destroy();var n=new Ha(e),i=document.querySelector("video"),r=i.getElementsByTagName("source")[0].src;if(r.includes("token=")){var s=r.split("token=")[1].split("&")[0];r=r.replace(s,Mf())}i.getElementsByTagName("source")[0].src=r,n.loadSource(r),n.attachMedia(i),ih&&n.on(Ha.Events.LEVEL_UPDATED,(function(e,t){"online"===Mh&&!1===t.details.live&&(console.log("The live stream has ended!"),Ph=!0)})),n.on(Ha.Events.AUDIO_TRACKS_UPDATED,(function(){try{kf()}catch(e){console.log("Error adding audio controls",e)}})),n.on(Ha.Events.SUBTITLE_TRACKS_UPDATED,(function(e,t){t.subtitleTracks&&t.subtitleTracks.length&&(player_configs.defaultSubtitle&&(window.player.language=player_configs.defaultSubtitle),player_configs.startsWithSubtitle&&(window.player.captions.active=!0))})),n.on(Ha.Events.MANIFEST_PARSED,(function(){try{Cf(JSON.parse(localStorage.getItem("plyr")).quality)}catch(e){}t.recoverFromError?(t.isPlaying&&i.play(),i.currentTime=t.currentTime,i.speed=t.speed,i.volume=t.volume):ph||player_configs.autoplay&&(player_configs.smartAutoplay?(i.volume=1,i.play()):(i.volume=0,i.play()))})),n.on(Ha.Events.BUFFER_FLUSHED,(function(e,t){Lf(!0)})),n.on(Ha.Events.BUFFER_APPENDED,(function(e,t){Th||Lf(!1),"audio"===t.type&&window.isPlaying&&window.player.play()})),n.on(Ha.Events.LEVEL_LOADED,(function(e,t){clearTimeout(op),op=setTimeout((function(){try{if(lp.includes(window.hls.currentLevel))return;var e=[];t.details.fragments.forEach((function(t){e.push(t.url)}));var n=Array.from(e).filter((function(e){return e.includes("drm.pandavideo.com")}));if(n.length){var i=n.slice(0,Math.min(Math.ceil(n.length/2),250));try{var r=i.map((function(e){return fetch(e,{method:"HEAD"}).then()}));Promise.all(r)}catch(e){}}lp.push(window.hls.currentLevel)}catch(e){}}),500)})),n.on(Ha.Events.LEVEL_SWITCHED,(function(e,t){var i=document.querySelector(".plyr__controls [data-plyr='quality'][value='0'] span");if(null!=i)if(n.autoLevelEnabled){var r=n.levels[t.level].height;i.innerHTML="Auto ("+r+"p)"}else i.innerHTML="Auto";var s,a=Su(document.querySelectorAll(".plyr__controls [role='menuitem'] span.plyr__menu__value"));try{for(a.s();!(s=a.n()).done;){var o=s.value;if(o.innerHTML.includes("Auto")||"0p"===o.innerHTML)if(n.autoLevelEnabled){var l=n.levels[t.level].height;o.innerHTML="Auto ("+l+"p)"}else o.innerHTML="Auto"}}catch(e){a.e(e)}finally{a.f()}}));var a=function(){try{var e=n.streamController.levels.map((function(e){return e.height})),t=n.streamController.levels[n.streamController.level].height,i=e.sort((function(e,t){return t-e})).find((function(e){return e!==t}));Cf(i),console.log("Changing video quality to the next higher one",i),window.player.quality=i}catch(e){}},o=function(){try{var e=n.streamController.levels.map((function(e){return e.height})),t=n.streamController.levels[n.streamController.level].height;if(t<=720)return!1;var i=e.sort((function(e,t){return t-e})).find((function(e){return e<t}));return!!i&&(console.log("Changing video quality to a lower one",i),Cf(i),window.player.quality=i,!0)}catch(e){}return!1},l=0;n.on(Ha.Events.LEVEL_SWITCHING,(function(e,t){var i,r=Su(n.levels);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(s&&s.uri&&s.uri.includes("token=")){var a=s.uri.split("token=")[1].split("&")[0],o=Mf();s.url=[s.uri.replace(a,o)]}}}catch(e){r.e(e)}finally{r.f()}})),n.on(Ha.Events.ERROR,(function(t,s){if("hlsFragParsingMetadata"!=="".concat(s.event)||"internalException"!=="".concat(s.details))if(ap++,"bufferStalledError"==="".concat(s.details)&&Lf(!0),ih&&"levelLoadTimeout"==="".concat(s.details))console.log("=> PANDA HLS ERROR DELECTED\nPRELOAD="+ph+"\n",t,s),Af(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:i.volume,isPlaying:!i.paused});else if(s.response&&404===s.response.code)ih?setTimeout((function(){console.log("=> PANDA HLS ERROR DELECTED\nPRELOAD="+ph+"\n",t,s),Af(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:i.volume,isPlaying:!i.paused})}),1e4):Vu||a();else if(s.response&&403===s.response.code&&l<3){if(3==++l)a(),l=0;else if(Wu&&r.includes("token=")){var c=r.split("token=")[1].split("&")[0],d=r.replace(c,Mf());i.getElementsByTagName("source")[0].src=d}}else if(s.fatal)setTimeout((function(){if(Wu&&r.includes("token=")){var n=r.split("token=")[1].split("&")[0],a=r.replace(n,Mf());i.getElementsByTagName("source")[0].src=a}console.log("=> PANDA HLS ERROR DELECTED\nPRELOAD="+ph+"\n",t,s),Af(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:i.volume,isPlaying:!i.paused})}),3e4);else if("online"!==Mh)if(!Vu&&function(e){try{var t,n=e.abrController.fragCurrent.url,i=qu.find((function(e){return n.includes(e)})),r=Su(e.streamController.levels);try{for(r.s();!(t=r.n()).done;){var s=t.value;if(s.details&&s.details.fragments){var a,o=Su(s.details.fragments);try{for(o.s();!(a=o.n()).done;)if(!a.value.url.includes(i))return!0}catch(e){o.e(e)}finally{o.f()}}}}catch(e){r.e(e)}finally{r.f()}}catch(e){}return!1}(n)&&zu.includes("".concat(s.details)))!function(e){var t=e.abrController.fragCurrent.url;ju=qu.find((function(e){return!t.includes(e)}));var n,i=Su(e.streamController.levels);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.details&&r.details.fragments){var s,a=Su(r.details.fragments);try{var o=function(){var e=s.value,t=e.url,n=qu.find((function(e){return t.includes(e)})),i=t.replace(n,ju);e.url=i};for(a.s();!(s=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}}}}catch(e){i.e(e)}finally{i.f()}console.log("Recovering to",qu.findIndex((function(e){return e===ju})))}(n);else{if(Vu&&[Ha.ErrorDetails.BUFFER_STALLED_ERROR,Ha.ErrorDetails.BUFFER_NUDGE_ON_STALL].includes(s.details))return void o();if([Ha.ErrorDetails.BUFFER_APPEND_ERROR,Ha.ErrorDetails.BUFFER_STALLED_ERROR,Ha.ErrorDetails.BUFFER_NUDGE_ON_STALL,Ha.ErrorDetails.BUFFER_FULL_ERROR].includes(s.details))return void(o()||n.startLoad());[Ha.ErrorDetails.FRAG_LOAD_ERROR,Ha.ErrorDetails.FRAG_LOAD_TIMEOUT].includes(s.details)?o():s.reason&&!s.reason.includes("AAC PES did not start with ADTS header")&&(console.log("=> PANDA HLS ERROR DELECTED\nPRELOAD="+ph+"\n",t,s),Af(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:window.player.volume,isPlaying:!i.paused}))}})),window.hls=n,-1==window.hls.currentLevel&&"online"!==Mh&&"finished"!==Mh&&"NOT_LIVE"!==Mh&&(window.hls.currentLevel=2)}function Rf(){bh&&Af({abrEwmaDefaultEstimate:5e6,maxBufferLength:20,autoStartLoad:!0,manifestLoadingRetryDelay:3e4,fragLoadingMaxRetry:9999,fragLoadingTimeOut:1e3*cp,xhrSetup:function(e,t){}}),rh=!0}function If(){return Df.apply(this,arguments)}function Df(){return(Df=Tu(wu().mark((function e(){var t,n,i,r,s;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t="https://hit-realtime.pandavideo.com/icon.gif",n=!!window.hls.levels[window.hls.currentLevel]&&window.hls.levels[window.hls.currentLevel].height){e.next=5;break}return e.abrupt("return");case 5:i=window.player.currentTime,r=window.hls.bandwidthEstimate/1e3,s="".concat(t,"?quality=").concat(n,"&time=").concat(i.toFixed(2),"&bandwidth=").concat(r.toFixed(2),"&v=").concat(Xu,"&u=").concat(mp,"&p=").concat(Qu,"&referrer=").concat(encodeURIComponent(pp),"&visibily=").concat(!document[Lu],"&errors=").concat(ap),ap=0,fetch(s),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("Error sending live beacon",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function Pf(e){var t=new Image;t.src=e,t.onload=function(){try{var e="cover";t.width<t.height&&(e="contain"),Uh.style.setProperty("--background-size",e)}catch(e){Uh.style.setProperty("--background-size","cover")}},t.onerror=function(){Uh.style.setProperty("--background-size","cover")}}function Mf(){for(var e="",t=0;t<64;t++){var n=Math.floor(62*Math.random());e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n)}return e}function Of(){return Of=Tu(wu().mark((function e(t){var n,i,r,s,a,o,l,c,d,u,h,p,f;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,i=[],r=!1,s=!1,e.prev=4,a=-1===t.indexOf("?")?"?":"&",t+="".concat(a,"get_qualities=1"),o={method:"GET"},ih||(o.headers={"X-Custom-Referer":pp}),e.next=11,fetch("".concat(t),o);case 11:if(401!==(l=e.sent).status){e.next=19;break}return c=l.headers.get("drm-group-id"),Eh&&(c=Eh),cf(c),e.abrupt("return",!1);case 19:if(403!==l.status){e.next=22;break}return Xu="48af5a59-3ac4-480e-abff-905690d94567",Qu="vz-ded14ebd-85a",document.querySelector("video > source").src="https://b-".concat(Qu).concat($u,"/").concat(Xu,"/playlist.m3u8"),window.pandatag("videoHtmlLoaded",!0),uf(),e.abrupt("return",!1);case 22:return e.next=24,l.text();case 24:d=e.sent,u=d.split("\n");try{h=u.filter((function(e){return e.startsWith("#EXTINF")})).map((function(e){return e.split(",")[1]})),p=h[0].split("|").reduce((function(e,t){var n=xu(t.split(":"),2),i=n[0],r=n[1];return e[i]=r,e}),{}),p.drm&&(r="true"===p.drm,Vu=r),p.block_download&&(s="true"===p.block_download),p.duration&&(n=parseInt(p.duration)),p.percent_ts&&0==(Yu=100*parseFloat(p.percent_ts))&&(Vu=!1,Th=!1),Vu&&(Nf(),Th=!0)}catch(e){}f="",u.forEach((function(e){var n=e.match(/#EXT-X-STREAM-INF:.*RESOLUTION=\d+x(\d+)/);n&&n[1]?i.push(parseInt(n[1],10)):e.endsWith(".m3u8")&&!f&&(f=e.startsWith("http")?e:t.split("/").slice(0,-1).join("/")+"/"+e)})),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(4),console.error("Error getting m3u8:",e.t0);case 34:return e.abrupt("return",{block_download:s,drm:r,duration:n,m3u8Qualities:i});case 35:case"end":return e.stop()}}),e,null,[[4,31]])}))),Of.apply(this,arguments)}function Nf(){var e=document.getElementById("video-container"),t=Math.floor(e.offsetWidth/14);t>96&&(t=96),t<24&&(t=24);var n=Math.floor(e.offsetWidth/54);n>24&&(n=24),n<16&&(n=16);var i='\n    <svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 24 24">\n        <g fill="none" fill-rule="evenodd">\n            <path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z" />\n            <path fill="currentColor" d="M6 8a6 6 0 1 1 12 0h1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2zm6-4a4 4 0 0 1 4 4H8a4 4 0 0 1 4-4m2 10a2 2 0 0 1-1 1.732V17a1 1 0 1 1-2 0v-1.268A2 2 0 0 1 12 12a2 2 0 0 1 2 2" />\n        </g>\n    </svg>\n    '),r='\n      <div id="drm-loader" class="drm-loader">\n        <div id="drm-loader-content" class="drm-loader-content">\n          <div class="drm-loader-icon">'.concat(i,'</div>\n          <div class="drm-loader-text">').concat(Xh[Kh].drmPreload,'</div>\n          <div class="drm-loader-bar">\n            <div class="drm-loader-progress" style="width: 0%;"></div>\n          </div>\n        </div>\n      </div>\n    '),s="\n    .drm-loader {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(63, 85, 238, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      \n      .drm-loader-content {\n        display: flex;\n        flex-direction: column;\n        text-align: center;\n        align-items: center;\n        color: #fff;\n      }\n      \n      .drm-loader-icon {\n        opacity: 1;\n      }\n      \n      .drm-loader-text {\n        margin-top: 20px;\n        font-size: ".concat(n,"px;\n        font-weight: 400;\n        color: #ffffff;\n        line-height: 14.22px;\n        font-family: 'Rubik', sans-serif;\n      }\n      \n      .drm-loader-bar {\n        width: 50%;\n        height: 12px;\n        background: #fff;\n        margin-top: 20px;\n        position: relative;\n        overflow: hidden;\n        border-radius: 8px;\n        border: 1px solid #FFFFFF;\n        display: grid;\n        justify-self: center;\n      }\n\n      .drm-loader-progress {\n        background-color: #007bff; /* Cor de preenchimento da barra */\n        height: 100%;\n        width: 0%; /* Largura inicial */\n        border-radius: 8px;\n        transition: width 0.5s ease-out;\n      }\n    ");document.body.insertAdjacentHTML("beforeend",r);var a=document.createElement("link");a.href="https://fonts.googleapis.com/css2?family=Rubik:wght@300..900&display=swap",a.rel="stylesheet",document.head.appendChild(a);var o=document.createElement("style");o.type="text/css",o.innerText=s,document.head.appendChild(o),Bf()}function Ff(){document.getElementById("drm-loader")&&!Ih&&(document.getElementById("drm-loader").style.display="flex",Lf(!1),Ih=!0)}function Bf(){document.getElementById("drm-loader")&&(document.getElementById("drm-loader").style.display="none"),Uf(0)}function Uf(e){var t=document.querySelector(".drm-loader-progress");t&&(t.style.width=e+"%",e>=100&&setTimeout(Bf,Ah))}function $f(e,t){if(t)return clearInterval(Rh),Rh=null,Uf(Lh),void setTimeout(Bf,Ah);Ff(),Uf(Math.round(e))}function Gf(){var e=document.querySelector("video"),t=null,n=e.getElementsByTagName("source")[0].src;function i(n){if(n){var i=0;bh&&!Vu||(i=n.includes(720)?720:Math.min.apply(Math,bu(n)),n.shift()),dp.quality={default:i,options:n,forced:!0,onChange:function(e){Cf(e)}}}else dp.quality={default:480,options:[360,480,720],forced:!0,onChange:function(e){Cf(e)}};pandatag("setupPlayer",(function(n){var i;player_configs.disableSeeking?n.listeners={seek:function(e){return e.preventDefault(),!1}}:Vu&&!gh&&(n.listeners={seek:function(e){return Th=!0,window.player.pause(),Lf(!0),Hf(),!0}}),t=new(za())(e,n),(!player_configs.controls.includes("fullscreen")||player_configs.iosFakeFullscreen&&gh)&&t.eventListeners.forEach((function(e){"dblclick"===e.type&&e.element.removeEventListener(e.type,e.callback,e.options)})),"online"!==Gu.status&&"active"!==Gu.status||((i=document.createElement("button")).setAttribute("class","panda-live-chat plyr__control plyr__controls__item"),i.setAttribute("type","button"),i.addEventListener("click",(function(){window.innerWidth;var e=document.querySelector(".live-chat-container"),t=document.getElementsByClassName("plyr")[0];if(e)e.classList.contains("disabled")?(e.classList.remove("disabled"),af("remove"),sf()):(e.style.height="0px",e.classList.add("disabled"));else{var n=document.createElement("div");n.classList.add("live-chat-container"),n.innerHTML=gp(),t.style.flexDirection="row",t.insertAdjacentElement("beforeend",n),sf()}})),i.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 18V21.766L6.515 20.857L11.277 18H16C17.103 18 18 17.103 18 16V8C18 6.897 17.103 6 16 6H4C2.897 6 2 6.897 2 8V16C2 17.103 2.897 18 4 18H5ZM4 8H16V16H10.723L7 18.234V16H4V8Z" fill="white"/><path d="M20 2H8C6.897 2 6 2.897 6 4H18C19.103 4 20 4.897 20 6V14C21.103 14 22 13.103 22 12V4C22 2.897 21.103 2 20 2Z" fill="white"/></svg>',Ip(i,1),window.addEventListener("message",(function(e){var t=e.data;if("panda_newLiveChatMessage"===t||"panda_closeLiveChat"===t){var n=document.querySelector(".live-chat-container");"panda_newLiveChatMessage"===t?n.classList.contains("disabled")&&af("add"):"panda_closeLiveChat"===t&&(n.style.height="0px",n.classList.add("disabled"))}}))),function(){of.apply(this,arguments)}();var s=document.getElementsByClassName("loading-icon")[0];_h||Yf(s,"disabled"),window.player=t,function(){try{var n=document.getElementsByTagName("video")[0];n.addEventListener("webkitbeginfullscreen",(function(){Yf(document.querySelector("div.plyr"),"fullscreen")}),!1),n.addEventListener("webkitendfullscreen",(function(){Kf(document.querySelector("div.plyr"),"fullscreen")}),!1)}catch(e){}var i=["progress","ready","play","pause","timeupdate","seeking","seeked","ended","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","canplay","error"],s={};i.forEach((function(e){t.on(e,(function(){var n=(new Date).getTime();if(!s[e]||n-s[e]>30){s[e]=n;var i,r=Su(rp);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.iframe.contentWindow&&a.iframe.contentWindow.postMessage({message:"panda_"+e,video:Xu,currentTime:t.currentTime,isMutedIndicator:!(!player_configs.mutedIndicatorIcon||qh),isPreviousProgressLoaded:zh},"*")}}catch(e){r.e(e)}finally{r.f()}if("ready"===e&&_h)return;window.parent.postMessage({message:"panda_"+e,video:Xu,currentTime:t.currentTime,isMutedIndicator:!(!player_configs.mutedIndicatorIcon||qh),isPreviousProgressLoaded:zh},"*")}}))})),player_configs.smartAutoplay&&up.forEach((function(e){window.addEventListener(e,r)})),nh&&window.parent.postMessage({message:"panda_ready_comparison",video:nh,video_external_id:Xu},"*"),Vu&&!gh&&(Ff(),Hf()),Vu&&!gh&&t.on("play",(function(){Th&&(t.pause(),Lf(!0),Hf())})),t.on("languagechange",(function(){var e,n=null===(e=t)||void 0===e||null===(e=e.captions)||void 0===e?void 0:e.language;if(n)if(bh){var i=window.hls.subtitleTracks.find((function(e){return e.lang===n}));i&&(window.hls.subtitleTrack=i.id)}else for(var r=document.getElementsByTagName("video")[0],s=0;s<r.textTracks.length;s++)r.textTracks[s].language===n?r.textTracks[s].mode="showing":r.textTracks[s].mode="hidden"})),(player_configs.playOpensFullscreen||player_configs.playOpensFullscreenNative)&&(t.on("play",(function(){player_configs.mutedIndicatorIcon&&!qh||(player_configs.playOpensFullscreenNative?t.fullscreen.enter():window.parent.postMessage({message:"panda_open_window_fullscreen",video:Xu},"*"))})),t.on("pause",(function(){player_configs.playOpensFullscreenNative?t.fullscreen.exit():window.parent.postMessage({message:"panda_close_window_fullscreen",video:Xu},"*")}))),player_configs.disablePause&&t.on("pause",(function(){t.duration!==t.currentTime&&t.play().catch((function(){}))}));var a=t.speed,o=t.config.speed.turbo;if(setInterval((function(){if(t.speed!==a){if(function(e){document.querySelectorAll('[data-plyr="speed"]').forEach((function(t){t.getAttribute("value")===String(e)?t.setAttribute("aria-checked","true"):t.setAttribute("aria-checked","false")}))}(a=t.speed),t.speed!==o)try{localStorage.setItem("user-plyr-speed-config",t.speed)}catch(e){}T(),window.parent.postMessage({message:"panda_speed_update",video:Xu,speed:t.speed},"*")}}),50),t.on("timeupdate",(function(e){ih&&Ph&&function(e,t){var n=Math.round(1e4*e)/1e4,i=Math.round(1e4*t)/1e4;if(Math.abs(n-i)<=.01){var r=document.getElementsByClassName("live-offline-badge")[0],s=document.getElementById("live-subtitle");s&&(s.innerHTML=Xh[Kh].liveFinished),document.getElementById("live-title").innerHTML=Dh,Kf(r,"disabled")}}(t.currentTime,hls.media.duration);var n=parseInt(t.currentTime,10);n%5==Ku%5&&Ku!==n&&qf({}),t.currentTime>0&&Yh.length&&(Yh.forEach((function(e){"currentTime"===e.type&&t.playing&&(t.currentTime=e.value)})),Yh=[])})),_h){var l=function(){t.once("progress",(function(){t.once("timeupdate",(function(){if(Lf(!1),!player_configs.disablePause&&c)return c.style.visibility="visible"}))}))},c=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');t.once("play",(function(){if(Ru.checkPlayerVolume(),!t.seeking)return l();t.once("seeked",(function(){return l()}))}))}function d(e){t.currentTime=e}function u(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).reload,n=void 0!==e&&e;if(!player_configs.mutedIndicatorIcon||qh){var i=parseInt(t.currentTime.toFixed(0)),r=player_configs.ctas.filter((function(e){return(i>e.time+e.duration||i<e.time)&&"video"===e.type&&!!e.removed}));r.length&&(player_configs.ctas=player_configs.ctas.map((function(e){return r.find((function(t){return t.id===e.id}))&&(e.removed=!1),e})));var s=player_configs.ctas.find((function(e){var t=document.getElementById(e.id);if(t){if(!n)return!1;t.remove()}return e.time<=i&&e.time+e.duration>=i&&"video"===e.type&&!e.removed}));if(s){var a,o,l=document.getElementsByClassName("plyr--html5")[0],c=(document.getElementsByClassName("plyr__controls"),document.createElement("div"));c.onmouseenter=function(){var e=document.getElementsByClassName("plyr--hide-controls");e&&e[0]&&Kf(e[0],"plyr--hide-controls")},c.id=s.id,null!=s&&s.pauseVideo&&window.postMessage({type:"pause"},"*"),Yf(c,"cta-overlay"),Yf(c,"cta-element"),"full"===s.width&&(c.style.width="100%",c.style.height="".concat(s.height,"px"));var d=document.createElement("iframe");if(null!=s&&null!==(a=s.metadata)&&void 0!==a&&a.isMiniTrigger&&(c.style.opacity=0,c.style.transition="opacity ".concat(s.metadata.fadeConfigs.fadeInMs,"ms")),null!=s&&null!==(o=s.metadata)&&void 0!==o&&o.selectedButtonSize&&(c.style.zIndex=3,Hu&&s.metadata.link&&!s.metadata.wereQueryParamsMerged)){var u=function(e,t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.indexOf("?");return n>=0?(t&&(n+=1),e.slice(n)):""}(e,!0),i={targetContent:"",newContent:""};if(n){var r=mu(n),s=mu(t),a=pu(pu({},r),s);i.targetContent=n,i.newContent=function(e){var t=new URLSearchParams;for(var n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);return t.toString()}(a)}else i.targetContent=e,i.newContent="".concat(e,"?").concat(t);return i}(s.metadata.link,Hu);s.script=s.script.replace(u.targetContent,u.newContent),s.metadata.wereQueryParamsMerged=!0}if(s.maxZIndex&&(c.style.zIndex=99999),s.height&&s.width){var h=function(){var e=window.innerWidth,t=window.innerHeight,n={topLeft:function(){d.style.top="30px",d.style.left="30px"},fixedTopLeft:function(){d.style.top="0",d.style.left="0"},topCenter:function(){var t=parseInt(d.style.width.replace("px",""),10);d.style.top="30px",d.style.left=e/2-t/2+"px"},topRight:function(){d.style.top="30px",d.style.right="30px"},midLeft:function(){var e=parseInt(d.style.height.replace("px",""),10);d.style.top=t/2-e/2+"px",d.style.left="30px"},midCenter:function(){var n=parseInt(d.style.height.replace("px",""),10),i=parseInt(d.style.width.replace("px",""),10);d.style.top=t/2-n/2+"px",d.style.left=e/2-i/2+"px"},midRight:function(){var e=parseInt(d.style.height.replace("px",""),10);d.style.top=t/2-e/2+"px",d.style.right="30px"},bottomLeft:function(){d.style.bottom="70px",d.style.left="30px"},bottomCenter:function(){d.style.bottom="70px";var t=parseInt(d.style.width.replace("px",""),10);d.style.left=e/2-t/2+"px"},bottomRight:function(){d.style.bottom="70px",d.style.right="30px"}};"full"===s.width?(d.style.height="".concat(s.height,"px"),d.style.width="100%",d.style.top=0,d.style.left=0):e>=450?(d.style.height=s.height.large+"px",d.style.width=s.width.large+"px"):e<450&&e>300?(d.style.height=s.height.medium+"px",d.style.width=s.width.medium+"px"):e<=300&&(d.style.height=s.height.small+"px",d.style.width=s.width.small+"px"),s.position&&n[s.position]()};d.style.position="absolute",d.style.zIndex=999,h(),window.onresize=h}if(d.id="".concat(s.id,"_iframe"),d.onload=function(){Cp(d.contentWindow.document.body);var e=document.getElementById("".concat(s.id,"_iframe")),t=/<script>(.|\n)*?<\/script>/gm,n=s.script.match(t),i=s.script.replace(t,"");if(n&&n.length){var r=n[0].replace("<script>","").replace("<\/script>",""),a=document.createElement("script");a.type="text/javascript",a.innerHTML=r,e.contentWindow.document.body.innerHTML="".concat(i),e.contentWindow.document.body.appendChild(a)}else e.contentWindow.document.body.innerHTML="".concat(i);e.contentWindow.document.body.style="padding:0;margin:0"},rp.find((function(e){return e.id===s.id}))||rp.push({iframe:d,id:s.id}),c.appendChild(d),s.skipButton){var p=document.createElement("button");p.innerHTML="Continuar assistindo",Yf(p,"cta-skip-button"),p.onclick=function(){window.postMessage({type:"play"},"*")},c.appendChild(p)}l.appendChild(c),c.style.opacity=1}var f=player_configs.ctas.find((function(e){return!!document.getElementById(e.id)&&(e.time+e.duration<i||e.time>i)}));if(f){if(null!=f&&f.pauseVideoEnd&&(null==f?void 0:f.time)+(null==f?void 0:f.duration)<i)return void window.postMessage({type:"pause"},"*");var m,g=document.getElementById(f.id);g&&(null!=f&&null!==(m=f.metadata)&&void 0!==m&&m.isMiniTrigger?(g.style.transition="opacity ".concat(f.metadata.fadeConfigs.fadeOutMs,"ms"),g.style.opacity=0,setTimeout((function(){g.remove()}),f.metadata.fadeConfigs.fadeOutMs)):g.remove()),rp=rp.filter((function(e){return e.id!==f.id}))}}}function h(){"http"===player_configs.endThumbnail.substr(0,4)&&(player_configs.ctas=player_configs.ctas.filter((function(e){return"end"!==e.type})),player_configs.ctas.push({type:"end",id:"endThumb",script:"<img src='".concat(player_configs.endThumbnail,"' style='object-fit:cover; width:100%; height:100%;'><script>document.querySelector('img').onclick=function() { window.parent.postMessage({type: 'cta_play',}, '*') }</scr")+"ipt>"})),"http"===player_configs.pauseThumbnail.substr(0,4)&&(player_configs.ctas||(player_configs.ctas=[]),player_configs.ctas=player_configs.ctas.filter((function(e){return"pause"!==e.type})),player_configs.ctas.push({type:"pause",id:"pauseThumb",script:"<img src='".concat(player_configs.pauseThumbnail,"' style='object-fit:cover; width:100%; height:100%;'><script>document.querySelector('img').onclick=function() { window.parent.postMessage({type: 'cta_play',}, '*') }</scri")+"pt>"})),player_configs.ctas&&player_configs.ctas.length>0&&(t.on("play",(function(){var e=document.getElementById("end-cta");e&&Yf(e,"disabled");var t,n=Su(document.getElementsByClassName("pause-cta"));try{for(n.s();!(t=n.n()).done;)Yf(t.value,"disabled")}catch(e){n.e(e)}finally{n.f()}})),t.on("pause",(function(){var e=parseInt(t.currentTime,10),n=parseInt(t.duration,10);if(!t.seeking&&e!==n){var i=player_configs.ctas.find((function(t){return"pause"===t.type&&(void 0===t.startTime||void 0===t.endTime||t.startTime<e&&t.endTime>e)}));if(!i)return;var r=document.getElementById(i.id);r&&Kf(r,"disabled")}})),t.on("ended",(function(){window.onEnd&&window.onEnd()})),t.on("timeupdate",u))}function p(){var e=parseInt(t.currentTime.toFixed(0),10);if(parseInt(t.duration.toFixed(0),10)-e>30){var n=document.getElementById("live-time-indicator");n&&Yf(n,"not-realtime"),m=!1}else{m=!0;var i=document.querySelector(".plyr__progress input");i&&(Yf(i,"hide-slyder-badge"),i.style="--value: 100%;"),Kf(document.getElementById("live-time-indicator"),"not-realtime")}if(!m){var r=document.querySelector(".plyr__progress input");r&&Kf(r,"hide-slyder-badge")}}if(t.on("play",(function(){Yh.length&&(Yh.forEach((function(e){"currentTime"===e.type&&t.playing&&(t.currentTime=e.value)})),Yh=[]),jf()})),player_configs.restartAfterEnd&&(player_configs.onlyLoopMuted?t.muted&&t.on("ended",(function(){d(0),t.play().catch((function(){}))})):t.on("ended",(function(){d(0),t.play().catch((function(){}))}))),player_configs.videoRedirect&&t.on("ended",(function(){window.postMessage({type:"redirect_video",parameter:{videoId:player_configs.videoRedirect.externalId}},"*")})),h(),player_configs.alternativeProgress&&t.on("timeupdate",(function(){var e,n=parseFloat(t.currentTime.toFixed(3),10),i=parseFloat(t.duration.toFixed(3),10),r=document.querySelector(".alternative-progress");if(player_configs.alternativeProgressDefaultVelocity){var s=n/i;e=100*Math.sqrt(1-(s-=1)*s)}else{var a=player_configs.alternativeProgress2xLimit,o=player_configs.alternativeProgressVelocity,l=a/100/o;e=n<i*l?(e=100*n/i*o).toFixed(2):a+(n-i*l)*(100-a)/(i*(1-l))}r&&e&&(r.style="--value-progress: "+e+"%;"),player_configs.alternativeProgressHeight&&r&&(r.style="--value-progress: "+e+"%;height: "+player_configs.alternativeProgressHeight+"px;")})),"boolean"==typeof player_configs.hideControlsOnStart&&player_configs.hideControlsOnStart||"string"==typeof player_configs.hideControlsOnStart&&"true"==player_configs.hideControlsOnStart.toLowerCase()){var f=document.querySelector(".plyr__controls");f&&Yf(f,"disabled"),t.on("play",(function(e){var t=document.querySelector(".plyr__controls");t&&Kf(t,"disabled")}))}ih&&"online"===Mh&&(t.on("timeupdate",p),t.on("seeking",(function(){Kf(document.querySelector(".plyr__progress input"),"hide-slyder-badge"),p()})),t.on("seeked",(function(){var e=parseInt(t.currentTime.toFixed(0),10),n=parseInt(t.duration.toFixed(0),10);n-e>10&&n-e<30&&window.postMessage({type:"currentTime",parameter:-1},"*")}))),player_configs.saveProgress&&t.on("timeupdate",(function(){var e=parseInt(t.currentTime.toFixed(0),10),n=parseInt(t.duration.toFixed(0),10);if(0!=e&&qh)if(100*e/n>90)try{localStorage.removeItem("panda_video:"+Xu)}catch(e){}else try{localStorage.setItem("panda_video:"+Xu,e)}catch(e){}else if(ch&&![document.querySelector(".small-muted-icon"),document.querySelector(".panda-muted-indicator-item")].some((function(e){return e&&!Vf(e,"disabled")}))&&zh)try{localStorage.setItem("panda_video:"+Xu,e)}catch(e){}}));var m=!0,g=0,y=[],v=[];function b(n){if(player_configs.saveProgressScreen){var i=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');player_configs.autoplay?(t.muted=!0,t.play()):(t.pause(),Yf(i,"disabled")),e.style.visibility="hidden";var r=document.querySelector(".container"),s=document.createElement("div");Yf(s,"panda-resume-screen-wrapper"),s.style="opacity: "+player_configs.saveProgressBackgroundOpacity+";";var a=document.createElement("p");a.innerText=player_configs.saveProgressTitle;var o=document.createElement("div");Yf(o,"panda-resume-screen-buttons");var l=document.createElement("button");l.innerHTML='<svg viewBox="0 0 24 24">\n                                  <path fill="var(--plyr-video-control-color)" d="M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M10,16.5L16,12L10,7.5V16.5Z" />\n                              </svg><span>'+player_configs.saveProgressButton1Title+"</span>",l.onclick=function(){ph?(t.currentTime=n-1,d()):(window.onLoadVideoWithoutPreload||(window.onLoadVideoWithoutPreload=[]),window.onLoadVideoWithoutPreload.push((function(){t.currentTime=n,d()})),window.onLoadVideoWithoutPreload.forEach((function(e){return e()}))),zf({})};var c=document.createElement("button");c.innerHTML='<svg viewBox="0 0 24 24">\n                                  <path fill="var(--plyr-video-control-color)" d="M12,4C14.1,4 16.1,4.8 17.6,6.3C20.7,9.4 20.7,14.5 17.6,17.6C15.8,19.5 13.3,20.2 10.9,19.9L11.4,17.9C13.1,18.1 14.9,17.5 16.2,16.2C18.5,13.9 18.5,10.1 16.2,7.7C15.1,6.6 13.5,6 12,6V10.6L7,5.6L12,0.6V4M6.3,17.6C3.7,15 3.3,11 5.1,7.9L6.6,9.4C5.5,11.6 5.9,14.4 7.8,16.2C8.3,16.7 8.9,17.1 9.6,17.4L9,19.4C8,19 7.1,18.4 6.3,17.6Z" />\n                              </svg><span>'+player_configs.saveProgressButton2Title+"<span>",c.onclick=function(){t.currentTime=0,d()},o.appendChild(l),o.appendChild(c),s.appendChild(a),s.appendChild(o),r.appendChild(s)}function d(){var n;setTimeout((function(){try{try{t.play().catch((function(){})),qh=!0}catch(e){}}catch(e){}}),0),Kf(i,"disabled"),(n=document.getElementById("wrapper-progress"))&&Kf(n,"disabled"),Yf(s,"disabled"),e.style.visibility="visible",t.volume=1,zf({})}}t.on("timeupdate",(function(){var e=parseInt(t.currentTime.toFixed(0),10),n=parseInt(t.duration.toFixed(0),10);if("online"===Mh&&Oh&&!m&&window.pb.updateLengthForLiveStream(n),0!==e&&!1===t.muted){var i=parseInt(100*e/n,10);if(!y.includes(i)){var r,s=player_configs.customPixels.filter((function(e){return"percentage"===e.conditionType&&e.conditionValue===i})),a=Su(s);try{for(a.s();!(r=a.n()).done;){var o=r.value,l=new Function(o.script);try{l()}catch(e){}}}catch(e){a.e(e)}finally{a.f()}y.push(i)}if(!v.includes(e)){var c,d=player_configs.customPixels.filter((function(t){return"absolute"===t.conditionType&&t.conditionValue===e})),u=Su(d);try{for(u.s();!(c=u.n()).done;){var h=c.value,p=new Function(h.script);try{p()}catch(e){}}}catch(e){u.e(e)}finally{u.f()}v.push(e)}if(i%5==0&&i!==g){if(g=i,player_configs.fbPixel.length>0)try{qh&&fbq("track","panda_watchtime_".concat(i,"%"),{percent:i,video_id:Xu,library_id:"b-"+Qu,duration:n,current_time:e})}catch(e){}if(player_configs.gtagIds.length>0)try{qh&&gtag("event","panda_watchtime_".concat(i,"%"),{percent:i,video_id:Xu,library_id:"b-"+Qu,duration:n,current_time:e})}catch(e){}if(i%10==0){if(player_configs.fbPixel.length>0)try{qh&&fbq("track","pandavideo_watchtime",{percent:i,video_id:Xu,library_id:"b-"+Qu,duration:n,current_time:e})}catch(e){}if(player_configs.gtagIds.length>0)try{qh&&gtag("event","pandavideo_watchtime",{percent:i,video_id:Xu,library_id:"b-"+Qu,duration:n,current_time:e})}catch(e){}}}}})),t.once("play",(function(e){if(!player_configs.autoplay){try{player_configs.controls.includes("volume")||(t.volume=1),zf({})}catch(e){}qh=!0}var n=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');if(n&&Kf(n,"disabled"),Yf(document.getElementsByClassName("loading-icon")[0],"disabled"),Yf(document.querySelector("div.plyr__poster"),"disabled"),player_configs.initSubtitle){var i=document.querySelector(".plyr__controls");i&&Kf(i,"disabled")}ph||rh||Rf()})),t.once("canplay",(function(){var n,i=document.querySelector(".plyr__poster");i&&Kf(i,"thumbnail-blur"),gh&&kf(),player_configs.startsWithSubtitle&&((JSON.parse(localStorage.getItem("plyr"))||{}).captions=!0,window.player.captions.active=!0,window.player.toggleCaptions(!0)),Fh&&oh&&setTimeout((function(){Kf(document.getElementsByClassName("plyr__controls")[0],"disabled")}),2e3),function(){var e=null;try{e=localStorage.getItem("panda_video_audio_lang")}catch(e){}if(e){var t,n=Su(Tf());try{var i=function(){var n=t.value;if(n.lang===e)return setTimeout((function(){xf(n.id)}),100),1};for(n.s();!(t=n.n()).done&&!i(););}catch(e){n.e(e)}finally{n.f()}}}(),window.addEventListener("blur",(function(){df()}));try{n=localStorage.getItem("panda_video:"+Xu)}catch(e){}var r,s=player_configs.defaultSpeed;try{localStorage.getItem("user-plyr-speed-config")}catch(e){}if(t.speed=s||player_configs.defaultSpeed,n&&player_configs.saveProgressScreen||!player_configs.autoplay||qh?(t.volume<.5||t.muted)&&!Fh&&(t.muted=!1,t.volume=1):player_configs.smartAutoplay?(t.muted=!1,t.volume=1,t.play().then((function(){Pp(),Dp()})).catch((function(e){"NotAllowedError"===e.name&&(t.muted=!0,t.play())})),e.autoplay=""):(t.muted=!0,t.play()),player_configs.saveProgressScreen&&n&&player_configs.autoplay?(t.muted=!0,t.play()):player_configs.saveProgressScreen&&n&&!player_configs.autoplay?t.pause():n&&player_configs.saveProgress&&d(parseInt(n)),Pu.searchParams.get("startTime")&&d(parseInt(Pu.searchParams.get("startTime"),10)),zh=!0,ph||window.onLoadVideoWithoutPreload&&window.onLoadVideoWithoutPreload.forEach((function(e){return e()})),player_configs.controls.includes("captions")||(r=document.querySelectorAll('[data-plyr="settings"].plyr__control.plyr__control--forward'))&&r.forEach((function(e){var t=e.querySelector("span");t&&/Legendas|Subttulos|Subtitles/i.test(t.innerHTML)&&(e.style.display="none")})),_h){Yf(document.getElementsByClassName("loading-icon")[0],"disabled");var a=null;try{a=localStorage.getItem("panda_video:"+Xu)}catch(e){}if(player_configs.saveProgressScreen&&a)return;t.play()}jf()})),t.on("ready",(function(n){if(function(){!function(){try{var e=document.getElementById("copy-paste");e&&e.remove()}catch(e){}}();try{var e=document.createElement("div");e.id="report-problem-dialog",Yf(e,"disabled"),e.innerHTML='<div id="copy-paste"><header> <p class="report-problem-text">'.concat(Xh[Kh].reportModalTitle,'</p></header> <div id="report-first-step"> <section id="radio-section"> <div> <input type="radio" id="report-not-loading" name="issue-reported" value="report-not-loading" checked> <label for="report-not-loading">').concat(Xh[Kh].reportModalOption1,'</label><br></div><div> <input type="radio" id="report-unmatch-description" name="issue-reported" value="report-unmatch-description"> <label for="report-unmatch-description">').concat(Xh[Kh].reportModalOption2,'</label> </div><div> <input type="radio" id="report-low-quality" name="issue-reported" value="report-low-quality"> <label for="report-low-quality">').concat(Xh[Kh].reportModalOption3,'</label> </div><div> <input type="radio" id="report-other" name="issue-reported" value="report-other"> <label for="report-other">').concat(Xh[Kh].reportModalOption4,'</label><br></div><div class="report-textfield-card"> <div id="other-input-wrapper" class="disabled"> <input class="other-input" type="text" id="other-input" name="other" placeholder="').concat(Xh[Kh].reportModalField,'"> </div></div></section> <footer> <button id="report-second-step-btn" class="report-problem-dialog-button">').concat(Xh[Kh].reportModalAction1,'</button> <button id="report-close-dialog-btn" class="report-problem-dialog-button">').concat(Xh[Kh].reportModalAction2,'</button> </footer> </div><div id="report-second-step" class="disabled"> <div id="loading-div"> <svg viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve"> <path fill="#4874F1" d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="360 50 50" repeatCount="indefinite"/> </path> </svg> </div><p id="second-step-text">').concat(Xh[Kh].reportModalText1," <br/> ").concat(Xh[Kh].reportModalText2,'</p></div><div id="report-third-step" class="disabled ').concat(Zu?"":"alone",'"> <header> ').concat(Zu?'<img id="panda-last-step-img" src="./icons/pandacheck.svg"/>':"",' </header> <p class="report-problem-text">').concat(Xh[Kh].reportModalText3,'</p><footer> <button id="report-ok-btn" class="report-problem-dialog-button">OK</button> </footer> </div></div>'),document.getElementsByClassName("plyr")[0].insertAdjacentElement("afterbegin",e)}catch(e){}!function(){try{var e=document.getElementsByClassName("plyr__control plyr__control--forward")[0].parentElement,t=document.createElement("button"),n=window.getComputedStyle(document.body,null).getPropertyValue("--plyr-color-main");t.textContent=Xh[Kh].reportModalTitle,t.classList.add("customSettingsBtn"),t.id="report-issue-btn",t.setAttribute("data-plyr","settings"),t.setAttribute("type","button"),t.setAttribute("role","menuitem"),t.setAttribute("aria-haspopup","true"),e.appendChild(t),document.getElementById("report-issue-btn").addEventListener("click",(function(){_p(),document.getElementsByClassName("plyr__controls__item plyr__menu")[0].click()})),t.onmouseover=function(){t.style.backgroundColor=n},t.onmouseleave=function(){t.style.removeProperty("background-color")};var i=document.createElement("button");i.textContent=Xh[Kh].viewHotKeys,i.classList.add("customSettingsBtn"),i.id="view-hot-keys-btn",i.setAttribute("data-plyr","settings"),i.setAttribute("type","button"),i.setAttribute("role","menuitem"),i.setAttribute("aria-haspopup","true"),Vh||e.appendChild(i),i.onmouseover=function(){i.style.backgroundColor=n},i.onmouseleave=function(){i.style.removeProperty("background-color")},document.getElementById("view-hot-keys-btn").addEventListener("click",(function(){wp()}));var r=document.querySelector(".plyr__menu button");r&&(r.onclick=function(){var e=document.getElementsByClassName("plyr__controls")[0];if(e){"true"===r.getAttribute("aria-expanded")?Yf(e,"plyr-controls-fix-index"):Kf(e,"plyr-controls-fix-index");var t=document.getElementById("context-menu-ai");t&&t.classList.contains("active")&&t.classList.remove("active")}})}catch(e){}}()}(),function(){try{var e=document.createElement("div");e.id="hot-keys-dialog",e.innerHTML='\n           <div id="hot-keys-dialog-content">\n               <header>\n                   <p class="hot-keys-title">'.concat(Xh[Kh].viewHotKeys,"</p>\n                   <button>").concat(bp,"</button>\n               </header>\n               <ul>\n                   <li>\n                       <p>").concat(Xh[Kh].playPause,"</p>\n                       <p>").concat(Xh[Kh].spaceOrK,"</p>\n                   </li>\n                   <li>\n                       <p>").concat(Xh[Kh].increaseVolume,"</p>\n                       <p>").concat(Xh[Kh].upArrow,"</p>\n                   </li>\n                   <li>\n                       <p>").concat(Xh[Kh].decreaseVolume,"</p>\n                       <p>").concat(Xh[Kh].downArrow,"</p>\n                   </li>\n                   <li>\n                       <p>").concat(Xh[Kh].seekForward,"</p>\n                       <p>").concat(Xh[Kh].rightArrow,"</p>\n                   </li>\n                   <li>\n                       <p>").concat(Xh[Kh].seekBackward,"</p>\n                       <p>").concat(Xh[Kh].leftArrow,"</p>\n                   </li>\n                   <li>\n                       <p>").concat(Xh[Kh].increaseSpeed,"</p>\n                       <p>").concat(Xh[Kh].shiftPeriod,"</p>\n                   </li>\n                   <li>\n                       <p>").concat(Xh[Kh].decreaseSpeed,"</p>\n                       <p>").concat(Xh[Kh].shiftComma,"</p>\n                   </li>\n               </ul>\n           </div>\n       "),Yf(e,"disabled"),document.getElementsByClassName("plyr")[0].insertAdjacentElement("afterbegin",e)}catch(e){}}(),t.media.load(),player_configs.ctas.length>0&&u(),player_configs.saveProgress){var i;try{i=localStorage.getItem("panda_video:"+Xu)}catch(e){}player_configs.saveProgressScreen&&i?"online"!==Mh&&b(parseInt(i,10)):player_configs.mutedIndicatorIcon?Bp():player_configs.muted&&player_configs.smallMutedIcon&&Mp()}var r,s,a;player_configs.captionsFontSize&&(r=Number(player_configs.captionsFontSize),s="\n        .plyr__captions {\n            font-size: ".concat(r,"px;\n        }\n\n        @media (min-width: 480px) {\n            .plyr__captions {\n                font-size: ").concat(r>34?r-8:r,"px;\n            }\n        }\n\n        @media (max-width: 480px) {\n            .plyr__captions {\n                font-size: ").concat(r>=26?r-12:r,"px;\n            }\n        }\n\n        @media (max-width: 460px) {\n            .plyr__captions {\n                font-size: 14px;\n            }\n        }\n\n        @media (min-width: 768px) {\n            .plyr__captions {\n                font-size: ").concat(r+3,"px;\n            }\n        }\n\n        @media (min-width: 1024px) {\n            .plyr:-webkit-full-screen .plyr__captions, .plyr:fullscreen .plyr__captions, .plyr__captions {\n                font-size: ").concat(r+6,"px;\n            }\n        }\n    "),(a=document.createElement("style")).innerText=s,document.head.appendChild(a)),e.style.visibility="visible",ph&&bh&&Af({abrEwmaDefaultEstimate:5e6,maxBufferLength:20,autoStartLoad:!0,manifestLoadingRetryDelay:3e4,fragLoadingMaxRetry:9999,fragLoadingTimeOut:1e3*cp,xhrSetup:function(e,t){}}),ih&&"online"===Mh&&setInterval(If,15e3)}));var _=!1;function w(e){return E.apply(this,arguments)}function E(){return(E=Tu(wu().mark((function e(t){var n;return wu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://hit-video.vunel.com:6443/icon_form.gif?v=".concat(Xu,"&p=").concat(Qu),e.next=3,fetch(n,{method:"POST",body:JSON.stringify(t),mode:"no-cors"});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){var e;try{e=localStorage.getItem("panda_video:"+Xu)}catch(e){}var n=t.currentTime;e&&0===n&&(n=parseFloat(e));var i=Uh.style.getPropertyValue("--plyr-color-main"),r=Uh.style.getPropertyValue("--plyr-captions-text-color"),s=Uh.style.getPropertyValue("--plyr-captions-background"),a=Uh.style.getPropertyValue("--plyr-video-control-color"),o=Uh.style.getPropertyValue("--plyr-menu-color"),l=_?t.duration:0,c={paused:t.paused,hasAudio:t.hasAudio,muted:t.muted,pip:t.pip,volume:t.volume,speed:t.config.speed,captions:t.captions,currentTime:n,duration:l,fullscreen:t.fullscreen.active,colors:{primaryColor:i,captionsColor:r,captionsBackgroundColor:s,controlsColor:a,menuColor:o}};window.parent.postMessage({message:"panda_allData",video:Pu.searchParams.get("v"),playerData:JSON.parse(JSON.stringify(c))},"*")}t.on("loadedmetadata",(function(e){jf(),_=!0})),i.forEach((function(e){t.on(e,T)})),window.onmessage=function(e){var n=e.data,i=document.querySelector(":root");if("setParentWindowUrl"===n.type&&(Hu=n.parameter,u({reload:!0})),"currentTime"!==n.type){if("muted_indicator_play"===n.type&&Pp(),"cta_play"===n.type&&t.play().catch((function(){})),"volume"===n.type)return t.volume=n.parameter,void(!qh&&n.parameter>0&&zf({}));if("speed"!==n.type)if("send_form"!==n.type)if("play_toggle"!==n.type){if("colors"===n.type){var r=n.parameter.colors;return r.primaryColor&&i.style.setProperty("--plyr-color-main",r.primaryColor),r.captionsColor&&i.style.setProperty("--plyr-captions-text-color",r.captionsColor),r.captionsBackgroundColor&&i.style.setProperty("--plyr-captions-background",r.captionsBackgroundColor),r.controlsColor&&(i.style.setProperty("--plyr-video-control-color",r.controlsColor),i.style.setProperty("--plyr-video-control-color-hover",r.controlsColor)),r.menuColor&&i.style.setProperty("--plyr-menu-color",r.menuColor),r.mutedIndicatorBackgroundColor&&i.style.setProperty("--muted-indicator-background",r.mutedIndicatorBackgroundColor),void(r.mutedIndicatorTextColor&&i.style.setProperty("--muted-indicator-text",r.mutedIndicatorTextColor))}if("ctas"===n.type){var s=n.parameter.ctas;return qp(),0===player_configs.ctas.length?(player_configs.ctas=s,zp(),jp(),h()):(player_configs.ctas=s,jp(),zp()),void u()}if("redirect_video"===n.type){var a,o=n.parameter.videoId;if(ch)return;document.querySelector("body").style.backgroundColor="#000";var l=document.querySelector("#video-container");return l&&l.remove(),Bh.defaultSpeed=null===(a=t)||void 0===a?void 0:a.speed,void function(e){Xu=e;var t=document.querySelector("div.container");t&&t.remove(),delete window.pandaLoad,delete window.pandatag,qh=!1,delete window.hls,delete window.player,Gh=!1,delete window.pb,window.pandaLoad={},Fh=!0;var n="https://b-"+Qu+$u+"/"+e+"/playlist.m3u8",i='\n    <div class="container redirect-loading" id="video-container">\n     '.concat(oh?"":'<video controls crossorigin preload="auto" autoplay muted playsinline ><source type="application/x-mpegURL" src="'.concat(n,'" ></video>'),'\n            \x3c!-- Loading indicator --\x3e\n            <div id="error-indicator" class="disabled">\n            </div>\n            <div class="loading-icon disabled">\n                <svg x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve">\n                    <path fill="#9e9e9e"\n                        d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">\n                        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s"\n                            from="0 50 50" to="360 50 50" repeatCount="indefinite" />\n                    </path>\n                </svg>\n            </div>\n            \n            \x3c!-- Live --\x3e\n            <div class="live-offline-badge disabled">\n\n                <img src="icons/panda-icon.svg" alt="">\n                <p id="live-subtitle">AGUARDANDO LIVE STREAM</p>\n                <p id="live-title"></p>\n            </div>\n            <div class="live-thumb disabled">\n                <img src="#" alt="Live Offline">\n            </div>\n        </div>\n    '),r=document.getElementsByTagName("body")[0],s=(new DOMParser).parseFromString(i,"text/html").body.firstChild;if(r.appendChild(s),oh){var a=(new DOMParser).parseFromString('<video controls crossorigin preload="auto" autoplay muted playsinline ><source type="application/x-mpegURL" src="'.concat(n,'"></video>'),"text/html").body.firstChild,o=document.getElementById("video-container");o.insertBefore(a,o.getElementsByTagName("div")[0])}window.pandaLoad.videoHtmlLoaded=!0,vp(),wf()}(o)}if("remove_cta"===n.type){var c=n.parameter,p=document.getElementById(c);player_configs.ctas=player_configs.ctas.map((function(e){return e.id!==c?e:vu(vu({},e),{},{removed:!0})})),p&&p.remove(),t.play().catch((function(){})),!0===(null==n?void 0:n.endPause)&&t.pause()}if("custom_muted_indicator"===n.type&&(player_configs.customMutedIndicatorData=n.parameter,player_configs.mutedIndicatorAnimation="custom",Fp()),"disable_control"===n.type){var f=n.parameter;("play"===f?document.querySelector('[data-plyr="play"]:not(.plyr__control--overlaid'):"play-large"===f?document.querySelector('[data-plyr="play"].plyr__control--overlaid'):document.querySelector('[data-plyr="'.concat(f,'"]'))).style.display="none"}if("enable_control"===n.type){var m=n.parameter;"play"===m?document.querySelector('[data-plyr="play"]:not(.plyr__control--overlaid').style.display="":"play-large"===m?document.querySelector('[data-plyr="play"].plyr__control--overlaid').style.display="flex":document.querySelector('[data-plyr="'.concat(m,'"]')).style.display=""}if("enable_all_controls"===n.type){var g=document.querySelector('[data-plyr="play"].plyr__control--overlaid');g&&(g.style.display="flex");var y=document.querySelector(".plyr__controls");y&&Kf(y,"disabled");var v=document.getElementById("wrapper-progress");v&&Kf(v,"disabled")}if("disable_all_controls"===n.type){var b=document.querySelector('[data-plyr="play"].plyr__control--overlaid');b&&(b.style.display="none");var _=document.querySelector(".plyr__controls");_&&Yf(_,"disabled")}if("bookMarks"===n.type){var E=n.parameter.bookMarks;return player_configs.bookMarks=E,void Yp()}if("fullscreen.toggle"!==n.type)if("fullscreen.exit"!==n.type)if("enable_caption_preview"===n.type&&Wf(n.parameter),"set_caption_preview"===n.type&&Xf(n.parameter),"disable_caption_preview"===n.type&&function(){var e=document.querySelector(".plyr__captions"),t=document.querySelector("#caption-preview");e.style.display="none";try{e.removeChild(t)}catch(e){}}(),"run_internal_methods"!==n.type)null!=n.parameter?t[n.type]&&t[n.type](n.parameter):t[n.type]&&t[n.type]();else{if(!ch)return;var T=new Function("return "+n.function)(),S=n.parameter;S?T(S):T()}else t.fullscreen.exit();else t.fullscreen.toggle()}else t.paused?t.play().catch((function(){})):t.pause();else w(n.parameter);else t.speed=n.parameter}else-1===n.parameter?d(t.duration-2):d(n.parameter)}}()})),pandatag("playerLoaded",!0)}function r(e){Dp(),document.querySelector(".panda-muted-indicator-item")||player_configs.mutedIndicatorIcon?(Pp(),t.on("controlsshown",(function(){qh||Pp()}))):(t.volume=1,t.play().catch((function(e){t.muted=!0,t.play()}))),up.forEach((function(e){window.removeEventListener(e,r)}))}(function(e){return Of.apply(this,arguments)})(n).then((function(e){if(e){var t=Math.ceil(e.duration/2);e.block_download&&bh&&(Wu=!0,document.querySelector("video").getElementsByTagName("source")[0].src+=n.includes("?")?"&":"?token="+Mf());for(var r=[],s=0;s<t;s+=36)r.push("https://b-"+Qu+$u+"/"+Xu+"/seek/_"+r.length+".jpg");window.player_configs.showPreviewThumbs&&!ih&&(dp.thumbnail={enabled:!0,pic_num:t,width:300,height:168,col:6,row:6,offsetX:0,offsetY:0,urls:r}),e.m3u8Qualities.length>1?i([0].concat(bu(e.m3u8Qualities.sort((function(e,t){return t-e}))))):i(e.m3u8Qualities)}})).catch((function(e){console.error("Error:",e),++Sh<=3?setTimeout((function(){Gf()}),100):i()}))}function Hf(){clearInterval(Ch),Ch=setInterval((function(){function e(){qh&&player.play(),Th=!1,Lf(!1),clearInterval(Ch)}if(player.duration>0&&player.duration<40)return e(),void $f(100,!0);window.hls.mainForwardBufferInfo&&window.hls.mainForwardBufferInfo.len!==xh&&(xh=window.hls.mainForwardBufferInfo.len);var t=player.duration-player.currentTime,n=3;if(Yu){var i=Math.floor(Yu/10);(n=i>n?i:n)>8&&(n=8)}var r=4*n;xh>0&&($f(xh/r*100,kh),(xh>r||t<r)&&(kh=!0),kh&&player.duration>0&&Th&&e())}),500)}function qf(e){var t=e.force,n=e.time;if(window.player){var i=parseInt(window.player.currentTime,10);ah&&(void 0!==n&&(i=n),(t||!player.muted&&qh&&!player.paused&&!ch&&"online"!==Mh)&&(navigator.sendBeacon(jh+"/icon.gif?type=check&v="+Xu+"&u="+mp+"&p="+Qu+"&current_time="+i+"&referrer="+encodeURIComponent(pp)+"&visibily="+!document[Lu]),Ku=i))}}function zf(e){var t=e.mutedIndicator;if(!ch&&!sh&&ah){try{navigator.sendBeacon(jh+"/icon.gif?type=play&v="+Xu+"&u="+mp+"&p="+Qu+"&referrer="+encodeURIComponent(pp)+"&visibily="+!document[Lu])}catch(e){}try{gtag("event","play",{video_id:Xu,library_id:"b-"+Qu})}catch(e){}try{fbq("track","play",{video_id:Xu,library_id:"b-"+Qu})}catch(e){}var n,i=player_configs.customPixels.filter((function(e){return"play"===e.conditionType})),r=Su(i);try{for(r.s();!(n=r.n()).done;){var s=n.value,a=new Function(s.script);try{a()}catch(e){}}}catch(e){r.e(e)}finally{r.f()}qf({force:!0,time:t?0:void 0}),sh=!0}}function jf(e){var t=document.getElementById("video-container");if(t){if(t.classList.contains("in-page-container")){var n=t.offsetHeight,i=(window.innerHeight-n)/2;n<1&&(i=0),t.style.cssText="\n        margin-top: ".concat(i,"px !important;\n      ")}var r=document.querySelector(".live-chat-container");r&&!r.classList.contains("disabled")&&(window.innerWidth<830||sf())}}function Vf(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function Yf(e,t){e&&(Vf(e,t)||(e.className+=" "+t))}function Kf(e,t){if(e&&Vf(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function Wf(e){var t=e.backgroundColor,n=e.fontSize,i=e.textColor,r=document.querySelector("#video-container"),s=document.querySelector(".plyr__captions");if(!s){var a=document.createElement("div");a.classList.add("plyr__captions"),a.setAttribute("dir","auto"),r.appendChild(a),s=document.querySelector(".plyr__captions")}if(!document.querySelector("#caption-preview")){var o=document.createElement("span");o.innerText="".concat(Xh[Kh].captionPreview),o.classList.add("plyr__caption"),o.id="caption-preview",s.appendChild(o)}s.style.display="block",s.style.fontSize=n,Uh.style.setProperty("--plyr-captions-background",t),Uh.style.setProperty("--plyr-captions-text-color",i)}function Xf(e){var t=e.backgroundColor,n=e.fontSize,i=e.textColor;document.querySelector(".plyr__captions").style.fontSize=n,Uh.style.setProperty("--plyr-captions-background",t),Uh.style.setProperty("--plyr-captions-text-color",i)}window.addEventListener("resize",jf),document.onkeydown=function(e){27==(e=e||window.event).keyCode&&(player_configs.playOpensFullscreen?window.parent.postMessage({message:"panda_close_window_fullscreen",video:Xu},"*"):player_configs.playOpensFullscreenNative&&window.postMessage({type:"fullscreen.exit"},"*"))}})()})();</script></body>